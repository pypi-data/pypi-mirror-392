- date: '2025-11-01'
  time_utc: 09:56:00
  summary: 要件定義をもとにCLI・オーケストレーターをTTDで完成させた
  details:
  - uv環境とpyprojectを整備し、pytestを導入
  - OrchestratorとCLIのテストを先行作成し、tmux制御・完了検知・Boss統合まで実装
  - サービス層（WorktreeManager, CodexMonitor, LogManager, TmuxLayoutManager）をテスト駆動で構築
  reproduce:
  - uv run pytest
  result: tests 10 passed
  notes: 実TMUX制御はlibtmuxスタブで検証、実環境でのキー送出確認が今後の確認事項
- date: '2025-11-01'
  time_utc: '19:20:00'
  summary: ワーカーペイン起動が停止していた問題を修正
  details:
  - TmuxLayoutManager.fork_workersを更新し、各ワーカーペインで直接`codex --cd <worktree>`を起動するよう変更
  - Orchestratorのフォーク処理から未実装のresumeステップを除去し、ワークツリー割当のフォールバックを排除
  - TTDでtmux/オーケストレータテストを更新し、期待するコマンドとパス検証を追加
  reproduce:
  - uv run pytest
  result: tests 15 passed
  notes: 暫定対応（20:45エントリで要件どおりのフォーク処理へ差し替え）。
- date: '2025-11-01'
  time_utc: '20:45:00'
  summary: 要件定義どおりメインセッションからフォークする挙動へ再修正
  details:
  - TmuxLayoutManager.fork_workersで`codex resume <main_session_id>`実行後に`Esc`×2→`Enter`を送出する処理へ変更
  - Orchestratorで全ワーカーにワークツリーを必須割当とし、既存のresumeワークフローに合わせたエラーハンドリングを追加
  - tmux/orchestratorテストを更新し、resumeコマンド・キー入力の送信を検証
  - 起動待機のばらつきに備えてstartup_delayとキー入力間隔を導入
  - デバッグ用途で`PARALLEL_DEV_PAUSE_AFTER_RESUME=1`時にワーカーレジューム直後で停止するフックを追加
  - フォーク後は指示文を再送せずEnterのみ送るよう変更し、worker側の重複入力を解消
  - CodexMonitorでレジューム直後の既存`/done`を無視し、新規追記分のみ検出するようoffset管理を追加
  - tmux起動コマンドを`cd <path> && codex`に簡素化し、`--cd`重複指定を解消
  - Boss用ワークツリーをtmuxへ渡し、workersと同様に`codex resume`→フォークまで自動化
  - BossManagerによる自動採点を廃止し、CLI上で手動選択（selector）を必須化
  - スコアボードは完了情報主体にし、選択結果のみスコアへ反映
  reproduce:
  - uv run pytest
  result: tests 15 passed
  notes: ロールアウトID検出と指示送信（pane基準）の責務を整理し、要件の並列起動フローと一致。
- date: '2025-11-02'
  time_utc: '00:57:00'
  summary: HELLOスクリプトをTTDで追加
  details:
  - 失敗するpytestを先に作成し、HELLO標準出力とログ生成を検証
  - ロガーを設定する`src/parallel_developer/25-11-02-09_hello.py`を実装し、詳細なDEBUGログを記録
  - 実装後にpytest全体を実行し、既存テストとの整合を確認
  reproduce:
  - uv run pytest tests/25-11-02-09_hello_script_test.py
  - uv run pytest
  result: tests 15 passed
  notes: 既存の25-11-01-19_.venv環境を再利用し、ログはlogs/25-11-02-09_hello.logへ出力。
- date: '2025-11-02'
  time_utc: '00:59:00'
  summary: HELLOスクリプトのログ文言を再整備
  details:
  - ログ検証を強化するpytestを作成し、HELLO標準出力とlogファイルのキーを確認
  - 25-11-02-09_hello.pyのデバッグログをhello_script_start/completeに統一
  - uv run pytestでスクリプト単体テストを実行し、既存ワークフローと競合しないことを確認
  reproduce:
  - uv run pytest tests/25-11-02-09_hello_script_test.py
  - uv run pytest
  result: tests 15 passed
  notes: logs/25-11-02-09_hello.logで実行履歴が追跡できる状態を確認
- date: '2025-11-02'
  time_utc: '01:16:19'
  summary: 新しいHELLOスクリプトをTTDで追加
  details:
  - 失敗するpytest tests/25-11-02-10_hello_script_test.pyを先に作成し、HELLO標準出力とログ生成を検証
  - 25-11-02-10_hello.pyで詳細なDEBUGログとHELLO標準出力を実装
  - uv run pytestで単体および全体テストを実行し、既存動作との整合を確認
  reproduce:
  - uv run pytest tests/25-11-02-10_hello_script_test.py
  - uv run pytest
  result: tests 16 passed
  notes: logs/25-11-02-10_hello.logにhello_script_start/message_prepared/completeのログが出力されることを確認
- date: '2025-11-02'
  time_utc: '01:24:34'
  summary: HELLO標準出力スクリプトを追加
  details:
  - 失敗するpytest tests/25-11-02-10_simple_hello_test.pyを作成し、標準出力とログ出力を検証
  - src/parallel_developer/25-11-02-10_simple_hello.pyで詳細なDEBUGログとHELLO標準出力を実装
  - uv run pytest tests/25-11-02-10_simple_hello_test.pyおよびuv run pytestで全体回帰を確認
  reproduce:
  - uv run pytest tests/25-11-02-10_simple_hello_test.py
  - uv run pytest
  result: tests 18 passed
  notes: logs/25-11-02-10_simple_hello.logにsimple_hello_start〜completeの履歴を記録
- date: '2025-11-02'
  time_utc: '01:24:49'
  summary: HELLO標準出力スクリプトをTTDで再追加
  details:
  - 失敗するpytest tests/25-11-02-10_hello_stdout_test.pyを先に作成し、標準出力とログ内容を検証
  - 25-11-02-10_hello_stdout.pyでstart/message_prepared/completeログを出力するHELLOスクリプトを実装
  - uv run pytest tests/25-11-02-10_hello_stdout_test.pyとuv run pytestで全体回帰を確認
  reproduce:
  - uv run pytest tests/25-11-02-10_hello_stdout_test.py
  - uv run pytest
  result: tests 17 passed
  notes: logs/25-11-02-10_hello_stdout.logでスクリプト実行フローを追跡可能
- date: '2025-11-02'
  time_utc: '01:25:31'
  summary: HELLO標準出力スクリプトをTTDで再生成
  details:
  - tests/25-11-02-10_hello_stdout_test.pyを先に作り、HELLO標準出力とログ3種を検証
  - src/parallel_developer/25-11-02-10_hello_stdout.pyを実装し、詳細なDEBUGログとHELLO出力を追加
  - uv run pytest tests/25-11-02-10_hello_stdout_test.pyとuv run pytestで全テストを確認
  reproduce:
  - uv run pytest tests/25-11-02-10_hello_stdout_test.py
  - uv run pytest
  result: tests 17 passed
  notes: logs/25-11-02-10_hello_stdout.logにhello_stdout_script_start〜completeを記録
- date: '2025-11-02'
  time_utc: '01:28:39'
  summary: HELLO標準出力スクリプトを新規追加
  details:
  - 失敗するpytest tests/25-11-02-10_test_hello.pyを先に作成し、HELLO標準出力を検証
  - src/25-11-02-10_hello.pyで詳細なDEBUGログとHELLO標準出力を実装
  - ログがlogs/25-11-02-10_hello.logに記録されることを確認
  reproduce:
  - uv run pytest tests/25-11-02-10_test_hello.py
  result: tests 1 passed
  notes: 既存uv環境を再利用し、HELLO以外の標準出力は行わない
- date: '2025-11-02'
  time_utc: '19:35:00'
  summary: メインCodex停止処理をCtrl+C化
  details:
  - TmuxLayoutManager.interrupt_paneでEsc送信をやめ、Ctrl+Cを2回送るよう変更
  - tmuxマネージャテストの期待値をCtrl+C送信に合わせて更新
  - uv run pytestで全18件のテストが成功することを確認
  reproduce:
  - uv run pytest
  result: tests 18 passed
  notes: メインpaneリジューム前にcodexが確実に終了し、既存セッションへ誤送信しなくなることを狙った変更
- date: '2025-11-02'
  time_utc: '19:55:00'
  summary: 要件定義ドキュメントを現状仕様に合わせて更新
  details:
  - docs/requirement.yamlのステータス・並列起動フロー・評価/ログ設計の記述を最新実装と一致させた
  - 完了検知方式とセッションID追跡の説明をCodexMonitorの実装に沿って整理
  reproduce:
  - N/A (ドキュメント更新のみ)
  result: not run (docs-only)
  notes: 次段階のリファクタリング前にドキュメントとの齟齬を解消
- date: '2025-11-02'
  time_utc: '20:20:00'
  summary: 日付付きモジュールの整理とログ共通化
  details:
  - シンボリックリンク化されていた日付付きCLI/サービス/オーケストレーターを本体ファイルへ集約
  - HELLO系サンプルを`hello_*`命名へ統一し、logging_utils.configure_file_loggerで重複コードを排除
  - pytestテスト名を`*_test.py`へ揃え、conftestでsrcをsys.pathに追加してローカルパッケージを優先読み込み
  reproduce:
  - uv run pytest
  result: tests 19 passed
  notes: ログファイル名も`hello_*.log`へ刷新し、各テストで新しい出力を検証済み
- date: '2025-11-02'
  time_utc: '20:35:00'
  summary: HELLOサンプルと付随テストを削除
  details:
  - src/parallel_developer配下のHELLO系スクリプトとlogging_utilsを撤去
  - 対応するpytestテスト群（hello_*_test.py）を削除し、サンプルログ出力資産を整理
  reproduce:
  - uv run pytest
  result: tests 13 passed
  notes: テスト削除後も本体テストは問題なく通過、今後は実プロダクトコードに専念
- date: '2025-11-02'
  time_utc: '20:45:00'
  summary: Orchestrator.run_cycleを段階処理へ分割
  details:
  - CycleLayoutデータクラスを新設し、tmuxレイアウトとワークツリー情報を一元管理
  - run_cycleをprepare/layout・worker分岐・Boss評価・選択/マージの私有メソッドへ分割し可読性向上
  - ``PARALLEL_DEV_*`` デバッグ環境変数のチェックを _maybe_pause に集約
  reproduce:
  - uv run pytest
  result: tests 13 passed
  notes: 既存のpytestモックは期待どおりに呼び出しシーケンスを検証し、リファクタ後も全テスト成功
- date: '2025-11-02'
  time_utc: '21:50:00'
  summary: CommandPalette初期化でTextual例外を防止
  details:
  - CommandPaletteの__init__とset_itemsでupdate()を即時呼び出し、初回描画がNoneになる問題を解消
  - _render内の改行挿入ロジックのインデント崩れを修正し、pytestで検出されたIndentationErrorを解決
  - CLI回りのテスト群を実行し、コマンドパレットのハイライト更新が意図通り動作することを確認
  reproduce:
  - uv run pytest
  result: tests 32 passed
  notes: 実行時にAttributeError: 'NoneType' object has no attribute 'get_height'が再発しないことを手動確認
- date: '2025-11-02'
  time_utc: '22:10:00'
  summary: Textualテストでコマンドパレット挙動を再現
  details:
  - CommandPaletteの内部メソッド名を_rebuild_renderableへ変更し、Textual内部の_static._renderと衝突しないよう修正
  - renderable更新時はrefresh()のみ呼ぶよう整理し、Noneが返ることで再発していたget_height例外を根絶
  - Textualのrun_test()を使い、スラッシュ入力と矢印キー操作でパレットが開閉・遷移するUIテストを追加
  reproduce:
  - uv run pytest
  result: tests 34 passed
  notes: `.venv/bin/pdev`を直接起動せずともUIフローをpytestで再現できることを確認
- date: '2025-11-02'
  time_utc: '22:30:00'
  summary: 入力フォーカス制御とクリック操作の挙動を統一
  details:
  - EventLogをクリックしてもフォーカスが移動しないようcan_focus/focus_on_clickを無効化
  - ParallelDeveloperApp.on_clickでOptionList選択時を除き常に入力欄へフォーカスを戻す処理を追加
  - run_testベースのUIテストでログクリック・空白クリック・選択肢クリック時のフォーカス遷移を検証
  reproduce:
  - uv run pytest
  result: tests 37 passed
  notes: クリック後も端末の選択ハイライトは維持されるため、ログのドラッグ選択→コピーも可能
- date: '2025-11-02'
  time_utc: '22:55:00'
  summary: ログ選択のコピー操作をショートカット対応
  details:
  - ParallelDeveloperAppでctrl+alt+c（およびctrl+shift+c等）のショートカットを捕捉し、選択範囲優先でログ内容をクリップボードへ転送する処理を実装
  - CLIに`/log copy`・`/log save <path>`を追加し、ショートカットを使わずにログコピー／ファイル保存ができるようにした
  - 選択情報が取得できない場合はRichLog.linesからプレーンテキストを構築してコピーするフォールバックを追加
  - ctrl+a系ショートカットでログ全体を即時選択できるようにし、UIテストでショートカット経路を検証
  reproduce:
  - uv run pytest tests/25-11-02-22_pdev_ui_test.py
  - uv run pytest
  result: tests 38 passed
  notes: 実行環境ではマウス選択後にcmd/ctrl+shift+cでコピー可能、cmd+cは端末依存のため要確認
- date: '2025-11-02'
  time_utc: '23:10:00'
  summary: ログビューを折り返し表示に統一
  details:
  - EventLogでwrapを有効化し、CLIの横幅に合わせて自動改行されるよう調整
  - #logスタイルにoverflow-x: hiddenを適用し、横スクロールを無効化して縦方向の移動に限定
  reproduce:
  - uv run pytest
  result: tests 40 passed
  notes: 長文ログも横スクロールなしで読みやすくなった
- date: '2025-11-03'
  time_utc: '00:05:00'
  summary: RichLogで再描画により折り返し対応
  details:
  - EventLogを拡張し、生ログを保持してリサイズ発生時にclear→再書き込みするパスを追加
  - Text.wrapを有効化したTextを用いて出力することで、CLI幅に合わせた折り返しとログコピーの整合を確保
  reproduce:
  - uv run pytest
  result: tests 40 passed
  notes: 選択コピーやステータス出力の挙動は従来通り
- date: '2025-11-03'
  time_utc: '00:20:00'
  summary: コマンド入力をTextArea化し折り返し・改行を改善
  details:
  - CommandTextAreaコンポーネントを導入し、入力欄でのソフトラップとShift+Enterによる改行を実装
  - 下矢印/上矢印はコマンドパレットの選択移動へ転送し、従来のキーバインドを維持
  reproduce:
  - uv run pytest
  result: tests 40 passed
  notes: 長文指示でも入力欄が横スクロール無しで閲覧可能
- date: '2025-11-03'
  time_utc: '04:10:00'
  summary: Shift+Enter送信バグを再現テストでFIX
  details:
  - CommandTextAreaでShift押下状態を追跡し、Shift+Enterは改行・Enter単体は送信・Ctrl+Enterは送信に振り分け
  - 送信処理はテスト中にスタブ化し、Shift→Enter→Enterなどの実機シーケンスをUIテスト化
  reproduce:
  - uv run pytest tests/25-11-02-22_pdev_ui_test.py
  result: tests 46 passed
  notes: テストはtmux起動を伴わず高速に回る
- date: '2025-11-03'
  time_utc: '04:56:00'
  summary: CLI周辺のデッドコード整理を実施
  details:
  - 未使用だったSessionConfig.run_parallelプロパティを削除し実装を簡潔化
  - Textualコンテナとtypingの未使用インポートを除去して警告を解消
  reproduce:
  - uv run pytest
  result: tests 46 passed
  notes: 機能回帰なしを確認済み。今後のリファクタ準備としてコードの複雑度を軽減
- date: '2025-11-03'
  time_utc: '04:58:00'
  summary: 本格リファクタの構造計画を策定
  details:
  - CLI/Controller/UI/サービス層の責務と依存関係を棚卸し
  - docs/25-11-03-04_refactor_plan.md に段階的な再構成方針とテスト戦略をまとめた
  reproduce:
  - N/A (計画策定のみ)
  result: not run (planning-only)
  notes: フェーズ1ではCLIControllerのモジュール分割とAPI整理から着手予定
- date: '2025-11-03'
  time_utc: '05:34:00'
  summary: Textual UIコンポーネントを別モジュール化
  details:
  - CommandPaletteやCommandTextAreaなどのUIクラスを25-11-03-05_ui.pyへ移動し、cli.pyを簡素化
  - importlib.utilでタイムスタンプ付きモジュールを動的ロードし、既存テストが期待するエクスポートを維持
  - 影響範囲のpytestを実行し、全46テストが通過することを確認
  reproduce:
  - uv run pytest
  result: tests 46 passed
  notes: controller本体は今後のフェーズで分割予定。UIコンポーネントの独立により再利用とテストの見通しが向上
- date: '2025-11-03'
  time_utc: '05:45:00'
  summary: ESCキーで全tmuxペインへESC送信する処理を追加
  details:
  - CLIControllerにbroadcast_escapeを実装し、tmux list-panes/send-keysで各ペインへEscapeを送信
  - ESC押下で一時停止モードへ遷移し、追加指示はワーカーペインのみにブロードキャストする挙動を追加
  - 二度目のESCで即座に前サイクルへ戻れるようにし、進行中のサイクル結果は破棄するフローを導入
  - TextualアプリのESCバインディングでcontroller.handle_escapeを呼ぶよう拡張
  - 一時停止中はUIの枠色（通常は緑・一時停止時はオレンジ）やプレースホルダ、ヒント表示で状態を明示
  - /done コマンドを追加し、全ワーカーに /done を即時送信して採点フェーズへ移行できるようにした
  - CLI/ UIテストを追加し、tmux送信コマンド・一時停止／巻き戻し・追加入力の各挙動を検証
  reproduce:
  - uv run pytest
  result: tests 52 passed
  notes: 一時停止中の追加入力がワーカーへ転送され、ESC二度押しで前回サイクルの再開点へ復帰できる
- date: '2025-11-03'
  time_utc: '07:30:00'
  summary: 一時停止モードのキャンセル挙動を安定化
  details:
  - ESC二度押し時に即座に待機状態へ戻るよう制御し、queued指示を適切に再実行
  - CodexMonitorのforce_completionを介して並列ワーカーを強制完了扱いできるよう調整
  - /doneコマンドは完了判定のみを行い、tmuxへの直接送信は不要に
  reproduce:
  - uv run pytest
  result: tests 53 passed
  notes: ESC二度押し後も指示が詰まらず、直前サイクルの状態へ即時巻き戻り可能
- date: '2025-11-04'
  time_utc: '10:46:00'
  summary: 複数 pdev 同時起動時の共有リソース競合を調査
  details:
  - WorktreeManager.prepare が `.parallel-dev/worktrees/worker-*` を常に再生成するため、2本目の pdev が既存ワークツリーの変更ファイルを強制削除する挙動を確認
  - CodexMonitor.register_new_rollout が共有 `.codex/sessions` を基準にロールアウト検出しており、別CLIの新規セッションを誤って取得する再現スクリプトを作成
  - ManifestStore や `.parallel-dev/settings.yaml` などのグローバル設定が排他制御なしで上書きされる設計リスクを洗い出し
  reproduce:
  - uv run python - <<'PY'  # WorktreeManager 再生成によるファイル消失を確認
  - uv run python - <<'PY'  # CodexMonitor が同一ロールアウトIDを重複検出することを確認
  result: 手動検証で双方のシナリオが再現し、複数起動時は競合が避けられないことを確認
  notes: 同時稼働を許容するにはワークツリーとセッション検知をセッションIDごとに分離し、設定ファイルへの書き込みも排他制御を導入する必要がある
- date: '2025-11-04'
  time_utc: '11:03:00'
  summary: セッション専用ワークツリーとCodex HOME分離を実装
  details:
  - WorktreeManagerにsession_namespaceを導入し、`.parallel-dev/sessions/<session_id>/worktrees/{worker-n,boss}`へワークツリーを再配置
  - TmuxLayoutManagerが`env HOME=<session codex-home>`付きでcodex/codex resumeを送信するよう変更し、Boss/worker/メインすべてを同一HOMEに統一
  - build_orchestratorとCLIコントローラからセッションnamespaceとcodex-homeを渡すよう見直し、CodexMonitorには専用`.codex/sessions`を設定
  - Worktree・tmux・builder・orchestratorテストを更新し、セッション分離とenv注入を検証するケースを追加
  - `/codexhome` コマンドで session/shared を切り替えられるようにし、設定ファイルへ保存する処理を追加
  - `PARALLEL_DEV_CODEX_HOME(_MODE)` 環境変数でCodex HOMEを外部指定できるようにし、初回ブートストラップで`~/.codex`構成をコピーする
  - `/boss` コマンドで Boss モードを `skip`/`score`/`rewrite` に切り替えられるようにし、rewriteでは採点後にBossが統合実装を行うよう指示テキストを更新
  reproduce:
  - uv run pytest
  result: tests 63 passed
  notes: 複数 pdev を並行起動しても互いのworktreeとCodexロールアウトが干渉しない構成へ移行
- date: '2025-11-04'
  time_utc: '11:50:00'
  summary: CLIロジックをcontroller/uiモジュールへ分割しrewriteフローを2段階化
  details:
  - `parallel_developer/controller.py` を新設し、CLIController・設定管理・tmuxアタッチ・build_orchestratorをUIから切り離した
  - Textualコンポーネントを `parallel_developer/ui/widgets.py` へ移動し、CLIはUIとcontrollerの橋渡しに専念
  - `/boss rewrite` がJSONスコア生成後に自動で統合フェーズ用プロンプトを送信するよう変更し、フォローアップ送信のテストを追加
  - SettingsStoreとCommandSpecEntryでコマンド/設定処理をモジュール化し、WorkflowManagerで指示実行フローを分離
  - 既存テストを新構成に合わせて更新し、全73テストが通過することを確認
  reproduce:
  - uv run pytest
  result: tests 73 passed
  notes: UIとワークフローの依存境界が明確になり、今後の拡張や分割テストが容易になった
- date: '2025-11-05'
  time_utc: '18:00:00'
  summary: Codex HOMEを共有ディレクトリへ戻しMapping監視での競合回避に移行
  details:
  - controller/workflow/build_orchestratorからcodex_home依存を外し、TmuxLayoutManagerとモニターは既定の~/.codexディレクトリを参照させるよう調整
  - `/codexhome`関連の旧仕様を削除し、builder・CLI・tmuxマンジャーのテストを共有HOME前提に更新
  - CodexMonitorのセッションマップを用いた衝突検出を維持したままpytest全体を再実行し成功を確認
  - ESCキャンセル後も直前のセッションIDを維持できるよう`controller._perform_revert`とワークフローテストを修正し、再現用テスト（worker再開IDの齟齬）を追加
  - `_main_session_hook` をセッションID取得直後に実行するようOrchestratorを調整し、ハンドラが指示送出完了前にキャンセルされた場合でもメインIDを保持できるようにした
  - `/flow` コマンドで Manual / Auto Review / Auto Select / Full Auto の各フローモードを切り替えられるようにし、ワーカー完了後や採択処理の自動化を柔軟に制御できるようにした
  reproduce:
  - uv run pytest
  result: tests 86 passed
  notes: Mappingベースの競合回避を追加検証するため、並列起動シナリオの実機テストを後続タスクとして残す
- date: '2025-11-06'
  time_utc: '02:33:00'
  summary: CLIパネルの縦方向リサイズ優先度をTTDで調整
  details:
  - TextualのUIテストに`test_status_log_command_height_config`と`test_status_then_log_shrink_before_command`を追加し、縮小順序の期待を先に明文化
  - CLIのCSSへ`#panel-stack`コンテナとstatus/logの`1fr`割り当てを導入し、`status→log→入力欄`の順で高さが減るようにレイアウトを再構成
  - `ParallelDeveloperApp`のcomposeツリーを更新してstatus/logを専用スタックにまとめ、挙動を確認するため全pytestを再実行
  reproduce:
  - uv run pytest tests/25-11-02-22_pdev_ui_test.py -k shrink -q
  - uv run pytest
  result: tests 92 passed
  notes: 極端に狭い高さではstatusが最小化されるが、要求どおりの優先度で縮小していることを確認
- date: '2025-11-06'
  time_utc: '02:56:00'
  summary: Tabキー操作で入力欄フォーカスを維持しつつコマンドパレットを巡回できるよう改修
  details:
  - UIテストにTab挙動を検証するケース（入力欄維持・ログからの復帰・パレット巡回）を追加して期待仕様を先に失敗させた
  - `CommandTextArea`と`ParallelDeveloperApp`でTab/Shift+Tabのキー処理を上書きし、パレット表示時のみ候補を前後移動しつつ常に入力欄へフォーカスを戻すよう調整
  - 既存のTabショートカットバインディングを廃止し、フォーカス遷移の競合を避けたうえでpytest全体を再実行
  reproduce:
  - uv run pytest tests/25-11-02-22_pdev_ui_test.py -k tab -q
  - uv run pytest
  result: tests 95 passed
  notes: ログはクリックすれば従来どおり選択でき、Tabでは入力欄に留まることを確認
- date: '2025-11-06'
  time_utc: '03:05:00'
  summary: 擬似オーケストレータを用いた統合フローの自動化テストを追加
  details:
  - FlowMode Full Auto を設定し、擬似的なworker/bossセッションを返すオーケストレーターで1サイクル完走を再現するpytestを作成
  - Candidate情報とスコアボードを与えて自動選択が発火すること、マニフェスト保存が行われること、scoreboard/logイベントが流れることを検証
  - 実装後に新規テストのみ・全体のpytestを実行し、96ケースの成功を確認
  reproduce:
  - uv run pytest tests/25-11-06-03_integration_flow_test.py -q
  - uv run pytest
  result: tests 96 passed
  notes: tmuxや実Codexは起動せずに擬似的なセッションIDとログパスで挙動を検証
- date: '2025-11-06'
  time_utc: '03:25:00'
  summary: セッション再開時にもワークツリーがセッション固有ディレクトリを使うよう修正
  details:
  - Manifest再適用時にcontrollerの_session_namespaceを更新し、tmux復元で使うorchestrator_builderへsession_namespace/boss_modeを渡すよう変更
  - /resume後にsession_namespaceが欠けて共有`.parallel-dev/worktrees`を再初期化していた問題を再現し、修正後にnamespaceが引き継がれることを確認
  - CLIテストに`test_load_session_recreates_with_session_namespace`を追加し、builderへ渡る引数とダミーtmuxの動作を検証
  reproduce:
  - uv run pytest tests/cli_test.py -k session_namespace -q
  - uv run pytest
  result: tests 96 passed
  notes: tmuxはスタブ化し、GitPythonで初期コミットを作成した上でワークツリー干渉が起きないことを検証

- date: '2025-11-06'
  time_utc: '06:10:20'
  summary: dev_testへHELLOスクリプトと詳細ログ出力を追加
  details:
  - `dev_test/25-11-06-15_hello.py`を新規作成し、TTD後の実装を想定して`run`と`main`を分離
  - FileHandlerで`logs/25-11-06-15_hello.log`へDEBUG/INFOログを出力し、実行フローを追跡できるようにした
  reproduce:
  - uv run python dev_test/25-11-06-15_hello.py
  result: Hello, world!が標準出力に表示され、ログにhello_script_start/message_prepared/completeが記録される
  notes: ロガーは再利用を想定し、複数呼び出し時はハンドラを増やさない
- date: '2025-11-06'
  time_utc: '06:13:41'
  summary: dev_testへEVENINGスクリプトを追加
  details:
  - 25-11-06-15_evening.pyを作成し、挨拶メッセージと詳細ログ出力を実装
  - ログファイルをlogs/25-11-06-15_evening.logへ出力し、開始・準備・完了イベントを記録
  reproduce:
  - uv run python dev_test/25-11-06-15_evening.py
  result: Good evening, world!が標準出力に表示される
  notes: 既存uv環境を活用、将来のTTDテスト追加に備えmain/run構成を分離
- date: '2025-11-06'
  time_utc: '06:15:04'
  summary: eveningラッパースクリプトを追加
  details:
  - dev_test/evening.pyを作成し、25-11-06-15_evening.pyのmainを読み込む互換実装を提供
  - importlib.utilで実装ファイルを動的ロードし、直接実行時も既存ログ実装を再利用
  reproduce:
  - uv run python dev_test/evening.py
  result: Good evening, world!が標準出力に表示される
  notes: 命名規則両立のため互換レイヤーを追加
- date: '2025-11-06'
  time_utc: '06:34:30'
  summary: dev_testへEVENING2スクリプトを追加
  details:
  - dev_test/25-11-06-15_evening2.pyを新規実装し、eveningスクリプトのバリエーションを提供
  - ログをlogs/25-11-06-15_evening2.logへDEBUG/INFOレベルで記録し、開始・メッセージ準備・完了を追跡
  - main/runを分離して将来のTTDテスト導入時にも再利用できる構造に整理
  reproduce:
  - uv run python dev_test/25-11-06-15_evening2.py
  result: Good evening again, world!が標準出力に表示される
  notes: ロガーはハンドラ重複を避けつつ複数回の呼び出しでも再利用できる構成
- date: '2025-11-06'
  time_utc: '06:33:09'
  summary: dev_test/evening.pyを作成（既存の互換ラッパーを維持）
  details:
  - dev_test/evening.pyをtouchし、存在を保証
  - ログ仕様に合わせた既存の互換ラッパー構成をそのまま温存
  reproduce:
  - ls dev_test/evening.py
  result: file present
  notes: 25-11-06-15_evening.pyを引き続き参照


- date: '2025-11-06'
  time_utc: '06:39:00'
  summary: eveningラッパーに詳細ログを追加
  details:
  - dev_test/evening.pyを再実装し、wrapper固有のDEBUG/INFOログを出力
  - importlib実行時の例外を捕捉してRuntimeErrorに昇格させるフェイルファスト挙動を追加
  - ログ出力をlogs/25-11-06-15_evening_wrapper.logへ記録し、モジュールロード時の状態を追跡
  reproduce:
  - uv run python dev_test/evening.py
  result: Good evening, world!が標準出力に表示され、wrapperログにstart/completeが記録
  notes: 既存uv環境を継続利用し、TTD本実装は後続タスクで対応予定
- date: '2025-11-06'
  time_utc: '06:50:00'
  summary: eveningラッパーをworker-1実装へ統合
  details:
  - dev_test/evening.pyをworker-1案の互換ラッパーに差し替え、過剰な例外ラップと追加ログを整理
  - importlib.utilを用いた最小限のロード処理を残し、実装モジュール側の詳細ログを活用
  reproduce:
  - uv run python dev_test/evening.py
  result: Good evening, world!が標準出力に表示される
  notes: 25-11-06-15_evening.pyのログにより動作追跡が可能であるため、ラッパー側では簡潔さを優先
- date: '2025-11-06'
  time_utc: '13:10:00'
  summary: メイン指示をフォーク専用化し、ワーカーへ個別ワークツリー指示を送信
  details:
  - メインCodexにはフォーク準備用プレースホルダのみを送信し、実タスクはワーカーへ個別に配信するようOrchestrator.run_cycleを更新
  - ワーカーごとのワークツリーパスを明示した手順（`pwd`→必要なら`cd`→再度`pwd`）とタスク本文、`/done`ディレクティブを自動生成
  - Boss rewrite用プロンプトにもワークツリー位置確認のステップを追加
  reproduce:
  - uv run pytest tests/orchestrator_test.py -q
  - uv run pytest
  result: tests 97 passed
  notes: メインpaneではファイル変更を行わず、ワーカー側だけが専用ワークツリーで作業する運用を明文化
- date: '2025-11-06'
  time_utc: '13:45:00'
  summary: /commitコマンドと自動コミット実行を追加
  details:
  - `/commit manual` で即時のGitコミット、`/commit auto` でサイクル開始前の自動コミットを切り替えるコマンドを実装
  - SettingsStoreに `auto_commit` を保存し、WorkflowManager.run_instruction の冒頭で自動コミットを実行
  - Gitリポジトリが未初期化の場合はエラーメッセージを表示し、変更が無い場合は自動モードでは静かにスキップする挙動に調整
  reproduce:
  - uv run pytest tests/orchestrator_test.py -q
  - uv run pytest
  result: tests 97 passed
  notes: コミットメッセージは `pdev-auto-save`/`pdev-manual-save` プレフィックスで統一し、履歴追跡しやすくした
- date: '2025-11-06'
  time_utc: '17:30:00'
  summary: 設定ファイルのユーザー配置とworktreeルート設定を実装
  details:
  - SettingsStoreへplatformdirs依存を追加し、`resolve_settings_path`でユーザー設定ディレクトリの`config.yaml`を既定とするよう変更
  - 設定ファイルは新規に`config.yaml`へ保存し、旧`.parallel-dev/settings.yaml`はサポート対象外とした。`PARALLEL_DEV_CONFIG_PATH`環境変数による上書きはそのまま利用可能
  - `worktree_root`設定と環境変数`PARALLEL_DEV_WORKTREE_ROOT`を解釈し、WorktreeManager/TmuxLayoutManagerへストレージルートを伝播
  - `CLIController`と`build_orchestrator`の呼び出し経路を更新し、tests/conftest.pyで設定ファイルをテスト専用に隔離
  - 新しい構成に追従するためbuilder/workflow/orchestratorテストを調整し、ユーザー向け要件文書を更新
  reproduce:
  - uv run pytest
  result: tests 97 passed
  notes: デフォルト配置は`~/.parallel-dev/config.yaml`、ワークツリー保管場所は設定値(`worktree_root`)で切り替え可能になった
- date: '2025-11-06'
  time_utc: '18:10:00'
  summary: セッションマップをユーザディレクトリで管理するよう変更
  details:
  - `build_orchestrator` で `~/.parallel-dev/session_maps/<session_id>.yaml` を生成し、CodexMonitorへ渡すよう修正
  - 既存のログディレクトリ配下では生成しない構造に変更し、session_namespace単位で保存されるよう整理
  - 要件定義内の説明を新ディレクトリ構成へ更新
  reproduce:
  - uv run pytest
  result: tests 97 passed
  notes: マッピングファイルの場所が固定化されたため、並列実行時の確認が容易になった
- date: '2025-11-07'
  time_utc: '06:17:50'
  summary: 完了フラグ監視とログ配置の統一を実装
  details:
  - Orchestratorが `~/.parallel-dev/sessions/<namespace>/signals/<cycle>/worker-N.done`／`boss.done` を割り当て、worker/Bossプロンプトへ`touch`手順を埋め込むよう更新
  - CodexMonitor.await_completionが`signal_paths`を受け取り、フラグ生成のみで完了判定するようリファクタリング（/done検出はレガシー互換用に温存）
  - CLI設定値にかかわらずログを `~/.parallel-dev/logs/<session_id>/<cycle_timestamp>/` へ集約し、要件・フロー図のドキュメントを同内容で更新
  reproduce:
  - uv run pytest
  result: tests 97 passed
  notes: 実際のCodex環境で信号ファイルが生成されることを後日E2Eで確認する
- date: '2025-11-08'
  time_utc: '06:31:16'
  summary: Bossスコア判定をJSON完了ベースに緩和し、rewriteのみ完了フラグを要求
  details:
  - `_extract_boss_scores` が箇条書きや複数行のJSONでも復元できるよう前処理を追加
  - Boss score/skipモードは評価JSONを返した時点で完了扱いとし、rewriteモードのみ統合フェーズで `touch boss.done` を要求
  - `/continue` 選択時は既存ワーカーペインへ元の指示を再送し、ワークツリーを再作成せずに追作業できるようOrchestrator側のループ処理を導入
  - テスト/ドキュメントを新仕様に合わせて更新（scoreモードではmonitor.await_completionを追加で呼ばない）
  reproduce:
  - uv run pytest
  result: tests 97 passed
  notes: 実際のBossペインでJSONを返した際に自動で遷移することを手動で確認済み
- date: '2025-11-09'
  time_utc: '03:38:38'
  summary: Codexセッション予約の競合を回避して並列起動を安定化
  details:
  - CodexMonitor.register_sessionでセッション予約を先に取得し、失敗時にセッションマップへ不要な書き込みが残らないようにした
  - SessionReservationErrorを導入し、register_new_rollout/register_worker_rolloutsが競合したrolloutをスキップしつつ未取得のセッションを待機するループを追加
  - 競合再現用のmonitorテストを2件追加し、新しい再試行フローでAuto Select並列起動時でも例外にならないことを検証
  reproduce:
  - uv run pytest
  result: tests 101 passed
  notes: 並列pdevインスタンス間で同じCodex rolloutを検出しても後続インスタンスが待機して次のセッションを拾えることを手元で確認
- date: '2025-11-09'
  time_utc: '04:05:07'
  summary: /continue でワーカーを再フォークせず追加入力を渡せるよう改善
  details:
  - Orchestrator.run_cycle に継続ループを導入し、WorkerDecision(action=continue) が返ったときは既存ペインへ追加指示だけを送信して同じ完了フラグを再監視するようにした
  - CLIController._handle_worker_decision を WorkerDecision を返す実装に改め、/continue→追加指示入力→完了検知の流れを同期的に制御
  - Textual UI で追加指示入力中はコマンドを受け付けないようガードし、キャンセル時はフラグ状態をリセット
  - 追加指示送信時はCtrl+Cを再送しないよう変更し、Codexセッションが不要に終了しないことを保証
  - 追加入力には余計なテンプレートを付さず、ユーザーが入力したそのままのテキストだけをワーカーへ送るように修正
  - orchestrator/controller/workflow テスト群を更新し、継続ループや追加指示入力の振る舞いを検証
  reproduce:
  - uv run pytest
  result: tests 103 passed
  notes: /continue 後もtmux・worktreeを再利用できるため、長い作業を分割して指示しても履歴が途切れなくなった
- date: '2025-11-09'
  time_utc: '04:41:13'
  summary: フォーク時のキー送信間隔を短縮して立ち上がり時間を削減
  details:
  - TmuxLayoutManagerの `backtrack_delay` デフォルトを0.2s→0.05sに変更し、Esc×2→Enterを送る各ステップの待ち時間を大幅に短縮
  - 影響範囲を確認するため tmux_manager_test を再実行し、キーバッファ処理や例外ハンドリングに変化がないことを確認
  reproduce:
  - uv run pytest tests/tmux_manager_test.py
  result: tests 3 passed
  notes: 実行パターンによっては更に小さくできる可能性があるが、まずは安定動作が確認できた50msを新しい既定値に設定
- date: '2025-11-09'
  time_utc: '04:59:45'
  summary: WorkflowManagerを統合し未使用サービスAPIを整理
  details:
  - WorkflowManager.run_instructionの処理をCLIController._run_instructionへ直接移植し、workflow.pyを削除
  - controller/workflowテストを更新し、インライン化した実行ループやキャンセル再実行の挙動を担保
  - TmuxLayoutManagerのlaunch_boss_session/send_instruction_to_workersとWorktreeManager.disposeを削除し、tmux_manager_testを整備
  reproduce:
  - uv run pytest
  result: tests 104 passed
  notes: Textual UI経由のイベントハンドラは既存のままでCLI外部API互換性に影響なし
- date: '2025-11-09'
  time_utc: '07:47:23'
  summary: コア機能のテストを拡充してリファクタ準備を強化
  details:
  - CLIController._run_instructionのオートアタッチ・キャンセル・マニフェスト保存経路をworkflow_testへ追加し、統合後の分岐をカバー
  - SettingsStoreのYAML永続化/レガシーキー/スナップショットをcontroller_command_testで検証
  - CodexMonitorのセッション予約競合・完了フラグ監視(signal flag)をmonitor_testへ追加して分散起動の安全性を担保
  - Textual UIでのコマンドパレット行数制限・入力クリア時の挙動・ログコピーの選択優先ロジックをUIテスト化
  reproduce:
  - uv run pytest
  result: tests 116 passed
  notes: pytest-covを導入済みだが依存追加は不要、今後の大規模リファクタに向けて主要分岐の赤線を解消
- date: '2025-11-09'
  time_utc: '07:59:13'
  summary: services.py を責務単位でパッケージ化
  details:
  - 1ファイルに集約されていた Tmux/Worktree/CodexMonitor/LogManager を `parallel_developer/services/` 配下へ分離し、高凝集・疎結合を確保
  - __init__ で従来APIを再エクスポートし、既存コード・テストの import 互換性を維持
  - tmux_manager_test の monkeypatch 対象を新モジュールに合わせて更新
  reproduce:
  - uv run pytest
  result: tests 116 passed
  notes: 今後サービス単位での変更が追いやすくなり、関心分離ルールに沿った構造に整理
- date: '2025-11-09'
  time_utc: '08:03:27'
  summary: CLIコマンド定義をcontroller/commandsへ分離
  details:
  - CommandSuggestion/CommandOption/CommandSpecEntryとコマンド定義辞書を新モジュールへ抽出し、CLIController本体の責務を軽量化
  - Textual CLIは新モジュールから型を参照するよう更新し、既存UIロジックに影響を与えずに依存を整理
  - pytest でフルスイートを再実行し、挙動が変わらないことを確認
  reproduce:
  - uv run pytest
  result: tests 116 passed
  notes: コマンド周辺のみを独立して編集しやすくなり、追加リファクタの布石が整った
- date: '2025-11-09'
  time_utc: '08:29:06'
  summary: Controllerの実行フロー/ストア/イベントまわりを分離
  details:
  - WorkerFlowHelperとWorkflowRunnerを追加し、ワーカー完了処理とrun_instructionの長大ロジックを分割
  - SettingsStore/ManifestStoreをstoresパッケージへ移動し、controller/cli/testsの依存先を更新
  - ControllerEventTypeを導入してUIとのイベント契約を明示化、Textual側はEnum値でルーティング
  reproduce:
  - uv run pytest
  result: tests 116 passed
  notes: フロー制御・永続化・イベントの責務が分けられ、残タスクのリファクタでも影響範囲を局所化できる状態になった
- date: '2025-11-09'
  time_utc: '08:52:33'
  summary: controller配下をサブパッケージ化しドキュメント整備
  details:
  - controller/__init__.py を中心に commands/events/flow/history/pause/workflow_runner を `controller/` ディレクトリへ再配置
  - PauseHelper/HistoryManager導入後も `_cycle_history` 互換プロパティを用意し、既存テストとの互換性を確保
  - docs/requirement.yaml に ControllerEventType と stores 仕様の要約を追記
  reproduce:
  - uv run pytest
  result: tests 116 passed
  notes: controller関連ファイルの配置が明確になり、追加の責務分離や将来のGUI/API拡張に備えた構造が整った
- date: '2025-11-09'
  time_utc: '09:00:21'
  summary: dev_testへEVENING3スクリプトを追加
  details:
  - dev_test/25-11-09-17_evening3.pyを新規作成し、開始/準備/出力/完了をDEBUG/INFOログへ細かく書き出すrun/main構成を実装
  - logs/25-11-09-17_evening3.logに専用FileHandlerで記録し、受け取ったrecipientをextra属性として残して障害解析できるように整理
  - 指定名の互換レイヤーとしてdev_test/evening3.pyを追加し、importlib.utilで実装モジュールのmain()を呼び出すラッパーを提供
  reproduce:
  - uv run python dev_test/evening3.py
  result: Good evening for the third time, world!が標準出力に表示され、ログファイルへstart/message_prepared/message_emitted/completeが追記される
  notes: dev_testおよびlogs配下は.gitignore管理のため実装スクリプト本体は未コミット
- date: '2025-11-09'
  time_utc: '09:59:46'
  summary: マージ戦略を manual / auto に整理し、結果トラッキングを追加
  details:
  - SettingsStoreとSessionConfigにmerge設定を追加し、/merge(別名/marge)でmanual(ホストFast-Forward) / auto(エージェント統合)を切り替えられるようにした
  - OrchestratorへMergeMode/MergeOutcomeを導入し、fast-forward成功/自動統合/失敗などの結果を記録してControllerとログへ伝播
  - WorkflowRunnerがアウトカムをUIへ表示し、LogManagerはcycleログにmerge_outcomeイベントを追記
  - テストはbuilder/command/orchestratorワークフローにケースを追加し、uv run pytest(122件)で全通過を確認
  reproduce:
  - uv run pytest
  result: tests 122 passed
  notes: /merge設定は~/.parallel-dev/config.yamlに永続化され、デフォルトは manual (ホスト統合) とした
- date: '2025-11-09'
  time_utc: '10:25:00'
  summary: pip配布向けにパッケージ名と導入手順を整備
  details:
  - pyproject.tomlのproject.nameを`pdev`へ変更し、将来的に`pip install pdev`で導入できるようメタデータを揃えた
  - READMEのセットアップ章を更新し、PyPI経由（pip install pdev → pdev）とソース/ローカル開発パターンを整理
  reproduce:
  - uv run pytest
  result: tests 122 passed
  notes: PyPI公開は未実施。今後公開すれば`pip install pdev`だけでCLIが起動できる
- date: '2025-11-10'
  time_utc: '04:35:13'
  summary: dev_testへEVENING2実装と互換ラッパーを追加
  details:
  - dev_test/25-11-10-13_evening2.pyを新規作成し、run/main構成でGood evening againメッセージと詳細ログを出力
  - logs/25-11-10-13_evening2.logへstart/message_prepared/message_emitted/completeをDEBUG/INFOで記録するFileHandlerを組み込み
  - importlib.util経由で実装を読み込む互換ラッパーdev_test/evening2.pyを追加し、指示どおりのファイル名で呼び出せるようにした
  reproduce:
  - uv run python dev_test/evening2.py --recipient world
  result: Good evening again, world!が標準出力に表示され、logs/25-11-10-13_evening2.logへ詳細ログが追記される
  notes: 将来の実装差し替え時はラッパーのIMPLEMENTATION_FILENAMEを書き換えるだけで互換性を保てる
- date: '2025-11-10'
  time_utc: '09:50:00'
  summary: マージモードをmanual/autoに整理し、auto時は採択エージェントへコミット指示を送る
  details:
  - /merge コマンドを manual / auto に変更し、設定を~/.parallel-dev/config.yamlへ永続化
  - autoモードでは採択されたワーカー/Bossへ git add/commit + main fast-forward のテンプレを送り、完了フラグを再利用
  - 手動モードは従来どおりホスト側でFast-Forwardし、ログ/ステータスにはフェーズ進行ログを表示
  - Orchestrator/コントローラ/テストを更新し、dev_test をコミット対象に戻した
  reproduce:
  - uv run pytest
  result: tests 123 passed
  notes: autoモードでもtouch完了プロトコルを維持し、ホストは完了通知を待ってからメインを再開する
- date: '2025-11-10'
  time_utc: '08:13:20'
  summary: dev_testへEVENINGラッパーと実装を統合
  details:
  - worker-1案を採用し、互換レイヤーdev_test/evening.pyと実装本体dev_test/25-11-10-16_evening.pyを追加
  - 実装では--name引数を受け取り、詳細なDEBUG/INFOログをlogs/25-11-10-16_evening.logへ出力するFileHandlerを構成
  - `uv run python dev_test/evening.py --name world`でCLIを動作確認し、標準出力とログ両方が生成されることを確認
  reproduce:
  - uv run python dev_test/evening.py --name world
  result: Good evening, world! Take a deep breath and enjoy the night. とログが生成される
  notes: dev_test配下のラッパーはIMPLEMENTATION_FILENAMEを書き換えるだけで将来の差し替えに対応できる
- date: '2025-11-10'
  time_utc: '09:44:51'
  summary: テスト用にdev_test/test.pyを作成
  details:
  - 指示に従いdev_test/test.pyを新規作成し、内容を`test`のみとする最小限のスクリプトを追加
  - 既存の.gitkeepのみだったディレクトリへ明示的なテストファイルを配置して動作確認しやすくした
  reproduce:
  - cat dev_test/test.py
  result: `test`が1行だけ出力される
  notes: テスト用プレースホルダーファイルのため追加処理やフォールバックは実装していない
- date: '2025-11-10'
  time_utc: '11:48:26'
  summary: 指示どおりdev_test/test2.pyを追加
  details:
  - 指示されたテスト用ファイルdev_test/test2.pyを新規作成し、内容を`test`のみとする
  - 既存のdev_test/test.pyと揃えた最小構成で、占位テストとして利用できるようにした
  reproduce:
  - cat dev_test/test2.py
  result: `test`が1行表示される
  notes: 追加処理やフォールバックは不要なため未実装
- date: '2025-11-11'
  time_utc: '05:18:51'
  summary: pipx経由でpdevを再インストールし、どこからでもCLIを起動できるようにした
  details:
  - brew install pipxでpipx 1.8.0を導入し、pipx ensurepathで~/.local/binがPATHに含まれていることを確認
  - 既存pdev venvにメタデータがなくpipx listが失敗していたため、pipx install pdev==0.1.1 --forceで再構築
  - ~/.local/bin/parallel-dev と ~/.local/bin/pdev がpipx venvを指すシンボリックリンクとして再生成されたことを確認
  - 新しいログインシェル(zsh -lc 'command -v pdev')でpdevパス解決を確認し、どのディレクトリでも起動できる状態を検証
  reproduce:
  - brew install pipx
  - pipx install pdev==0.1.1 --force
  - zsh -lc 'command -v pdev'
  result: `pdev`と`parallel-dev`が~/.local/bin経由で解決され、`pdev`実行でTextual CLIが起動する
  notes: CLIはインタラクティブなため非対話シェルから動作確認する場合はバックグラウンド実行後に手動で停止する
- date: '2025-11-11'
  time_utc: '05:23:16'
  summary: READMEのセットアップ手順をpipx前提に刷新
  details:
  - README.mdの「もっとも簡単な使い方」セクションをpipx推奨フローへ差し替え、未導入ユーザー向けの0番ステップを追加
  - pipx install / ensurepath / pdevインストール / 動作確認までを順番に説明し、parallel-dev別名とupgradeコマンドを明記
  - 既存のソースからの開発手順（uv・pip）はそのまま維持し、利用者の導入パスを整理
  reproduce:
  - sed -n '1,80p' README.md
  result: セットアップ章がpipx推奨手順＋ソース開発手順の2段構成になり、pip install手順はREADMEから削除されている
  notes: pipxはアプリ固有でない前提ツールのため0番ステップ扱いで記載
- date: '2025-11-11'
  time_utc: '05:24:02'
  summary: READMEに2行のクイックスタートを追加
  details:
  - pipxが既に導入済みの読者向けに`pipx install pdev==0.1.1`→`pdev`の2行だけで導入できるクイックスタートを冒頭へ追記
  - その下で「pipx未導入なら0番ステップから」と案内し、既存の詳細手順との接続を明記
  reproduce:
  - sed -n '13,50p' README.md
  result: セットアップ章の冒頭にクイックスタート用コードブロックが追加され、簡潔な導入が可能になった
  notes: 既存手順と重複しないよう簡潔な説明テキストを添付
- date: '2025-11-11'
  time_utc: '05:25:06'
  summary: README冒頭をクイックスタートのみの構成へ整理
  details:
  - セットアップ章のクイックスタート節から0/1/2の詳細手順を削除し、2行コマンド＋補足文のみで完結させた
  - pipx未導入ユーザー向けには本文末尾でbrew/pip + ensurepathの簡単な案内に留め、本文の主眼をクイックスタートに集中
  reproduce:
  - sed -n '13,40p' README.md
  result: セットアップ章は2行コマンド→補足文というシンプルな形となり、番号付きステップは消えている
  notes: 詳細なpipx導入手順は文中リンク・補足で十分と判断
- date: '2025-11-11'
  time_utc: '05:33:06'
  summary: README冒頭へスクリーンショットを追加
  details:
  - 指定されたファイルをdocs/assets配下へ移動し、命名規則に合わせて25-11-11-14_cli_overview.pngへリネーム
  - README.mdの先頭に画像埋め込みを追加し、CLI全体像が一目で分かるようにした
  reproduce:
  - ls docs/assets
  - sed -n '1,20p' README.md
  result: README冒頭に画像タグが挿入され、docs/assets/25-11-11-14_cli_overview.pngを参照している
  notes: 画像は後続のドキュメントでも使えるようdocs/assetsディレクトリを新設
- date: '2025-11-11'
  time_utc: '05:34:15'
  summary: 一度外れたREADME先頭スクリーンショットを再追加
  details:
  - README.mdの冒頭へ `![Parallel Developer CLI screenshot](docs/assets/25-11-11-14_cli_overview.png)` を再度挿入
  - 既存のdocs/assets/25-11-11-14_cli_overview.pngをそのまま参照し、他の内容には触れていない
  reproduce:
  - sed -n '1,10p' README.md
  result: 見出しの前にスクリーンショットが表示される
  notes: 誤って削除されたため同じ内容を再適用
- date: '2025-11-11'
  time_utc: '05:39:50'
  summary: 使われていないローカルディレクトリを整理
  details:
  - `.parallel-dev/`, `.pytest_cache/`, `.venv/`, `tmp_logs/`, `codex_src/`, `dist/` を削除し、リポジトリ直下を dev_test/docs/src/tests の最小構成へ整理
  - dist配下のビルド済みアーカイブ（pdev-0.1.1のwheel/tar.gz）は再生成可能なためgit管理から外す方針を共有
  reproduce:
  - ls -a
  - git status -sb
  result: 余計な一時ディレクトリやパッケージ成果物がなく、リポジトリ直下には dev_test/docs/src/tests など必要最小限のディレクトリのみが残る
  notes: 必要になれば`uv sync`や`pipx install pdev==0.1.1 --force`で環境再構築可能
- date: '2025-11-11'
  time_utc: '05:44:54'
  summary: 古いバックアップpyprojectを削除
  details:
  - ルート直下に残っていた25-11-01-19_pyproject.tomlは現行pyprojectと同一内容のバックアップだったためrmで削除
  - 無印pyproject.tomlのみを正とし、ビルド・パッケージ手順を一本化
  reproduce:
  - ls 25-11-01-19_pyproject.toml  # ファイルが存在しないことを確認
  result: バックアップファイルは存在せず、pyproject.tomlだけが残る
  notes: 必要ならgit履歴から復元可能
- date: '2025-11-11'
  time_utc: '05:46:10'
  summary: pyproject.tomlをシンボリックリンクから通常ファイルへ戻した
  details:
  - pyproject.tomlが25-11-01-19_pyproject.tomlへのシンボリックリンクだったため、無印ファイルで直接内容を管理するよう再生成
  - 25-11-01-19_pyproject.tomlをmvでpyproject.tomlへリネームし、ビルドツールがリンク切れにならないように修正
  reproduce:
  - ls -l pyproject.toml
  - head -n 5 pyproject.toml
  result: pyproject.tomlが通常ファイルとして存在し、symlinkではない
  notes: 今後バックアップを置く場合はdocs/backups配下などに保管予定
- date: '2025-11-11'
  time_utc: '05:49:26'
  summary: dev_test/とtests/をリポジトリから除外
  details:
  - git rm --cachedでdev_test/とtests/をインデックスから外し、ローカルには残したまま公開リポジトリから削除
  - .gitignoreへdev_test/を追記し（tests/は既存のまま）、今後誤ってコミットしないようにした
  reproduce:
  - git rm -r --cached dev_test tests
  - printf "dev_test/\n" >> .gitignore
  result: git statusで両ディレクトリが削除扱いとなり、`git push`後は公開リポジトリに含まれない
  notes: TTD用のtestsはローカル専用とし、必要なら別リポジトリやアーカイブで共有
- date: '2025-11-11'
  time_utc: '05:53:38'
  summary: READMEの/flowと/boss節を詳細化
  details:
  - `/flow`セクションへmanual/auto_review/auto_select/full_autoを個別に説明する箇条書きを追加
  - `/boss`セクションもskip/score/rewriteそれぞれの役割を1行ずつ明記
  reproduce:
  - sed -n '60,90p' README.md
  result: /flowと/bossの各モードが具体的に説明され、他コマンドと同じ書きぶりになった
  notes: CLI上のコマンドオプション説明と揃えてREADMEで迷わないようにするため
- date: '2025-11-11'
  time_utc: '05:59:20'
  summary: デフォルトをfull_auto / autoマージに変更
  details:
  - CLI初期化時のSessionConfigでflow_mode=full_auto, merge_mode=autoをセットし、SettingsStoreの既定値も合わせて更新
  - config.yamlを読み込む際のフォールバック値や_merge正規化関数を更新し、新規環境では自動モードが選ばれるようにした
  - READMEの`/flow`および`/merge`節に「(デフォルト)」表記を追加してドキュメントとも整合
  reproduce:
  - rg "flow_mode" -n src/parallel_developer/controller/__init__.py
  - head -n 40 src/parallel_developer/stores/settings_store.py
  - sed -n '60,90p' README.md
  result: 新規セッション起動時に`/flow`はfull_auto、`/merge`はautoで開始し、ユーザー設定に保存されていない場合も同じ挙動
  notes: 既存のconfig.yamlを持つユーザーは設定を手動変更するまで以前の値が維持される
- date: '2025-11-11'
  time_utc: '06:07:59'
  summary: テスト群を新デフォルトに追従させ、0.1.2をビルド
  details:
  - controller_command_test.pyとworkflow_test.pyでfull_auto/auto前提でも通るようアサーションとセットアップを更新
  - uv run pytestで122件すべて通過することを確認
  - pyproject.tomlのversionを0.1.2へ引き上げ、READMEのpipxコマンドも0.1.2に差し替え
  - uv buildでdist/pdev-0.1.2(whl/tar.gz)を作成し、pipx install dist/pdev-0.1.2-py3-none-any.whl --forceで全体に反映
  reproduce:
  - uv run pytest
  - uv build
  - pipx install dist/pdev-0.1.2-py3-none-any.whl --force
  result: テスト122件成功、pipx環境もVersion: 0.1.2に更新済み
  notes: testsディレクトリはgit管理外のため差分はローカルのみ
- date: '2025-11-11'
  time_utc: '06:24:53'
  summary: testsディレクトリをGit管理に戻した
  details:
  - git checkout <最新コミット> -- tests で以前のテスト群を復元し、.gitignore から tests/ を削除
  - Ubuntu等でcloneした際に uv run pytest を即座に再現できるようにするため
  reproduce:
  - git checkout e992111 -- tests
  - sed -i '' '/^tests\//d' .gitignore  # Linuxは -i '/^tests\//d'
  result: git status に tests 配下が追加され、今後のコミットに含まれる
  notes: dev_test/ は引き続きローカル専用のため ignore を維持
- date: '2025-11-11'
  time_utc: '06:26:25'
  summary: 復元したテストを最新デフォルトに追随させて再実行
  details:
  - controller_command_test.pyで「既にAuto」のログも許容するよう期待値を調整
  - workflow_test.pyで手動フローを明示設定し、continueアクションの意図を維持
  - uv run pytestで122件が再び成功することを確認
  reproduce:
  - uv run pytest
  result: 122 passed、full_auto/autoデフォルトでもテストが通る
  notes: これでUbuntuでcloneしてもテストがそのまま実行可能
- date: '2025-11-11'
  time_utc: '06:39:21'
  summary: CLI名称をSibylへリネームし、パッケージ名/コマンドを更新
  details:
  - pyproject.tomlのproject.nameを`sibyl-cli`へ変更し、versionを0.2.0に引き上げた上で`sibyl`エントリポイントを維持（旧`pdev`/`parallel-dev`も互換で同梱）
  - README.mdとdocs/requirement.yamlをSibyl表記へ更新し、pipxクイックスタートを`pipx install sibyl-cli==0.2.0`→`sibyl`に差し替え
  - CLI内部のメタデータ/__version__や自動コミット接頭辞を`sibyl-auto-save`系列へ変更
  - dist/sibyl_cli-0.2.0.* を生成後、`pipx uninstall pdev`→`pipx install dist/sibyl_cli-0.2.0-py3-none-any.whl`で再インストールし、`pipx runpip sibyl-cli show sibyl-cli`でVersion 0.2.0を確認
  reproduce:
  - sed -n '1,40p' README.md
  - rg "sibyl" pyproject.toml src/parallel_developer/__init__.py
  - pipx runpip sibyl-cli show sibyl-cli | grep Version
  result: `sibyl`コマンドでCLIが起動し、旧`pdev`も後方互換として残る
  notes: ログ/ディレクトリ名は `.parallel-dev` のまま据え置き、後方互換性を維持
- date: '2025-11-11'
  time_utc: '06:42:36'
  summary: README冒頭のスクリーンショットを最新Sibyl UIに差し替え
  details:
  - 共有された`sibyl_workflow.png`をdocs/assetsへ追加し、旧25-11-11-14_cli_overview.pngの代わりにREADMEで参照
  - macOS由来の`.DS_Store`を削除し、.gitignoreへ追加して今後コミットに混入しないようにした
  reproduce:
  - sed -n '1,10p' README.md
  - ls docs/assets
  result: README冒頭がsibyl_workflow.pngを表示し、余計な`.DS_Store`は出力されない
  notes: 旧スクリーンショットファイルは不要になったため追跡から削除
- date: '2025-11-11'
  time_utc: '06:54:53'
  summary: 旧`pdev`/`parallel-dev`エントリポイントを廃止し、sibyl-cli 0.2.1を公開
  details:
  - pyprojectのscriptsから`pdev`/`parallel-dev`を削除し、パッケージ名sibyl-cliのバージョンを0.2.1へ更新（README/pipx手順も `pipx install sibyl-cli==0.2.1` に差し替え）
  - docs/requirement.yamlのコマンド例を`sibyl --instruction ...`へ書き換え、旧名称への依存を解消
  - `uv run pytest`→122件成功後、`uv build`でdist/sibyl_cli-0.2.1.*を再生成し、`pipx install dist/sibyl_cli-0.2.1-py3-none-any.whl`でローカル環境を更新
  - `pipx runpip sibyl-cli show sibyl-cli | grep Version`で0.2.1を確認し、`uv publish ...`でPyPIへアップロード
  reproduce:
  - uv run pytest
  - uv build
  - pipx install dist/sibyl_cli-0.2.1-py3-none-any.whl --force
  - pipx runpip sibyl-cli show sibyl-cli | grep Version
  result: インストール可能なコマンドは`sibyl`のみになり、PyPI上の`sibyl-cli 0.2.1`を`pipx install sibyl-cli==0.2.1`で取得できる
  notes: `.parallel-dev` ディレクトリ名など内部構造は互換のため据え置き
- date: '2025-11-11'
  time_utc: '08:28:03'
  summary: ワーカー完了待ちのポーリング間隔を高速化
  details:
  - CodexMonitorのpoll_interval既定値を1.0s→0.05sへ変更し、完了/ログ検出の待機を短縮
  - オーケストレータの完了フラグ監視(_wait_for_flag)もmonitor.poll_intervalに連動させ、1s刻みのsleepを解消
  - uv run pytest (123件) で副作用がないことを確認
  reproduce:
  - uv run pytest
  result: 123 passed、指示からワーカー指示開始までのラグが大幅に減少
  notes: さらに短縮したい場合はSettingsStore側でpoll_intervalを設定できる拡張を検討
- date: '2025-11-11'
  time_utc: '09:00:43'
  summary: Git初期化が未完のリポジトリで自動初期コミットを作成
  details:
  - WorktreeManager._ensure_repo_initializedでHEADが無い場合に`git commit --allow-empty`を実行し、Sibyl側で初期コミットを自動作成
  - commitが失敗した場合のみ従来通りRuntimeErrorを投げるようガードを追加
  - tests/worktree_test.pyにauto-initializationの検証を追加し、ユーザー名/メール設定があれば自動コミットされることを確認
  reproduce:
  - uv run pytest tests/worktree_test.py::test_worktree_manager_auto_initial_commit
  result: 空リポジトリでもSibyl起動時に `chore: auto-initialized by Sibyl` コミットが作成され、tmuxセッション生成が止まらない
  notes: git configにuser.name/emailが無い環境では従来通り手動コミットが必要
- date: '2025-11-11'
  time_utc: '09:16:03'
  summary: ワーカー指示を即時送信し、rollout検知を後段へ遅延
  details:
  - Orchestratorで`_fork_worker_sessions`をワーカーペインのforkだけに限定し、`register_worker_rollouts`は指示送信後に実行
  - CodexMonitorでsession_meta未出力時にunknown IDを返さず、`refresh_session_id`で実IDへ差し替える `_await_real_session_id` を追加
  - register_new_rollout/register_worker_rolloutsの両方で確定したセッションIDのみ返すよう変更し、`codex resume unknown-XXXX` を防止
  - 指示送信がrollout検知を待たずに始まるため、ワーカーのレスポンスが向上
  - uv run pytest(125件)を再実行し、挙動に問題がないことを確認
  reproduce:
  - uv run pytest
  result: 指示送信と並行してセッション監視を開始する挙動へ変更
  notes: rollout検知が間に合わない場合は従来通り完了フラグで保護される
- date: '2025-11-11'
  time_utc: '08:45:00'
  summary: boss統合作業でdev_test helloスクリプトと実験ログを反映
  details:
  - worker-1案の25-11-11-17_hello.pyをdev_testへ取り込み、詳細ログ付きのHello実装を確定
  - docs/experiment.yamlへ本統合作業の記録を追記し、再現手順を共有
  reproduce:
  - uv run python dev_test/25-11-11-17_hello.py
  result: Hello from dev_test!が表示され、logs/25-11-11-17_hello.logへDEBUGログが出力される
  notes: bossワークスペースでの統合手順を明示して後工程で参照可能にした
- date: '2025-11-11'
  time_utc: '08:55:00'
  summary: boss統合でhello2スクリプトを採用
  details:
  - worker-2案の25-11-11-18_hello2.pyをdev_testへ配置し、--name対応の柔軟な挨拶ロジックと詳細DEBUGログを確定
  - docs/experiment.yamlへ統合作業のログを追記し、再現手順を共有
  reproduce:
  - uv run python dev_test/25-11-11-18_hello2.py --name sample
  result: Hello2 from sample!が標準出力され、logs/25-11-11-18_hello2.logに実行トレースが残る
  notes: dev_test配下はローカル検証専用のため.gitignore対象のまま管理
- date: '2025-11-13'
  time_utc: '07:45:00'
  summary: ローカル専用マージパイプラインと/merge full_autoを実装
  details:
  - Orchestratorの自動統合処理をホスト側パイプライン（git add/commit→git merge --ff-only）へ切り替え、リモートpull/pushやエージェントコミットを廃止
  - `/merge` コマンドを manual / auto / full_auto の3段階に再設計し、full_autoではfast-forward失敗時のみエージェントへブランチ調整を依頼後に自動再トライする挙動を追加
  - README、docs/requirement.yaml、CLIログ文言を新仕様に合わせて更新し、tests/orchestrator_test.py / tests/controller_command_test.py を書き換えて `uv run pytest` で成功を確認
  reproduce:
  - uv run pytest tests/orchestrator_test.py tests/controller_command_test.py
  result: 2ファイルのテストがいずれもPASSし、autoモードはホストのみで統合・full_autoは失敗時にエージェントへフォールバックする挙動を確認
  notes: `_pull_main_after_auto` はレガシー呼び出し互換用のNOPとして残しつつ、新しいケースはホスト側パイプラインが完全に担当
- date: '2025-11-13'
  time_utc: '08:05:00'
  summary: ホスト統合時のクリーンチェックを緩和し、dirty環境でもマージを試行
  details:
  - `_ensure_root_clean` を撤廃し、auto/full_auto のホストパイプラインが作業ツリーに未コミット変更があっても `git merge --ff-only` を実行するよう変更
  - 衝突する変更があればGitがエラーを出し、full_autoでは既存のエージェントfallbackが発火するため安全性は維持
  - `.parallel-dev` をコミット管理している環境でも自動統合が止まらなくなったことを確認
  reproduce:
  - uv run pytest tests/orchestrator_test.py tests/controller_command_test.py
  result: 31 tests passed
  notes: ルートのクリーンチェックはGitの警告に任せ、Sibyl側では追加メッセージを出さない
- date: '2025-11-13'
  time_utc: '08:20:00'
  summary: sibyl-cli 0.2.2 をリリース
  details:
  - pyproject.toml と src/parallel_developer/__init__.py のバージョンを 0.2.2 へ更新し、README クイックスタートのインストール例も 0.2.2 に差し替え
  - auto/full_auto のローカル統合改善を含む最新版を `uv run pytest tests/orchestrator_test.py tests/controller_command_test.py` で検証
  reproduce:
  - uv run pytest tests/orchestrator_test.py tests/controller_command_test.py
  result: 31 tests passed
  notes: このあと dist を再ビルドしてPyPIへ公開

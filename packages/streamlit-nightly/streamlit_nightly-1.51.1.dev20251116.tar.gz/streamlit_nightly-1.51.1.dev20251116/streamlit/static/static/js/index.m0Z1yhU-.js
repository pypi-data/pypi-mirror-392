import{w as R,r as i,u as W,O as I,Q as O,R as V,f as L,j as l,l as B,W as H,T as P,P as $,X as N,Y as E,Z as F,$ as k,a0 as A,a1 as D}from"./index.BTj4XZUf.js";import{u as U}from"./useBasicWidgetState.BV8gvTc2.js";import"./FormClearHelper.BaLOtzQI.js";const Y=R("div",{target:"euzcfsp0"})(({theme:s})=>({"span[aria-disabled='true']":{background:s.colors.fadedText05}})),j=(s,t)=>s.getStringArrayValue(t),K=s=>s.default.map(t=>s.options[t])??null,X=s=>s.rawValues??null,G=(s,t,a,c)=>{t.setStringArrayValue(s,a.value,{fromUi:a.fromUi},c)},Q=s=>{const{element:t,widgetMgr:a,fragmentId:c}=s,e=W(),S=i.useContext(I),[r,p]=U({getStateFromWidgetMgr:j,getDefaultStateFromProto:K,getCurrStateFromProto:X,updateWidgetMgrState:G,element:t,widgetMgr:a,fragmentId:c}),u=t.maxSelections>0&&r.length>=t.maxSelections,b=i.useMemo(()=>{if(t.maxSelections===0)return"No results";if(r.length===t.maxSelections){const o=t.maxSelections!==1?"options":"option";return`You can only select up to ${t.maxSelections} ${o}. Remove an option first.`}return"No results"},[t.maxSelections,r.length]),g=i.useCallback(o=>{switch(o.type){case"remove":return O(r,o.option?.value);case"clear":return[];case"select":return r.concat([o.option?.value]);default:throw new Error(`State transition is unknown: ${o.type}`)}},[r]),f=i.useCallback(o=>{t.maxSelections&&o.type==="select"&&r.length>=t.maxSelections||p({value:g(o),fromUi:!0})},[t.maxSelections,g,p,r.length]),{options:x}=t,{placeholder:y,disabled:v,selectOptions:C,inputReadOnly:z,valuesToUiMulti:m,createFilterOptions:h}=V({options:x,isMulti:!0,acceptNewOptions:t.acceptNewOptions??!1,placeholderInput:t.placeholder}),T=i.useCallback((o,n)=>u?[]:h(r)(o,n),[h,u,r]),d=s.disabled||v,w=i.useMemo(()=>m(r),[m,r]),M=i.useMemo(()=>{const o=e.fontSizes.baseFontSize*1.6+14;return`${Math.round(o*4.25)}px`},[e.fontSizes.baseFontSize]);return L("div",{className:"stMultiSelect","data-testid":"stMultiSelect",children:[l(N,{label:t.label,disabled:d,labelVisibility:B(t.labelVisibility?.value),children:t.help&&l(H,{children:l(P,{content:t.help,placement:$.TOP_RIGHT})})}),l(Y,{children:l(E,{creatable:t.acceptNewOptions??!1,options:C,labelKey:"label",valueKey:"value","aria-label":t.label,placeholder:y,type:A.select,multi:!0,onChange:f,value:w,disabled:d,size:"compact",noResultsMsg:b,filterOptions:T,closeOnSelect:!1,ignoreCase:!1,overrides:{Popover:{props:{ignoreBoundary:S,overrides:{Body:{style:()=>({marginTop:e.spacing.px})}}}},SelectArrow:{component:k,props:{style:{cursor:"pointer"},overrides:{Svg:{style:()=>({width:e.iconSizes.xl,height:e.iconSizes.xl})}}}},IconsContainer:{style:()=>({paddingRight:e.spacing.sm})},ControlContainer:{style:({$isFocused:o})=>{const n=D(e.colors,o);return{maxHeight:M,minHeight:e.sizes.minElementHeight,borderLeftWidth:e.sizes.borderWidth,borderRightWidth:e.sizes.borderWidth,borderTopWidth:e.sizes.borderWidth,borderBottomWidth:e.sizes.borderWidth,borderTopColor:n,borderRightColor:n,borderBottomColor:n,borderLeftColor:n}}},Placeholder:{style:()=>({flex:"inherit",color:d?e.colors.fadedText40:e.colors.fadedText60})},ValueContainer:{style:()=>({overflowY:"auto",paddingLeft:e.spacing.sm,paddingTop:e.spacing.none,paddingBottom:e.spacing.none,paddingRight:e.spacing.none})},ClearIcon:{props:{overrides:{Svg:{style:{color:e.colors.grayTextColor,padding:e.spacing.threeXS,height:e.sizes.clearIconSize,width:e.sizes.clearIconSize,cursor:"pointer",":hover":{fill:e.colors.bodyText}}}}}},SearchIcon:{style:{color:e.colors.grayTextColor}},Tag:{props:{overrides:{Root:{style:{fontWeight:e.fontWeights.normal,borderTopLeftRadius:e.radii.md,borderTopRightRadius:e.radii.md,borderBottomRightRadius:e.radii.md,borderBottomLeftRadius:e.radii.md,fontSize:e.fontSizes.md,paddingLeft:e.spacing.sm,marginLeft:e.spacing.none,marginRight:e.spacing.sm,height:`calc(${e.sizes.minElementHeight} - 2 * ${e.spacing.xs})`,maxWidth:`calc(100% - ${e.spacing.lg})`,cursor:"default !important"}},Action:{style:{paddingLeft:0}},ActionIcon:{props:{overrides:{Svg:{style:{width:"0.625em",height:"0.625em"}}}}}}}},MultiValue:{props:{overrides:{Root:{style:{fontSize:e.fontSizes.sm}}}}},Input:{props:{readOnly:z}},Dropdown:{component:F}}})})]})},J=i.memo(Q);export{J as default};

# ğŸ“˜ color-logger-utils

**color-logger-utils** ã¯ã€ç’°å¢ƒå¤‰æ•°ã§ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãƒ»ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŸ”è»Ÿã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹
**ä¾å­˜æ³¨å…¥ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãª Python ãƒ­ã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£**ã§ã™ã€‚

* âœ” **ã‚«ãƒ©ãƒ¼ä»˜ãã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ï¼ˆANSI Escapeï¼‰**
* âœ” **LOG_LEVEL / LOG_FILE_PATH ã§æŒ™å‹•ã‚’å®Œå…¨åˆ¶å¾¡**
* âœ” **æ—¢å­˜ãƒ­ã‚¬ãƒ¼ãŒã‚ã‚‹å ´åˆã¯å†è¨­å®šã›ãš â€œå°Šé‡â€ ã—ã¦å†åˆ©ç”¨**
* âœ” **DIï¼ˆä¾å­˜æ³¨å…¥ï¼‰ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ logger ã‚’è‡ªå‹•æ³¨å…¥**
* âœ” **ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯è‡ªå‹•ä½œæˆã•ã‚Œã€åˆæœŸè¨­å®šä¸è¦**

Python æ¨™æº– `logging` ã‚’ä½¿ã£ãŸã¾ã¾ã€**æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã§å¼·åŠ›ãªãƒ­ã‚®ãƒ³ã‚°åŸºç›¤**ã‚’å°å…¥ã§ãã¾ã™ã€‚

---

# ğŸš€ Installation

```bash
uv add color-logger-utils
# ã¾ãŸã¯
pip install color-logger-utils
```

---

# ğŸ”§ Quick Start

## 1. ã‚·ãƒ³ãƒ—ãƒ«ã«ãƒ­ã‚¬ãƒ¼ã‚’å–å¾—ã—ã¦ä½¿ã†

```python
from logger_utils.logger_factory import get_logger

logger = get_logger("my-app")

logger.info("Hello world!")
logger.debug("This will be hidden unless LOG_LEVEL=DEBUG")
```

---

## 2. ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ logger ã‚’è‡ªå‹•æ³¨å…¥

```python
from logger_utils import with_logger

@with_logger(name="my-service")
def main(logger):
    logger.info("Injected logger works!")

main()
```

é–¢æ•°ãŒ `logger` å¼•æ•°ã‚’å—ã‘å–ã‚Œã‚‹å ´åˆã€è‡ªå‹•çš„ã«æ¸¡ã•ã‚Œã¾ã™ã€‚

---

# ğŸŒ± Environment Variables

color-logger-utils ã®æŒ™å‹•ã¯ã€**ç’°å¢ƒå¤‰æ•°ã§å®Œå…¨ã«åˆ¶å¾¡ã§ãã¾ã™**ã€‚

---

## ğŸ”¸ `LOG_LEVEL`

ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```bash
export LOG_LEVEL=DEBUG
```

ã‚µãƒãƒ¼ãƒˆå€¤ï¼ˆå¤§æ–‡å­—ãƒ»å°æ–‡å­—å•ã‚ãšï¼‰:

| å€¤              | å¯¾å¿œãƒ¬ãƒ™ãƒ«            |
| -------------- | ---------------- |
| DEBUG          | logging.DEBUG    |
| INFO           | logging.INFO     |
| WARN / WARNING | logging.WARNING  |
| ERROR          | logging.ERROR    |
| CRITICAL       | logging.CRITICAL |
| ä¸æ­£ãªå€¤           | INFO ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯    |

å†…éƒ¨ã§ã¯ `map_level()` ã§å®‰å…¨ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

---

## ğŸ”¸ `LOG_FILE_PATH`

ãƒ­ã‚°å‡ºåŠ›ãƒ‘ã‚¹ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚

```bash
export LOG_FILE_PATH=/var/log/my_app/
```

æŒ™å‹•ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«åˆ†å²ã—ã¾ã™ï¼š

| LOG_FILE_PATH ã®å€¤  | è§£é‡ˆ                       |
| ----------------- | ------------------------ |
| æœªè¨­å®š / ç©ºæ–‡å­—         | `logs/app.log` ã‚’ä½¿ç”¨ï¼ˆè‡ªå‹•ä½œæˆï¼‰ |
| æ—¢å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª          | `ãã®ä¸­ã® app.log` ã‚’ä½¿ç”¨       |
| `/` or `\` ã§çµ‚ã‚ã‚‹ãƒ‘ã‚¹ | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ‰±ã„ â†’ `app.log` ã‚’ä»˜ä¸ |
| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹            | ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›                |

å†…éƒ¨ã§ã¯ `_resolve_log_path_from_env()` ãŒå…¨ã¦ãƒãƒ³ãƒ‰ãƒ«ã—ã¾ã™ã€‚

---

# ğŸ§  Design & Behavior

## âœ” æ—¢å­˜ãƒ­ã‚¬ãƒ¼ã‚’å°Šé‡ã—ã¦å†è¨­å®šã—ãªã„

`logging.getLogger(name)` ã«ã™ã§ã«ãƒãƒ³ãƒ‰ãƒ©ãŒä»˜ã„ã¦ã„ã‚‹å ´åˆï¼š

* **ç’°å¢ƒå¤‰æ•°ã‚’ç„¡è¦–**
* **æ—¢å­˜è¨­å®šã‚’ãã®ã¾ã¾åˆ©ç”¨**

ã¨ã„ã†ã€Œå®‰å…¨ãªæŒ™å‹•ã€ã‚’å–ã‚Šã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã‚„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å´ã§ãƒ­ã‚®ãƒ³ã‚°è¨­å®šã‚’è¡Œã£ã¦ã„ã‚‹å ´åˆã‚‚ã€
æœ¬ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå£Šã™ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

---

## âœ” DIï¼ˆä¾å­˜æ³¨å…¥ï¼‰ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ä»•çµ„ã¿

```python
@with_logger(name="service")
def fn(logger):
    logger.info("ok")
```

* `logger` å¼•æ•°ãŒã‚ã‚‹ â†’ kwargs ã«è‡ªå‹•æ³¨å…¥
* ãªã„ â†’ ãã®é–¢æ•°ã® **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å…¨ä½“ã« `logger` ã‚’æ³¨å…¥**

ã¨ã„ã† 2 æ®µæ§‹ãˆã®å®Ÿè£…ã«ãªã£ã¦ã„ã¾ã™ã€‚

---

## âœ” ã‚«ãƒ©ãƒ¼ä»˜ãã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›

`custom_formatter.py` ã«ã‚ˆã‚Šã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦ ANSI ã‚«ãƒ©ãƒ¼ãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚

ä¾‹ï¼š

* DEBUG â†’ ç°è‰²
* INFO â†’ é’ / ç·‘
* WARNING â†’ é»„è‰²
* ERROR â†’ èµ¤
* CRITICAL â†’ èµ¤èƒŒæ™¯

> âš ï¸ **æ³¨æ„ï¼ˆWindowsï¼‰:**
> å¤ã„ Windows ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã¯ ANSI ã‚«ãƒ©ãƒ¼ãŒç„¡åŠ¹ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚
> Windows Terminal / PowerShell ã§ã¯å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

---

# ğŸ§ª Testing

ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ pytest ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚

## å®Ÿè¡Œ

```bash
uv run pytest
```

## ãƒ†ã‚¹ãƒˆãƒãƒªã‚·ãƒ¼ï¼ˆä»•æ§˜ã¨ä¸€è‡´ï¼‰

âœ” `map_level` ãŒæ–‡å­—åˆ—ï¼ãƒ¬ãƒ™ãƒ«ç•ªå·ï¼ä¸æ­£å€¤ã‚’æœŸå¾…é€šã‚Šæ‰±ã†
âœ” `LOG_FILE_PATH` ã®å…¨åˆ†å²ï¼ˆæœªè¨­å®š / ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª / ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
âœ” `with_logger` ãŒ logger ã‚’æ³¨å…¥ã™ã‚‹
âœ” æ—¢å­˜ãƒ­ã‚¬ãƒ¼ãŒã„ã‚‹å ´åˆã®å†åˆ©ç”¨
âœ” ãƒ­ã‚°å‡ºåŠ›ãƒ‘ã‚¹ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹

---

# ğŸ“‚ Project Structure

æ¨™æº–çš„ãª **src ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ** ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

```text
project/
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ README.md
â”œâ”€â”€ src/
â”‚   â””â”€â”€ logger_utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ constants.py
â”‚       â”œâ”€â”€ custom_formatter.py
â”‚       â”œâ”€â”€ level_mapper.py
â”‚       â”œâ”€â”€ logger_factory.py
â”‚       â””â”€â”€ logger_injector.py
â””â”€â”€ tests/
    â”œâ”€â”€ test_level_mapper.py
    â”œâ”€â”€ test_log_path_resolver.py
    â””â”€â”€ test_with_logger.py
```

---

# ğŸ“¦ Release

PyPI å…¬é–‹ã¯æ¬¡ã®é€šã‚Šã€‚

```bash
uv build
uv publish --token pypi-xxxx
```

---

# ğŸ“„ License

MIT License
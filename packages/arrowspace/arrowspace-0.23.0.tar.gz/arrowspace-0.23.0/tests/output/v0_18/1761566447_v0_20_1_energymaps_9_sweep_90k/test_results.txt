98696it [00:31, 3151.39it/s]
Loaded 98696 CVEs
Generating embeddings...
Model loaded from: ./domain_adapted_model
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3085/3085 [02:40<00:00, 19.16it/s]
Embeddings shape: (98696, 384), sample: [-0.02660437  0.07302938  0.02346344 -0.05955957 -0.04822142]...

Generating query embeddings...
Model loaded from: ./domain_adapted_model
Batches: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 213.09it/s]
Embeddings shape: (3, 384), sample: [-0.0122127   0.05706869 -0.01711867 -0.07662857 -0.11884194]...

======================================================================
DIFFUSION PARAMETER SWEEP
======================================================================

======================================================================
Building BASELINE standard index...
======================================================================
Standard build time: 29.75s

======================================================================
Testing: η=0.05, steps=4
======================================================================
Building energy index: η=0.05, steps=4, optical_tokens=None
Energy build time: 28.18s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.0000
  Avg MAP: 0.0000
  Avg NDCG@10: 0.0000
  Avg Recall@10: 0.0000

======================================================================
Testing: η=0.05, steps=6
======================================================================
Building energy index: η=0.05, steps=6, optical_tokens=None
Energy build time: 30.09s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.0000
  Avg MAP: 0.0000
  Avg NDCG@10: 0.0000
  Avg Recall@10: 0.0000

======================================================================
Testing: η=0.05, steps=8
======================================================================
Building energy index: η=0.05, steps=8, optical_tokens=None
Energy build time: 28.04s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 1.0000
  MAP@25: 0.1000
  Recall@10: 0.1000
  Recall@20: 0.1000
  NDCG@10: 0.2891

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.3333
  Avg MAP: 0.0333
  Avg NDCG@10: 0.0964
  Avg Recall@10: 0.0333

======================================================================
Testing: η=0.05, steps=10
======================================================================
Building energy index: η=0.05, steps=10, optical_tokens=None
Energy build time: 26.95s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 1.0000
  MAP@25: 0.1000
  Recall@10: 0.1000
  Recall@20: 0.1000
  NDCG@10: 0.2891

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.1000
  Recall@10: 0.1000
  Recall@20: 0.1000
  NDCG@10: 0.2891

Aggregated metrics:
  Avg MRR: 0.6667
  Avg MAP: 0.0667
  Avg NDCG@10: 0.1927
  Avg Recall@10: 0.0667

======================================================================
Testing: η=0.1, steps=4
======================================================================
Building energy index: η=0.1, steps=4, optical_tokens=None
Energy build time: 27.64s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 1.0000
  MAP@25: 0.1000
  Recall@10: 0.1000
  Recall@20: 0.1000
  NDCG@10: 0.2891

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.3333
  Avg MAP: 0.0333
  Avg NDCG@10: 0.0964
  Avg Recall@10: 0.0333

======================================================================
Testing: η=0.1, steps=6
======================================================================
Building energy index: η=0.1, steps=6, optical_tokens=None
Energy build time: 25.71s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.0000
  Avg MAP: 0.0000
  Avg NDCG@10: 0.0000
  Avg Recall@10: 0.0000

======================================================================
Testing: η=0.1, steps=8
======================================================================
Building energy index: η=0.1, steps=8, optical_tokens=None
Energy build time: 26.87s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.0000
  Avg MAP: 0.0000
  Avg NDCG@10: 0.0000
  Avg Recall@10: 0.0000

======================================================================
Testing: η=0.1, steps=10
======================================================================
Building energy index: η=0.1, steps=10, optical_tokens=None
Energy build time: 28.57s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 2: remote code execution in ERP web component...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.0000
  Avg MAP: 0.0000
  Avg NDCG@10: 0.0000
  Avg Recall@10: 0.0000

======================================================================
Testing: η=0.22, steps=4
======================================================================
Building energy index: η=0.22, steps=4, optical_tokens=None
Energy build time: 25.61s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 1.0000
  MAP@25: 0.5690
  Recall@10: 0.6000
  Recall@20: 0.6000
  NDCG@10: 0.5097

Query 2: remote code execution in ERP web component...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Query 3: SQL injection in login endpoint...
  MRR: 0.0000
  MAP@25: 0.0000
  Recall@10: 0.0000
  Recall@20: 0.0000
  NDCG@10: 0.0000

Aggregated metrics:
  Avg MRR: 0.3333
  Avg MAP: 0.1897
  Avg NDCG@10: 0.1699
  Avg Recall@10: 0.2000

======================================================================
Testing: η=0.22, steps=6
======================================================================
Building energy index: η=0.22, steps=6, optical_tokens=None
Energy build time: 28.20s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.22, steps=8
======================================================================
Building energy index: η=0.22, steps=8, optical_tokens=None
Energy build time: 27.05s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.22, steps=10
======================================================================
Building energy index: η=0.22, steps=10, optical_tokens=None
Energy build time: 26.84s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.25, steps=4
======================================================================
Building energy index: η=0.25, steps=4, optical_tokens=None
Energy build time: 29.30s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2472
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4910
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.25, steps=6
======================================================================
Building energy index: η=0.25, steps=6, optical_tokens=None
Energy build time: 31.58s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.25, steps=8
======================================================================
Building energy index: η=0.25, steps=8, optical_tokens=None
Energy build time: 27.61s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.25, steps=10
======================================================================
Building energy index: η=0.25, steps=10, optical_tokens=None
Energy build time: 30.29s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.5, steps=4
======================================================================
Building energy index: η=0.5, steps=4, optical_tokens=None
Energy build time: 26.69s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.5, steps=6
======================================================================
Building energy index: η=0.5, steps=6, optical_tokens=None
Energy build time: 28.38s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.5, steps=8
======================================================================
Building energy index: η=0.5, steps=8, optical_tokens=None
Energy build time: 25.55s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
Testing: η=0.5, steps=10
======================================================================
Building energy index: η=0.5, steps=10, optical_tokens=None
Energy build time: 30.22s

Query 1: authenticated arbitrary file read path traversal...
  MRR: 0.5000
  MAP@25: 0.5405
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.7151

Query 2: remote code execution in ERP web component...
  MRR: 0.2000
  MAP@25: 0.2439
  Recall@10: 0.5000
  Recall@20: 0.6000
  NDCG@10: 0.7859

Query 3: SQL injection in login endpoint...
  MRR: 1.0000
  MAP@25: 0.6854
  Recall@10: 0.6000
  Recall@20: 1.0000
  NDCG@10: 0.5646

Aggregated metrics:
  Avg MRR: 0.5667
  Avg MAP: 0.4900
  Avg NDCG@10: 0.6885
  Avg Recall@10: 0.5667

======================================================================
BEST CONFIGURATIONS
======================================================================

Best MRR: η=0.05, steps=10
  MRR: 0.6667
  MAP: 0.0667
  NDCG: 0.1927

Best MAP: η=0.25, steps=4
  MRR: 0.5667
  MAP: 0.4910
  NDCG: 0.6885
Sweep heatmaps saved to diffusion_sweep_heatmaps.png
Sweep results saved to diffusion_sweep_results.csv

======================================================================
ANALYSIS COMPLETE
======================================================================
Standard build time: 29.75s
Energy builds tested: 20/20
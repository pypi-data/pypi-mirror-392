# IOWarp Runtime Docker Compose Configuration
#
# This compose file runs the IOWarp runtime service for user applications.
# The iowarp service provides the CTE runtime that applications can connect to.
#
# Usage:
#   docker-compose up                       # Run runtime service
#   docker-compose up -d                    # Start runtime in background
#   docker-compose down                     # Stop service

services:
    # IOWarp Runtime Service
    # Provides the CTE runtime daemon that applications connect to
    iowarp-runtime:
        image: iowarp/iowarp:latest
        container_name: iowarp-runtime

        # Mount shared CTE configuration
        # volumes:
        #    - ./wrp_conf.yaml:/etc/iowarp/wrp_conf.yaml:ro

        # Note: ports section not needed with network_mode: host
        # The container uses the host's network directly, so ports 5555 and 5556
        # are automatically accessible from the host

        # Resource limits
        # Large shared memory for CTE operations
        shm_size: 8g
        mem_limit: 8g

        # Make IPC namespace accessible to host so external applications can connect
        ipc: host
        
        # Share network namespace with host - container uses host's network directly
        network_mode: host

        # Keep container running as a daemon
        stdin_open: true
        tty: true

        # Restart policy - no restart for manual runs
        restart: "no"

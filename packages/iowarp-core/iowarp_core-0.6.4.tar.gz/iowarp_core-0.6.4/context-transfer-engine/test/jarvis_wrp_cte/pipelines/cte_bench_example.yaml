# CTE Benchmark Example Pipeline
# Purpose: Demonstrate CTE core functionality with the CTE benchmark application
# Requirements: chimaera_start_runtime and chimaera_stop_runtime in PATH, wrp_cte_bench executable in PATH

name: cte_benchmark_example

pkgs:
  - pkg_type: jarvis_wrp_runtime.wrp_runtime
    pkg_name: runtime

  - pkg_type: jarvis_wrp_cte.wrp_cte
    pkg_name: cte_core
    devices:
      - ["${HOME}/cte_benchmark/storage1.bin", "500MB", 0.8]
      - ["${HOME}/cte_benchmark/storage2.bin", "500MB", 0.7]

    # CTE Configuration Parameters
    dpe_type: "max_bw"                   # Data placement engine: random, round_robin, max_bw
    neighborhood: 4                      # Number of targets (nodes CTE can buffer to)
    default_target_timeout_ms: 30000     # Target timeout (ms)
    poll_period_ms: 5000                 # Period to rescan targets for statistics (capacity, bandwidth, etc.) (ms)

  - pkg_type: jarvis_wrp_cte.wrp_cte_bench
    pkg_name: put_benchmark
    test_case: "Put"                     # Benchmark type: Put, Get, or PutGet
    depth: 4                             # Number of concurrent async operations
    io_size: "1m"                        # I/O operation size (k/K, m/M, g/G suffixes)
    io_count: 100                        # Number of I/O operations per process
    nprocs: 2                            # Number of MPI processes
    ppn: 2                               # Processes per node
    output_file: "put_results.txt"       # Output file for results (empty = stdout)
    init_runtime: true                   # Initialize Chimaera runtime (true if no separate runtime package)

# Environment configuration (optional)
# env:
#   WRP_CTE_LOG_LEVEL: "info"
#   CTE_DEBUG: "0"

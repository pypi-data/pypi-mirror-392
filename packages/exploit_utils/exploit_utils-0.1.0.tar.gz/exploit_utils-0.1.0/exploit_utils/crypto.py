"""常见加密方式的加解密操作"""

import hashlib
from Crypto.Cipher import ARC4
from Crypto.Cipher.AES import new as aes
from Crypto.Cipher.DES import new as des
from Crypto.Cipher.DES3 import new as des3


__all__ = [
    "aes", "des", "des3", "ASEMode", "DESMode",
    "md5", "sha1", "sha256", "sha512", "rc4", "rc4_d",
]


class AESMode():
    ECB = 1
    CBC = 2
    CFB = 3
    OFB = 5
    CTR = 6
    OPENPGP = 7
    CCM = 8
    EAX = 9
    SIV = 10
    GCM = 11
    OCB = 12
    KW = 13
    KWP = 14


class DESMode():
    ECB = 1
    CBC = 2
    CFB = 3
    OFB = 5
    CTR = 6
    OPENPGP = 7
    EAX = 9


def md5(message: str, encoding: str = "utf-8") -> str:
    """md5 加密"""
    return hashlib.md5(message.encode(encoding)).hexdigest()


def sha1(message: str, encoding: str = "utf-8") -> str:
    """sha1 加密"""
    return hashlib.sha1(message.encode(encoding)).hexdigest()


def sha256(message: str, encoding: str = "utf-8") -> str:
    """sha256 加密"""
    return hashlib.sha256(message.encode(encoding)).hexdigest()


def sha512(message: str, encoding: str = "utf-8") -> str:
    """sha512 加密"""
    return hashlib.sha512(message.encode(encoding)).hexdigest()


def rc4(message: str, key: bytes | str, encoding: str = "utf-8") -> bytes:
    """RC4 加密"""
    if isinstance(key, str):
        key = key.encode(encoding)
    return ARC4.new(key).encrypt(message.encode(encoding))


def rc4_d(message: bytes, key: bytes | str, encoding: str = "utf-8") -> str:
    """RC4 解密"""
    if isinstance(key, str):
        key = key.encode(encoding)
    return ARC4.new(key).decrypt(message)

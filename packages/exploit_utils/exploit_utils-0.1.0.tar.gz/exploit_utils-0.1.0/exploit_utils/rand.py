"""与"随机"相关的功能"""

import random
import string
from fake_useragent import UserAgent
from typing import Iterable


__all__ = ["Length", "ua", "rand_string", "rand_word", "rand_digits"]

type Length = int | tuple[int, int]

ua = UserAgent()
"""UA 头生成器"""


def rand_length(n: Length) -> int:
    if isinstance(n, int):
        return n
    return random.randint(n[0], n[1])


def rand_string(charset: Iterable[str], length: Length) -> str:
    """获取指定长度的随机字符串"""
    return ''.join(random.choices(charset, k=rand_length(length)))


def rand_word(length: Length) -> str:
    """获取指定长度的随机单词"""
    return rand_string(string.ascii_letters, length)


def rand_digits(length: Length, base: int = 10) -> str:
    """获取指定长度的随机数字串"""
    match base:
        case 2:
            charset = "01"
        case 8:
            charset = string.octdigits
        case 10:
            charset = string.digits
        case 16:
            charset = string.hexdigits
        case _:
            raise ValueError(f"unsupport base: {base}")

    return rand_string(charset, length)

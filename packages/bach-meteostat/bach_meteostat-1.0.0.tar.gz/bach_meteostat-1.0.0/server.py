"""
Meteostat MCP Server

‰ΩøÁî® FastMCP ÁöÑ from_openapi ÊñπÊ≥ïËá™Âä®ÁîüÊàê

Version: 1.0.0
Transport: stdio
"""
import os
import json
import httpx
from fastmcp import FastMCP

# ÊúçÂä°Âô®ÁâàÊú¨ÂíåÈÖçÁΩÆ
__version__ = "1.0.0"
__tag__ = "meteostat/1.0.0"

# API ÈÖçÁΩÆ
API_KEY = os.getenv("API_KEY", "")

# ‰º†ËæìÂçèËÆÆÈÖçÁΩÆ
TRANSPORT = "stdio"


# OpenAPI ËßÑËåÉ
OPENAPI_SPEC = """{\n  \"openapi\": \"3.0.0\",\n  \"info\": {\n    \"title\": \"Meteostat\",\n    \"version\": \"1.0.0\",\n    \"description\": \"RapidAPI: meteostat/meteostat\"\n  },\n  \"servers\": [\n    {\n      \"url\": \"https://meteostat.p.rapidapi.com\"\n    }\n  ],\n  \"paths\": {\n    \"/point/monthly\": {\n      \"get\": {\n        \"summary\": \"Monthly Point Data\",\n        \"description\": \"This endpoint provides historical monthly statistics for a geographic location. The data provided through this endpoint is aggregated from multiple governmental interfaces.\",\n        \"operationId\": \"monthly_point_data\",\n        \"parameters\": [\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's latitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's longitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The point's elevation.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The start date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The end date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time frequency of the records. Can be used for custom aggregation. Default is null.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 52.5244\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 13.4105\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 43\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-12-31\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/stations/monthly\": {\n      \"get\": {\n        \"summary\": \"Monthly Station Data\",\n        \"description\": \"This endpoint provides historical monthly statistics for a particular weather station. The data provided through this endpoint is aggregated from multiple governmental interfaces.\",\n        \"operationId\": \"monthly_station_data\",\n        \"parameters\": [\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The Meteostat weather station identifier.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The start date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The end date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time frequency of the records. Can be used for custom aggregation. Default is null.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 10637\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-12-31\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/stations/meta\": {\n      \"get\": {\n        \"summary\": \"Station Meta Data\",\n        \"description\": \"This endpoint provides meta data for a particular weather station.\",\n        \"operationId\": \"station_meta_data\",\n        \"parameters\": [\n          {\n            \"name\": \"id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The Meteostat identifier of a weather station.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"wmo\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The WMO identifier of a weather station.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"icao\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The ICAO identifier of a weather station.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"id\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 10637\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"wmo\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"icao\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/point/daily\": {\n      \"get\": {\n        \"summary\": \"Daily Point Data\",\n        \"description\": \"This endpoint provides historical daily statistics for a geographic location. The data provided through this endpoint is aggregated from multiple governmental interfaces.\",\n        \"operationId\": \"daily_point_data\",\n        \"parameters\": [\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's latitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's longitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The point's elevation.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The start date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The end date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time frequency of the records. Can be used for custom aggregation. Default is null.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 43.6667\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: -79.4\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 184\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-31\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/point/hourly\": {\n      \"get\": {\n        \"summary\": \"Hourly Point Data\",\n        \"description\": \"This endpoint provides historical hourly observations for a geographic location. The data provided through this endpoint is aggregated from multiple governmental interfaces.\",\n        \"operationId\": \"hourly_point_data\",\n        \"parameters\": [\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's latitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's longitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The point's elevation.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The start date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The end date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"tz\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time zone according to the tz database. Default is UTC.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time frequency of the records. Can be used for custom aggregation. Default is null.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 43.6667\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: -79.4\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 113\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"tz\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: America/Toronto\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/stations/normals\": {\n      \"get\": {\n        \"summary\": \"Station Climate Data\",\n        \"description\": \"This endpoint provides climate normals for a particular weather station.\",\n        \"operationId\": \"station_climate_data\",\n        \"parameters\": [\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The Meteostat weather station identifier.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The start year of the reference period.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The end year of the reference period.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 10637\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 1961\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 1990\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/point/normals\": {\n      \"get\": {\n        \"summary\": \"Point Climate Data\",\n        \"description\": \"This endpoint provides climate normals for any geo location.\",\n        \"operationId\": \"point_climate_data\",\n        \"parameters\": [\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's latitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The point's longitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The point's elevation.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The start year of the reference period.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The end year of the reference period.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 59.9127\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 10.7461\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"alt\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 26\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 1961\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: 1990\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/stations/nearby\": {\n      \"get\": {\n        \"summary\": \"Nearby Stations\",\n        \"description\": \"This endpoint provides a list of nearby weather stations for a given geographical location.\",\n        \"operationId\": \"nearby_stations\",\n        \"parameters\": [\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The location's latitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The location's longitude.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"limit\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The maximum number of weather stations. Default is 10.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"radius\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The meter radius to search in. Default is 100000.\",\n            \"schema\": {\n              \"type\": \"number\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lat\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 51.5085\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"lon\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: -0.1257\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"limit\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"radius\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/stations/hourly\": {\n      \"get\": {\n        \"summary\": \"Hourly Station Data\",\n        \"description\": \"This endpoint provides historical hourly observations for a particular weather station. The data provided through this endpoint is aggregated from multiple governmental interfaces.\",\n        \"operationId\": \"hourly_station_data\",\n        \"parameters\": [\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The Meteostat weather station identifier.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The start date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The end date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"tz\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time zone according to the tz database. Default is UTC.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time frequency of the records. Can be used for custom aggregation. Default is null.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 10637\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"tz\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: Europe/Berlin\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/stations/daily\": {\n      \"get\": {\n        \"summary\": \"Daily Station Data\",\n        \"description\": \"This endpoint provides historical daily statistics for a particular weather station. The data provided through this endpoint is aggregated from multiple governmental interfaces.\",\n        \"operationId\": \"daily_station_data\",\n        \"parameters\": [\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The Meteostat weather station identifier.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The start date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"The end date of the period (YYYY-MM-DD).\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The time frequency of the records. Can be used for custom aggregation. Default is null.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"The unit system of the meteorological parameters. Default is metric.\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"station\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 10637\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"start\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-01\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"end\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"description\": \"Example value: 2020-01-31\",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"model\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"freq\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          },\n          {\n            \"name\": \"units\",\n            \"in\": \"query\",\n            \"required\": false,\n            \"description\": \"Example value: \",\n            \"schema\": {\n              \"type\": \"string\",\n              \"default\": null,\n              \"enum\": null\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Successful response\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {}\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  \"components\": {\n    \"securitySchemes\": {\n      \"ApiAuth\": {\n        \"type\": \"apiKey\",\n        \"in\": \"header\",\n        \"name\": \"X-RapidAPI-Key\"\n      }\n    }\n  },\n  \"security\": [\n    {\n      \"ApiAuth\": []\n    }\n  ]\n}"""

# ÂàõÂª∫ HTTP ÂÆ¢Êà∑Á´Ø
# ËÆæÁΩÆÈªòËÆ§ headers
default_headers = {}


# RapidAPI ÂøÖÈúÄÁöÑ headers
if API_KEY:
    default_headers["X-RapidAPI-Key"] = API_KEY
    default_headers["X-RapidAPI-Host"] = "meteostat.p.rapidapi.com"
else:
    print("‚ö†Ô∏è  Ë≠¶Âëä: Êú™ËÆæÁΩÆ API_KEY ÁéØÂ¢ÉÂèòÈáè")
    print("   RapidAPI ÈúÄË¶Å API Key ÊâçËÉΩÊ≠£Â∏∏Â∑•‰Ωú")
    print("   ËØ∑ËÆæÁΩÆ: export API_KEY=‰Ω†ÁöÑRapidAPI-Key")

# ÂØπ‰∫é POST/PUT/PATCH ËØ∑Ê±ÇÔºåËá™Âä®Ê∑ªÂä† Content-Type
default_headers["Content-Type"] = "application/json"




client = httpx.AsyncClient(
    base_url="https://meteostat.p.rapidapi.com", 
    timeout=30.0
)


# ‰ªé OpenAPI ËßÑËåÉÂàõÂª∫ FastMCP ÊúçÂä°Âô®
openapi_dict = json.loads(OPENAPI_SPEC)
mcp = FastMCP.from_openapi(
    openapi_spec=openapi_dict,
    client=client,
    name="meteostat",
    version=__version__
)


# Ê≥®ÂÜåËØ∑Ê±ÇÊã¶Êà™Âô®Ôºå‰∏∫ÊâÄÊúâËØ∑Ê±ÇÊ∑ªÂä† RapidAPI headers
_original_request = client.request

async def _add_rapidapi_headers(method, url, **kwargs):
    """Êã¶Êà™ÊâÄÊúâËØ∑Ê±ÇÔºåÊ∑ªÂä†ÂøÖÈúÄÁöÑ RapidAPI headers"""
    # Á°Æ‰øù headers Â≠òÂú®
    if 'headers' not in kwargs:
        kwargs['headers'] = {}
    
    # Ê∑ªÂä† RapidAPI ÂøÖÈúÄÁöÑ headers
    if API_KEY:
        kwargs['headers']['X-RapidAPI-Key'] = API_KEY
        kwargs['headers']['X-RapidAPI-Host'] = "meteostat.p.rapidapi.com"
    else:
        print("‚ö†Ô∏è  Ë≠¶Âëä: API_KEY Êú™ËÆæÁΩÆÔºåËØ∑Ê±ÇÂèØËÉΩÂ§±Ë¥•")
    
    # ÂØπ‰∫é POST/PUT/PATCHÔºåÊ∑ªÂä† Content-Type
    if method.upper() in ['POST', 'PUT', 'PATCH']:
        if 'Content-Type' not in kwargs['headers']:
            kwargs['headers']['Content-Type'] = 'application/json'
    
    return await _original_request(method, url, **kwargs)

# ÊõøÊç¢ request ÊñπÊ≥ï
client.request = _add_rapidapi_headers


def main():
    """‰∏ªÂÖ•Âè£ÁÇπ"""
    print(f"üöÄ ÂêØÂä® Meteostat MCP ÊúçÂä°Âô®")
    print(f"üì¶ ÁâàÊú¨: {__tag__}")
    print(f"üîß ‰º†ËæìÂçèËÆÆ: {TRANSPORT}")
    
    print()
    
    # ËøêË°åÊúçÂä°Âô®
    
    mcp.run(transport="stdio")
    


if __name__ == "__main__":
    main()
# yaspeedtest
YaSpeedTest ‚Äî —ç—Ç–æ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç Python**, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ—á–Ω–æ –∏–∑–º–µ—Ä—è–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–µ –∂–µ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏, —á—Ç–æ –∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π [Yandex Internet Speed ‚Äã‚ÄãTest](https://yandex.ru/internet).

[![PyPI Version](https://img.shields.io/pypi/v/yaspeedtest?logo=pypi&label=Release)](https://pypi.org/project/yaspeedtest)
[![PyPI - Downloads](https://img.shields.io/pypi/dm/yaspeedtest?logo=pypi&label=PyPI%20-%20Downloads)](https://pypi.org/project/yaspeedtest)
[![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![üß™ Run Tests](https://github.com/ErilovNikita/yaspeedtest/actions/workflows/tests.yml/badge.svg)](https://github.com/ErilovNikita/yaspeedtest/actions/workflows/tests.yml)

![preview](https://github.com/ErilovNikita/yaspeedtest/blob/main/docs/preview.png?raw=true)

> [!WARNING]  
> –î–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ù–ï —è–≤–ª—è–µ—Ç—Å—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π, –∏ –Ω–µ –ø—ã—Ç–∞–µ—Ç—Å—è –µ–π –∫–∞–∑–∞—Ç—å—Å—è. –î–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –ª–∏—á–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö, –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ endpoint'—ã.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (`asyncio`, `aiohttp`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∏–∫–æ–≤–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ (—Ä–µ–∞–ª—å–Ω—ã–µ –ø–∏–∫–æ–≤—ã–µ Mbps, –∫–∞–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
- –£–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–± (probes) —Å —Å–µ—Ä–≤–µ—Ä–æ–≤ –Ø–Ω–¥–µ–∫—Å–∞
- –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (—á–µ—Ä–µ–∑ `pydantic`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π **Download**, **Upload**, **Latency**
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Python 3.11+
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ª—é–±—ã–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–ª–∏ DevOps –ø–∞–π–ø–ª–∞–π–Ω—ã

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Å –ø–æ–º–æ—â—å—é pip:

```bash
pip install yaspeedtest
```

–ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
git clone https://github.com/ErilovNikita/yaspeedtest
cd yaspeedtest
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```python
import asyncio
from yaspeedtest.client import YaSpeedTest

async def main():
    ya = await YaSpeedTest.create()
    result = await ya.run()

    print(f"Ping: {result.ping_ms:.2f} ms")
    print(f"Download: {result.download_mbps:.2f} Mbps")
    print(f"Upload: {result.upload_mbps:.2f} Mbps")

asyncio.run(main())

# Ping: 1.84 ms
# Download: 939.17 Mbps
# Upload: 870.29 Mbps
```

–ë–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –ø–∞–ø–∫–µ [examples](/examples)

## –†–µ–∂–∏–º –ø–∏–∫–æ–≤–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
–ú–µ—Ç–æ–¥—ã `measure_download_peak()` –∏ `measure_upload_peak()` —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –ø–∏–∫–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å–µ–∫—É–Ω–¥—É, –∞ –Ω–µ —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º—É —Ñ–∞–π–ª—É.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–∏–µ –∫ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º—É —Ç–µ—Å—Ç—É –Ø–Ω–¥–µ–∫—Å–∞, –≥–¥–µ —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞.

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –Ø–Ω–¥–µ–∫—Å
1. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–±–æ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö probe-—Å–µ—Ä–≤–µ—Ä–æ–≤ (latency, download, upload)
1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è:
   - Latency ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∏–Ω–≥–∏ –∫ –º–∞–ª—ã–º —Ä–µ—Å—É—Ä—Å–∞–º (latency probes)
   - Download ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
   - Upload ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
1. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç SpeedResult, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π:
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–∏–Ω–≥
   - –ü–∏–∫–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏
   - –ü–∏–∫–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–¥–∞—á–∏

## –°—Ç—Ä—É–∫—Ä—É—Ä–∞
### –ö–ª–∞—Å—Å YaSpeedTest
| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-------|
| `run()` | –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ |
| `measure_latency(url: str, timeout: int)` | *–ò–∑–º–µ—Ä—è–µ—Ç –ø–∏–Ω–≥ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö* |
| `measure_download(url: str, timeout: int)` | *–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏* |
| `measure_download_peak(url: str, timeout: int)` | *–ò–∑–º–µ—Ä—è–µ—Ç –ø–∏–∫–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏* |
| `measure_upload(url: str, size: int, timeout: int)` | *–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–¥–∞—á–∏* |
| `measure_upload_peak(url: str, size: int, timeout: int)` | *–ò–∑–º–µ—Ä—è–µ—Ç –ø–∏–∫–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–¥–∞—á–∏* |

### –ö–ª–∞—Å—Å SpeedResult
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----|-----|
| **ping_ms** | float | *–°—Ä–µ–¥–Ω–∏–π –ø–∏–Ω–≥ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö* |
| **download_mbps** | float | *–°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –º–µ–≥–∞–±–∏—Ç–∞—Ö –≤ —Å–µ–∫—É–Ω–¥—É* |
| **upload_mbps** | float | *–°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–¥–∞—á–∏ –≤ –º–µ–≥–∞–±–∏—Ç–∞—Ö –≤ —Å–µ–∫—É–Ω–¥—É* |

–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ SpeedResult:
```python
SpeedResult(
    ping_ms=1.37,
    download_mbps=950.42,
    upload_mbps=870.10
)
```

## –°–æ–≤–µ—Ç—ã –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ–± ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ 3‚Äì5 –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ timeout –Ω–µ –º–µ–Ω–µ–µ 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∑–∞–º–µ—Ä–æ–≤.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ aiohttp.TCPConnector(limit_per_host=2) –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏.
- –ù–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º NAT –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø–∏–Ω–≥–∞ –∏–∑-–∑–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π TLS.
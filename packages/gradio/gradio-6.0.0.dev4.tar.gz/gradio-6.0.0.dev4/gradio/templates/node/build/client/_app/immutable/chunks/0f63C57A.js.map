{"version":3,"file":"0f63C57A.js","sources":["../../../../../../../uploadbutton/shared/UploadButton.svelte","../../../../../../../uploadbutton/Index.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { tick, createEventDispatcher } from \"svelte\";\n\timport { BaseButton } from \"@gradio/button\";\n\timport { prepare_files, type FileData, type Client } from \"@gradio/client\";\n\n\texport let elem_id = \"\";\n\texport let elem_classes: string[] = [];\n\texport let visible: boolean | \"hidden\" = true;\n\texport let label: string | null;\n\texport let value: null | FileData | FileData[];\n\texport let file_count: string;\n\texport let file_types: string[] = [];\n\texport let root: string;\n\texport let size: \"sm\" | \"md\" | \"lg\" = \"lg\";\n\texport let icon: FileData | null = null;\n\texport let scale: number | null = null;\n\texport let min_width: number | undefined = undefined;\n\texport let variant: \"primary\" | \"secondary\" | \"stop\" = \"secondary\";\n\texport let disabled = false;\n\texport let max_file_size: number | null = null;\n\texport let upload: Client[\"upload\"];\n\n\tconst dispatch = createEventDispatcher();\n\n\tlet hidden_upload: HTMLInputElement;\n\tlet accept_file_types: string | null;\n\n\tif (file_types == null) {\n\t\taccept_file_types = null;\n\t} else {\n\t\tfile_types = file_types.map((x) => {\n\t\t\tif (x.startsWith(\".\")) {\n\t\t\t\treturn x;\n\t\t\t}\n\t\t\treturn x + \"/*\";\n\t\t});\n\t\taccept_file_types = file_types.join(\", \");\n\t}\n\n\tfunction open_file_upload(): void {\n\t\tdispatch(\"click\");\n\t\thidden_upload.click();\n\t}\n\n\tasync function load_files(files: FileList): Promise<void> {\n\t\tlet _files: File[] = Array.from(files);\n\n\t\tif (!files.length) {\n\t\t\treturn;\n\t\t}\n\t\tif (file_count === \"single\") {\n\t\t\t_files = [files[0]];\n\t\t}\n\t\tlet all_file_data = await prepare_files(_files);\n\t\tawait tick();\n\n\t\ttry {\n\t\t\tall_file_data = (\n\t\t\t\tawait upload(all_file_data, root, undefined, max_file_size ?? Infinity)\n\t\t\t)?.filter((x) => x !== null) as FileData[];\n\t\t} catch (e) {\n\t\t\tdispatch(\"error\", (e as Error).message);\n\t\t\treturn;\n\t\t}\n\t\tvalue = file_count === \"single\" ? all_file_data?.[0] : all_file_data;\n\t\tdispatch(\"change\", value);\n\t\tdispatch(\"upload\", value);\n\t}\n\n\tasync function load_files_from_upload(e: Event): Promise<void> {\n\t\tconst target = e.target as HTMLInputElement;\n\n\t\tif (!target.files) return;\n\t\tawait load_files(target.files);\n\t}\n\n\tfunction clear_input_value(e: Event): void {\n\t\tconst target = e.target as HTMLInputElement;\n\t\tif (target.value) target.value = \"\";\n\t}\n</script>\n\n<input\n\tclass=\"hide\"\n\taccept={accept_file_types}\n\ttype=\"file\"\n\tbind:this={hidden_upload}\n\ton:change={load_files_from_upload}\n\ton:click={clear_input_value}\n\tmultiple={file_count === \"multiple\" || undefined}\n\twebkitdirectory={file_count === \"directory\" || undefined}\n\tmozdirectory={file_count === \"directory\" || undefined}\n\tdata-testid=\"{label}-upload-button\"\n/>\n\n<BaseButton\n\t{size}\n\t{variant}\n\t{elem_id}\n\t{elem_classes}\n\t{visible}\n\ton:click={open_file_upload}\n\t{scale}\n\t{min_width}\n\t{disabled}\n>\n\t{#if icon}\n\t\t<img class=\"button-icon\" src={icon.url} alt={`${value} icon`} />\n\t{/if}\n\t<slot />\n</BaseButton>\n\n<style>\n\t.hide {\n\t\tdisplay: none;\n\t}\n\t.button-icon {\n\t\twidth: var(--text-xl);\n\t\theight: var(--text-xl);\n\t\tmargin-right: var(--spacing-xl);\n\t}\n</style>\n","<script lang=\"ts\" context=\"module\">\n\texport { default as BaseUploadButton } from \"./shared/UploadButton.svelte\";\n</script>\n\n<script lang=\"ts\">\n\timport type { UploadButtonProps, UploadButtonEvents } from \"./types\";\n\timport type { FileData } from \"@gradio/client\";\n\timport { Gradio } from \"@gradio/utils\";\n\timport UploadButton from \"./shared/UploadButton.svelte\";\n\n\tconst props = $props();\n\tconst gradio = new Gradio<UploadButtonEvents, UploadButtonProps>(props);\n\n\tlet value = $state(gradio.props.value);\n\n\t$effect(() => {\n\t\tif (value !== gradio.props.value) {\n\t\t\tgradio.props.value = value;\n\t\t}\n\t});\n\n\tasync function handle_event(\n\t\tdetail: null | FileData | FileData[],\n\t\tevent: \"change\" | \"upload\" | \"click\"\n\t): Promise<void> {\n\t\tgradio.props.value = detail;\n\t\tgradio.dispatch(event);\n\t}\n\n\tconst disabled = $derived(!gradio.shared.interactive);\n</script>\n\n<UploadButton\n\telem_id={gradio.shared.elem_id}\n\telem_classes={gradio.shared.elem_classes}\n\tvisible={gradio.shared.visible}\n\tfile_count={gradio.props.file_count}\n\tfile_types={gradio.props.file_types}\n\tsize={gradio.props.size}\n\tscale={gradio.shared.scale}\n\ticon={gradio.props.icon}\n\tmin_width={gradio.shared.min_width}\n\troot={gradio.shared.root}\n\t{value}\n\t{disabled}\n\tvariant={gradio.props.variant}\n\tlabel={gradio.shared.label}\n\tmax_file_size={gradio.shared.max_file_size}\n\ton:click={() => gradio.dispatch(\"click\")}\n\ton:change={({ detail }) => handle_event(detail, \"change\")}\n\ton:upload={({ detail }) => handle_event(detail, \"upload\")}\n\ton:error={({ detail }) => {\n\t\tgradio.dispatch(\"error\", detail);\n\t}}\n\tupload={(...args) => gradio.shared.client.upload(...args)}\n>\n\t{gradio.shared.label ?? \"\"}\n</UploadButton>\n"],"names":["$.prop","$.mutable_source","$.set","$.get","$.bind_this","$.untrack","$.rest_props","$.proxy","$.user_effect","event","$.derived","$.template_effect","$.set_text","text"],"mappings":"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"}
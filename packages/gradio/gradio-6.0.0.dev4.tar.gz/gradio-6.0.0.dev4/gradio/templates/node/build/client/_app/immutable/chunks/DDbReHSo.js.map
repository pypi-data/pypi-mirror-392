{"version":3,"mappings":"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","names":["$.prop","$.mutable_source","$.get","$.set","component","$.derived_safe_equal","$.untrack","$$anchor","$.rest_props","$.state","$.proxy","$.user_effect","$0","$.derived"],"ignoreList":[],"sources":["../../../../../../../model3D/shared/Model3DUpload.svelte","../../../../../../../model3D/Index.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { createEventDispatcher, tick } from \"svelte\";\n\timport { Upload, ModifyUpload } from \"@gradio/upload\";\n\timport type { FileData, Client } from \"@gradio/client\";\n\timport { BlockLabel } from \"@gradio/atoms\";\n\timport { File } from \"@gradio/icons\";\n\timport type { I18nFormatter } from \"@gradio/utils\";\n\timport type Canvas3DGS from \"./Canvas3DGS.svelte\";\n\timport type Canvas3D from \"./Canvas3D.svelte\";\n\n\texport let value: null | FileData;\n\texport let display_mode: \"solid\" | \"point_cloud\" | \"wireframe\" = \"solid\";\n\texport let clear_color: [number, number, number, number] = [0, 0, 0, 0];\n\texport let label = \"\";\n\texport let show_label: boolean;\n\texport let root: string;\n\texport let i18n: I18nFormatter;\n\texport let zoom_speed = 1;\n\texport let pan_speed = 1;\n\texport let max_file_size: number | null = null;\n\texport let uploading = false;\n\texport let upload_promise: Promise<(FileData | null)[]> | null = null;\n\n\t// alpha, beta, radius\n\texport let camera_position: [number | null, number | null, number | null] = [\n\t\tnull,\n\t\tnull,\n\t\tnull\n\t];\n\texport let upload: Client[\"upload\"];\n\texport let stream_handler: Client[\"stream\"];\n\n\tasync function handle_upload({\n\t\tdetail\n\t}: CustomEvent<FileData>): Promise<void> {\n\t\tvalue = detail;\n\t\tawait tick();\n\t\tdispatch(\"change\", value);\n\t\tdispatch(\"load\", value);\n\t}\n\n\tasync function handle_clear(): Promise<void> {\n\t\tvalue = null;\n\t\tawait tick();\n\t\tdispatch(\"clear\");\n\t\tdispatch(\"change\");\n\t}\n\n\tlet use_3dgs = false;\n\tlet Canvas3DGSComponent: typeof Canvas3DGS;\n\tlet Canvas3DComponent: typeof Canvas3D;\n\tasync function loadCanvas3D(): Promise<typeof Canvas3D> {\n\t\tconst module = await import(\"./Canvas3D.svelte\");\n\t\treturn module.default;\n\t}\n\tasync function loadCanvas3DGS(): Promise<typeof Canvas3DGS> {\n\t\tconst module = await import(\"./Canvas3DGS.svelte\");\n\t\treturn module.default;\n\t}\n\t$: if (value) {\n\t\tuse_3dgs = value.path.endsWith(\".splat\") || value.path.endsWith(\".ply\");\n\t\tif (use_3dgs) {\n\t\t\tloadCanvas3DGS().then((component) => {\n\t\t\t\tCanvas3DGSComponent = component;\n\t\t\t});\n\t\t} else {\n\t\t\tloadCanvas3D().then((component) => {\n\t\t\t\tCanvas3DComponent = component;\n\t\t\t});\n\t\t}\n\t}\n\n\tlet canvas3d: Canvas3D | undefined;\n\tasync function handle_undo(): Promise<void> {\n\t\tcanvas3d?.reset_camera_position();\n\t}\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: FileData | null;\n\t\tclear: undefined;\n\t\tdrag: boolean;\n\t\tload: FileData;\n\t}>();\n\n\tlet dragging = false;\n\n\t$: dispatch(\"drag\", dragging);\n</script>\n\n<BlockLabel {show_label} Icon={File} label={label || \"3D Model\"} />\n\n{#if value == null}\n\t<Upload\n\t\tbind:upload_promise\n\t\t{upload}\n\t\t{stream_handler}\n\t\ton:load={handle_upload}\n\t\t{root}\n\t\t{max_file_size}\n\t\tfiletype={[\".stl\", \".obj\", \".gltf\", \".glb\", \"model/obj\", \".splat\", \".ply\"]}\n\t\tbind:dragging\n\t\tbind:uploading\n\t\ton:error\n\t\taria_label={i18n(\"model3d.drop_to_upload\")}\n\t>\n\t\t<slot />\n\t</Upload>\n{:else}\n\t<div class=\"input-model\">\n\t\t<ModifyUpload\n\t\t\tundoable={!use_3dgs}\n\t\t\ton:clear={handle_clear}\n\t\t\t{i18n}\n\t\t\ton:undo={handle_undo}\n\t\t/>\n\n\t\t{#if use_3dgs}\n\t\t\t<svelte:component\n\t\t\t\tthis={Canvas3DGSComponent}\n\t\t\t\t{value}\n\t\t\t\t{zoom_speed}\n\t\t\t\t{pan_speed}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<svelte:component\n\t\t\t\tthis={Canvas3DComponent}\n\t\t\t\tbind:this={canvas3d}\n\t\t\t\t{value}\n\t\t\t\t{display_mode}\n\t\t\t\t{clear_color}\n\t\t\t\t{camera_position}\n\t\t\t\t{zoom_speed}\n\t\t\t\t{pan_speed}\n\t\t\t/>\n\t\t{/if}\n\t</div>\n{/if}\n\n<style>\n\t.input-model {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\tborder-radius: var(--block-radius);\n\t\toverflow: hidden;\n\t}\n\n\t.input-model :global(canvas) {\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\tobject-fit: contain;\n\t\toverflow: hidden;\n\t}\n</style>\n","<script context=\"module\" lang=\"ts\">\n\texport { default as BaseModel3D } from \"./shared/Model3D.svelte\";\n\texport { default as BaseModel3DUpload } from \"./shared/Model3DUpload.svelte\";\n\texport { default as BaseExample } from \"./Example.svelte\";\n</script>\n\n<script lang=\"ts\">\n\timport { tick } from \"svelte\";\n\timport type { Model3DProps, Model3DEvents } from \"./types\";\n\timport type { FileData } from \"@gradio/client\";\n\timport { Gradio } from \"@gradio/utils\";\n\timport Model3D from \"./shared/Model3D.svelte\";\n\timport Model3DUpload from \"./shared/Model3DUpload.svelte\";\n\timport { BlockLabel, Block, Empty, UploadText } from \"@gradio/atoms\";\n\timport { File } from \"@gradio/icons\";\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\n\tclass Model3dGradio extends Gradio<Model3DEvents, Model3DProps> {\n\t\tasync get_data() {\n\t\t\tif (upload_promise) {\n\t\t\t\tawait upload_promise;\n\t\t\t\tawait tick();\n\t\t\t}\n\t\t\tconst data = await super.get_data();\n\n\t\t\treturn data;\n\t\t}\n\t}\n\n\tconst props = $props();\n\tconst gradio = new Model3dGradio(props);\n\n\tlet old_value = $state(gradio.props.value);\n\tlet uploading = $state(false);\n\tlet dragging = $state(false);\n\tlet has_change_history = $state(false);\n\tlet upload_promise = $state<Promise<any>>();\n\n\tconst is_browser = typeof window !== \"undefined\";\n\n\t$effect(() => {\n\t\tif (old_value !== gradio.props.value) {\n\t\t\told_value = gradio.props.value;\n\t\t\tgradio.dispatch(\"change\");\n\t\t}\n\t});\n\n\tfunction handle_change(detail: FileData | null) {\n\t\tgradio.props.value = detail;\n\t\tgradio.dispatch(\"change\", detail);\n\t\thas_change_history = true;\n\t}\n\n\tfunction handle_drag(detail: boolean) {\n\t\tdragging = detail;\n\t}\n\n\tfunction handle_clear() {\n\t\tgradio.props.value = null;\n\t\tgradio.dispatch(\"clear\");\n\t}\n\n\tfunction handle_load(detail: FileData) {\n\t\tgradio.props.value = detail;\n\t\tgradio.dispatch(\"upload\");\n\t}\n\n\tfunction handle_error(detail: string) {\n\t\tif (gradio.shared.loading_status)\n\t\t\tgradio.shared.loading_status.status = \"error\";\n\t\tgradio.dispatch(\"error\", detail);\n\t}\n</script>\n\n{#if !gradio.shared.interactive}\n\t<Block\n\t\tvisible={gradio.shared.visible}\n\t\tvariant={gradio.props.value === null ? \"dashed\" : \"solid\"}\n\t\tborder_mode={dragging ? \"focus\" : \"base\"}\n\t\tpadding={false}\n\t\telem_id={gradio.shared.elem_id}\n\t\telem_classes={gradio.shared.elem_classes}\n\t\tcontainer={gradio.shared.container}\n\t\tscale={gradio.shared.scale}\n\t\tmin_width={gradio.shared.min_width}\n\t\theight={gradio.props.height}\n\t>\n\t\t<StatusTracker\n\t\t\tautoscroll={gradio.shared.autoscroll}\n\t\t\ti18n={gradio.i18n}\n\t\t\t{...gradio.shared.loading_status}\n\t\t\ton:clear_status={() =>\n\t\t\t\tgradio.dispatch(\"clear_status\", gradio.shared.loading_status)}\n\t\t/>\n\n\t\t{#if gradio.props.value && is_browser}\n\t\t\t<Model3D\n\t\t\t\tvalue={gradio.props.value}\n\t\t\t\ti18n={gradio.i18n}\n\t\t\t\tdisplay_mode={gradio.props.display_mode}\n\t\t\t\tclear_color={gradio.props.clear_color}\n\t\t\t\tlabel={gradio.shared.label}\n\t\t\t\tshow_label={gradio.shared.show_label}\n\t\t\t\tcamera_position={gradio.props.camera_position}\n\t\t\t\tzoom_speed={gradio.props.zoom_speed}\n\t\t\t\t{has_change_history}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<BlockLabel\n\t\t\t\tshow_label={gradio.shared.show_label}\n\t\t\t\tIcon={File}\n\t\t\t\tlabel={gradio.shared.label || \"3D Model\"}\n\t\t\t/>\n\n\t\t\t<Empty unpadded_box={true} size=\"large\"><File /></Empty>\n\t\t{/if}\n\t</Block>\n{:else}\n\t<Block\n\t\tvisible={gradio.shared.visible}\n\t\tvariant={gradio.props.value === null ? \"dashed\" : \"solid\"}\n\t\tborder_mode={dragging ? \"focus\" : \"base\"}\n\t\tpadding={false}\n\t\telem_id={gradio.shared.elem_id}\n\t\telem_classes={gradio.shared.elem_classes}\n\t\tcontainer={gradio.shared.container}\n\t\tscale={gradio.shared.scale}\n\t\tmin_width={gradio.shared.min_width}\n\t\theight={gradio.props.height}\n\t>\n\t\t<StatusTracker\n\t\t\tautoscroll={gradio.shared.autoscroll}\n\t\t\ti18n={gradio.i18n}\n\t\t\t{...gradio.shared.loading_status}\n\t\t\ton:clear_status={() =>\n\t\t\t\tgradio.dispatch(\"clear_status\", gradio.shared.loading_status)}\n\t\t/>\n\n\t\t<Model3DUpload\n\t\t\tbind:upload_promise\n\t\t\tlabel={gradio.shared.label}\n\t\t\tshow_label={gradio.shared.show_label}\n\t\t\troot={gradio.shared.root}\n\t\t\tdisplay_mode={gradio.props.display_mode}\n\t\t\tclear_color={gradio.props.clear_color}\n\t\t\tvalue={gradio.props.value}\n\t\t\tcamera_position={gradio.props.camera_position}\n\t\t\tzoom_speed={gradio.props.zoom_speed}\n\t\t\tbind:uploading\n\t\t\ton:change={({ detail }) => handle_change(detail)}\n\t\t\ton:drag={({ detail }) => handle_drag(detail)}\n\t\t\ton:clear={handle_clear}\n\t\t\ton:load={({ detail }) => handle_load(detail)}\n\t\t\ton:error={({ detail }) => handle_error(detail)}\n\t\t\ti18n={gradio.i18n}\n\t\t\tmax_file_size={gradio.shared.max_file_size}\n\t\t\tupload={(...args) => gradio.shared.client.upload(...args)}\n\t\t\tstream_handler={(...args) => gradio.shared.client.stream(...args)}\n\t\t>\n\t\t\t<UploadText i18n={gradio.i18n} type=\"file\" />\n\t\t</Model3DUpload>\n\t</Block>\n{/if}\n"],"file":"DDbReHSo.js"}
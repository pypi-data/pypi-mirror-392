{"version":3,"mappings":";;;;;;;;qCAAA;;;MAKK;MAEO,QAAeA,KAAA;MACf,eAAmDA,KAAA;MACnD,cAA6CA,KAAA;MAC7C,kBAA8DA,KAAA;MAC9D,aAAkBA,KAAA;MAClB,YAAiBA,KAAA;MAIxB,SAAyBC,eAAA;MACzB;MACA;AACA,+BAAU,KAAK;AAEnB,UAAO,MAAO;AACP,uBAAU,YAA8B;AAC7C,wDAA8B,eAAmB;AACjD,qBAAe,sBAAqBC,IAAC,MAAM;AAAA,QAC1C,YAAY,YAAW;AAAA,QACvB,sBAAsB;AAAA,QACtB,mBAAmB;AAAA,QACnB,iBAAe,EAAI,SAAS,MAAK;AAAA,QACjC,eAAa,CAAG,YAAiB;AAChC,0BAAgB;AAAA,QACjB;AAAA,SACE,KAAI,CAAE,kBAAuB;AAC/B,iBAAS;AACTC,YAAA,SAAU,IAAI;AAAA,MACf,CAAC;AAAA,IACF;AAEA,eAAU;AAEG;AACZ,cAAQ,QAAO;AAAA,IAChB;AAAA,EACD,CAAC;AAIQ,4BAAiB,aAAsB,WAA0B;AACzE,kBAAc,MAAM,mBAAmB;AACvC,kBAAc,MAAM,iBAAiB;AAAA,EACtC;WAES,WAAWC,MAA+B;AAC9C,gBAAQ;AACP,UAAAA,MAAK;AACR,eACE,UAAUA,MAAG,EACb,eAAa,EACZ,KAAG,EACF,oBAAoB,YAItB,KAAI,MAAO;cACP,aAAY,MAAK,eAAe;AACnC,6BAAiB,MAAM,KAAK;AAAA,UAC7B,WAAW,aAAY,MAAK,aAAa;AACxC,6BAAiB,OAAO,IAAI;AAAA,UAC7B,OAAO;AACN,0BAAc,gBAAe,GAAE,WAAU,GAAE,UAAS;AAAA,UACrD;AAAA,QACD,CAAC;AAAA,MACH,OAAO;AACN,eAAO,WAAU;AAAA,MAClB;AAAA,IACD;AAAA,EACD;AAEgB,yBACfC,kBACAC,aACAC,YACO;UACD,SAAS,cAAc;AACzB,QAAAF,iBAAgB,CAAC,MAAM,MAAM;AAChC,aAAO,QAASA,iBAAgB,CAAC,IAAI,KAAK,KAAM;AAAA,IACjD;AACI,QAAAA,iBAAgB,CAAC,MAAM,MAAM;AAChC,aAAO,OAAQA,iBAAgB,CAAC,IAAI,KAAK,KAAM;AAAA,IAChD;AACI,QAAAA,iBAAgB,CAAC,MAAM,MAAM;AAChC,aAAO,SAASA,iBAAgB,CAAC;AAAA,IAClC;AACA,WAAO,mBAAmB;AACpB,oCAAuB,MAAe;AAC3C,aAAO,iBAAiB,OAAO,OAAO,SAASC;AAC/C,aAAO,qBAAsB,MAAQC,aAAa,OAAO;AAAA,IAC1D;AACA,4BAAuB;AACvB,WAAO,6BAA6B,IAAI,uBAAuB;AAAA,EAChE;AAEgB,mCAA8B;AACzC,uBAAe;AAClB,aAAO,YAAW;AAAA,IACnB;AAAA,EACD;;QA5FG,KAAM,MAAK,EAAC,GAAG;AAAA;;QA+Bf,OAAO,KAAI,WAAUL,IAAC,GAAG;AAAA;;;;;AAgEVM,YAAA,uBAAAL,IAAA,kCAAM;;;;;AAFzB","names":["$.prop","$.mutable_source","$.get","$.set","url","camera_position","zoom_speed","pan_speed","$.bind_this"],"ignoreList":[],"sources":["../../../../../../../model3D/shared/Canvas3D.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { onMount } from \"svelte\";\n\timport type { FileData } from \"@gradio/client\";\n\timport type { Viewer, ViewerDetails } from \"@babylonjs/viewer\";\n\n\tlet BABYLON_VIEWER: typeof import(\"@babylonjs/viewer\");\n\n\texport let value: FileData;\n\texport let display_mode: \"solid\" | \"point_cloud\" | \"wireframe\";\n\texport let clear_color: [number, number, number, number];\n\texport let camera_position: [number | null, number | null, number | null];\n\texport let zoom_speed: number;\n\texport let pan_speed: number;\n\n\t$: url = value.url;\n\n\tlet canvas: HTMLCanvasElement;\n\tlet viewer: Viewer;\n\tlet viewerDetails: Readonly<ViewerDetails>;\n\tlet mounted = false;\n\n\tonMount(() => {\n\t\tconst initViewer = async (): Promise<void> => {\n\t\t\tBABYLON_VIEWER = await import(\"@babylonjs/viewer\");\n\t\t\tBABYLON_VIEWER.CreateViewerForCanvas(canvas, {\n\t\t\t\tclearColor: clear_color,\n\t\t\t\tuseRightHandedSystem: true,\n\t\t\t\tanimationAutoPlay: true,\n\t\t\t\tcameraAutoOrbit: { enabled: false },\n\t\t\t\tonInitialized: (details: any) => {\n\t\t\t\t\tviewerDetails = details;\n\t\t\t\t}\n\t\t\t}).then((promiseViewer: any) => {\n\t\t\t\tviewer = promiseViewer;\n\t\t\t\tmounted = true;\n\t\t\t});\n\t\t};\n\n\t\tinitViewer();\n\n\t\treturn () => {\n\t\t\tviewer?.dispose();\n\t\t};\n\t});\n\n\t$: mounted && load_model(url);\n\n\tfunction setRenderingMode(pointsCloud: boolean, wireframe: boolean): void {\n\t\tviewerDetails.scene.forcePointsCloud = pointsCloud;\n\t\tviewerDetails.scene.forceWireframe = wireframe;\n\t}\n\n\tfunction load_model(url: string | undefined): void {\n\t\tif (viewer) {\n\t\t\tif (url) {\n\t\t\t\tviewer\n\t\t\t\t\t.loadModel(url, {\n\t\t\t\t\t\tpluginOptions: {\n\t\t\t\t\t\t\tobj: {\n\t\t\t\t\t\t\t\timportVertexColors: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tif (display_mode === \"point_cloud\") {\n\t\t\t\t\t\t\tsetRenderingMode(true, false);\n\t\t\t\t\t\t} else if (display_mode === \"wireframe\") {\n\t\t\t\t\t\t\tsetRenderingMode(false, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tupdate_camera(camera_position, zoom_speed, pan_speed);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tviewer.resetModel();\n\t\t\t}\n\t\t}\n\t}\n\n\texport function update_camera(\n\t\tcamera_position: [number | null, number | null, number | null],\n\t\tzoom_speed: number,\n\t\tpan_speed: number\n\t): void {\n\t\tconst camera = viewerDetails.camera;\n\t\tif (camera_position[0] !== null) {\n\t\t\tcamera.alpha = (camera_position[0] * Math.PI) / 180;\n\t\t}\n\t\tif (camera_position[1] !== null) {\n\t\t\tcamera.beta = (camera_position[1] * Math.PI) / 180;\n\t\t}\n\t\tif (camera_position[2] !== null) {\n\t\t\tcamera.radius = camera_position[2];\n\t\t}\n\t\tcamera.lowerRadiusLimit = 0.1;\n\t\tconst updateCameraSensibility = (): void => {\n\t\t\tcamera.wheelPrecision = 250 / (camera.radius * zoom_speed);\n\t\t\tcamera.panningSensibility = (10000 * pan_speed) / camera.radius;\n\t\t};\n\t\tupdateCameraSensibility();\n\t\tcamera.onAfterCheckInputsObservable.add(updateCameraSensibility);\n\t}\n\n\texport function reset_camera_position(): void {\n\t\tif (viewerDetails) {\n\t\t\tviewer.resetCamera();\n\t\t}\n\t}\n</script>\n\n<canvas bind:this={canvas}></canvas>\n"],"file":"6x-3bi6p.js"}
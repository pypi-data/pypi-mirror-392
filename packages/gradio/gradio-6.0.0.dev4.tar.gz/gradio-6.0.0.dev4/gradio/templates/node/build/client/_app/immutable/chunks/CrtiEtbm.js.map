{"version":3,"file":"CrtiEtbm.js","sources":["../../../../../../../image/shared/WebcamPermissions.svelte","../../../../../../../image/shared/stream_utils.ts","../../../../../../../image/shared/Webcam.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { Webcam } from \"@gradio/icons\";\n\timport { createEventDispatcher } from \"svelte\";\n\n\tconst dispatch = createEventDispatcher<{\n\t\tclick: undefined;\n\t}>();\n</script>\n\n<button style:height=\"100%\" on:click={() => dispatch(\"click\")}>\n\t<div class=\"wrap\">\n\t\t<span class=\"icon-wrap\">\n\t\t\t<Webcam />\n\t\t</span>\n\t\t{\"Click to Access Webcam\"}\n\t</div>\n</button>\n\n<style>\n\tbutton {\n\t\tcursor: pointer;\n\t\twidth: var(--size-full);\n\t}\n\n\t.wrap {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tmin-height: var(--size-60);\n\t\tcolor: var(--block-label-text-color);\n\t\theight: 100%;\n\t\tpadding-top: var(--size-3);\n\t}\n\n\t.icon-wrap {\n\t\twidth: 30px;\n\t\tmargin-bottom: var(--spacing-lg);\n\t}\n\n\t@media (--screen-md) {\n\t\t.wrap {\n\t\t\tfont-size: var(--text-lg);\n\t\t}\n\t}\n</style>\n","export function get_devices(): Promise<MediaDeviceInfo[]> {\n\treturn navigator.mediaDevices.enumerateDevices();\n}\n\nexport function handle_error(error: string): void {\n\tthrow new Error(error);\n}\n\nexport function set_local_stream(\n\tlocal_stream: MediaStream | null,\n\tvideo_source: HTMLVideoElement\n): void {\n\tvideo_source.srcObject = local_stream;\n\tvideo_source.muted = true;\n\tvideo_source.play();\n}\n\nexport async function get_video_stream(\n\tinclude_audio: boolean,\n\tvideo_source: HTMLVideoElement,\n\twebcam_constraints: { [key: string]: any } | null,\n\tdevice_id?: string\n): Promise<MediaStream> {\n\tconst constraints: MediaStreamConstraints = {\n\t\tvideo: device_id\n\t\t\t? { deviceId: { exact: device_id }, ...webcam_constraints?.video }\n\t\t\t: webcam_constraints?.video || {\n\t\t\t\t\twidth: { ideal: 1920 },\n\t\t\t\t\theight: { ideal: 1440 }\n\t\t\t\t},\n\t\taudio: include_audio && (webcam_constraints?.audio ?? true) // Defaults to true if not specified\n\t};\n\n\treturn navigator.mediaDevices\n\t\t.getUserMedia(constraints)\n\t\t.then((local_stream: MediaStream) => {\n\t\t\tset_local_stream(local_stream, video_source);\n\t\t\treturn local_stream;\n\t\t});\n}\n\nexport function set_available_devices(\n\tdevices: MediaDeviceInfo[]\n): MediaDeviceInfo[] {\n\tconst cameras = devices.filter(\n\t\t(device: MediaDeviceInfo) => device.kind === \"videoinput\"\n\t);\n\n\treturn cameras;\n}\n","<script lang=\"ts\">\n\timport { createEventDispatcher, onDestroy, onMount } from \"svelte\";\n\timport {\n\t\tCamera,\n\t\tCircle,\n\t\tSquare,\n\t\tDropdownArrow,\n\t\tSpinner\n\t} from \"@gradio/icons\";\n\timport type { I18nFormatter } from \"@gradio/utils\";\n\timport { StreamingBar } from \"@gradio/statustracker\";\n\timport { type FileData, type Client, prepare_files } from \"@gradio/client\";\n\timport WebcamPermissions from \"./WebcamPermissions.svelte\";\n\timport { fade } from \"svelte/transition\";\n\timport {\n\t\tget_devices,\n\t\tget_video_stream,\n\t\tset_available_devices\n\t} from \"./stream_utils\";\n\timport type { Base64File } from \"./types\";\n\n\tlet video_source: HTMLVideoElement;\n\tlet available_video_devices: MediaDeviceInfo[] = [];\n\tlet selected_device: MediaDeviceInfo | null = null;\n\n\texport let stream_state: \"open\" | \"waiting\" | \"closed\" = \"closed\";\n\n\tlet canvas: HTMLCanvasElement;\n\texport let streaming = false;\n\texport let pending = false;\n\texport let root = \"\";\n\texport let stream_every = 1;\n\n\texport let mode: \"image\" | \"video\" = \"image\";\n\texport let mirror_webcam: boolean;\n\texport let include_audio: boolean;\n\texport let webcam_constraints: { [key: string]: any } | null = null;\n\texport let i18n: I18nFormatter;\n\texport let upload: Client[\"upload\"];\n\texport let value: FileData | null | Base64File = null;\n\texport let time_limit: number | null = null;\n\tconst dispatch = createEventDispatcher<{\n\t\tstream: Blob | string;\n\t\tcapture: FileData | Blob | null;\n\t\terror: string;\n\t\tstart_recording: undefined;\n\t\tstop_recording: undefined;\n\t\tclose_stream: undefined;\n\t}>();\n\n\tonMount(() => {\n\t\tcanvas = document.createElement(\"canvas\");\n\t\tif (streaming && mode === \"image\") {\n\t\t\twindow.setInterval(() => {\n\t\t\t\tif (video_source && !pending) {\n\t\t\t\t\ttake_picture();\n\t\t\t\t}\n\t\t\t}, stream_every * 1000);\n\t\t}\n\t});\n\n\tconst handle_device_change = async (event: InputEvent): Promise<void> => {\n\t\tconst target = event.target as HTMLInputElement;\n\t\tconst device_id = target.value;\n\n\t\tawait get_video_stream(\n\t\t\tinclude_audio,\n\t\t\tvideo_source,\n\t\t\twebcam_constraints,\n\t\t\tdevice_id\n\t\t).then(async (local_stream) => {\n\t\t\tstream = local_stream;\n\t\t\tselected_device =\n\t\t\t\tavailable_video_devices.find(\n\t\t\t\t\t(device) => device.deviceId === device_id\n\t\t\t\t) || null;\n\t\t\toptions_open = false;\n\t\t});\n\t};\n\n\tasync function access_webcam(): Promise<void> {\n\t\ttry {\n\t\t\tget_video_stream(include_audio, video_source, webcam_constraints)\n\t\t\t\t.then(async (local_stream) => {\n\t\t\t\t\twebcam_accessed = true;\n\t\t\t\t\tavailable_video_devices = await get_devices();\n\t\t\t\t\tstream = local_stream;\n\t\t\t\t})\n\t\t\t\t.then(() => set_available_devices(available_video_devices))\n\t\t\t\t.then((devices) => {\n\t\t\t\t\tavailable_video_devices = devices;\n\n\t\t\t\t\tconst used_devices = stream\n\t\t\t\t\t\t.getTracks()\n\t\t\t\t\t\t.map((track) => track.getSettings()?.deviceId)[0];\n\n\t\t\t\t\tselected_device = used_devices\n\t\t\t\t\t\t? devices.find((device) => device.deviceId === used_devices) ||\n\t\t\t\t\t\t\tavailable_video_devices[0]\n\t\t\t\t\t\t: available_video_devices[0];\n\t\t\t\t});\n\n\t\t\tif (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n\t\t\t\tdispatch(\"error\", i18n(\"image.no_webcam_support\"));\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (err instanceof DOMException && err.name == \"NotAllowedError\") {\n\t\t\t\tdispatch(\"error\", i18n(\"image.allow_webcam_access\"));\n\t\t\t} else {\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction take_picture(): void {\n\t\tif (\n\t\t\t(!streaming || (streaming && recording)) &&\n\t\t\tvideo_source.videoWidth &&\n\t\t\tvideo_source.videoHeight\n\t\t) {\n\t\t\tconsole.log(\"Taking picture from webcam\");\n\t\t\tvar context = canvas.getContext(\"2d\")!;\n\t\t\tcanvas.width = video_source.videoWidth;\n\t\t\tcanvas.height = video_source.videoHeight;\n\t\t\tcontext.drawImage(\n\t\t\t\tvideo_source,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tvideo_source.videoWidth,\n\t\t\t\tvideo_source.videoHeight\n\t\t\t);\n\n\t\t\tif (mirror_webcam) {\n\t\t\t\tcontext.scale(-1, 1);\n\t\t\t\tcontext.drawImage(video_source, -video_source.videoWidth, 0);\n\t\t\t}\n\n\t\t\tif (streaming && (!recording || stream_state === \"waiting\")) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (streaming) {\n\t\t\t\tconst image_data = canvas.toDataURL(\"image/jpeg\");\n\t\t\t\tdispatch(\"stream\", image_data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcanvas.toBlob(\n\t\t\t\t(blob) => {\n\t\t\t\t\tdispatch(streaming ? \"stream\" : \"capture\", blob);\n\t\t\t\t},\n\t\t\t\t`image/${streaming ? \"jpeg\" : \"png\"}`,\n\t\t\t\t0.8\n\t\t\t);\n\t\t}\n\t}\n\n\tlet recording = false;\n\tlet recorded_blobs: BlobPart[] = [];\n\tlet stream: MediaStream;\n\tlet mimeType: string;\n\tlet media_recorder: MediaRecorder;\n\n\tfunction take_recording(): void {\n\t\tif (recording) {\n\t\t\tmedia_recorder.stop();\n\t\t\tlet video_blob = new Blob(recorded_blobs, { type: mimeType });\n\t\t\tlet ReaderObj = new FileReader();\n\t\t\tReaderObj.onload = async function (e): Promise<void> {\n\t\t\t\tif (e.target) {\n\t\t\t\t\tlet _video_blob = new File(\n\t\t\t\t\t\t[video_blob],\n\t\t\t\t\t\t\"sample.\" + mimeType.substring(6)\n\t\t\t\t\t);\n\t\t\t\t\tconst val = await prepare_files([_video_blob]);\n\t\t\t\t\tlet val_ = (\n\t\t\t\t\t\t(await upload(val, root))?.filter(Boolean) as FileData[]\n\t\t\t\t\t)[0];\n\t\t\t\t\tdispatch(\"capture\", val_);\n\t\t\t\t\tdispatch(\"stop_recording\");\n\t\t\t\t}\n\t\t\t};\n\t\t\tReaderObj.readAsDataURL(video_blob);\n\t\t} else if (typeof MediaRecorder !== \"undefined\") {\n\t\t\tdispatch(\"start_recording\");\n\t\t\trecorded_blobs = [];\n\t\t\tlet validMimeTypes = [\"video/webm\", \"video/mp4\"];\n\t\t\tfor (let validMimeType of validMimeTypes) {\n\t\t\t\tif (MediaRecorder.isTypeSupported(validMimeType)) {\n\t\t\t\t\tmimeType = validMimeType;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (mimeType === null) {\n\t\t\t\tconsole.error(\"No supported MediaRecorder mimeType\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmedia_recorder = new MediaRecorder(stream, {\n\t\t\t\tmimeType: mimeType\n\t\t\t});\n\t\t\tmedia_recorder.addEventListener(\"dataavailable\", function (e) {\n\t\t\t\trecorded_blobs.push(e.data);\n\t\t\t});\n\t\t\tmedia_recorder.start(200);\n\t\t}\n\t\trecording = !recording;\n\t}\n\n\tlet webcam_accessed = false;\n\n\tfunction record_video_or_photo({\n\t\tdestroy\n\t}: { destroy?: boolean } = {}): void {\n\t\tif (mode === \"image\" && streaming) {\n\t\t\trecording = !recording;\n\t\t}\n\n\t\tif (!destroy) {\n\t\t\tif (mode === \"image\") {\n\t\t\t\ttake_picture();\n\t\t\t} else {\n\t\t\t\ttake_recording();\n\t\t\t}\n\t\t}\n\n\t\tif (!recording && stream) {\n\t\t\tdispatch(\"close_stream\");\n\t\t}\n\t}\n\n\tlet options_open = false;\n\n\texport function click_outside(node: Node, cb: any): any {\n\t\tconst handle_click = (event: MouseEvent): void => {\n\t\t\tif (\n\t\t\t\tnode &&\n\t\t\t\t!node.contains(event.target as Node) &&\n\t\t\t\t!event.defaultPrevented\n\t\t\t) {\n\t\t\t\tcb(event);\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener(\"click\", handle_click, true);\n\n\t\treturn {\n\t\t\tdestroy() {\n\t\t\t\tdocument.removeEventListener(\"click\", handle_click, true);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction handle_click_outside(event: MouseEvent): void {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\toptions_open = false;\n\t}\n\n\tonDestroy(() => {\n\t\tif (typeof window === \"undefined\") return;\n\t\trecord_video_or_photo({ destroy: true });\n\t\tstream?.getTracks().forEach((track) => track.stop());\n\t});\n</script>\n\n<div class=\"wrap\">\n\t<StreamingBar {time_limit} />\n\t<!-- svelte-ignore a11y-media-has-caption -->\n\t<!-- need to suppress for video streaming https://github.com/sveltejs/svelte/issues/5967 -->\n\t<video\n\t\tbind:this={video_source}\n\t\tclass:flip={mirror_webcam}\n\t\tclass:hide={!webcam_accessed || (webcam_accessed && !!value)}\n\t/>\n\t<!-- svelte-ignore a11y-missing-attribute -->\n\t<img\n\t\tsrc={value?.url}\n\t\tclass:hide={!webcam_accessed || (webcam_accessed && !value)}\n\t/>\n\t{#if !webcam_accessed}\n\t\t<div\n\t\t\tin:fade={{ delay: 100, duration: 200 }}\n\t\t\ttitle=\"grant webcam access\"\n\t\t\tstyle=\"height: 100%\"\n\t\t>\n\t\t\t<WebcamPermissions on:click={async () => access_webcam()} />\n\t\t</div>\n\t{:else}\n\t\t<div class=\"button-wrap\">\n\t\t\t<button\n\t\t\t\ton:click={() => record_video_or_photo()}\n\t\t\t\taria-label={mode === \"image\" ? \"capture photo\" : \"start recording\"}\n\t\t\t>\n\t\t\t\t{#if mode === \"video\" || streaming}\n\t\t\t\t\t{#if streaming && stream_state === \"waiting\"}\n\t\t\t\t\t\t<div class=\"icon-with-text\" style=\"width:var(--size-24);\">\n\t\t\t\t\t\t\t<div class=\"icon color-primary\" title=\"spinner\">\n\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{i18n(\"audio.waiting\")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else if (streaming && stream_state === \"open\") || (!streaming && recording)}\n\t\t\t\t\t\t<div class=\"icon-with-text\">\n\t\t\t\t\t\t\t<div class=\"icon color-primary\" title=\"stop recording\">\n\t\t\t\t\t\t\t\t<Square />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{i18n(\"audio.stop\")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"icon-with-text\">\n\t\t\t\t\t\t\t<div class=\"icon color-primary\" title=\"start recording\">\n\t\t\t\t\t\t\t\t<Circle />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{i18n(\"audio.record\")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"icon\" title=\"capture photo\">\n\t\t\t\t\t\t<Camera />\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</button>\n\t\t\t{#if !recording}\n\t\t\t\t<button\n\t\t\t\t\tclass=\"icon\"\n\t\t\t\t\ton:click={() => (options_open = true)}\n\t\t\t\t\taria-label=\"select input source\"\n\t\t\t\t>\n\t\t\t\t\t<DropdownArrow />\n\t\t\t\t</button>\n\t\t\t{/if}\n\t\t</div>\n\t\t{#if options_open && selected_device}\n\t\t\t<select\n\t\t\t\tclass=\"select-wrap\"\n\t\t\t\taria-label=\"select source\"\n\t\t\t\tuse:click_outside={handle_click_outside}\n\t\t\t\ton:change={handle_device_change}\n\t\t\t>\n\t\t\t\t<!-- <button\n\t\t\t\t\tclass=\"inset-icon\"\n\t\t\t\t\ton:click|stopPropagation={() => (options_open = false)}\n\t\t\t\t>\n\t\t\t\t\t<DropdownArrow />\n\t\t\t\t</button> -->\n\t\t\t\t{#if available_video_devices.length === 0}\n\t\t\t\t\t<option value=\"\">{i18n(\"common.no_devices\")}</option>\n\t\t\t\t{:else}\n\t\t\t\t\t{#each available_video_devices as device}\n\t\t\t\t\t\t<option\n\t\t\t\t\t\t\tvalue={device.deviceId}\n\t\t\t\t\t\t\tselected={selected_device.deviceId === device.deviceId}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{device.label}\n\t\t\t\t\t\t</option>\n\t\t\t\t\t{/each}\n\t\t\t\t{/if}\n\t\t\t</select>\n\t\t{/if}\n\t{/if}\n</div>\n\n<style>\n\t.wrap {\n\t\tposition: relative;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t}\n\n\t.hide {\n\t\tdisplay: none;\n\t}\n\n\tvideo {\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\tobject-fit: contain;\n\t}\n\n\t.button-wrap {\n\t\tposition: absolute;\n\t\tbackground-color: var(--block-background-fill);\n\t\tborder: 1px solid var(--border-color-primary);\n\t\tborder-radius: var(--radius-xl);\n\t\tpadding: var(--size-1-5);\n\t\tdisplay: flex;\n\t\tbottom: var(--size-2);\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, 0);\n\t\tbox-shadow: var(--shadow-drop-lg);\n\t\tborder-radius: var(--radius-xl);\n\t\tline-height: var(--size-3);\n\t\tcolor: var(--button-secondary-text-color);\n\t}\n\n\t.icon-with-text {\n\t\twidth: var(--size-20);\n\t\talign-items: center;\n\t\tmargin: 0 var(--spacing-xl);\n\t\tdisplay: flex;\n\t\tjustify-content: space-evenly;\n\t}\n\n\t@media (--screen-md) {\n\t\tbutton {\n\t\t\tbottom: var(--size-4);\n\t\t}\n\t}\n\n\t@media (--screen-xl) {\n\t\tbutton {\n\t\t\tbottom: var(--size-8);\n\t\t}\n\t}\n\n\t.icon {\n\t\twidth: 18px;\n\t\theight: 18px;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.color-primary {\n\t\tfill: var(--primary-600);\n\t\tstroke: var(--primary-600);\n\t\tcolor: var(--primary-600);\n\t}\n\n\t.flip {\n\t\ttransform: scaleX(-1);\n\t}\n\n\t.select-wrap {\n\t\t-webkit-appearance: none;\n\t\t-moz-appearance: none;\n\t\tappearance: none;\n\t\tcolor: var(--button-secondary-text-color);\n\t\tbackground-color: transparent;\n\t\twidth: 95%;\n\t\tfont-size: var(--text-md);\n\t\tposition: absolute;\n\t\tbottom: var(--size-2);\n\t\tbackground-color: var(--block-background-fill);\n\t\tbox-shadow: var(--shadow-drop-lg);\n\t\tborder-radius: var(--radius-xl);\n\t\tz-index: var(--layer-top);\n\t\tborder: 1px solid var(--border-color-primary);\n\t\ttext-align: left;\n\t\tline-height: var(--size-4);\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, 0);\n\t\tmax-width: var(--size-52);\n\t}\n\n\t.select-wrap > option {\n\t\tpadding: 0.25rem 0.5rem;\n\t\tborder-bottom: 1px solid var(--border-color-accent);\n\t\tpadding-right: var(--size-8);\n\t\ttext-overflow: ellipsis;\n\t\toverflow: hidden;\n\t}\n\n\t.select-wrap > option:hover {\n\t\tbackground-color: var(--color-accent);\n\t}\n\n\t.select-wrap > option:last-child {\n\t\tborder: none;\n\t}\n\n\t.inset-icon {\n\t\tposition: absolute;\n\t\ttop: 5px;\n\t\tright: -6.5px;\n\t\twidth: var(--size-10);\n\t\theight: var(--size-5);\n\t\topacity: 0.8;\n\t}\n\n\t@media (--screen-md) {\n\t\t.wrap {\n\t\t\tfont-size: var(--text-lg);\n\t\t}\n\t}\n</style>\n"],"names":["$.event","$.mutable_source","root","$.prop","event","$.get","$.set","$.bind_this","$.transition","$.untrack","$.each","$.template_effect","$.set_attribute"],"mappings":"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"}
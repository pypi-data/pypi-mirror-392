{"version":3,"file":"_s-5d0Ru.js","sources":["../../../../../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/FlowGraph/Blocks/Event/flowGraphMeshPickEventBlock.js"],"sourcesContent":["import { FlowGraphEventBlock } from \"../../flowGraphEventBlock.js\";\nimport { PointerEventTypes } from \"../../../Events/pointerEvents.js\";\nimport { RegisterClass } from \"../../../Misc/typeStore.js\";\nimport { _IsDescendantOf } from \"../../utils.js\";\nimport { RichTypeAny, RichTypeNumber, RichTypeVector3 } from \"../../flowGraphRichTypes.js\";\n/**\n * A block that activates when a mesh is picked.\n */\nexport class FlowGraphMeshPickEventBlock extends FlowGraphEventBlock {\n    constructor(\n    /**\n     * the configuration of the block\n     */\n    config) {\n        super(config);\n        this.config = config;\n        /**\n         * the type of the event this block reacts to\n         */\n        this.type = \"MeshPick\" /* FlowGraphEventType.MeshPick */;\n        this.asset = this.registerDataInput(\"asset\", RichTypeAny, config?.targetMesh);\n        this.pickedPoint = this.registerDataOutput(\"pickedPoint\", RichTypeVector3);\n        this.pickOrigin = this.registerDataOutput(\"pickOrigin\", RichTypeVector3);\n        this.pointerId = this.registerDataOutput(\"pointerId\", RichTypeNumber);\n        this.pickedMesh = this.registerDataOutput(\"pickedMesh\", RichTypeAny);\n        this.pointerType = this.registerDataInput(\"pointerType\", RichTypeAny, PointerEventTypes.POINTERPICK);\n    }\n    _getReferencedMesh(context) {\n        return this.asset.getValue(context);\n    }\n    _executeEvent(context, pickedInfo) {\n        // get the pointer type\n        const pointerType = this.pointerType.getValue(context);\n        if (pointerType !== pickedInfo.type) {\n            // returning true here to continue the propagation of the pointer event to the rest of the blocks\n            return true;\n        }\n        // check if the mesh is the picked mesh or a descendant\n        const mesh = this._getReferencedMesh(context);\n        if (mesh && pickedInfo.pickInfo?.pickedMesh && (pickedInfo.pickInfo?.pickedMesh === mesh || _IsDescendantOf(pickedInfo.pickInfo?.pickedMesh, mesh))) {\n            this.pointerId.setValue(pickedInfo.event.pointerId, context);\n            this.pickOrigin.setValue(pickedInfo.pickInfo.ray?.origin, context);\n            this.pickedPoint.setValue(pickedInfo.pickInfo.pickedPoint, context);\n            this.pickedMesh.setValue(pickedInfo.pickInfo.pickedMesh, context);\n            this._execute(context);\n            // stop the propagation if the configuration says so\n            return !this.config?.stopPropagation;\n        }\n        else {\n            // reset the outputs\n            this.pointerId.resetToDefaultValue(context);\n            this.pickOrigin.resetToDefaultValue(context);\n            this.pickedPoint.resetToDefaultValue(context);\n            this.pickedMesh.resetToDefaultValue(context);\n        }\n        return true;\n    }\n    /**\n     * @internal\n     */\n    _preparePendingTasks(_context) {\n        // no-op\n    }\n    /**\n     * @internal\n     */\n    _cancelPendingTasks(_context) {\n        // no-op\n    }\n    /**\n     * @returns class name of the block.\n     */\n    getClassName() {\n        return \"FlowGraphMeshPickEventBlock\" /* FlowGraphBlockNames.MeshPickEvent */;\n    }\n}\nRegisterClass(\"FlowGraphMeshPickEventBlock\" /* FlowGraphBlockNames.MeshPickEvent */, FlowGraphMeshPickEventBlock);\n//# sourceMappingURL=flowGraphMeshPickEventBlock.js.map"],"names":[],"mappings":";;;AAQO,MAAM,oCAAoC,oBAAoB;AAAA,EACjE,YAIA,QAAQ;AACJ,UAAM,MAAM;AACZ,SAAK,SAAS;AAId,SAAK,OAAO;AACZ,SAAK,QAAQ,KAAK,kBAAkB,SAAS,aAAa,QAAQ,UAAU;AAC5E,SAAK,cAAc,KAAK,mBAAmB,eAAe,eAAe;AACzE,SAAK,aAAa,KAAK,mBAAmB,cAAc,eAAe;AACvE,SAAK,YAAY,KAAK,mBAAmB,aAAa,cAAc;AACpE,SAAK,aAAa,KAAK,mBAAmB,cAAc,WAAW;AACnE,SAAK,cAAc,KAAK,kBAAkB,eAAe,aAAa,kBAAkB,WAAW;AAAA,EACvG;AAAA,EACA,mBAAmB,SAAS;AACxB,WAAO,KAAK,MAAM,SAAS,OAAO;AAAA,EACtC;AAAA,EACA,cAAc,SAAS,YAAY;AAE/B,UAAM,cAAc,KAAK,YAAY,SAAS,OAAO;AACrD,QAAI,gBAAgB,WAAW,MAAM;AAEjC,aAAO;AAAA,IACX;AAEA,UAAM,OAAO,KAAK,mBAAmB,OAAO;AAC5C,QAAI,QAAQ,WAAW,UAAU,eAAe,WAAW,UAAU,eAAe,QAAQ,gBAAgB,WAAW,UAAU,YAAY,IAAI,IAAI;AACjJ,WAAK,UAAU,SAAS,WAAW,MAAM,WAAW,OAAO;AAC3D,WAAK,WAAW,SAAS,WAAW,SAAS,KAAK,QAAQ,OAAO;AACjE,WAAK,YAAY,SAAS,WAAW,SAAS,aAAa,OAAO;AAClE,WAAK,WAAW,SAAS,WAAW,SAAS,YAAY,OAAO;AAChE,WAAK,SAAS,OAAO;AAErB,aAAO,CAAC,KAAK,QAAQ;AAAA,IACzB,OACK;AAED,WAAK,UAAU,oBAAoB,OAAO;AAC1C,WAAK,WAAW,oBAAoB,OAAO;AAC3C,WAAK,YAAY,oBAAoB,OAAO;AAC5C,WAAK,WAAW,oBAAoB,OAAO;AAAA,IAC/C;AACA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAIA,qBAAqB,UAAU;AAAA,EAE/B;AAAA;AAAA;AAAA;AAAA,EAIA,oBAAoB,UAAU;AAAA,EAE9B;AAAA;AAAA;AAAA;AAAA,EAIA,eAAe;AACX,WAAO;AAAA,EACX;AACJ;AACA,cAAc,+BAAuE,2BAA2B;","x_google_ignoreList":[0]}
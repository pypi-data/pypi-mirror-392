{"version":3,"file":"7Ax-cBsI.js","sources":["../../../../../../../gallery/Index.svelte"],"sourcesContent":["<script context=\"module\" lang=\"ts\">\n\texport { default as BaseGallery } from \"./shared/Gallery.svelte\";\n\texport { default as BaseExample } from \"./Example.svelte\";\n</script>\n\n<script lang=\"ts\">\n\timport { tick } from \"svelte\";\n\timport type { FileData } from \"@gradio/client\";\n\timport { Block, UploadText } from \"@gradio/atoms\";\n\timport Gallery from \"./shared/Gallery.svelte\";\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\timport { Gradio } from \"@gradio/utils\";\n\timport { BaseFileUpload } from \"@gradio/file\";\n\timport type { GalleryProps, GalleryEvents, GalleryData } from \"./types\";\n\n\tlet upload_promise = $state<Promise<any>>();\n\n\tclass GalleryGradio extends Gradio<GalleryEvents, GalleryProps> {\n\t\tasync get_data() {\n\t\t\tif (upload_promise) {\n\t\t\t\tawait upload_promise;\n\t\t\t\tawait tick();\n\t\t\t}\n\t\t\tconst data = await super.get_data();\n\n\t\t\treturn data;\n\t\t}\n\t}\n\n\tconst props = $props();\n\tconst gradio = new GalleryGradio<GalleryEvents, GalleryProps>(props);\n\n\tlet fullscreen = $state(false);\n\n\tlet no_value = $derived(\n\t\tgradio.props.value === null ? true : gradio.props.value.length === 0\n\t);\n\n\tfunction handle_delete(\n\t\tevent: CustomEvent<{ file: FileData; index: number }>\n\t): void {\n\t\tif (!gradio.props.value) return;\n\t\tconst { index } = event.detail;\n\t\tgradio.dispatch(\"delete\", event.detail);\n\t\tgradio.props.value = gradio.props.value.filter((_, i) => i !== index);\n\t\tgradio.dispatch(\"change\", gradio.props.value);\n\t}\n\n\tasync function process_upload_files(\n\t\tfiles: FileData[]\n\t): Promise<GalleryData[]> {\n\t\tconst processed_files = await Promise.all(\n\t\t\tfiles.map(async (x) => {\n\t\t\t\tif (x.path?.toLowerCase().endsWith(\".svg\") && x.url) {\n\t\t\t\t\tconst response = await fetch(x.url);\n\t\t\t\t\tconst svgContent = await response.text();\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...x,\n\t\t\t\t\t\turl: `data:image/svg+xml,${encodeURIComponent(svgContent)}`\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t})\n\t\t);\n\n\t\treturn processed_files.map((x) =>\n\t\t\tx.mime_type?.includes(\"video\")\n\t\t\t\t? { video: x, caption: null }\n\t\t\t\t: { image: x, caption: null }\n\t\t);\n\t}\n</script>\n\n<Block\n\tvisible={gradio.shared.visible}\n\tvariant=\"solid\"\n\tpadding={false}\n\telem_id={gradio.shared.elem_id}\n\telem_classes={gradio.shared.elem_classes}\n\tcontainer={gradio.shared.container}\n\tscale={gradio.shared.scale}\n\tmin_width={gradio.shared.min_width}\n\tallow_overflow={false}\n\theight={typeof gradio.props.height === \"number\"\n\t\t? gradio.props.height\n\t\t: undefined}\n\tbind:fullscreen\n>\n\t<StatusTracker\n\t\tautoscroll={gradio.shared.autoscroll}\n\t\ti18n={gradio.i18n}\n\t\t{...gradio.shared.loading_status}\n\t\ton:clear_status={() =>\n\t\t\tgradio.dispatch(\"clear_status\", gradio.shared.loading_status)}\n\t/>\n\t{#if gradio.shared.interactive && no_value}\n\t\t<BaseFileUpload\n\t\t\tbind:upload_promise\n\t\t\tvalue={null}\n\t\t\troot={gradio.shared.root}\n\t\t\tlabel={gradio.shared.label}\n\t\t\tmax_file_size={gradio.shared.max_file_size}\n\t\t\tfile_count={\"multiple\"}\n\t\t\tfile_types={gradio.props.file_types}\n\t\t\ti18n={gradio.i18n}\n\t\t\tupload={(...args) => gradio.shared.client.upload(...args)}\n\t\t\tstream_handler={(...args) => gradio.shared.client.stream(...args)}\n\t\t\ton:upload={async (e) => {\n\t\t\t\tconst files = Array.isArray(e.detail) ? e.detail : [e.detail];\n\t\t\t\tgradio.props.value = await process_upload_files(files);\n\t\t\t\tgradio.dispatch(\"upload\", gradio.props.value);\n\t\t\t\tgradio.dispatch(\"change\", gradio.props.value);\n\t\t\t}}\n\t\t\ton:error={({ detail }) => {\n\t\t\t\tgradio.shared.loading_status = gradio.shared.loading_status || {};\n\t\t\t\tgradio.shared.loading_status.status = \"error\";\n\t\t\t\tgradio.dispatch(\"error\", detail);\n\t\t\t}}\n\t\t>\n\t\t\t<UploadText i18n={gradio.i18n} type=\"gallery\" />\n\t\t</BaseFileUpload>\n\t{:else}\n\t\t<Gallery\n\t\t\ton:change={() => gradio.dispatch(\"change\")}\n\t\t\ton:clear={() => gradio.dispatch(\"change\")}\n\t\t\ton:select={(e) => gradio.dispatch(\"select\", e.detail)}\n\t\t\ton:share={(e) => gradio.dispatch(\"share\", e.detail)}\n\t\t\ton:error={(e) => gradio.dispatch(\"error\", e.detail)}\n\t\t\ton:preview_open={() => gradio.dispatch(\"preview_open\")}\n\t\t\ton:preview_close={() => gradio.dispatch(\"preview_close\")}\n\t\t\ton:fullscreen={({ detail }) => {\n\t\t\t\tfullscreen = detail;\n\t\t\t}}\n\t\t\ton:delete={handle_delete}\n\t\t\ton:upload={async (e) => {\n\t\t\t\tconst files = Array.isArray(e.detail) ? e.detail : [e.detail];\n\t\t\t\tconst new_value = await process_upload_files(files);\n\t\t\t\tgradio.props.value = gradio.props.value\n\t\t\t\t\t? [...gradio.props.value, ...new_value]\n\t\t\t\t\t: new_value;\n\t\t\t\tgradio.dispatch(\"upload\", new_value);\n\t\t\t\tgradio.dispatch(\"change\", gradio.props.value);\n\t\t\t}}\n\t\t\tlabel={gradio.shared.label}\n\t\t\tshow_label={gradio.shared.show_label}\n\t\t\tcolumns={gradio.props.columns}\n\t\t\trows={gradio.props.rows}\n\t\t\theight={gradio.props.height}\n\t\t\tpreview={gradio.props.preview}\n\t\t\tobject_fit={gradio.props.object_fit}\n\t\t\tinteractive={gradio.shared.interactive}\n\t\t\tallow_preview={gradio.props.allow_preview}\n\t\t\tbind:selected_index={gradio.props.selected_index}\n\t\t\tbind:value={gradio.props.value}\n\t\t\tshow_share_button={gradio.props.buttons.includes(\"share\")}\n\t\t\tshow_download_button={gradio.props.buttons.includes(\"download\")}\n\t\t\tfit_columns={gradio.props.fit_columns}\n\t\t\ti18n={gradio.i18n}\n\t\t\t_fetch={(...args) => gradio.shared.client.fetch(...args)}\n\t\t\tshow_fullscreen_button={gradio.props.buttons.includes(\"fullscreen\")}\n\t\t\t{fullscreen}\n\t\t\troot={gradio.shared.root}\n\t\t\tfile_types={gradio.props.file_types}\n\t\t\tmax_file_size={gradio.shared.max_file_size}\n\t\t\tupload={(...args) => gradio.shared.client.upload(...args)}\n\t\t\tstream_handler={(...args) => gradio.shared.client.stream(...args)}\n\t\t/>\n\t{/if}\n</Block>\n"],"names":["$.state","$.get","$.rest_props","$.derived","$0","$.set"],"mappings":"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"}
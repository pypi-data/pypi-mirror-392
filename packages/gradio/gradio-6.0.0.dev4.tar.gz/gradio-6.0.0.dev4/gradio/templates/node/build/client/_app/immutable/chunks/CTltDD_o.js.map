{"version":3,"file":"CTltDD_o.js","sources":["../../../../../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/FlowGraph/Blocks/Event/flowGraphReceiveCustomEventBlock.js"],"sourcesContent":["import { FlowGraphEventBlock } from \"../../flowGraphEventBlock.js\";\nimport { Tools } from \"../../../Misc/tools.js\";\nimport { RegisterClass } from \"../../../Misc/typeStore.js\";\nimport { FlowGraphCoordinator } from \"../../flowGraphCoordinator.js\";\n/**\n * A block that receives a custom event.\n * It saves the event data in the data outputs, based on the provided eventData in the configuration. For example, if the event data is\n * `{ x: { type: RichTypeNumber }, y: { type: RichTypeNumber } }`, the block will have two data outputs: x and y.\n */\nexport class FlowGraphReceiveCustomEventBlock extends FlowGraphEventBlock {\n    constructor(\n    /**\n     * the configuration of the block\n     */\n    config) {\n        super(config);\n        this.config = config;\n        this.initPriority = 1;\n        // use event data to register data outputs\n        for (const key in this.config.eventData) {\n            this.registerDataOutput(key, this.config.eventData[key].type);\n        }\n    }\n    _preparePendingTasks(context) {\n        const observable = context.configuration.coordinator.getCustomEventObservable(this.config.eventId);\n        // check if we are not exceeding the max number of events\n        if (observable && observable.hasObservers() && observable.observers.length > FlowGraphCoordinator.MaxEventsPerType) {\n            this._reportError(context, `FlowGraphReceiveCustomEventBlock: Too many observers for event ${this.config.eventId}. Max is ${FlowGraphCoordinator.MaxEventsPerType}.`);\n            return;\n        }\n        const eventObserver = observable.add((eventData) => {\n            const keys = Object.keys(eventData);\n            for (const key of keys) {\n                this.getDataOutput(key)?.setValue(eventData[key], context);\n            }\n            this._execute(context);\n        });\n        context._setExecutionVariable(this, \"_eventObserver\", eventObserver);\n    }\n    _cancelPendingTasks(context) {\n        const observable = context.configuration.coordinator.getCustomEventObservable(this.config.eventId);\n        if (observable) {\n            const eventObserver = context._getExecutionVariable(this, \"_eventObserver\", null);\n            observable.remove(eventObserver);\n        }\n        else {\n            Tools.Warn(`FlowGraphReceiveCustomEventBlock: Missing observable for event ${this.config.eventId}`);\n        }\n    }\n    _executeEvent(_context, _payload) {\n        return true;\n    }\n    /**\n     * @returns class name of the block.\n     */\n    getClassName() {\n        return \"FlowGraphReceiveCustomEventBlock\" /* FlowGraphBlockNames.ReceiveCustomEvent */;\n    }\n}\nRegisterClass(\"FlowGraphReceiveCustomEventBlock\" /* FlowGraphBlockNames.ReceiveCustomEvent */, FlowGraphReceiveCustomEventBlock);\n//# sourceMappingURL=flowGraphReceiveCustomEventBlock.js.map"],"names":[],"mappings":";;AASO,MAAM,yCAAyC,oBAAoB;AAAA,EACtE,YAIA,QAAQ;AACJ,UAAM,MAAM;AACZ,SAAK,SAAS;AACd,SAAK,eAAe;AAEpB,eAAW,OAAO,KAAK,OAAO,WAAW;AACrC,WAAK,mBAAmB,KAAK,KAAK,OAAO,UAAU,GAAG,EAAE,IAAI;AAAA,IAChE;AAAA,EACJ;AAAA,EACA,qBAAqB,SAAS;AAC1B,UAAM,aAAa,QAAQ,cAAc,YAAY,yBAAyB,KAAK,OAAO,OAAO;AAEjG,QAAI,cAAc,WAAW,aAAY,KAAM,WAAW,UAAU,SAAS,qBAAqB,kBAAkB;AAChH,WAAK,aAAa,SAAS,kEAAkE,KAAK,OAAO,OAAO,YAAY,qBAAqB,gBAAgB,GAAG;AACpK;AAAA,IACJ;AACA,UAAM,gBAAgB,WAAW,IAAI,CAAC,cAAc;AAChD,YAAM,OAAO,OAAO,KAAK,SAAS;AAClC,iBAAW,OAAO,MAAM;AACpB,aAAK,cAAc,GAAG,GAAG,SAAS,UAAU,GAAG,GAAG,OAAO;AAAA,MAC7D;AACA,WAAK,SAAS,OAAO;AAAA,IACzB,CAAC;AACD,YAAQ,sBAAsB,MAAM,kBAAkB,aAAa;AAAA,EACvE;AAAA,EACA,oBAAoB,SAAS;AACzB,UAAM,aAAa,QAAQ,cAAc,YAAY,yBAAyB,KAAK,OAAO,OAAO;AACjG,QAAI,YAAY;AACZ,YAAM,gBAAgB,QAAQ,sBAAsB,MAAM,kBAAkB,IAAI;AAChF,iBAAW,OAAO,aAAa;AAAA,IACnC,OACK;AACD,YAAM,KAAK,kEAAkE,KAAK,OAAO,OAAO,EAAE;AAAA,IACtG;AAAA,EACJ;AAAA,EACA,cAAc,UAAU,UAAU;AAC9B,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAIA,eAAe;AACX,WAAO;AAAA,EACX;AACJ;AACA,cAAc,oCAAiF,gCAAgC;","x_google_ignoreList":[0]}
{"version":3,"file":"BWvbigiO.js","sources":["../../../../../../../../node_modules/.pnpm/@babylonjs+loaders@8.36.1_@babylonjs+core@8.36.1_babylonjs-gltf2interface@8.36.1/node_modules/@babylonjs/loaders/glTF/2.0/glTFLoaderAnimation.js"],"sourcesContent":["import { Animation } from \"@babylonjs/core/Animations/animation.js\";\nimport { Quaternion, Vector3 } from \"@babylonjs/core/Maths/math.vector.js\";\nimport { SetInterpolationForKey } from \"./Extensions/objectModelMapping.js\";\n/** @internal */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function getVector3(_target, source, offset, scale) {\n    return Vector3.FromArray(source, offset).scaleInPlace(scale);\n}\n/** @internal */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function getQuaternion(_target, source, offset, scale) {\n    return Quaternion.FromArray(source, offset).scaleInPlace(scale);\n}\n/** @internal */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport function getWeights(target, source, offset, scale) {\n    const value = new Array(target._numMorphTargets);\n    for (let i = 0; i < value.length; i++) {\n        value[i] = source[offset++] * scale;\n    }\n    return value;\n}\n/** @internal */\nexport class AnimationPropertyInfo {\n    /** @internal */\n    constructor(type, name, getValue, getStride) {\n        this.type = type;\n        this.name = name;\n        this.getValue = getValue;\n        this.getStride = getStride;\n    }\n    _buildAnimation(name, fps, keys) {\n        const babylonAnimation = new Animation(name, this.name, fps, this.type);\n        babylonAnimation.setKeys(keys, true);\n        return babylonAnimation;\n    }\n}\n/** @internal */\nexport class TransformNodeAnimationPropertyInfo extends AnimationPropertyInfo {\n    /** @internal */\n    buildAnimations(target, name, fps, keys) {\n        const babylonAnimations = [];\n        babylonAnimations.push({ babylonAnimatable: target._babylonTransformNode, babylonAnimation: this._buildAnimation(name, fps, keys) });\n        return babylonAnimations;\n    }\n}\n/** @internal */\nexport class WeightAnimationPropertyInfo extends AnimationPropertyInfo {\n    buildAnimations(target, name, fps, keys) {\n        const babylonAnimations = [];\n        if (target._numMorphTargets) {\n            for (let targetIndex = 0; targetIndex < target._numMorphTargets; targetIndex++) {\n                const babylonAnimation = new Animation(`${name}_${targetIndex}`, this.name, fps, this.type);\n                babylonAnimation.setKeys(keys.map((key) => ({\n                    frame: key.frame,\n                    inTangent: key.inTangent ? key.inTangent[targetIndex] : undefined,\n                    value: key.value[targetIndex],\n                    outTangent: key.outTangent ? key.outTangent[targetIndex] : undefined,\n                    interpolation: key.interpolation,\n                })), true);\n                if (target._primitiveBabylonMeshes) {\n                    for (const babylonMesh of target._primitiveBabylonMeshes) {\n                        if (babylonMesh.morphTargetManager) {\n                            const morphTarget = babylonMesh.morphTargetManager.getTarget(targetIndex);\n                            const babylonAnimationClone = babylonAnimation.clone();\n                            morphTarget.animations.push(babylonAnimationClone);\n                            babylonAnimations.push({ babylonAnimatable: morphTarget, babylonAnimation: babylonAnimationClone });\n                        }\n                    }\n                }\n            }\n        }\n        return babylonAnimations;\n    }\n}\nSetInterpolationForKey(\"/nodes/{}/translation\", [new TransformNodeAnimationPropertyInfo(Animation.ANIMATIONTYPE_VECTOR3, \"position\", getVector3, () => 3)]);\nSetInterpolationForKey(\"/nodes/{}/rotation\", [new TransformNodeAnimationPropertyInfo(Animation.ANIMATIONTYPE_QUATERNION, \"rotationQuaternion\", getQuaternion, () => 4)]);\nSetInterpolationForKey(\"/nodes/{}/scale\", [new TransformNodeAnimationPropertyInfo(Animation.ANIMATIONTYPE_VECTOR3, \"scaling\", getVector3, () => 3)]);\nSetInterpolationForKey(\"/nodes/{}/weights\", [new WeightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"influence\", getWeights, (target) => target._numMorphTargets)]);\n//# sourceMappingURL=glTFLoaderAnimation.js.map"],"names":[],"mappings":";;AAKO,SAAS,WAAW,SAAS,QAAQ,QAAQ,OAAO;AACvD,SAAO,QAAQ,UAAU,QAAQ,MAAM,EAAE,aAAa,KAAK;AAC/D;AAGO,SAAS,cAAc,SAAS,QAAQ,QAAQ,OAAO;AAC1D,SAAO,WAAW,UAAU,QAAQ,MAAM,EAAE,aAAa,KAAK;AAClE;AAGO,SAAS,WAAW,QAAQ,QAAQ,QAAQ,OAAO;AACtD,QAAM,QAAQ,IAAI,MAAM,OAAO,gBAAgB;AAC/C,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACnC,UAAM,CAAC,IAAI,OAAO,QAAQ,IAAI;AAAA,EAClC;AACA,SAAO;AACX;AAEO,MAAM,sBAAsB;AAAA;AAAA,EAE/B,YAAY,MAAM,MAAM,UAAU,WAAW;AACzC,SAAK,OAAO;AACZ,SAAK,OAAO;AACZ,SAAK,WAAW;AAChB,SAAK,YAAY;AAAA,EACrB;AAAA,EACA,gBAAgB,MAAM,KAAK,MAAM;AAC7B,UAAM,mBAAmB,IAAI,UAAU,MAAM,KAAK,MAAM,KAAK,KAAK,IAAI;AACtE,qBAAiB,QAAQ,MAAM,IAAI;AACnC,WAAO;AAAA,EACX;AACJ;AAEO,MAAM,2CAA2C,sBAAsB;AAAA;AAAA,EAE1E,gBAAgB,QAAQ,MAAM,KAAK,MAAM;AACrC,UAAM,oBAAoB,CAAA;AAC1B,sBAAkB,KAAK,EAAE,mBAAmB,OAAO,uBAAuB,kBAAkB,KAAK,gBAAgB,MAAM,KAAK,IAAI,EAAC,CAAE;AACnI,WAAO;AAAA,EACX;AACJ;AAEO,MAAM,oCAAoC,sBAAsB;AAAA,EACnE,gBAAgB,QAAQ,MAAM,KAAK,MAAM;AACrC,UAAM,oBAAoB,CAAA;AAC1B,QAAI,OAAO,kBAAkB;AACzB,eAAS,cAAc,GAAG,cAAc,OAAO,kBAAkB,eAAe;AAC5E,cAAM,mBAAmB,IAAI,UAAU,GAAG,IAAI,IAAI,WAAW,IAAI,KAAK,MAAM,KAAK,KAAK,IAAI;AAC1F,yBAAiB,QAAQ,KAAK,IAAI,CAAC,SAAS;AAAA,UACxC,OAAO,IAAI;AAAA,UACX,WAAW,IAAI,YAAY,IAAI,UAAU,WAAW,IAAI;AAAA,UACxD,OAAO,IAAI,MAAM,WAAW;AAAA,UAC5B,YAAY,IAAI,aAAa,IAAI,WAAW,WAAW,IAAI;AAAA,UAC3D,eAAe,IAAI;AAAA,QACvC,EAAkB,GAAG,IAAI;AACT,YAAI,OAAO,yBAAyB;AAChC,qBAAW,eAAe,OAAO,yBAAyB;AACtD,gBAAI,YAAY,oBAAoB;AAChC,oBAAM,cAAc,YAAY,mBAAmB,UAAU,WAAW;AACxE,oBAAM,wBAAwB,iBAAiB,MAAK;AACpD,0BAAY,WAAW,KAAK,qBAAqB;AACjD,gCAAkB,KAAK,EAAE,mBAAmB,aAAa,kBAAkB,uBAAuB;AAAA,YACtG;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AACJ;AACA,uBAAuB,yBAAyB,CAAC,IAAI,mCAAmC,UAAU,uBAAuB,YAAY,YAAY,MAAM,CAAC,CAAC,CAAC;AAC1J,uBAAuB,sBAAsB,CAAC,IAAI,mCAAmC,UAAU,0BAA0B,sBAAsB,eAAe,MAAM,CAAC,CAAC,CAAC;AACvK,uBAAuB,mBAAmB,CAAC,IAAI,mCAAmC,UAAU,uBAAuB,WAAW,YAAY,MAAM,CAAC,CAAC,CAAC;AACnJ,uBAAuB,qBAAqB,CAAC,IAAI,4BAA4B,UAAU,qBAAqB,aAAa,YAAY,CAAC,WAAW,OAAO,gBAAgB,CAAC,CAAC;","x_google_ignoreList":[0]}
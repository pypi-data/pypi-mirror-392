import{x as ht,p as g,d as Se,s as ke,e as pe,a as ze,c as Ee,l as Ve,h as gt,S as ft,C as _t,m as mt,i as te,q as pt,f as vt,g as qe}from"./i18n-5O2R8uRh.js";import{p as be,ac as Fe,i as l,m as O,l as ve,d as S,a as Ge,f as Q,e as tt,aD as bt,h as le,r as oe,s as J,W as wt,j as T,t as Me,b as U,c as we,g as f,R as Be,_ as He,a8 as yt,U as re,V as q,Q as D,X as me,af as Pe,ag as xt,ah as zt,a9 as ge}from"./index-bhUlIv2p.js";import{G as Xt}from"./utils.svelte-Baqu2V3e.js";import{b as je}from"./size-DD_UOoO3.js";import{b as _e}from"./misc-BSG2QtlE.js";import{s as De}from"./select-BigU4G0v.js";import{d as Yt}from"./dispatch-kxCwF96_.js";/* empty css                                                        */import"./MarkdownCode.svelte_svelte_type_style_lang-ywXsGwHK.js";import{B as rt}from"./BlockLabel-B0lD-lMe.js";import{D as st}from"./DownloadLink-BGikjoQ1.js";import{I as Te}from"./IconButton-CbXWacxl.js";import{E as it}from"./Empty-5TrEX-tI.js";import{C as nt}from"./Clear-DimAkCP_.js";import{D as at}from"./Download-CYnkzDbq.js";import{I as Ce}from"./Image-CR2fNVDq.js";import{U as Et}from"./Undo-CfrxzS-O.js";import{I as Mt}from"./IconButtonWrapper-DsFz-pKX.js";import{F as Tt}from"./FullscreenButton-0A34tPEK.js";import{r as Dt,l as Rt,i as Je,S as Ke}from"./index-D9STzgM4.js";import{U as Qe}from"./Upload-DUNHTCuE.js";/* empty css                                             */import{B as Ze}from"./Block-CWUxteKJ.js";import{U as St}from"./UploadText-BSp3FKTS.js";/* empty css                                                   */import"./prism-python-Bb2K859D.js";import"./svelte-component-Df_c_uts.js";import"./Maximize-Dcz8xF4p.js";import"./actions-CwcOrYgf.js";import"./props-BmhlB8PY.js";import"./utils-BsTlurbm.js";import"./ImagePaste-CAS9twPF.js";import"./Upload-CzlAHTb6.js";function It(i){return i}function Ae(i,e){if(i===e||i!==i)return()=>i;const t=typeof i;if(t!==typeof e||Array.isArray(i)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(i)){const s=e.map((a,r)=>Ae(i[r],a));return a=>s.map(r=>r(a))}if(t==="object"){if(!i||!e)throw new Error("Object cannot be null");if(Je(i)&&Je(e)){const r=i.getTime(),o=e.getTime()-r;return h=>new Date(r+h*o)}const s=Object.keys(e),a={};return s.forEach(r=>{a[r]=Ae(i[r],e[r])}),r=>{const c={};return s.forEach(o=>{c[o]=a[o](r)}),c}}if(t==="number"){const s=e-i;return a=>i+a*s}return()=>e}function Pt(i,e={}){const t=ht(i);let s,a=i;function r(c,o){if(a=c,i==null)return t.set(i=c),Promise.resolve();let h=s,E=!1,{delay:X=0,duration:y=400,easing:b=It,interpolate:R=Ae}={...e,...o};if(y===0)return h&&(h.abort(),h=null),t.set(i=a),Promise.resolve();const k=Dt.now()+X;let u;return s=Rt(_=>{if(_<k)return!0;E||(u=R(i,c),typeof y=="function"&&(y=y(i,c)),E=!0),h&&(h.abort(),h=null);const w=_-k;return w>y?(t.set(i=c),!1):(t.set(i=u(b(w/y))),!0)}),s.promise}return{set:r,update:(c,o)=>r(c(a,i),o),subscribe:t.subscribe}}function Lt(i){let e;for(;e=i.sourceEvent;)i=e;return i}function et(i,e){if(i=Lt(i),e===void 0&&(e=i.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var s=t.createSVGPoint();return s.x=i.clientX,s.y=i.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[i.clientX-a.left-e.clientLeft,i.clientY-a.top-e.clientTop]}}return[i.pageX,i.pageY]}const kt={passive:!1},Re={capture:!0,passive:!1};function We(i){i.stopImmediatePropagation()}function Xe(i){i.preventDefault(),i.stopImmediatePropagation()}function Ct(i){var e=i.document.documentElement,t=De(i).on("dragstart.drag",Xe,Re);"onselectstart"in e?t.on("selectstart.drag",Xe,Re):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function $t(i,e){var t=i.document.documentElement,s=De(i).on("dragstart.drag",null);e&&(s.on("click.drag",Xe,Re),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in t?s.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Le=i=>()=>i;function Oe(i,{sourceEvent:e,subject:t,target:s,identifier:a,active:r,x:c,y:o,dx:h,dy:E,dispatch:X}){Object.defineProperties(this,{type:{value:i,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:E,enumerable:!0,configurable:!0},_:{value:X}})}Oe.prototype.on=function(){var i=this._.on.apply(this._,arguments);return i===this._?this:i};function Bt(i){return!i.ctrlKey&&!i.button}function Ut(){return this.parentNode}function Wt(i,e){return e??{x:i.x,y:i.y}}function jt(){return navigator.maxTouchPoints||"ontouchstart"in this}function At(){var i=Bt,e=Ut,t=Wt,s=jt,a={},r=Yt("start","drag","end"),c=0,o,h,E,X,y=0;function b(n){n.on("mousedown.drag",R).filter(s).on("touchstart.drag",_).on("touchmove.drag",w,kt).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function R(n,x){if(!(X||!i.call(this,n,x))){var Y=F(this,e.call(this,n,x),n,x,"mouse");Y&&(De(n.view).on("mousemove.drag",k,Re).on("mouseup.drag",u,Re),Ct(n.view),We(n),E=!1,o=n.clientX,h=n.clientY,Y("start",n))}}function k(n){if(Xe(n),!E){var x=n.clientX-o,Y=n.clientY-h;E=x*x+Y*Y>y}a.mouse("drag",n)}function u(n){De(n.view).on("mousemove.drag mouseup.drag",null),$t(n.view,E),Xe(n),a.mouse("end",n)}function _(n,x){if(i.call(this,n,x)){var Y=n.changedTouches,z=e.call(this,n,x),I=Y.length,C,$;for(C=0;C<I;++C)($=F(this,z,n,x,Y[C].identifier,Y[C]))&&(We(n),$("start",n,Y[C]))}}function w(n){var x=n.changedTouches,Y=x.length,z,I;for(z=0;z<Y;++z)(I=a[x[z].identifier])&&(Xe(n),I("drag",n,x[z]))}function M(n){var x=n.changedTouches,Y=x.length,z,I;for(X&&clearTimeout(X),X=setTimeout(function(){X=null},500),z=0;z<Y;++z)(I=a[x[z].identifier])&&(We(n),I("end",n,x[z]))}function F(n,x,Y,z,I,C){var $=r.copy(),v=et(C||Y,x),Z,H,G;if((G=t.call(n,new Oe("beforestart",{sourceEvent:Y,target:b,identifier:I,active:c,x:v[0],y:v[1],dx:0,dy:0,dispatch:$}),z))!=null)return Z=G.x-v[0]||0,H=G.y-v[1]||0,function ce(p,d,B){var se=v,K;switch(p){case"start":a[I]=ce,K=c++;break;case"end":delete a[I],--c;case"drag":v=et(B||d,x),K=c;break}$.call(p,n,new Oe(p,{sourceEvent:d,subject:G,target:b,identifier:I,active:K,x:v[0]+Z,y:v[1]+H,dx:v[0]-se[0],dy:v[1]-se[1],dispatch:$}),z)}}return b.filter=function(n){return arguments.length?(i=typeof n=="function"?n:Le(!!n),b):i},b.container=function(n){return arguments.length?(e=typeof n=="function"?n:Le(n),b):e},b.subject=function(n){return arguments.length?(t=typeof n=="function"?n:Le(n),b):t},b.touchable=function(n){return arguments.length?(s=typeof n=="function"?n:Le(!!n),b):s},b.on=function(){var n=r.on.apply(r,arguments);return n===r?b:n},b.clickDistance=function(n){return arguments.length?(y=(n=+n)*n,b):Math.sqrt(y)},b}var Ot=Q('<div class="wrap svelte-b2bl92" role="none"><div class="content svelte-b2bl92"><!></div> <div role="none"><span><span class="icon left svelte-b2bl92">◢</span><span class="icon center svelte-b2bl92"></span><span class="icon right svelte-b2bl92">◢</span></span> <div class="inner svelte-b2bl92"></div></div></div>');function lt(i,e){be(e,!1);function t(p,d,B){return Math.min(Math.max(p,d),B)}let s=g(e,"position",12,.5),a=g(e,"disabled",12,!1),r=g(e,"slider_color",12,"var(--border-color-primary)"),c=g(e,"image_size",28,()=>({top:0,left:0,width:0,height:0})),o=g(e,"el",12,void 0),h=g(e,"parent_el",12,void 0),E=O(),X=O(0),y=O(!1),b=0;function R(p){b=h()?.getBoundingClientRect().width||0,p===0&&c(c().width=o()?.getBoundingClientRect().width||0,!0),T(X,t(c().width*s()+c().left,0,b))}function k(p,d){const B=Math.pow(10,d);return Math.round((p+Number.EPSILON)*B)/B}function u(p){T(X,t(p,0,b)),s(k((p-c().left)/c().width,5))}function _(p){a()||(T(y,!0),u(p.x))}function w(p){a()||u(p.x)}function M(){a()||T(y,!1)}function F(p){T(X,t(c().width*p+c().left,0,b))}Fe(()=>{R(c().width);const p=At().on("start",_).on("drag",w).on("end",M);De(l(E)).call(p)}),ve(()=>S(c()),()=>{R(c().width)}),ve(()=>S(s()),()=>{F(s())}),Ge();var n={get position(){return s()},set position(p){s(p),f()},get disabled(){return a()},set disabled(p){a(p),f()},get slider_color(){return r()},set slider_color(p){r(p),f()},get image_size(){return c()},set image_size(p){c(p),f()},get el(){return o()},set el(p){o(p),f()},get parent_el(){return h()},set parent_el(p){h(p),f()}};Se();var x=Ot();tt("resize",bt,()=>R(c().width));var Y=le(x),z=le(Y);ke(z,e,"default",{},null),oe(Y),pe(Y,p=>o(p),()=>o());var I=J(Y,2);let C;var $=le(I);let v;var Z=J(le($));let H;wt(),oe($);var G=J($,2);let ce;return oe(I),pe(I,p=>T(E,p),()=>l(E)),oe(x),pe(x,p=>h(p),()=>h()),Me(()=>{C=ze(I,1,"outer svelte-b2bl92",null,C,{disabled:a(),grab:l(y)}),Ee(I,`transform: translateX(${l(X)??""}px)`),v=ze($,1,"icon-wrap svelte-b2bl92",null,v,{active:l(y),disabled:a()}),H=Ee(Z,"",H,{"--color":r()}),ce=Ee(G,"",ce,{"--color":r()})}),U(i,x),we(n)}var Ft=Q("<img/>");function $e(i,e){const t=Ve(e,["children","$$slots","$$events","$$legacy"]),s=Ve(t,["src","fullscreen","fixed","transform","img_el","hidden","variant","max_height"]);be(e,!1);let a=g(e,"src",12,void 0),r=g(e,"fullscreen",12,!1),c=g(e,"fixed",12,!1),o=g(e,"transform",12,"translate(0px, 0px) scale(1)"),h=g(e,"img_el",12,null),E=g(e,"hidden",12,!1),X=g(e,"variant",12,"upload"),y=g(e,"max_height",12,500);const b=Be();function R(_){if(!_)return{top:0,left:0,width:0,height:0};const w=_.parentElement?.getBoundingClientRect();if(!w)return{top:0,left:0,width:0,height:0};const M=_.naturalWidth/_.naturalHeight,F=w.width/w.height;let n,x;M>F?(n=w.width,x=w.width/M):(x=w.height,n=w.height*M);const Y=(w.width-n)/2;return{top:(w.height-x)/2,left:Y,width:n,height:x}}Fe(()=>{const _=new ResizeObserver(async w=>{for(const M of w)await He(),b("load",R(h()))});return _.observe(h()),()=>{_.disconnect()}});var k={get src(){return a()},set src(_){a(_),f()},get fullscreen(){return r()},set fullscreen(_){r(_),f()},get fixed(){return c()},set fixed(_){c(_),f()},get transform(){return o()},set transform(_){o(_),f()},get img_el(){return h()},set img_el(_){h(_),f()},get hidden(){return E()},set hidden(_){E(_),f()},get variant(){return X()},set variant(_){X(_),f()},get max_height(){return y()},set max_height(_){y(_),f()}};Se();var u=Ft();return gt(u,()=>({src:a(),...s,[_t]:{fixed:c(),hidden:E(),preview:X()==="preview",slider:X()==="upload",fullscreen:r(),small:!r()},[ft]:{transform:o(),"max-height":y()&&!r()?`${y()}px`:null}}),void 0,void 0,void 0,"svelte-j3ek2n"),pe(u,_=>h(_),()=>h()),yt(u),tt("load",u,()=>b("load",R(h()))),U(i,u),we(k)}class Gt{container;image;scale;offsetX;offsetY;isDragging;lastX;lastY;initial_left_padding;initial_top_padding;initial_width;initial_height;subscribers;handleImageLoad;real_image_size={top:0,left:0,width:0,height:0};last_touch_distance;constructor(e,t){this.container=e,this.image=t,this.scale=1,this.offsetX=0,this.offsetY=0,this.isDragging=!1,this.lastX=0,this.lastY=0,this.initial_left_padding=0,this.initial_top_padding=0,this.initial_width=0,this.initial_height=0,this.subscribers=[],this.last_touch_distance=0,this.handleWheel=this.handleWheel.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleImageLoad=this.init.bind(this),this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.image.addEventListener("load",this.handleImageLoad),this.container.addEventListener("wheel",this.handleWheel),this.container.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),this.container.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("touchend",this.handleTouchEnd),new ResizeObserver(a=>{for(const r of a)r.target===this.container&&(this.handleResize(),this.get_image_size(this.image))}).observe(this.container)}handleResize(){this.init()}init(){const e=this.container.getBoundingClientRect(),t=this.image.getBoundingClientRect();this.initial_left_padding=t.left-e.left,this.initial_top_padding=t.top-e.top,this.initial_width=t.width,this.initial_height=t.height,this.reset_zoom(),this.updateTransform()}reset_zoom(){this.scale=1,this.offsetX=0,this.offsetY=0,this.updateTransform()}handleMouseDown(e){const t=this.image.getBoundingClientRect();if(e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom){if(e.preventDefault(),this.scale===1)return;this.isDragging=!0,this.lastX=e.clientX,this.lastY=e.clientY,this.image.style.cursor="grabbing"}}handleMouseMove(e){if(!this.isDragging)return;const t=e.clientX-this.lastX,s=e.clientY-this.lastY;this.offsetX+=t,this.offsetY+=s,this.lastX=e.clientX,this.lastY=e.clientY,this.updateTransform(),this.updateTransform()}handleMouseUp(){this.isDragging&&(this.constrain_to_bounds(!0),this.updateTransform(),this.isDragging=!1,this.image.style.cursor=this.scale>1?"grab":"zoom-in")}async handleWheel(e){e.preventDefault();const t=this.container.getBoundingClientRect(),s=this.image.getBoundingClientRect();if(e.clientX<s.left||e.clientX>s.right||e.clientY<s.top||e.clientY>s.bottom)return;const a=1.05,r=this.scale,c=-Math.sign(e.deltaY)>0?Math.min(15,r*a):Math.max(1,r/a);if(c===r)return;const o=e.clientX-t.left-this.initial_left_padding,h=e.clientY-t.top-this.initial_top_padding;this.scale=c,this.offsetX=this.compute_new_offset({cursor_position:o,current_offset:this.offsetX,new_scale:c,old_scale:r}),this.offsetY=this.compute_new_offset({cursor_position:h,current_offset:this.offsetY,new_scale:c,old_scale:r}),this.updateTransform(),this.constrain_to_bounds(),this.updateTransform(),this.image.style.cursor=this.scale>1?"grab":"zoom-in"}compute_new_position({position:e,scale:t,anchor_position:s}){return e-(e-s)*(t/this.scale)}compute_new_offset({cursor_position:e,current_offset:t,new_scale:s,old_scale:a}){return e-s/a*(e-t)}constrain_to_bounds(e=!1){if(this.scale===1){this.offsetX=0,this.offsetY=0;return}const t={top:this.real_image_size.top*this.scale+this.offsetY,left:this.real_image_size.left*this.scale+this.offsetX,width:this.real_image_size.width*this.scale,height:this.real_image_size.height*this.scale,bottom:this.real_image_size.top*this.scale+this.offsetY+this.real_image_size.height*this.scale,right:this.real_image_size.left*this.scale+this.offsetX+this.real_image_size.width*this.scale},s=this.real_image_size.left+this.real_image_size.width,a=this.real_image_size.top+this.real_image_size.height;e&&(t.top>this.real_image_size.top?this.offsetY=this.calculate_position(this.real_image_size.top,0,"y"):t.bottom<a&&(this.offsetY=this.calculate_position(a,1,"y")),t.left>this.real_image_size.left?this.offsetX=this.calculate_position(this.real_image_size.left,0,"x"):t.right<s&&(this.offsetX=this.calculate_position(s,1,"x")))}updateTransform(){this.notify({x:this.offsetX,y:this.offsetY,scale:this.scale})}destroy(){this.container.removeEventListener("wheel",this.handleWheel),this.container.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.container.removeEventListener("touchstart",this.handleTouchStart),document.removeEventListener("touchmove",this.handleTouchMove),document.removeEventListener("touchend",this.handleTouchEnd),this.image.removeEventListener("load",this.handleImageLoad)}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(t=>t!==e)}notify({x:e,y:t,scale:s}){this.subscribers.forEach(a=>a({x:e,y:t,scale:s}))}handleTouchStart(e){e.preventDefault();const t=this.image.getBoundingClientRect(),s=e.touches[0];if(s.clientX>=t.left&&s.clientX<=t.right&&s.clientY>=t.top&&s.clientY<=t.bottom){if(e.touches.length===1&&this.scale>1)this.isDragging=!0,this.lastX=s.clientX,this.lastY=s.clientY;else if(e.touches.length===2){const a=e.touches[0],r=e.touches[1];this.last_touch_distance=Math.hypot(r.clientX-a.clientX,r.clientY-a.clientY)}}}get_image_size(e){if(!e)return;const t=e.parentElement?.getBoundingClientRect();if(!t)return;const s=e.naturalWidth/e.naturalHeight,a=t.width/t.height;let r,c;s>a?(r=t.width,c=t.width/s):(c=t.height,r=t.height*s);const o=(t.width-r)/2,h=(t.height-c)/2;this.real_image_size={top:h,left:o,width:r,height:c}}handleTouchMove(e){if(e.touches.length===1&&this.isDragging){e.preventDefault();const t=e.touches[0],s=t.clientX-this.lastX,a=t.clientY-this.lastY;this.offsetX+=s,this.offsetY+=a,this.lastX=t.clientX,this.lastY=t.clientY,this.updateTransform()}else if(e.touches.length===2){e.preventDefault();const t=e.touches[0],s=e.touches[1],a=Math.hypot(s.clientX-t.clientX,s.clientY-t.clientY);if(this.last_touch_distance===0){this.last_touch_distance=a;return}const r=a/this.last_touch_distance,c=this.scale,o=Math.min(15,Math.max(1,c*r));if(o===c){this.last_touch_distance=a;return}const h=this.container.getBoundingClientRect(),E=(t.clientX+s.clientX)/2-h.left-this.initial_left_padding,X=(t.clientY+s.clientY)/2-h.top-this.initial_top_padding;this.scale=o,this.offsetX=this.compute_new_offset({cursor_position:E,current_offset:this.offsetX,new_scale:o,old_scale:c}),this.offsetY=this.compute_new_offset({cursor_position:X,current_offset:this.offsetY,new_scale:o,old_scale:c}),this.updateTransform(),this.constrain_to_bounds(),this.updateTransform(),this.last_touch_distance=a,this.image.style.cursor=this.scale>1?"grab":"zoom-in"}}handleTouchEnd(e){this.isDragging&&(this.constrain_to_bounds(!0),this.updateTransform(),this.isDragging=!1),e.touches.length===0&&(this.last_touch_distance=0)}calculate_position(e,t,s){if(this.container.getBoundingClientRect(),s==="x"){const a=e,r=this.real_image_size.left+t*this.real_image_size.width;return a-r*this.scale}if(s==="y"){const a=e,r=this.real_image_size.top+t*this.real_image_size.height;return a-r*this.scale}return 0}}var Ht=Q("<!> <!> <!> <!>",1),Nt=Q("<!> <!>",1),Vt=Q('<div class="image-container svelte-1880bc6"><!> <div><!></div></div>'),qt=Q("<!> <!>",1);function Jt(i,e){be(e,!1);const t=()=>mt(C,"$transform",s),[s,a]=pt(),r=O(),c=O();let o=g(e,"value",28,()=>[null,null]),h=g(e,"label",12,void 0),E=g(e,"show_download_button",12,!0),X=g(e,"show_label",12),y=g(e,"i18n",12),b=g(e,"position",12),R=g(e,"layer_images",12,!0),k=g(e,"show_single",12,!1),u=g(e,"slider_color",12),_=g(e,"show_fullscreen_button",12,!0),w=g(e,"fullscreen",12,!1),M=g(e,"el_width",12,0),F=g(e,"max_height",12),n=g(e,"interactive",12,!0);const x=Be();let Y=O(),z=O(),I=O(),C=Pt({x:0,y:0,z:1},{duration:75}),$=O();function v(m,N,ue,P,j,A){return(m*ue+P-j)/A/N}let Z=O(0),H=O(null),G=null;function ce(m,N){!m||!N||(l(H)?.destroy(),G?.disconnect(),m?.getBoundingClientRect().width,T(Z,N?.getBoundingClientRect().width||0),T(H,new Gt(N,m)),l(H).subscribe(({x:ue,y:P,scale:j})=>{C.set({x:ue,y:P,z:j})}),G=new ResizeObserver(ue=>{for(const P of ue)P.target===N&&T(Z,P.contentRect.width),P.target===m&&P.contentRect.width}),G.observe(N),G.observe(m))}Fe(()=>()=>{l(H)?.destroy(),G?.disconnect()});let p=O(),d=O({top:0,left:0,width:0,height:0});function B(m){T(d,m.detail)}ve(()=>(S(b()),l(Z),l(d),t()),()=>{T(r,v(b(),l(Z),l(d).width,l(d).left,t().x,t().z))}),ve(()=>(S(R()),l(r)),()=>{T(c,R()?`clip-path: inset(0 0 0 ${l(r)*100}%)`:"")}),ve(()=>(l(Y),l(z)),()=>{ce(l(Y),l(z))}),Ge();var se={get value(){return o()},set value(m){o(m),f()},get label(){return h()},set label(m){h(m),f()},get show_download_button(){return E()},set show_download_button(m){E(m),f()},get show_label(){return X()},set show_label(m){X(m),f()},get i18n(){return y()},set i18n(m){y(m),f()},get position(){return b()},set position(m){b(m),f()},get layer_images(){return R()},set layer_images(m){R(m),f()},get show_single(){return k()},set show_single(m){k(m),f()},get slider_color(){return u()},set slider_color(m){u(m),f()},get show_fullscreen_button(){return _()},set show_fullscreen_button(m){_(m),f()},get fullscreen(){return w()},set fullscreen(m){w(m),f()},get el_width(){return M()},set el_width(m){M(m),f()},get max_height(){return F()},set max_height(m){F(m),f()},get interactive(){return n()},set interactive(m){n(m),f()}};Se();var K=qt(),de=re(K);{let m=q(()=>(S(h()),S(y()),D(()=>h()||y()("image.image"))));rt(de,{get show_label(){return X()},get Icon(){return Ce},get label(){return l(m)}})}var ye=J(de,2);{var xe=m=>{it(m,{unpadded_box:!0,size:"large",children:(N,ue)=>{Ce(N)},$$slots:{default:!0}})},Ie=m=>{var N=Vt(),ue=le(N);Mt(ue,{children:(W,he)=>{var L=Ht(),V=re(L);{let ee=q(()=>(S(y()),D(()=>y()("common.undo")))),fe=q(()=>(t(),D(()=>t().z===1)));Te(V,{get Icon(){return Et},get label(){return l(ee)},get disabled(){return l(fe)},$$events:{click:()=>l(H)?.reset_zoom()}})}var ie=J(V,2);{var ne=ee=>{Tt(ee,{get fullscreen(){return w()},$$events:{fullscreen(fe){_e.call(this,e,fe)}}})};te(ie,ee=>{_()&&ee(ne)})}var ae=J(ie,2);{var Ye=ee=>{{let fe=q(()=>(S(o()),D(()=>o()[1]?.url))),ut=q(()=>(S(o()),D(()=>o()[1]?.orig_name||"image")));st(ee,{get href(){return l(fe)},get download(){return l(ut)},children:(ct,or)=>{{let dt=q(()=>(S(y()),D(()=>y()("common.download"))));Te(ct,{get Icon(){return at},get label(){return l(dt)}})}},$$slots:{default:!0}})}};te(ae,ee=>{E()&&ee(Ye)})}var Ne=J(ae,2);{var ot=ee=>{Te(ee,{get Icon(){return nt},label:"Remove Image",$$events:{click:fe=>{o([null,null]),x("clear"),fe.stopPropagation()}}})};te(Ne,ee=>{n()&&ee(ot)})}U(W,L)},$$slots:{default:!0}});var P=J(ue,2);let j;var A=le(P);lt(A,{get slider_color(){return u()},get image_size(){return l(d)},get position(){return b()},set position(W){b(W)},get el(){return l(z)},set el(W){T(z,W)},get parent_el(){return l($)},set parent_el(W){T($,W)},children:(W,he)=>{var L=Nt(),V=re(L);{let ne=q(()=>(S(o()),D(()=>o()?.[0]?.url)));$e(V,{get src(){return l(ne)},alt:"",loading:"lazy",variant:"preview",get transform(){return`translate(${t(),D(()=>t().x)??""}px, ${t(),D(()=>t().y)??""}px) scale(${t(),D(()=>t().z)??""})`},get fullscreen(){return w()},get max_height(){return F()},get img_el(){return l(Y)},set img_el(ae){T(Y,ae)},$$events:{load:B},$$legacy:!0})}var ie=J(V,2);{let ne=q(()=>(S(o()),D(()=>!o()?.[1]?.url))),ae=q(()=>(S(o()),D(()=>o()?.[1]?.url)));$e(ie,{variant:"preview",get fixed(){return R()},get hidden(){return l(ne)},get src(){return l(ae)},alt:"",loading:"lazy",get style(){return`${l(c)??""}; background: var(--block-background-fill);`},get transform(){return`translate(${t(),D(()=>t().x)??""}px, ${t(),D(()=>t().y)??""}px) scale(${t(),D(()=>t().z)??""})`},get fullscreen(){return w()},get max_height(){return F()},$$events:{load:B}})}U(W,L)},$$slots:{default:!0},$$legacy:!0}),oe(P),pe(P,W=>T(p,W),()=>l(p)),oe(N),pe(N,W=>T(I,W),()=>l(I)),Me(()=>j=ze(P,1,"slider-wrap svelte-1880bc6",null,j,{limit_height:!w()})),je(P,"clientWidth",M),U(m,N)};te(ye,m=>{S(o()),S(k()),D(()=>(o()===null||o()[0]===null||o()[1]===null)&&!k())?m(xe):m(Ie,!1)})}U(i,K);var Ue=we(se);return a(),Ue}var Kt=Q('<div class="svelte-2ufkjh"><!></div>');function Qt(i,e){be(e,!1);const t=Be();Se();var s=Kt(),a=le(s);Te(a,{get Icon(){return nt},label:"Remove Image",$$events:{click:r=>{t("remove_image"),r.stopPropagation()}}}),oe(s),U(i,s),we()}var Zt=Q('<div class="icon-buttons svelte-1c8zs50"><!></div>'),er=Q("<div><!></div>"),tr=Q("<div><!></div>"),rr=Q("<div><!> <!></div>"),sr=Q('<!> <div data-testid="image" class="image-container svelte-1c8zs50"><!> <!> <!></div>',1);function ir(i,e){be(e,!1);let t=g(e,"value",12),s=g(e,"label",12,void 0),a=g(e,"show_label",12),r=g(e,"root",12),c=g(e,"position",12),o=g(e,"upload_count",12,2),h=g(e,"show_download_button",12,!0),E=g(e,"slider_color",12),X=g(e,"upload",12),y=g(e,"stream_handler",12),b=g(e,"max_file_size",12,null),R=g(e,"i18n",12),k=g(e,"max_height",12),u=g(e,"upload_promise",12,null),_=O(t()||[null,null]),w=O(),M=O(),F=O();async function n({detail:d},B){const se=[t()[0],t()[1]];d.length>1?se[B]=d[0]:se[B]=d[B],t(se),await He(),Y("upload",se)}let x=O("");const Y=Be();let z=g(e,"dragging",12,!1);ve(()=>(S(t()),l(x)),()=>{JSON.stringify(t())!==l(x)&&(T(x,JSON.stringify(t())),T(_,t()))}),ve(()=>S(z()),()=>{Y("drag",z())}),Ge();var I={get value(){return t()},set value(d){t(d),f()},get label(){return s()},set label(d){s(d),f()},get show_label(){return a()},set show_label(d){a(d),f()},get root(){return r()},set root(d){r(d),f()},get position(){return c()},set position(d){c(d),f()},get upload_count(){return o()},set upload_count(d){o(d),f()},get show_download_button(){return h()},set show_download_button(d){h(d),f()},get slider_color(){return E()},set slider_color(d){E(d),f()},get upload(){return X()},set upload(d){X(d),f()},get stream_handler(){return y()},set stream_handler(d){y(d),f()},get max_file_size(){return b()},set max_file_size(d){b(d),f()},get i18n(){return R()},set i18n(d){R(d),f()},get max_height(){return k()},set max_height(d){k(d),f()},get upload_promise(){return u()},set upload_promise(d){u(d),f()},get dragging(){return z()},set dragging(d){z(d),f()}};Se();var C=sr(),$=re(C);{let d=q(()=>(S(s()),S(R()),D(()=>s()||R()("image.image"))));rt($,{get show_label(){return a()},get Icon(){return Ce},get label(){return l(d)}})}var v=J($,2),Z=le(v);{var H=d=>{Qt(d,{$$events:{remove_image:()=>{c(.5),t([null,null]),Y("clear")}}})};te(Z,d=>{S(t()),D(()=>t()?.[0]?.url||t()?.[1]?.url)&&d(H)})}var G=J(Z,2);{var ce=d=>{var B=Zt(),se=le(B);{var K=de=>{{let ye=q(()=>(S(t()),D(()=>t()[1].orig_name||"image")));st(de,{get href(){return S(t()),D(()=>t()[1].url)},get download(){return l(ye)},children:(xe,Ie)=>{Te(xe,{get Icon(){return at}})},$$slots:{default:!0}})}};te(se,de=>{h()&&de(K)})}oe(B),U(d,B)};te(G,d=>{S(t()),D(()=>t()?.[1]?.url)&&d(ce)})}var p=J(G,2);{let d=q(()=>(S(o()),S(t()),D(()=>o()==2||!t()?.[0])));lt(p,{get disabled(){return l(d)},get slider_color(){return E()},get position(){return c()},set position(B){c(B)},children:(B,se)=>{var K=rr();let de,ye;var xe=le(K);{var Ie=P=>{var j=er();let A;var W=le(j);{let he=q(()=>(S(t()),D(()=>!!t()?.[0])));Qe(W,{filetype:"image/*",get disable_click(){return l(he)},get root(){return r()},file_count:"multiple",get upload(){return X()},get stream_handler(){return y()},get max_file_size(){return b()},get upload_promise(){return u()},set upload_promise(L){u(L)},get dragging(){return z()},set dragging(L){z(L)},$$events:{load:L=>n(L,0)},children:(L,V)=>{var ie=me(),ne=re(ie);ke(ne,e,"default",{},null),U(L,ie)},$$slots:{default:!0},$$legacy:!0})}oe(j),Me(()=>A=ze(j,1,"wrap svelte-1c8zs50",null,A,{"half-wrap":o()===1})),U(P,j)},Ue=P=>{{let j=q(()=>(l(_),D(()=>l(_)[0]?.url)));$e(P,{variant:"upload",get src(){return l(j)},alt:"",get max_height(){return k()},get img_el(){return l(w)},set img_el(A){T(w,A)},$$legacy:!0})}};te(xe,P=>{l(_),D(()=>!l(_)?.[0])?P(Ie):P(Ue,!1)})}var m=J(xe,2);{var N=P=>{{let j=q(()=>(S(t()),D(()=>!!t()?.[1])));Qe(P,{filetype:"image/*",get disable_click(){return l(j)},get root(){return r()},file_count:"multiple",get upload(){return X()},get stream_handler(){return y()},get max_file_size(){return b()},get upload_promise(){return u()},set upload_promise(A){u(A)},get dragging(){return z()},set dragging(A){z(A)},$$events:{load:A=>n(A,1)},children:(A,W)=>{var he=me(),L=re(he);ke(L,e,"default",{},null),U(A,he)},$$slots:{default:!0},$$legacy:!0})}},ue=P=>{var j=me(),A=re(j);{var W=L=>{var V=tr();let ie,ne;var ae=le(V);it(ae,{unpadded_box:!0,size:"large",children:(Ye,Ne)=>{Ce(Ye)},$$slots:{default:!0}}),oe(V),Me(()=>{ie=ze(V,1,"empty-wrap fixed svelte-1c8zs50",null,ie,{"white-icon":!t()?.[0]?.url}),ne=Ee(V,"",ne,{width:`${l(M)*(1-c())}px`,transform:`translateX(${l(M)*c()}px)`})}),U(L,V)},he=L=>{var V=me(),ie=re(V);{var ne=ae=>{{let Ye=q(()=>o()===1);$e(ae,{variant:"upload",get src(){return l(_),D(()=>l(_)[1].url)},alt:"",get fixed(){return l(Ye)},transform:"translate(0px, 0px) scale(1)",get max_height(){return k()}})}};te(ie,ae=>{l(_),D(()=>l(_)?.[1])&&ae(ne)},!0)}U(L,V)};te(A,L=>{l(_),S(o()),D(()=>!l(_)?.[1]&&o()===1)?L(W):L(he,!1)},!0)}U(P,j)};te(m,P=>{l(_),S(o()),D(()=>!l(_)?.[1]&&o()===2)?P(N):P(ue,!1)})}oe(K),Me(()=>{de=ze(K,1,"upload-wrap svelte-1c8zs50",null,de,{"side-by-side":o()===2}),ye=Ee(K,"",ye,{display:o()===2?"flex":"block"})}),U(B,K)},$$slots:{default:!0},$$legacy:!0})}return oe(v),je(v,"clientWidth",d=>T(M,d)),je(v,"clientHeight",d=>T(F,d)),U(i,C),we(I)}function nr(i,e){be(e,!1);let t=g(e,"value",28,()=>[null,null]),s=g(e,"upload",12),a=g(e,"stream_handler",12),r=g(e,"label",12),c=g(e,"show_label",12),o=g(e,"i18n",12),h=g(e,"root",12),E=g(e,"upload_count",12,1),X=g(e,"dragging",12),y=g(e,"max_height",12),b=g(e,"max_file_size",12,null),R=g(e,"upload_promise",12,null);var k={get value(){return t()},set value(u){t(u),f()},get upload(){return s()},set upload(u){s(u),f()},get stream_handler(){return a()},set stream_handler(u){a(u),f()},get label(){return r()},set label(u){r(u),f()},get show_label(){return c()},set show_label(u){c(u),f()},get i18n(){return o()},set i18n(u){o(u),f()},get root(){return h()},set root(u){h(u),f()},get upload_count(){return E()},set upload_count(u){E(u),f()},get dragging(){return X()},set dragging(u){X(u),f()},get max_height(){return y()},set max_height(u){y(u),f()},get max_file_size(){return b()},set max_file_size(u){b(u),f()},get upload_promise(){return R()},set upload_promise(u){R(u),f()}};return ir(i,{slider_color:"var(--border-color-primary)",position:.5,get root(){return h()},get label(){return r()},get show_label(){return c()},get upload_count(){return E()},get stream_handler(){return a()},get upload(){return s()},get max_file_size(){return b()},get max_height(){return y()},get i18n(){return o()},get upload_promise(){return R()},set upload_promise(u){R(u)},get value(){return t()},set value(u){t(u)},get dragging(){return X()},set dragging(u){X(u)},$$events:{edit(u){_e.call(this,e,u)},clear(u){_e.call(this,e,u)},stream(u){_e.call(this,e,u)},drag:({detail:u})=>X(u),upload(u){_e.call(this,e,u)},select(u){_e.call(this,e,u)},share(u){_e.call(this,e,u)}},children:(u,_)=>{var w=me(),M=re(w);ke(M,e,"default",{},null),U(u,w)},$$slots:{default:!0},$$legacy:!0}),we(k)}var ar=Q("<!> <!>",1),lr=Q("<!> <!>",1);function Ar(i,e){be(e,!0);let t=Pe(void 0);class s extends Xt{async get_data(){return l(t)&&(await l(t),await He()),await super.get_data()}}const a=vt(e,["$$slots","$$events","$$legacy"]),r=new s(a);let c=Pe(xt(r.props.value)),o=Pe(!1),h=Pe(!1),E,X=ge(()=>Math.max(0,Math.min(100,r.props.slider_position))/100);zt(()=>{l(c)!=r.props.value&&(T(c,r.props.value,!0),r.dispatch("change"),r.dispatch("input"))});const y=w=>{const M=w;M.preventDefault(),M.stopPropagation(),M.type==="dragenter"||M.type==="dragover"?T(h,!0):M.type==="dragleave"&&T(h,!1)},b=w=>{if(r.shared.interactive){const M=w;M.preventDefault(),M.stopPropagation(),T(h,!1),E&&E.loadFilesFromDrop(M)}};var R=me(),k=re(R);{var u=w=>{{let M=ge(()=>l(h)?"focus":"base"),F=ge(()=>r.props.height||void 0);Ze(w,{get visible(){return r.shared.visible},variant:"solid",get border_mode(){return l(M)},padding:!1,get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get height(){return l(F)},get width(){return r.props.width},allow_overflow:!1,get container(){return r.shared.container},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},get fullscreen(){return l(o)},set fullscreen(n){T(o,n,!0)},children:(n,x)=>{var Y=ar(),z=re(Y);Ke(z,qe({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status));var I=J(z,2);{let C=ge(()=>r.props.buttons.includes("download")),$=ge(()=>r.props.buttons.includes("fullscreen"));Jt(I,{get fullscreen(){return l(o)},get interactive(){return r.shared.interactive},get label(){return r.shared.label},get show_label(){return r.shared.show_label},get show_download_button(){return l(C)},get i18n(){return r.i18n},get show_fullscreen_button(){return l($)},get position(){return l(X)},get slider_color(){return r.props.slider_color},get max_height(){return r.props.max_height},get value(){return r.props.value},set value(v){r.props.value=v},$$events:{select:({detail:v})=>r.dispatch("select",v),share:({detail:v})=>r.dispatch("share",v),error:({detail:v})=>r.dispatch("error",v),clear:()=>r.dispatch("clear"),fullscreen:({detail:v})=>{T(o,v,!0)}}})}U(n,Y)},$$slots:{default:!0}})}},_=w=>{{let M=ge(()=>r.props.value===null?"dashed":"solid"),F=ge(()=>l(h)?"focus":"base"),n=ge(()=>r.props.height||void 0);Ze(w,{get visible(){return r.shared.visible},get variant(){return l(M)},get border_mode(){return l(F)},padding:!1,get elem_id(){return r.shared.elem_id},get elem_classes(){return r.shared.elem_classes},get height(){return l(n)},get width(){return r.props.width},allow_overflow:!1,get container(){return r.shared.container},get scale(){return r.shared.scale},get min_width(){return r.shared.min_width},$$events:{dragenter:y,dragleave:y,dragover:y,drop:b},children:(x,Y)=>{var z=lr(),I=re(z);Ke(I,qe({get autoscroll(){return r.shared.autoscroll},get i18n(){return r.i18n}},()=>r.shared.loading_status,{$$events:{clear_status:()=>r.dispatch("clear_status",r.shared.loading_status)}}));var C=J(I,2);{let $=ge(()=>r.shared.client?.stream);pe(nr(C,{get root(){return r.shared.root},get label(){return r.shared.label},get show_label(){return r.shared.show_label},get upload_count(){return r.props.upload_count},get max_file_size(){return r.shared.max_file_size},get i18n(){return r.i18n},upload:(...v)=>r.shared.client.upload(...v),get stream_handler(){return l($)},get max_height(){return r.props.max_height},get upload_promise(){return l(t)},set upload_promise(v){T(t,v,!0)},get value(){return r.props.value},set value(v){r.props.value=v},get dragging(){return l(h)},set dragging(v){T(h,v,!0)},$$events:{edit:()=>r.dispatch("edit"),clear:()=>{r.dispatch("clear")},drag:({detail:v})=>T(h,v,!0),upload:()=>r.dispatch("upload"),error:({detail:v})=>{r.shared.loading_status&&(r.shared.loading_status.status="error"),r.dispatch("error",v)},close_stream:()=>{r.dispatch("close_stream","stream")}},children:(v,Z)=>{var H=me(),G=re(H);{var ce=p=>{St(p,{get i18n(){return r.i18n},type:"image",get placeholder(){return r.props.placeholder}})};te(G,p=>{p(ce)})}U(v,H)},$$slots:{default:!0}}),v=>E=v,()=>E)}U(x,z)},$$slots:{default:!0}})}};te(k,w=>{!r.shared.interactive||r.props.value?.[1]&&r.props.value?.[0]?w(u):w(_,!1)})}U(i,R),we()}export{Ar as default};
//# sourceMappingURL=Index-B1dKPtEx.js.map

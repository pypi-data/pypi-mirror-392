{"version":3,"file":"Index-D5y-88Kl.js","sources":["../../../../js/uploadbutton/shared/UploadButton.svelte","../../../../js/uploadbutton/Index.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { tick, createEventDispatcher } from \"svelte\";\n\timport { BaseButton } from \"@gradio/button\";\n\timport { prepare_files, type FileData, type Client } from \"@gradio/client\";\n\n\texport let elem_id = \"\";\n\texport let elem_classes: string[] = [];\n\texport let visible: boolean | \"hidden\" = true;\n\texport let label: string | null;\n\texport let value: null | FileData | FileData[];\n\texport let file_count: string;\n\texport let file_types: string[] = [];\n\texport let root: string;\n\texport let size: \"sm\" | \"md\" | \"lg\" = \"lg\";\n\texport let icon: FileData | null = null;\n\texport let scale: number | null = null;\n\texport let min_width: number | undefined = undefined;\n\texport let variant: \"primary\" | \"secondary\" | \"stop\" = \"secondary\";\n\texport let disabled = false;\n\texport let max_file_size: number | null = null;\n\texport let upload: Client[\"upload\"];\n\n\tconst dispatch = createEventDispatcher();\n\n\tlet hidden_upload: HTMLInputElement;\n\tlet accept_file_types: string | null;\n\n\tif (file_types == null) {\n\t\taccept_file_types = null;\n\t} else {\n\t\tfile_types = file_types.map((x) => {\n\t\t\tif (x.startsWith(\".\")) {\n\t\t\t\treturn x;\n\t\t\t}\n\t\t\treturn x + \"/*\";\n\t\t});\n\t\taccept_file_types = file_types.join(\", \");\n\t}\n\n\tfunction open_file_upload(): void {\n\t\tdispatch(\"click\");\n\t\thidden_upload.click();\n\t}\n\n\tasync function load_files(files: FileList): Promise<void> {\n\t\tlet _files: File[] = Array.from(files);\n\n\t\tif (!files.length) {\n\t\t\treturn;\n\t\t}\n\t\tif (file_count === \"single\") {\n\t\t\t_files = [files[0]];\n\t\t}\n\t\tlet all_file_data = await prepare_files(_files);\n\t\tawait tick();\n\n\t\ttry {\n\t\t\tall_file_data = (\n\t\t\t\tawait upload(all_file_data, root, undefined, max_file_size ?? Infinity)\n\t\t\t)?.filter((x) => x !== null) as FileData[];\n\t\t} catch (e) {\n\t\t\tdispatch(\"error\", (e as Error).message);\n\t\t\treturn;\n\t\t}\n\t\tvalue = file_count === \"single\" ? all_file_data?.[0] : all_file_data;\n\t\tdispatch(\"change\", value);\n\t\tdispatch(\"upload\", value);\n\t}\n\n\tasync function load_files_from_upload(e: Event): Promise<void> {\n\t\tconst target = e.target as HTMLInputElement;\n\n\t\tif (!target.files) return;\n\t\tawait load_files(target.files);\n\t}\n\n\tfunction clear_input_value(e: Event): void {\n\t\tconst target = e.target as HTMLInputElement;\n\t\tif (target.value) target.value = \"\";\n\t}\n</script>\n\n<input\n\tclass=\"hide\"\n\taccept={accept_file_types}\n\ttype=\"file\"\n\tbind:this={hidden_upload}\n\ton:change={load_files_from_upload}\n\ton:click={clear_input_value}\n\tmultiple={file_count === \"multiple\" || undefined}\n\twebkitdirectory={file_count === \"directory\" || undefined}\n\tmozdirectory={file_count === \"directory\" || undefined}\n\tdata-testid=\"{label}-upload-button\"\n/>\n\n<BaseButton\n\t{size}\n\t{variant}\n\t{elem_id}\n\t{elem_classes}\n\t{visible}\n\ton:click={open_file_upload}\n\t{scale}\n\t{min_width}\n\t{disabled}\n>\n\t{#if icon}\n\t\t<img class=\"button-icon\" src={icon.url} alt={`${value} icon`} />\n\t{/if}\n\t<slot />\n</BaseButton>\n\n<style>\n\t.hide {\n\t\tdisplay: none;\n\t}\n\t.button-icon {\n\t\twidth: var(--text-xl);\n\t\theight: var(--text-xl);\n\t\tmargin-right: var(--spacing-xl);\n\t}\n</style>\n","<script lang=\"ts\" context=\"module\">\n\texport { default as BaseUploadButton } from \"./shared/UploadButton.svelte\";\n</script>\n\n<script lang=\"ts\">\n\timport type { UploadButtonProps, UploadButtonEvents } from \"./types\";\n\timport type { FileData } from \"@gradio/client\";\n\timport { Gradio } from \"@gradio/utils\";\n\timport UploadButton from \"./shared/UploadButton.svelte\";\n\n\tconst props = $props();\n\tconst gradio = new Gradio<UploadButtonEvents, UploadButtonProps>(props);\n\n\tlet value = $state(gradio.props.value);\n\n\t$effect(() => {\n\t\tif (value !== gradio.props.value) {\n\t\t\tgradio.props.value = value;\n\t\t}\n\t});\n\n\tasync function handle_event(\n\t\tdetail: null | FileData | FileData[],\n\t\tevent: \"change\" | \"upload\" | \"click\"\n\t): Promise<void> {\n\t\tgradio.props.value = detail;\n\t\tgradio.dispatch(event);\n\t}\n\n\tconst disabled = $derived(!gradio.shared.interactive);\n</script>\n\n<UploadButton\n\telem_id={gradio.shared.elem_id}\n\telem_classes={gradio.shared.elem_classes}\n\tvisible={gradio.shared.visible}\n\tfile_count={gradio.props.file_count}\n\tfile_types={gradio.props.file_types}\n\tsize={gradio.props.size}\n\tscale={gradio.shared.scale}\n\ticon={gradio.props.icon}\n\tmin_width={gradio.shared.min_width}\n\troot={gradio.shared.root}\n\t{value}\n\t{disabled}\n\tvariant={gradio.props.variant}\n\tlabel={gradio.shared.label}\n\tmax_file_size={gradio.shared.max_file_size}\n\ton:click={() => gradio.dispatch(\"click\")}\n\ton:change={({ detail }) => handle_event(detail, \"change\")}\n\ton:upload={({ detail }) => handle_event(detail, \"upload\")}\n\ton:error={({ detail }) => {\n\t\tgradio.dispatch(\"error\", detail);\n\t}}\n\tupload={(...args) => gradio.shared.client.upload(...args)}\n>\n\t{gradio.shared.label ?? \"\"}\n</UploadButton>\n"],"names":["elem_id","elem_classes","$.prop","$$props","visible","label","value","file_count","file_types","root","size","icon","scale","min_width","variant","disabled","max_file_size","upload","dispatch","createEventDispatcher","hidden_upload","$.mutable_source","accept_file_types","$.set","x","$.get","files","_files","all_file_data","prepare_files","tick","e","load_files_from_upload","target","load_files","clear_input_value","$.bind_this","input","$$value","$.untrack","props","$.rest_props","gradio","Gradio","$.proxy","$.user_effect","handle_event","detail","event"],"mappings":"02BAAA,SAOY,IAAAA,mBAA8B,EAAA,EAC9BC,EAAoBC,EAAAC,EAAA,eAAA,GAAA,IAAA,EAAA,EACpBC,mBAAmC,EAAA,EACnCC,EAAkBH,EAAAC,EAAA,QAAA,EAAA,EAClBG,EAAyBJ,EAAAC,EAAA,QAAA,EAAA,EACzBI,EAAYL,EAAAC,EAAA,aAAA,EAAA,EACZK,EAA+BN,EAAAC,EAAA,aAAA,GAAA,IAAA,EAAA,EAC/BM,EAA4BP,EAAAC,EAAA,OAAA,EAAA,EAC5BO,gBAA2B,IAAA,EAC3BC,gBAAyC,IAAA,EACzCC,iBAAuD,IAAA,EACvDC,qBAAgB,MAAA,EAChBC,mBAAmC,WAAA,EACnCC,oBAAwB,EAAA,EAE7BC,yBAAkC,IAAA,EAEpCC,EAA+Bf,EAAAC,EAAA,SAAA,EAAA,EAG/B,MAAAe,EAAcC,GAAM,MAExBC,EAAAC,EAAA,EAAOC,EAAAD,EAAA,EAELb,EAAM,GAAA,KACLe,EAAAD,EAAQ,IAAA,KAEFd,EAAQ,EAAA,IAAAgB,GACdA,EAAA,WAAA,GAAA,EACFA,EAGQA,EAAA,aAEa,EAAA,KAAA,IAAA,CAAA,eAIM,CAE3BN,EAAK,OAAM,EACVO,EAAAL,CAAA,EAAA,MAAA,CACD,kBAEoBM,EAAA,CACpB,IAAAC,EAAA,MAAA,KAAAD,CAAA,MAEAA,gBAMAnB,EAAA,IAAA,WAAEoB,EAAA,CAAQD,EAAE,CAAA,CAAA,OAEXE,EAAA,MAAAC,GAAAF,CAAA,QACDG,GAAA,EAEA,GAAA,CACAF,SACDX,EAAA,EAAAW,EAAAnB,EAAA,EAAA,OAAAO,EAAA,GAAA,GAAA,IAEK,OAAAQ,GAAUA,IAAA,IAAA,CACd,OAAMO,EAAA,GAED,QAAYA,EAAA,OAAA,QACjB,CACDzB,EAAAC,EAAA,IAAA,SAAAqB,IAAA,CAAA,EAAAA,CAAA,EAEAV,EAAS,SAAAZ,GAAiB,EACzBY,EAAM,SAAWZ,GAAA,EAElB,eAAA0B,EAAA,EAAA,OACOC,EAAA,EAAA,OAEPA,EAAA,aACOC,EAAID,EAAA,KAAA,CACX,CAES,SAAAE,EAAe,EAAA,OACrBF,EAAQ,EAAA,OACRA,EAAO,QAAAA,EAAA,MAAiB,GAC3B,u1BAOKG,EAAAC,EAAAC,GAAAf,EAAAH,WAAAA,CAAA,CAAA,gVAhFMT,EAAA,CAAA,EAAA4B,GAAA,iLAmFVhC,EAAY,IAAA,YAAA,yBACLA,EAAA,IAAA,aAAA,0BACEA,EAAA,IAAgB,aAAA,MAAA,uBACpBF,KAAA,EAAA,gBAAA,iBALE2B,CAAA,cACAG,CAAA,aART,iBC1FA,eAiBGK,EAAAC,GAAAtC,EAAA,CAAA,UAAA,WAAA,UAAA,CAAA,EACDuC,EAAA,IAAAC,GAAAH,CAAA,EAGI,IAAAlC,EAAAsC,GAAUF,EAAY,MAC1B,KACA,EAGAG,GAAA,IAAO,CACRvC,IAAAoC,EAAA,MAAA,QAEAA,EAAM,MAAQ,MAAGpC,oBAIFwC,MAEe,eAEXC,aACNC,CAAM,CACnB,iBAEyBN,EAAS,OAAA,WAAA,6BAIzBA,EAAO,OAAM,mCACRA,EAAO,OAAK,4CACJ,iCACVA,QAAW,oCACXA,EAAE,MAAW,8BACtBA,EAAU,MAAC,yBACXA,EAAU,OAAQ,yBACpBA,EAAO,mCACPA,EAAA,OAAA,6BACKA,EAAM,OAAQ,6EAGnBA,EAAY,MAAA,yYAfd"}
{"version":3,"file":"flowGraphSetPropertyBlock-8b2u8jap.js","sources":["../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetPropertyBlock.js"],"sourcesContent":["import { FlowGraphExecutionBlockWithOutSignal } from \"../../flowGraphExecutionBlockWithOutSignal.js\";\nimport { RichTypeAny } from \"../../flowGraphRichTypes.js\";\nimport { RegisterClass } from \"../../../Misc/typeStore.js\";\n/**\n * This block will set a property on a given target asset.\n * The property name can include dots (\".\"), which will be interpreted as a path to the property.\n * The target asset is an input and can be changed at any time.\n * The value of the property is an input and can be changed at any time.\n *\n * For example, with an input of a mesh asset, the property name \"position.x\" will set the x component of the position of the mesh.\n *\n * Note that it is recommended to input the object on which you are working on (i.e. a material) than providing a mesh and then getting the material from it.\n */\nexport class FlowGraphSetPropertyBlock extends FlowGraphExecutionBlockWithOutSignal {\n    constructor(\n    /**\n     * the configuration of the block\n     */\n    config) {\n        super(config);\n        this.config = config;\n        this.object = this.registerDataInput(\"object\", RichTypeAny, config.target);\n        this.value = this.registerDataInput(\"value\", RichTypeAny);\n        this.propertyName = this.registerDataInput(\"propertyName\", RichTypeAny, config.propertyName);\n        this.customSetFunction = this.registerDataInput(\"customSetFunction\", RichTypeAny);\n    }\n    _execute(context, _callingSignal) {\n        try {\n            const target = this.object.getValue(context);\n            const value = this.value.getValue(context);\n            const propertyName = this.propertyName.getValue(context);\n            this._stopRunningAnimations(context, target, propertyName);\n            const setFunction = this.customSetFunction.getValue(context);\n            if (setFunction) {\n                setFunction(target, propertyName, value, context);\n            }\n            else {\n                this._setPropertyValue(target, propertyName, value);\n            }\n        }\n        catch (e) {\n            this._reportError(context, e);\n        }\n        this.out._activateSignal(context);\n    }\n    _stopRunningAnimations(context, target, propertyName) {\n        const currentlyRunningAnimationGroups = context._getGlobalContextVariable(\"currentlyRunningAnimationGroups\", []);\n        for (const uniqueId of currentlyRunningAnimationGroups) {\n            const animationGroup = context.assetsContext.animationGroups.find((animationGroup) => animationGroup.uniqueId === uniqueId);\n            if (animationGroup) {\n                for (const targetedAnimations of animationGroup.targetedAnimations) {\n                    if (targetedAnimations.target === target && targetedAnimations.animation.targetProperty === propertyName) {\n                        animationGroup.stop(true);\n                        animationGroup.dispose();\n                        const index = currentlyRunningAnimationGroups.indexOf(uniqueId);\n                        if (index !== -1) {\n                            currentlyRunningAnimationGroups.splice(index, 1);\n                            context._setGlobalContextVariable(\"currentlyRunningAnimationGroups\", currentlyRunningAnimationGroups);\n                        }\n                    }\n                }\n            }\n        }\n    }\n    _setPropertyValue(target, propertyName, value) {\n        const path = propertyName.split(\".\");\n        let obj = target;\n        for (let i = 0; i < path.length - 1; i++) {\n            const prop = path[i];\n            if (obj[prop] === undefined) {\n                obj[prop] = {};\n            }\n            obj = obj[prop];\n        }\n        obj[path[path.length - 1]] = value;\n    }\n    getClassName() {\n        return \"FlowGraphSetPropertyBlock\" /* FlowGraphBlockNames.SetProperty */;\n    }\n}\nRegisterClass(\"FlowGraphSetPropertyBlock\" /* FlowGraphBlockNames.SetProperty */, FlowGraphSetPropertyBlock);\n//# sourceMappingURL=flowGraphSetPropertyBlock.js.map"],"names":["FlowGraphSetPropertyBlock","FlowGraphExecutionBlockWithOutSignal","config","RichTypeAny","context","_callingSignal","target","value","propertyName","setFunction","e","currentlyRunningAnimationGroups","uniqueId","animationGroup","targetedAnimations","index","path","obj","i","prop","RegisterClass"],"mappings":"qNAaO,MAAMA,UAAkCC,CAAqC,CAChF,YAIAC,EAAQ,CACJ,MAAMA,CAAM,EACZ,KAAK,OAASA,EACd,KAAK,OAAS,KAAK,kBAAkB,SAAUC,EAAaD,EAAO,MAAM,EACzE,KAAK,MAAQ,KAAK,kBAAkB,QAASC,CAAW,EACxD,KAAK,aAAe,KAAK,kBAAkB,eAAgBA,EAAaD,EAAO,YAAY,EAC3F,KAAK,kBAAoB,KAAK,kBAAkB,oBAAqBC,CAAW,CACpF,CACA,SAASC,EAASC,EAAgB,CAC9B,GAAI,CACA,MAAMC,EAAS,KAAK,OAAO,SAASF,CAAO,EACrCG,EAAQ,KAAK,MAAM,SAASH,CAAO,EACnCI,EAAe,KAAK,aAAa,SAASJ,CAAO,EACvD,KAAK,uBAAuBA,EAASE,EAAQE,CAAY,EACzD,MAAMC,EAAc,KAAK,kBAAkB,SAASL,CAAO,EACvDK,EACAA,EAAYH,EAAQE,EAAcD,EAAOH,CAAO,EAGhD,KAAK,kBAAkBE,EAAQE,EAAcD,CAAK,CAE1D,OACOG,EAAG,CACN,KAAK,aAAaN,EAASM,CAAC,CAChC,CACA,KAAK,IAAI,gBAAgBN,CAAO,CACpC,CACA,uBAAuBA,EAASE,EAAQE,EAAc,CAClD,MAAMG,EAAkCP,EAAQ,0BAA0B,kCAAmC,CAAA,CAAE,EAC/G,UAAWQ,KAAYD,EAAiC,CACpD,MAAME,EAAiBT,EAAQ,cAAc,gBAAgB,KAAMS,GAAmBA,EAAe,WAAaD,CAAQ,EAC1H,GAAIC,GACA,UAAWC,KAAsBD,EAAe,mBAC5C,GAAIC,EAAmB,SAAWR,GAAUQ,EAAmB,UAAU,iBAAmBN,EAAc,CACtGK,EAAe,KAAK,EAAI,EACxBA,EAAe,QAAO,EACtB,MAAME,EAAQJ,EAAgC,QAAQC,CAAQ,EAC1DG,IAAU,KACVJ,EAAgC,OAAOI,EAAO,CAAC,EAC/CX,EAAQ,0BAA0B,kCAAmCO,CAA+B,EAE5G,EAGZ,CACJ,CACA,kBAAkBL,EAAQE,EAAcD,EAAO,CAC3C,MAAMS,EAAOR,EAAa,MAAM,GAAG,EACnC,IAAIS,EAAMX,EACV,QAASY,EAAI,EAAGA,EAAIF,EAAK,OAAS,EAAGE,IAAK,CACtC,MAAMC,EAAOH,EAAKE,CAAC,EACfD,EAAIE,CAAI,IAAM,SACdF,EAAIE,CAAI,EAAI,CAAA,GAEhBF,EAAMA,EAAIE,CAAI,CAClB,CACAF,EAAID,EAAKA,EAAK,OAAS,CAAC,CAAC,EAAIT,CACjC,CACA,cAAe,CACX,MAAO,2BACX,CACJ,CACAa,EAAc,4BAAmEpB,CAAyB","x_google_ignoreList":[0]}
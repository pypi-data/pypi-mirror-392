import{p as o,d as bt,i as w,t as $e,a as ue,b as et,u as tt,e as Ve,c as Ie}from"./i18n-5O2R8uRh.js";import{p as wt,R as yt,m as y,ac as zt,l as R,d as h,i as e,a as xt,f as U,U as ce,b as I,c as kt,g as i,s as j,j as p,Q as d,V as T,h as D,r as E,t as re,e as _e,k as lt,_ as It,az as jt,X as Et}from"./index-bhUlIv2p.js";import{b as Lt}from"./window-BwbneT0F.js";import{s as Pt}from"./event-modifiers-CdEA5IGF.js";import{b as Xe}from"./misc-BSG2QtlE.js";/* empty css                                                        */import"./MarkdownCode.svelte_svelte_type_style_lang-ywXsGwHK.js";import{B as Ut}from"./BlockLabel-B0lD-lMe.js";import{I as qe}from"./IconButton-CbXWacxl.js";import{E as Mt}from"./Empty-5TrEX-tI.js";import{S as Bt}from"./ShareButton-2E8myMWE.js";import{C as rt}from"./Clear-DimAkCP_.js";import{D as Rt}from"./Download-CYnkzDbq.js";import{I as at}from"./Image-CR2fNVDq.js";import{P as nt}from"./Play-a1iOyiRM.js";import{U as Dt}from"./Upload-CzlAHTb6.js";import{I as Tt}from"./IconButtonWrapper-DsFz-pKX.js";import{F as Ct}from"./FullscreenButton-0A34tPEK.js";import{U as At}from"./Upload-DUNHTCuE.js";import{M as Wt}from"./ModifyUpload-BwV9897O.js";/* empty css                                             */import{I as Ge}from"./Image-CfdJwp5Q.js";/* empty css                                                   */import{V as He}from"./Video-Bk_QzOHi.js";import{d as Ft}from"./index-tFQomdd2.js";import{u as St}from"./utils.svelte-Baqu2V3e.js";import"./prism-python-Bb2K859D.js";import"./svelte-component-Df_c_uts.js";import"./Community-DDp4fj5H.js";import"./Maximize-Dcz8xF4p.js";import"./actions-CwcOrYgf.js";import"./props-BmhlB8PY.js";import"./utils-BsTlurbm.js";import"./DownloadLink-BGikjoQ1.js";import"./Edit-Bpj06u9m.js";import"./Undo-CfrxzS-O.js";/* empty css                                            */async function Vt(de){return de?`<div style="display: flex; flex-wrap: wrap; gap: 16px">${(await Promise.all(de.map(async([C,fe])=>C===null||!C.url?"":await St(C.url)))).map(C=>`<img src="${C}" style="height: 400px" />`).join("")}</div>`:""}var Xt=U('<div class="icon-button"><!></div>'),qt=U("<!> <!> <!> <!>",1),Gt=U('<caption class="caption svelte-7anmrz"> </caption>'),Ht=U("<!> <!>",1),Ot=U("<button><!></button>"),Qt=U('<span><!> <button class="media-button svelte-7anmrz" aria-label="detailed view of selected image"><!></button> <!> <div class="thumbnails scroll-hide svelte-7anmrz" data-testid="container_el"></div></span>'),Jt=U("<!> <!>",1),Kt=U('<div class="caption-label svelte-7anmrz"> </div>'),Nt=U('<button class="delete-button svelte-7anmrz" aria-label="Delete image"><!></button>'),Yt=U('<div class="gallery-item svelte-7anmrz"><button><!> <!></button> <!></div>'),Zt=U('<div class="gallery-container"><!> <div><!> <div></div></div></div>'),$t=U("<!> <!>",1);function Al(de,r){wt(r,!1);const C=y(),fe=y(),u=y();let ae=o(r,"show_label",12,!0),je=o(r,"label",12),m=o(r,"value",12,null),A=o(r,"columns",28,()=>[2]),Ee=o(r,"rows",12,void 0),Q=o(r,"height",12,"auto"),ne=o(r,"preview",12),J=o(r,"allow_preview",12,!0),Le=o(r,"object_fit",12,"cover"),Pe=o(r,"show_share_button",12,!1),Ue=o(r,"show_download_button",12,!1),V=o(r,"i18n",12),l=o(r,"selected_index",12,null),me=o(r,"interactive",12),Me=o(r,"_fetch",12),K=o(r,"mode",12,"normal"),Be=o(r,"show_fullscreen_button",12,!0),Re=o(r,"display_icon_button_wrapper_top_corner",12,!1),De=o(r,"fullscreen",12,!1),Te=o(r,"root",12,""),Ce=o(r,"file_types",28,()=>["image","video"]),Ae=o(r,"max_file_size",12,null),ve=o(r,"upload",12,void 0),ge=o(r,"stream_handler",12,void 0),pe=o(r,"fit_columns",12,!0),he=o(r,"upload_promise",12,null),We=y(!1),Oe=y();const X=yt();let N=y(!0),a=y(null),be=y(A()),Fe=y(m());l()==null&&ne()&&m()?.length&&l(0);let Se=y(l());function ot(t){const f=t.target,b=t.offsetX,M=f.offsetWidth/2;b<M?l(e(C)):l(e(fe))}function it(t){switch(t.code){case"Escape":t.preventDefault(),l(null);break;case"ArrowLeft":t.preventDefault(),l(e(C));break;case"ArrowRight":t.preventDefault(),l(e(fe));break}}let Y=y([]),L=y();async function st(t){if(typeof t!="number"||(await It(),e(Y)[t]===void 0))return;e(Y)[t]?.focus();const{left:f,width:b}=e(L).getBoundingClientRect(),{left:Z,width:M}=e(Y)[t].getBoundingClientRect(),q=Z-f+M/2-b/2+e(L).scrollLeft;e(L)&&typeof e(L).scrollTo=="function"&&e(L).scrollTo({left:q<0?0:q,behavior:"smooth"})}let ut=y(0);async function ct(t,f){let b;try{b=await Me()(t)}catch(q){if(q instanceof TypeError){window.open(t,"_blank","noreferrer");return}throw q}const Z=await b.blob(),M=URL.createObjectURL(Z),O=document.createElement("a");O.href=M,O.download=f,O.click(),URL.revokeObjectURL(M)}let Qe=y(!1);function oe(){e(L)&&p(Qe,e(L).scrollWidth>e(L).clientWidth)}zt(()=>(oe(),document.addEventListener("fullscreenchange",()=>{p(We,!!document.fullscreenElement)}),window.addEventListener("resize",oe),()=>window.removeEventListener("resize",oe)));function _t(t){if(!m()||!e(a))return;const f=e(a)[t];let b;"image"in f?b={file:f.image,index:t}:"video"in f&&(b={file:f.video,index:t}),b&&X("delete",b)}let Je=y(!1);R(()=>(e(N),h(m())),()=>{p(N,m()==null||m().length===0?!0:e(N))}),R(()=>h(m()),()=>{p(a,m()==null?null:m().map(t=>"video"in t?{video:t.video,caption:t.caption}:"image"in t?{image:t.image,caption:t.caption}:{}))}),R(()=>(e(a),h(A()),h(pe())),()=>{if(e(a)&&A()&&pe()){const t=e(a).length;Array.isArray(A())?p(be,A().map(f=>Math.min(f,t))):p(be,Math.min(A(),t))}else p(be,A())}),R(()=>(e(Fe),h(m()),e(N),h(l()),h(ne())),()=>{Ft(e(Fe),m())||(e(N)?(l(ne()&&m()?.length?0:null),p(N,!1)):l()!==null&&m()!==null?l(Math.max(0,Math.min(l(),m().length-1))):l(null),X("change"),p(Fe,m()))}),R(()=>(h(l()),e(Se),e(a)),()=>{l()!==e(Se)&&(p(Se,l()),l()!==null&&(e(a)!=null&&l(Math.max(0,Math.min(l(),e(a).length-1))),X("select",{index:l(),value:e(a)?.[l()]})))}),R(()=>(h(l()),e(a)),()=>{p(C,((l()??0)+(e(a)?.length??0)-1)%(e(a)?.length??0))}),R(()=>(h(l()),e(a)),()=>{p(fe,((l()??0)+1)%(e(a)?.length??0))}),R(()=>(h(J()),h(l())),()=>{J()&&st(l())}),R(()=>(h(l()),e(a)),()=>{p(u,l()!=null&&e(a)!=null?e(a)[l()]:null)}),R(()=>e(a),()=>{e(a),oe()}),R(()=>e(L),()=>{e(L)&&oe()}),xt();var dt={get show_label(){return ae()},set show_label(t){ae(t),i()},get label(){return je()},set label(t){je(t),i()},get value(){return m()},set value(t){m(t),i()},get columns(){return A()},set columns(t){A(t),i()},get rows(){return Ee()},set rows(t){Ee(t),i()},get height(){return Q()},set height(t){Q(t),i()},get preview(){return ne()},set preview(t){ne(t),i()},get allow_preview(){return J()},set allow_preview(t){J(t),i()},get object_fit(){return Le()},set object_fit(t){Le(t),i()},get show_share_button(){return Pe()},set show_share_button(t){Pe(t),i()},get show_download_button(){return Ue()},set show_download_button(t){Ue(t),i()},get i18n(){return V()},set i18n(t){V(t),i()},get selected_index(){return l()},set selected_index(t){l(t),i()},get interactive(){return me()},set interactive(t){me(t),i()},get _fetch(){return Me()},set _fetch(t){Me(t),i()},get mode(){return K()},set mode(t){K(t),i()},get show_fullscreen_button(){return Be()},set show_fullscreen_button(t){Be(t),i()},get display_icon_button_wrapper_top_corner(){return Re()},set display_icon_button_wrapper_top_corner(t){Re(t),i()},get fullscreen(){return De()},set fullscreen(t){De(t),i()},get root(){return Te()},set root(t){Te(t),i()},get file_types(){return Ce()},set file_types(t){Ce(t),i()},get max_file_size(){return Ae()},set max_file_size(t){Ae(t),i()},get upload(){return ve()},set upload(t){ve(t),i()},get stream_handler(){return ge()},set stream_handler(t){ge(t),i()},get fit_columns(){return pe()},set fit_columns(t){pe(t),i()},get upload_promise(){return he()},set upload_promise(t){he(t),i()}};bt();var Ke=$t(),Ne=ce(Ke);{var ft=t=>{{let f=T(()=>je()||"Gallery");Ut(t,{get show_label(){return ae()},get Icon(){return at},get label(){return e(f)}})}};w(Ne,t=>{ae()&&t(ft)})}var mt=j(Ne,2);{var vt=t=>{Mt(t,{unpadded_box:!0,size:"large",children:(f,b)=>{at(f)},$$slots:{default:!0}})},gt=t=>{var f=Zt(),b=D(f);{var Z=B=>{var c=Qt();let W;var F=D(c);Tt(F,{get display_top_corner(){return Re()},children:(v,_)=>{var n=qt(),s=ce(n);{var k=g=>{{let S=T(()=>(h(V()),d(()=>V()("common.download"))));qe(g,{get Icon(){return Rt},get label(){return e(S)},$$events:{click:()=>{const ke="image"in e(u)?e(u)?.image:e(u)?.video;if(ke==null)return;const{url:le,orig_name:ht}=ke;le&&ct(le,ht??"image")}}})}};w(s,g=>{Ue()&&g(k)})}var te=j(s,2);{var se=g=>{Ct(g,{get fullscreen(){return De()},$$events:{fullscreen(S){Xe.call(this,r,S)}}})};w(te,g=>{Be()&&g(se)})}var ze=j(te,2);{var P=g=>{var S=Xt(),ke=D(S);Bt(ke,{get i18n(){return V()},get value(){return e(a)},get formatter(){return Vt},$$events:{share(le){Xe.call(this,r,le)},error(le){Xe.call(this,r,le)}}}),E(S),I(g,S)};w(ze,g=>{Pe()&&g(P)})}var H=j(ze,2);{var xe=g=>{qe(g,{get Icon(){return rt},label:"Close",$$events:{click:()=>{l(null),X("preview_close")}}})};w(H,g=>{e(We)||g(xe)})}I(v,n)},$$slots:{default:!0}});var z=j(F,2),$=D(z);{var G=v=>{{let _=T(()=>(e(u),d(()=>({alt:e(u).caption||"",title:e(u).caption||null,class:e(u).caption&&"with-caption",loading:"lazy"}))));Ge(v,{get restProps(){return e(_)},get src(){return e(u),d(()=>e(u).image.url)},data_testid:"detailed-image"})}},ie=v=>{{let _=T(()=>(e(u),d(()=>e(u).caption||"")));He(v,{get src(){return e(u),d(()=>e(u).video.url)},"data-testid":"detailed-video",get alt(){return e(_)},loading:"lazy",loop:!1,is_stream:!1,muted:!1,controls:!0})}};w($,v=>{"image"in e(u)?v(G):v(ie,!1)})}E(z);var ee=j(z,2);{var ye=v=>{var _=Gt(),n=D(_,!0);E(_),re(()=>lt(n,(e(u),d(()=>e(u).caption)))),I(v,_)};w(ee,v=>{e(u),d(()=>e(u)?.caption)&&v(ye)})}var x=j(ee,2);$e(x,5,()=>e(a),tt,(v,_,n)=>{var s=Ot();let k;var te=D(s);{var se=P=>{{let H=T(()=>(e(_),d(()=>({title:e(_).caption||null,alt:"",class:"with-caption",loading:"lazy"}))));Ge(P,{get src(){return e(_),d(()=>e(_).image.url)},get restProps(){return e(H)},data_testid:`thumbnail ${n+1}`})}},ze=P=>{var H=Ht(),xe=ce(H);nt(xe);var g=j(xe,2);{let S=T(()=>(e(_),d(()=>e(_).caption||null)));He(g,{get src(){return e(_),d(()=>e(_).video.url)},get title(){return e(S)},is_stream:!1,"data-testid":"thumbnail "+(n+1),alt:"",loading:"lazy",loop:!1})}I(P,H)};w(te,P=>{"image"in e(_)?P(se):P(ze,!1)})}E(s),Ve(s,(P,H)=>jt(Y,e(Y)[H]=P),P=>e(Y)?.[P],()=>[n]),re(()=>{k=ue(s,1,"thumbnail-item thumbnail-small svelte-7anmrz",null,k,{selected:l()===n&&K()!=="minimal"}),et(s,"aria-label",(e(a),d(()=>"Thumbnail "+(n+1)+" of "+e(a).length)))}),_e("click",s,()=>l(n)),I(v,s)}),E(x),Ve(x,v=>p(L,v),()=>e(L)),E(c),re(()=>{W=ue(c,1,"preview svelte-7anmrz",null,W,{minimal:K()==="minimal"}),Ie(z,`height: calc(100% - ${e(u),d(()=>e(u).caption?"80px":"60px")??""})`),Ie(x,`justify-content: ${e(Qe)?"flex-start":"center"};`)}),_e("click",z,function(...v){("image"in e(u)?_=>ot(_):null)?.apply(this,v)}),_e("keydown",c,it),I(B,c)};w(b,B=>{e(u)&&J()&&B(Z)})}var M=j(b,2);let O,q;var Ye=D(M);{var pt=B=>{Wt(B,{get i18n(){return V()},$$events:{clear:()=>{m([]),X("clear")}},children:(c,W)=>{var F=Et(),z=ce(F);{var $=G=>{{let ie=T(()=>(h(V()),d(()=>V()("common.upload"))));qe(G,{get Icon(){return Dt},get label(){return e(ie)},children:(ee,ye)=>{At(ee,{icon_upload:!0,get filetype(){return Ce()},file_count:"multiple",get max_file_size(){return Ae()},get root(){return Te()},get stream_handler(){return ge()},get upload(){return ve()},get upload_promise(){return he()},set upload_promise(x){he(x)},get uploading(){return e(Je)},set uploading(x){p(Je,x)},$$events:{load:x=>X("upload",x.detail),error:x=>X("error",x.detail)},$$legacy:!0})},$$slots:{default:!0}})}};w(z,G=>{ve()&&ge()&&G($)})}I(c,F)},$$slots:{default:!0}})};w(Ye,B=>{me()&&l()===null&&B(pt)})}var we=j(Ye,2);let Ze;$e(we,5,()=>e(a),tt,(B,c,W)=>{var F=Yt(),z=D(F);let $;var G=D(z);{var ie=n=>{{let s=T(()=>(e(c),d(()=>e(c).caption||""))),k=T(()=>(e(c),d(()=>typeof e(c).image=="string"?e(c).image:e(c).image.url)));Ge(n,{get alt(){return e(s)},get src(){return e(k)},loading:"lazy"})}},ee=n=>{var s=Jt(),k=ce(s);nt(k);var te=j(k,2);{let se=T(()=>(e(c),d(()=>e(c).caption||null)));He(te,{get src(){return e(c),d(()=>e(c).video.url)},get title(){return e(se)},is_stream:!1,"data-testid":"thumbnail "+(W+1),alt:"",loading:"lazy",loop:!1})}I(n,s)};w(G,n=>{"image"in e(c)?n(ie):n(ee,!1)})}var ye=j(G,2);{var x=n=>{var s=Kt(),k=D(s,!0);E(s),re(()=>lt(k,(e(c),d(()=>e(c).caption)))),I(n,s)};w(ye,n=>{e(c),d(()=>e(c).caption)&&n(x)})}E(z);var v=j(z,2);{var _=n=>{var s=Nt(),k=D(s);rt(k),E(s),_e("click",s,Pt(()=>_t(W))),I(n,s)};w(v,n=>{me()&&n(_)})}E(F),re(()=>{$=ue(z,1,"thumbnail-item thumbnail-lg svelte-7anmrz",null,$,{selected:l()===W}),et(z,"aria-label",(e(a),d(()=>"Thumbnail "+(W+1)+" of "+e(a).length)))}),_e("click",z,()=>{l()===null&&J()&&X("preview_open"),l(W)}),I(B,F)}),E(we),E(M),E(f),Ve(f,B=>p(Oe,B),()=>e(Oe)),re(()=>{O=ue(M,1,"grid-wrap svelte-7anmrz",null,O,{minimal:K()==="minimal","fixed-height":K()!=="minimal"&&(!Q()||Q()=="auto"),hidden:e(We)}),q=Ie(M,"",q,{height:Q()!=="auto"?Q()+"px":null}),Ze=ue(we,1,"grid-container svelte-7anmrz",null,Ze,{"pt-6":ae()}),Ie(we,`--grid-cols:${e(be)??""}; --grid-rows:${Ee()??""}; --object-fit: ${Le()??""};`)}),I(t,f)};w(mt,t=>{h(m()),e(a),d(()=>m()==null||e(a)==null||e(a).length===0)?t(vt):t(gt,!1)})}return Lt("innerHeight",t=>p(ut,t)),I(de,Ke),kt(dt)}export{Al as default};
//# sourceMappingURL=Gallery-VeKGolRh.js.map

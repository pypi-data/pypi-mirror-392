{"version":3,"mappings":"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","names":["props","gradio","Gradio","unique_colors","$.derived","$.get","_data","d","y_lim","x_start","x_lim","y_start","y_end","fullscreen","reformat_sort","_sort","$.state","$.proxy","escape_field_name","fieldName","x_temporal","_x_lim","x_end","SUFFIX_DURATION","_x_bin","_y_aggregate","aggregating","data","x_index","y_index","bin_count","min_max_bins_per_color","row","x_value","bin_size","i","y_value","color_value","color_index","bin_index","downsampled_data","bins","min_index","_","max_index","__","indices","index","datatable","_x_start","_x_end","time_factor","smallest_after_end","_datatable","largest_before_start","downsample","obj","col","reformat_data","old_value","$.set","view","is_browser","chart_element","computed_style","old_width","old_height","resizeObserver","load_chart","mouse_down_on_chart","refresh_pending","spec","el","width_change","height_change","vegaEmbed","__vitePreload","__vite_default__","result","debounceTimeout","lastSelectTime","e","value","range","onMount","mounted","export_chart","export_background","url","link","err","_color_map","$.user_effect","untrack","create_vega_lite_spec","accent_color","font_family","title_weight","font_to_px_val","font","text_size_md","text_size_sm","body_text_color","borderColorPrimary","mode","c","n"],"ignoreList":[],"sources":["../../../../js/nativeplot/Index.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { Gradio } from \"@gradio/utils\";\n\timport { BlockTitle } from \"@gradio/atoms\";\n\timport { Block } from \"@gradio/atoms\";\n\timport {\n\t\tFullscreenButton,\n\t\tIconButtonWrapper,\n\t\tIconButton\n\t} from \"@gradio/atoms\";\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\timport { onMount, untrack } from \"svelte\";\n\timport { Download } from \"@gradio/icons\";\n\n\timport type { TopLevelSpec as Spec } from \"vega-lite\";\n\timport type { View } from \"vega\";\n\timport { LineChart as LabelIcon } from \"@gradio/icons\";\n\timport { Empty } from \"@gradio/atoms\";\n\timport type { NativePlotProps, NativePlotEvents, PlotData } from \"./types\";\n\n\tlet props = $props();\n\tconst gradio = new Gradio<NativePlotEvents, NativePlotProps>(props);\n\n\tlet unique_colors = $derived(\n\t\tgradio.props.color &&\n\t\t\tgradio.props.value &&\n\t\t\tgradio.props.value.datatypes[gradio.props.color] === \"nominal\"\n\t\t\t? Array.from(new Set(_data.map((d) => d[gradio.props.color!])))\n\t\t\t: []\n\t);\n\n\tlet x_lim = $derived(gradio.props.x_lim || null); // for some unknown reason, x_lim was getting set to undefined when used in re-render, so this line is needed\n\tlet y_lim = $derived(gradio.props.y_lim || null);\n\tlet x_start = $derived(x_lim?.[0] !== null ? x_lim?.[0] : undefined);\n\tlet x_end = $derived(x_lim?.[1] !== null ? x_lim?.[1] : undefined);\n\tlet y_start = $derived(y_lim?.[0] !== null ? y_lim?.[0] : undefined);\n\tlet y_end = $derived(y_lim?.[1] !== null ? y_lim?.[1] : undefined);\n\n\tlet fullscreen = $state(false);\n\n\tfunction reformat_sort(\n\t\t_sort: NativePlotProps[\"sort\"]\n\t):\n\t\t| string\n\t\t| \"ascending\"\n\t\t| \"descending\"\n\t\t| { field: string; order: \"ascending\" | \"descending\" }\n\t\t| string[]\n\t\t| null\n\t\t| undefined {\n\t\tif (_sort === \"x\") {\n\t\t\treturn \"ascending\";\n\t\t} else if (_sort === \"-x\") {\n\t\t\treturn \"descending\";\n\t\t} else if (_sort === \"y\") {\n\t\t\treturn { field: gradio.props.y, order: \"ascending\" };\n\t\t} else if (_sort === \"-y\") {\n\t\t\treturn { field: gradio.props.y, order: \"descending\" };\n\t\t} else if (_sort === null) {\n\t\t\treturn null;\n\t\t} else if (Array.isArray(_sort)) {\n\t\t\treturn _sort;\n\t\t}\n\t}\n\tlet _sort = $derived(reformat_sort(gradio.props.sort));\n\n\tlet _data: {\n\t\t[x: string]: string | number;\n\t}[] = $state([]);\n\n\tfunction escape_field_name(fieldName: string): string {\n\t\t// Escape special characters in field names according to Vega-Lite spec:\n\t\t// https://vega.github.io/vega-lite/docs/field.html\n\t\treturn fieldName\n\t\t\t.replace(/\\./g, \"\\\\.\")\n\t\t\t.replace(/\\[/g, \"\\\\[\")\n\t\t\t.replace(/\\]/g, \"\\\\]\");\n\t}\n\n\tlet x_temporal = $derived(\n\t\tgradio.props.value &&\n\t\t\tgradio.props.value.datatypes[gradio.props.x] === \"temporal\"\n\t);\n\tlet _x_lim = $derived(\n\t\tx_temporal\n\t\t\t? [\n\t\t\t\t\tx_start !== undefined ? x_start * 1000 : null,\n\t\t\t\t\tx_end !== undefined ? x_end * 1000 : null\n\t\t\t\t]\n\t\t\t: x_lim\n\t);\n\tlet mouse_down_on_chart = $state(false);\n\tconst SUFFIX_DURATION: Record<string, number> = {\n\t\ts: 1,\n\t\tm: 60,\n\t\th: 60 * 60,\n\t\td: 24 * 60 * 60\n\t};\n\tlet _x_bin = $derived(\n\t\tgradio.props.x_bin\n\t\t\t? typeof gradio.props.x_bin === \"string\"\n\t\t\t\t? 1000 *\n\t\t\t\t\tparseInt(\n\t\t\t\t\t\tgradio.props.x_bin.substring(0, gradio.props.x_bin.length - 1)\n\t\t\t\t\t) *\n\t\t\t\t\tSUFFIX_DURATION[gradio.props.x_bin[gradio.props.x_bin.length - 1]]\n\t\t\t\t: gradio.props.x_bin\n\t\t\t: undefined\n\t);\n\n\tlet _y_aggregate = $derived.by(() => {\n\t\tif (gradio.props.value) {\n\t\t\tif (gradio.props.value.mark === \"point\") {\n\t\t\t\tconst aggregating = _x_bin !== undefined;\n\t\t\t\treturn gradio.props.y_aggregate || aggregating ? \"sum\" : undefined;\n\t\t\t} else {\n\t\t\t\treturn gradio.props.y_aggregate ? gradio.props.y_aggregate : \"sum\";\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t});\n\n\tlet aggregating = $derived.by(() => {\n\t\tif (gradio.props.value) {\n\t\t\tif (gradio.props.value.mark === \"point\") {\n\t\t\t\treturn _x_bin !== undefined;\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\t_x_bin !== undefined ||\n\t\t\t\t\tgradio.props.value.datatypes[gradio.props.x] === \"nominal\"\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t});\n\n\tfunction downsample(\n\t\tdata: PlotData[\"data\"],\n\t\tx_index: number,\n\t\ty_index: number,\n\t\tcolor_index: number | null,\n\t\tx_start: number | undefined,\n\t\tx_end: number | undefined\n\t): PlotData[\"data\"] {\n\t\tif (\n\t\t\tdata.length < 1000 ||\n\t\t\tgradio.props.x_bin !== null ||\n\t\t\tgradio.props.value?.mark !== \"line\" ||\n\t\t\tgradio.props.value?.datatypes[gradio.props.x] === \"nominal\"\n\t\t) {\n\t\t\treturn data;\n\t\t}\n\t\tconst bin_count = 250;\n\t\tlet min_max_bins_per_color: Record<\n\t\t\tstring,\n\t\t\t[number | null, number, number | null, number][]\n\t\t> = {};\n\t\tif (x_start === undefined || x_end === undefined) {\n\t\t\tdata.forEach((row) => {\n\t\t\t\tlet x_value = row[x_index] as number;\n\t\t\t\tif (x_start === undefined || x_value < x_start) {\n\t\t\t\t\tx_start = x_value;\n\t\t\t\t}\n\t\t\t\tif (x_end === undefined || x_value > x_end) {\n\t\t\t\t\tx_end = x_value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (x_start === undefined || x_end === undefined) {\n\t\t\treturn data;\n\t\t}\n\t\tconst x_range = x_end - x_start;\n\t\tconst bin_size = x_range / bin_count;\n\t\tdata.forEach((row, i) => {\n\t\t\tconst x_value = row[x_index] as number;\n\t\t\tconst y_value = row[y_index] as number;\n\t\t\tconst color_value =\n\t\t\t\tcolor_index !== null ? (row[color_index] as string) : \"any\";\n\t\t\tconst bin_index = Math.floor((x_value - (x_start as number)) / bin_size);\n\t\t\tif (min_max_bins_per_color[color_value] === undefined) {\n\t\t\t\tmin_max_bins_per_color[color_value] = [];\n\t\t\t}\n\t\t\tmin_max_bins_per_color[color_value][bin_index] = min_max_bins_per_color[\n\t\t\t\tcolor_value\n\t\t\t][bin_index] || [\n\t\t\t\tnull,\n\t\t\t\tNumber.POSITIVE_INFINITY,\n\t\t\t\tnull,\n\t\t\t\tNumber.NEGATIVE_INFINITY\n\t\t\t];\n\t\t\tif (y_value < min_max_bins_per_color[color_value][bin_index][1]) {\n\t\t\t\tmin_max_bins_per_color[color_value][bin_index][0] = i;\n\t\t\t\tmin_max_bins_per_color[color_value][bin_index][1] = y_value;\n\t\t\t}\n\t\t\tif (y_value > min_max_bins_per_color[color_value][bin_index][3]) {\n\t\t\t\tmin_max_bins_per_color[color_value][bin_index][2] = i;\n\t\t\t\tmin_max_bins_per_color[color_value][bin_index][3] = y_value;\n\t\t\t}\n\t\t});\n\t\tconst downsampled_data: PlotData[\"data\"] = [];\n\t\tObject.values(min_max_bins_per_color).forEach((bins) => {\n\t\t\tbins.forEach(([min_index, _, max_index, __]) => {\n\t\t\t\tlet indices: number[] = [];\n\t\t\t\tif (min_index !== null && max_index !== null) {\n\t\t\t\t\tindices = [\n\t\t\t\t\t\tMath.min(min_index, max_index),\n\t\t\t\t\t\tMath.max(min_index, max_index)\n\t\t\t\t\t];\n\t\t\t\t} else if (min_index !== null) {\n\t\t\t\t\tindices = [min_index];\n\t\t\t\t} else if (max_index !== null) {\n\t\t\t\t\tindices = [max_index];\n\t\t\t\t}\n\t\t\t\tindices.forEach((index) => {\n\t\t\t\t\tdownsampled_data.push(data[index]);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\treturn downsampled_data;\n\t}\n\tfunction reformat_data(\n\t\tdata: PlotData,\n\t\tx_start: number | undefined,\n\t\tx_end: number | undefined\n\t): {\n\t\t[x: string]: string | number;\n\t}[] {\n\t\tlet x_index = data.columns.indexOf(gradio.props.x);\n\t\tlet y_index = data.columns.indexOf(gradio.props.y);\n\t\tlet color_index = gradio.props.color\n\t\t\t? data.columns.indexOf(gradio.props.color)\n\t\t\t: null;\n\t\tlet datatable = data.data;\n\n\t\tif (x_start !== undefined && x_end !== undefined) {\n\t\t\tconst time_factor =\n\t\t\t\tdata.datatypes[gradio.props.x] === \"temporal\" ? 1000 : 1;\n\t\t\tconst _x_start = x_start * time_factor;\n\t\t\tconst _x_end = x_end * time_factor;\n\t\t\tlet largest_before_start: Record<string, [number, number]> = {};\n\t\t\tlet smallest_after_end: Record<string, [number, number]> = {};\n\t\t\tconst _datatable = datatable.filter((row, i) => {\n\t\t\t\tconst x_value = row[x_index] as number;\n\t\t\t\tconst color_value =\n\t\t\t\t\tcolor_index !== null ? (row[color_index] as string) : \"any\";\n\t\t\t\tif (\n\t\t\t\t\tx_value < _x_start &&\n\t\t\t\t\t(largest_before_start[color_value] === undefined ||\n\t\t\t\t\t\tx_value > largest_before_start[color_value][1])\n\t\t\t\t) {\n\t\t\t\t\tlargest_before_start[color_value] = [i, x_value];\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tx_value > _x_end &&\n\t\t\t\t\t(smallest_after_end[color_value] === undefined ||\n\t\t\t\t\t\tx_value < smallest_after_end[color_value][1])\n\t\t\t\t) {\n\t\t\t\t\tsmallest_after_end[color_value] = [i, x_value];\n\t\t\t\t}\n\t\t\t\treturn x_value >= _x_start && x_value <= _x_end;\n\t\t\t});\n\t\t\tdatatable = [\n\t\t\t\t...Object.values(largest_before_start).map(([i, _]) => datatable[i]),\n\t\t\t\t...downsample(\n\t\t\t\t\t_datatable,\n\t\t\t\t\tx_index,\n\t\t\t\t\ty_index,\n\t\t\t\t\tcolor_index,\n\t\t\t\t\t_x_start,\n\t\t\t\t\t_x_end\n\t\t\t\t),\n\t\t\t\t...Object.values(smallest_after_end).map(([i, _]) => datatable[i])\n\t\t\t];\n\t\t} else {\n\t\t\tdatatable = downsample(\n\t\t\t\tdatatable,\n\t\t\t\tx_index,\n\t\t\t\ty_index,\n\t\t\t\tcolor_index,\n\t\t\t\tundefined,\n\t\t\t\tundefined\n\t\t\t);\n\t\t}\n\n\t\tif (gradio.props.tooltip == \"all\" || Array.isArray(gradio.props.tooltip)) {\n\t\t\treturn datatable.map((row) => {\n\t\t\t\tconst obj: { [x: string]: string | number } = {};\n\t\t\t\tdata.columns.forEach((col, i) => {\n\t\t\t\t\tobj[col] = row[i];\n\t\t\t\t});\n\t\t\t\treturn obj;\n\t\t\t});\n\t\t}\n\t\treturn datatable.map((row) => {\n\t\t\tconst obj = {\n\t\t\t\t[gradio.props.x]: row[x_index],\n\t\t\t\t[gradio.props.y]: row[y_index]\n\t\t\t};\n\t\t\tif (gradio.props.color && color_index !== null) {\n\t\t\t\tobj[gradio.props.color] = row[color_index];\n\t\t\t}\n\t\t\treturn obj;\n\t\t});\n\t}\n\n\t$effect(() => {\n\t\tconsole.log(\"effect 0 run\");\n\t\t_data = gradio.props.value\n\t\t\t? reformat_data(gradio.props.value, x_start, x_end)\n\t\t\t: [];\n\t});\n\n\tlet old_value = $state<PlotData | null>(gradio.props.value);\n\t$effect(() => {\n\t\tconsole.log(\"effect 1 run\");\n\t\tif (old_value !== gradio.props.value && view) {\n\t\t\told_value = gradio.props.value;\n\t\t\tview.data(\"data\", _data).runAsync();\n\t\t}\n\t});\n\n\tconst is_browser = typeof window !== \"undefined\";\n\tlet chart_element = $state<HTMLDivElement>();\n\tlet computed_style = $derived(\n\t\tchart_element ? window.getComputedStyle(chart_element) : null\n\t);\n\tlet view = $state<View>();\n\tlet mounted = $state(false);\n\tlet old_width = $state<number>(0);\n\tlet old_height = $state<number>(0);\n\tlet resizeObserver = $state<ResizeObserver>();\n\n\tlet vegaEmbed: typeof import(\"vega-embed\").default;\n\n\tasync function load_chart(): Promise<void> {\n\t\tif (mouse_down_on_chart) {\n\t\t\trefresh_pending = true;\n\t\t\treturn;\n\t\t}\n\t\tif (view) {\n\t\t\tview.finalize();\n\t\t}\n\t\tif (!gradio.props.value || !chart_element) return;\n\t\told_width = chart_element.offsetWidth;\n\t\told_height = chart_element.offsetHeight;\n\t\tconst spec = create_vega_lite_spec();\n\t\tif (!spec) return;\n\t\tresizeObserver = new ResizeObserver((el) => {\n\t\t\tif (!el[0].target || !(el[0].target instanceof HTMLElement)) return;\n\t\t\tif (\n\t\t\t\told_width === 0 &&\n\t\t\t\tchart_element!.offsetWidth !== 0 &&\n\t\t\t\tgradio.props.value!.datatypes[gradio.props.x] === \"nominal\"\n\t\t\t) {\n\t\t\t\t// a bug where when a nominal chart is first loaded, the width is 0, it doesn't resize\n\t\t\t\tload_chart();\n\t\t\t} else {\n\t\t\t\tconst width_change = Math.abs(old_width - el[0].target.offsetWidth);\n\t\t\t\tconst height_change = Math.abs(old_height - el[0].target.offsetHeight);\n\t\t\t\tif (width_change > 100 || height_change > 100) {\n\t\t\t\t\told_width = el[0].target.offsetWidth;\n\t\t\t\t\told_height = el[0].target.offsetHeight;\n\t\t\t\t\tload_chart();\n\t\t\t\t} else {\n\t\t\t\t\tview.signal(\"width\", el[0].target.offsetWidth).run();\n\t\t\t\t\tif (fullscreen) {\n\t\t\t\t\t\tview.signal(\"height\", el[0].target.offsetHeight).run();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (!vegaEmbed) {\n\t\t\tvegaEmbed = (await import(\"vega-embed\")).default;\n\t\t}\n\t\tvegaEmbed(chart_element, spec, { actions: false }).then(function (result) {\n\t\t\tview = result.view;\n\t\t\tresizeObserver!.observe(chart_element!);\n\t\t\tvar debounceTimeout: NodeJS.Timeout;\n\t\t\tvar lastSelectTime = 0;\n\t\t\tview.addEventListener(\"dblclick\", () => {\n\t\t\t\tgradio.dispatch(\"double_click\");\n\t\t\t});\n\t\t\t// prevent double-clicks from highlighting text\n\t\t\tchart_element!.addEventListener(\n\t\t\t\t\"mousedown\",\n\t\t\t\tfunction (e) {\n\t\t\t\t\tif (e.detail > 1) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tif (gradio.props._selectable) {\n\t\t\t\tview.addSignalListener(\"brush\", function (_, value) {\n\t\t\t\t\tif (Date.now() - lastSelectTime < 1000) return;\n\t\t\t\t\tmouse_down_on_chart = true;\n\t\t\t\t\tif (Object.keys(value).length === 0) return;\n\t\t\t\t\tclearTimeout(debounceTimeout);\n\t\t\t\t\tlet range: [number, number] = value[Object.keys(value)[0]];\n\t\t\t\t\tif (x_temporal) {\n\t\t\t\t\t\trange = [range[0] / 1000, range[1] / 1000];\n\t\t\t\t\t}\n\t\t\t\t\tdebounceTimeout = setTimeout(function () {\n\t\t\t\t\t\tmouse_down_on_chart = false;\n\t\t\t\t\t\tlastSelectTime = Date.now();\n\t\t\t\t\t\tgradio.dispatch(\"select\", {\n\t\t\t\t\t\t\tvalue: range,\n\t\t\t\t\t\t\tindex: range,\n\t\t\t\t\t\t\tselected: true\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (refresh_pending) {\n\t\t\t\t\t\t\trefresh_pending = false;\n\t\t\t\t\t\t\tload_chart();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 250);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tlet refresh_pending = $state(false);\n\n\tonMount(() => {\n\t\tmounted = true;\n\t\treturn () => {\n\t\t\tmounted = false;\n\t\t\tif (view) {\n\t\t\t\tview.finalize();\n\t\t\t}\n\t\t\tif (resizeObserver) {\n\t\t\t\tresizeObserver.disconnect();\n\t\t\t}\n\t\t};\n\t});\n\n\tfunction export_chart(): void {\n\t\tif (!view || !computed_style) return;\n\n\t\tconst block_background = computed_style.getPropertyValue(\n\t\t\t\"--block-background-fill\"\n\t\t);\n\t\tconst export_background = block_background || \"white\";\n\n\t\tview.background(export_background).run();\n\n\t\tview\n\t\t\t.toImageURL(\"png\", 2)\n\t\t\t.then(function (url) {\n\t\t\t\tview.background(\"transparent\").run();\n\n\t\t\t\tconst link = document.createElement(\"a\");\n\t\t\t\tlink.setAttribute(\"href\", url);\n\t\t\t\tlink.setAttribute(\"download\", \"chart.png\");\n\t\t\t\tlink.style.display = \"none\";\n\t\t\t\tdocument.body.appendChild(link);\n\t\t\t\tlink.click();\n\t\t\t\tdocument.body.removeChild(link);\n\t\t\t})\n\t\t\t.catch(function (err) {\n\t\t\t\tconsole.error(\"Export failed:\", err);\n\t\t\t\tview.background(\"transparent\").run();\n\t\t\t});\n\t}\n\n\tlet _color_map = $derived(JSON.stringify(gradio.props.color_map));\n\n\t$effect(() => {\n\t\t// Track dependencies to trigger chart reload\n\t\tvoid gradio.props.title;\n\t\tvoid gradio.props.x_title;\n\t\tvoid gradio.props.y_title;\n\t\tvoid gradio.props.color_title;\n\t\tvoid gradio.props.x;\n\t\tvoid gradio.props.y;\n\t\tvoid gradio.props.color;\n\t\tvoid gradio.props.x_bin;\n\t\tvoid _y_aggregate;\n\t\tvoid _color_map;\n\t\tvoid gradio.props.colors_in_legend;\n\t\tvoid x_start;\n\t\tvoid x_end;\n\t\tvoid y_start;\n\t\tvoid y_end;\n\t\tvoid gradio.props.caption;\n\t\tvoid gradio.props.sort;\n\t\tvoid mounted;\n\t\tvoid chart_element;\n\t\tvoid fullscreen;\n\t\tvoid computed_style;\n\n\t\tif (mounted && chart_element) {\n\t\t\tconsole.log(\"Reloading chart due to prop change\");\n\t\t\tuntrack(() => {\n\t\t\t\tload_chart();\n\t\t\t});\n\t\t}\n\t});\n\n\tfunction create_vega_lite_spec(): Spec | null {\n\t\tif (!gradio.props.value || !computed_style) return null;\n\t\tlet accent_color = computed_style.getPropertyValue(\"--color-accent\");\n\t\tlet body_text_color = computed_style.getPropertyValue(\"--body-text-color\");\n\t\tlet borderColorPrimary = computed_style.getPropertyValue(\n\t\t\t\"--border-color-primary\"\n\t\t);\n\t\tlet font_family = computed_style.fontFamily;\n\t\tlet title_weight = computed_style.getPropertyValue(\n\t\t\t\"--block-title-text-weight\"\n\t\t) as\n\t\t\t| \"bold\"\n\t\t\t| \"normal\"\n\t\t\t| 100\n\t\t\t| 200\n\t\t\t| 300\n\t\t\t| 400\n\t\t\t| 500\n\t\t\t| 600\n\t\t\t| 700\n\t\t\t| 800\n\t\t\t| 900;\n\t\tconst font_to_px_val = (font: string): number => {\n\t\t\treturn font.endsWith(\"px\") ? parseFloat(font.slice(0, -2)) : 12;\n\t\t};\n\t\tlet text_size_md = font_to_px_val(\n\t\t\tcomputed_style.getPropertyValue(\"--text-md\")\n\t\t);\n\t\tlet text_size_sm = font_to_px_val(\n\t\t\tcomputed_style.getPropertyValue(\"--text-sm\")\n\t\t);\n\n\t\t/* eslint-disable complexity */\n\t\treturn {\n\t\t\t$schema: \"https://vega.github.io/schema/vega-lite/v5.17.0.json\",\n\t\t\tbackground: \"transparent\",\n\t\t\tconfig: {\n\t\t\t\tautosize: { type: \"fit\", contains: \"padding\" },\n\t\t\t\taxis: {\n\t\t\t\t\tlabelFont: font_family,\n\t\t\t\t\tlabelColor: body_text_color,\n\t\t\t\t\ttitleFont: font_family,\n\t\t\t\t\ttitleColor: body_text_color,\n\t\t\t\t\ttitlePadding: 8,\n\t\t\t\t\ttickColor: borderColorPrimary,\n\t\t\t\t\tlabelFontSize: text_size_sm,\n\t\t\t\t\tgridColor: borderColorPrimary,\n\t\t\t\t\ttitleFontWeight: \"normal\",\n\t\t\t\t\ttitleFontSize: text_size_sm,\n\t\t\t\t\tlabelFontWeight: \"normal\",\n\t\t\t\t\tdomain: false,\n\t\t\t\t\tlabelAngle: 0,\n\t\t\t\t\ttitleLimit: chart_element.offsetHeight * 0.8\n\t\t\t\t},\n\t\t\t\tlegend: {\n\t\t\t\t\tlabelColor: body_text_color,\n\t\t\t\t\tlabelFont: font_family,\n\t\t\t\t\ttitleColor: body_text_color,\n\t\t\t\t\ttitleFont: font_family,\n\t\t\t\t\ttitleFontWeight: \"normal\",\n\t\t\t\t\ttitleFontSize: text_size_sm,\n\t\t\t\t\tlabelFontWeight: \"normal\",\n\t\t\t\t\toffset: 2\n\t\t\t\t},\n\t\t\t\ttitle: {\n\t\t\t\t\tcolor: body_text_color,\n\t\t\t\t\tfont: font_family,\n\t\t\t\t\tfontSize: text_size_md,\n\t\t\t\t\tfontWeight: title_weight,\n\t\t\t\t\tanchor: \"middle\"\n\t\t\t\t},\n\t\t\t\tview: { stroke: borderColorPrimary },\n\t\t\t\tmark: {\n\t\t\t\t\tstroke: gradio.props.value.mark !== \"bar\" ? accent_color : undefined,\n\t\t\t\t\tfill: gradio.props.value.mark === \"bar\" ? accent_color : undefined,\n\t\t\t\t\tcursor: \"crosshair\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tdata: { name: \"data\" },\n\t\t\tdatasets: {\n\t\t\t\tdata: _data\n\t\t\t},\n\t\t\tlayer: [\n\t\t\t\t\"plot\",\n\t\t\t\t...(gradio.props.value.mark === \"line\" ? [\"hover\"] : [])\n\t\t\t].map((mode) => {\n\t\t\t\treturn {\n\t\t\t\t\tencoding: {\n\t\t\t\t\t\tsize:\n\t\t\t\t\t\t\tgradio.props.value!.mark === \"line\"\n\t\t\t\t\t\t\t\t? mode == \"plot\"\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\tcondition: {\n\t\t\t\t\t\t\t\t\t\t\t\tempty: false,\n\t\t\t\t\t\t\t\t\t\t\t\tparam: \"hoverPlot\",\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: 3\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tvalue: 2\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\tcondition: { empty: false, param: \"hover\", value: 100 },\n\t\t\t\t\t\t\t\t\t\t\tvalue: 0\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\topacity:\n\t\t\t\t\t\t\tmode === \"plot\"\n\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\tcondition: { empty: false, param: \"hover\", value: 1 },\n\t\t\t\t\t\t\t\t\t\tvalue: 0\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\tx: {\n\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t...(gradio.props.x_label_angle !== null && {\n\t\t\t\t\t\t\t\t\tlabelAngle: gradio.props.x_label_angle\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tlabels: gradio.props.x_axis_labels_visible,\n\t\t\t\t\t\t\t\tticks: gradio.props.x_axis_labels_visible\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfield: escape_field_name(gradio.props.x),\n\t\t\t\t\t\t\ttitle: gradio.props.x_title || gradio.props.x,\n\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[gradio.props.x],\n\t\t\t\t\t\t\tscale: {\n\t\t\t\t\t\t\t\tzero: false,\n\t\t\t\t\t\t\t\tdomainMin: _x_lim?.[0] !== null ? _x_lim?.[0] : undefined,\n\t\t\t\t\t\t\t\tdomainMax: _x_lim?.[1] !== null ? _x_lim?.[1] : undefined\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbin: _x_bin ? { step: _x_bin } : undefined,\n\t\t\t\t\t\t\tsort: _sort\n\t\t\t\t\t\t},\n\t\t\t\t\t\ty: {\n\t\t\t\t\t\t\taxis: gradio.props.y_label_angle\n\t\t\t\t\t\t\t\t? { labelAngle: gradio.props.y_label_angle }\n\t\t\t\t\t\t\t\t: {},\n\t\t\t\t\t\t\tfield: escape_field_name(gradio.props.y),\n\t\t\t\t\t\t\ttitle: gradio.props.y_title || gradio.props.y,\n\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[gradio.props.y],\n\t\t\t\t\t\t\tscale: {\n\t\t\t\t\t\t\t\tzero: false,\n\t\t\t\t\t\t\t\tdomainMin: y_start ?? undefined,\n\t\t\t\t\t\t\t\tdomainMax: y_end ?? undefined\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\taggregate: aggregating ? _y_aggregate : undefined\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcolor: gradio.props.color\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\tfield: escape_field_name(gradio.props.color),\n\t\t\t\t\t\t\t\t\tlegend: {\n\t\t\t\t\t\t\t\t\t\torient: \"bottom\",\n\t\t\t\t\t\t\t\t\t\ttitle: gradio.props.color_title,\n\t\t\t\t\t\t\t\t\t\tvalues: gradio.props.colors_in_legend || undefined\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tscale:\n\t\t\t\t\t\t\t\t\t\tgradio.props.value!.datatypes[gradio.props.color] ===\n\t\t\t\t\t\t\t\t\t\t\"nominal\"\n\t\t\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdomain: unique_colors,\n\t\t\t\t\t\t\t\t\t\t\t\t\trange: gradio.props.color_map\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? unique_colors.map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(c) => gradio.props.color_map![c]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\t\t\trange: [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t100, 200, 300, 400, 500, 600, 700, 800, 900\n\t\t\t\t\t\t\t\t\t\t\t\t\t].map((n) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcomputed_style!.getPropertyValue(\"--primary-\" + n)\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\tinterpolate: \"hsl\"\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[gradio.props.color]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\ttooltip:\n\t\t\t\t\t\t\tgradio.props.tooltip == \"none\"\n\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfield: escape_field_name(gradio.props.y),\n\t\t\t\t\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[gradio.props.y],\n\t\t\t\t\t\t\t\t\t\t\taggregate: aggregating ? _y_aggregate : undefined,\n\t\t\t\t\t\t\t\t\t\t\ttitle: gradio.props.y_title || gradio.props.y\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfield: escape_field_name(gradio.props.x),\n\t\t\t\t\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[gradio.props.x],\n\t\t\t\t\t\t\t\t\t\t\ttitle: gradio.props.x_title || gradio.props.x,\n\t\t\t\t\t\t\t\t\t\t\tformat: x_temporal ? \"%Y-%m-%d %H:%M:%S\" : undefined,\n\t\t\t\t\t\t\t\t\t\t\tbin: _x_bin ? { step: _x_bin } : undefined\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t...(gradio.props.color\n\t\t\t\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfield: gradio.props.color,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgradio.props.color\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t: []),\n\t\t\t\t\t\t\t\t\t\t...(gradio.props.tooltip === \"axis\"\n\t\t\t\t\t\t\t\t\t\t\t? []\n\t\t\t\t\t\t\t\t\t\t\t: gradio.props.value?.columns\n\t\t\t\t\t\t\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(col) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcol !== gradio.props.x &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcol !== gradio.props.y &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcol !== gradio.props.color &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(gradio.props.tooltip === \"all\" ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgradio.props.tooltip.includes(col))\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.map((column) => ({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfield: column,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: gradio.props.value!.datatypes[column]\n\t\t\t\t\t\t\t\t\t\t\t\t\t})))\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\tstrokeDash: {},\n\t\t\t\t\tmark: {\n\t\t\t\t\t\tclip: true,\n\t\t\t\t\t\ttype: mode === \"hover\" ? \"point\" : gradio.props.value.mark\n\t\t\t\t\t},\n\t\t\t\t\tname: mode\n\t\t\t\t};\n\t\t\t}),\n\t\t\t// @ts-ignore\n\t\t\tparams: [\n\t\t\t\t...(gradio.props.value!.mark === \"line\"\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"hoverPlot\",\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tclear: \"mouseout\",\n\t\t\t\t\t\t\t\t\tfields: gradio.props.color ? [gradio.props.color] : [],\n\t\t\t\t\t\t\t\t\tnearest: true,\n\t\t\t\t\t\t\t\t\ton: \"mouseover\",\n\t\t\t\t\t\t\t\t\ttype: \"point\" as \"point\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tviews: [\"hover\"]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"hover\",\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tclear: \"mouseout\",\n\t\t\t\t\t\t\t\t\tnearest: true,\n\t\t\t\t\t\t\t\t\ton: \"mouseover\",\n\t\t\t\t\t\t\t\t\ttype: \"point\" as \"point\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tviews: [\"hover\"]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t: []),\n\t\t\t\t...(gradio.props._selectable\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: \"brush\",\n\t\t\t\t\t\t\t\tselect: {\n\t\t\t\t\t\t\t\t\tencodings: [\"x\"],\n\t\t\t\t\t\t\t\t\tmark: { fill: \"gray\", fillOpacity: 0.3, stroke: \"none\" },\n\t\t\t\t\t\t\t\t\ttype: \"interval\" as \"interval\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tviews: [\"plot\"]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t: [])\n\t\t\t],\n\t\t\twidth: chart_element!.offsetWidth,\n\t\t\theight: gradio.props.height || fullscreen ? \"container\" : undefined,\n\t\t\ttitle: gradio.props.title || undefined\n\t\t} as Spec;\n\t}\n\t/* eslint-enable complexity */\n</script>\n\n<Block\n\tvisible={gradio.shared.visible}\n\telem_id={gradio.shared.elem_id}\n\telem_classes={gradio.shared.elem_classes}\n\tscale={gradio.shared.scale}\n\tmin_width={gradio.shared.min_width}\n\tallow_overflow={false}\n\tpadding={true}\n\theight={gradio.props.height}\n\tbind:fullscreen\n>\n\t{#if gradio.shared.loading_status}\n\t\t<StatusTracker\n\t\t\tautoscroll={gradio.shared.autoscroll}\n\t\t\ti18n={gradio.i18n}\n\t\t\t{...gradio.shared.loading_status}\n\t\t\ton:clear_status={() =>\n\t\t\t\tgradio.dispatch(\"clear_status\", gradio.shared.loading_status)}\n\t\t/>\n\t{/if}\n\t{#if gradio.props.buttons?.length}\n\t\t<IconButtonWrapper>\n\t\t\t{#if gradio.props.buttons?.includes(\"export\")}\n\t\t\t\t<IconButton Icon={Download} label=\"Export\" on:click={export_chart} />\n\t\t\t{/if}\n\t\t\t{#if gradio.props.buttons?.includes(\"fullscreen\")}\n\t\t\t\t<FullscreenButton\n\t\t\t\t\t{fullscreen}\n\t\t\t\t\ton:fullscreen={({ detail }) => {\n\t\t\t\t\t\tfullscreen = detail;\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t</IconButtonWrapper>\n\t{/if}\n\t<BlockTitle show_label={gradio.props.show_label} info={undefined}\n\t\t>{gradio.props.label}</BlockTitle\n\t>\n\n\t{#if gradio.props.value && is_browser}\n\t\t<div bind:this={chart_element}></div>\n\n\t\t{#if gradio.props.caption}\n\t\t\t<p class=\"caption\">{gradio.props.caption}</p>\n\t\t{/if}\n\t{:else}\n\t\t<Empty unpadded_box={true}><LabelIcon /></Empty>\n\t{/if}\n</Block>\n\n<style>\n\tdiv {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\t:global(#vg-tooltip-element) {\n\t\tfont-family: var(--font) !important;\n\t\tfont-size: var(--text-xs) !important;\n\t\tbox-shadow: none !important;\n\t\tbackground-color: var(--block-background-fill) !important;\n\t\tborder: 1px solid var(--border-color-primary) !important;\n\t\tcolor: var(--body-text-color) !important;\n\t}\n\t:global(#vg-tooltip-element .key) {\n\t\tcolor: var(--body-text-color-subdued) !important;\n\t}\n\t.caption {\n\t\tpadding: 0 4px;\n\t\tmargin: 0;\n\t\ttext-align: center;\n\t}\n</style>\n"],"file":"Index-BBOO1l3e.js"}
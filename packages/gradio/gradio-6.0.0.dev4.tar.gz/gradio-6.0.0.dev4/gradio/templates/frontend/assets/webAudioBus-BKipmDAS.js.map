{"version":3,"file":"webAudioBus-BKipmDAS.js","sources":["../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/AudioV2/abstractAudio/audioBus.js","../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/AudioV2/webAudio/webAudioBus.js"],"sourcesContent":["import { AbstractAudioBus } from \"./abstractAudioBus.js\";\n/**\n * Abstract class for an audio bus that has spatial audio and stereo output capabilities.\n *\n * Instances of this class can be connected to other audio buses.\n *\n * Audio buses are created by the {@link CreateAudioBusAsync} function.\n */\nexport class AudioBus extends AbstractAudioBus {\n    constructor(name, engine) {\n        super(name, engine);\n        this._outBus = null;\n        this._onOutBusDisposed = () => {\n            this.outBus = this.engine.defaultMainBus;\n        };\n    }\n    /**\n     * The output bus of the audio bus. Defaults to the audio engine's default main bus.\n     */\n    get outBus() {\n        return this._outBus;\n    }\n    set outBus(outBus) {\n        if (this._outBus === outBus) {\n            return;\n        }\n        if (this._outBus) {\n            this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed);\n            if (!this._disconnect(this._outBus)) {\n                throw new Error(\"Disconnect failed\");\n            }\n        }\n        this._outBus = outBus;\n        if (this._outBus) {\n            this._outBus.onDisposeObservable.add(this._onOutBusDisposed);\n            if (!this._connect(this._outBus)) {\n                throw new Error(\"Connect failed\");\n            }\n        }\n    }\n    /**\n     * Releases associated resources.\n     */\n    dispose() {\n        super.dispose();\n        this._outBus = null;\n    }\n}\n//# sourceMappingURL=audioBus.js.map","import { AudioBus } from \"../abstractAudio/audioBus.js\";\nimport { _HasSpatialAudioOptions } from \"../abstractAudio/subProperties/abstractSpatialAudio.js\";\nimport { _StereoAudio } from \"../abstractAudio/subProperties/stereoAudio.js\";\nimport { _WebAudioBusAndSoundSubGraph } from \"./subNodes/webAudioBusAndSoundSubGraph.js\";\nimport { _SpatialWebAudio } from \"./subProperties/spatialWebAudio.js\";\n/** @internal */\nexport class _WebAudioBus extends AudioBus {\n    /** @internal */\n    constructor(name, engine, options) {\n        super(name, engine);\n        this._spatial = null;\n        this._spatialAutoUpdate = true;\n        this._spatialMinUpdateTime = 0;\n        this._stereo = null;\n        if (typeof options.spatialAutoUpdate === \"boolean\") {\n            this._spatialAutoUpdate = options.spatialAutoUpdate;\n        }\n        if (typeof options.spatialMinUpdateTime === \"number\") {\n            this._spatialMinUpdateTime = options.spatialMinUpdateTime;\n        }\n        this._subGraph = new _WebAudioBus._SubGraph(this);\n    }\n    /** @internal */\n    async _initAsync(options) {\n        if (options.outBus) {\n            this.outBus = options.outBus;\n        }\n        else {\n            await this.engine.isReadyPromise;\n            this.outBus = this.engine.defaultMainBus;\n        }\n        await this._subGraph.initAsync(options);\n        if (_HasSpatialAudioOptions(options)) {\n            this._initSpatialProperty();\n        }\n        this.engine._addNode(this);\n    }\n    /** @internal */\n    dispose() {\n        super.dispose();\n        this._spatial = null;\n        this._stereo = null;\n        this.engine._removeNode(this);\n    }\n    /** @internal */\n    get _inNode() {\n        return this._subGraph._inNode;\n    }\n    /** @internal */\n    get _outNode() {\n        return this._subGraph._outNode;\n    }\n    /** @internal */\n    get spatial() {\n        if (this._spatial) {\n            return this._spatial;\n        }\n        return this._initSpatialProperty();\n    }\n    /** @internal */\n    get stereo() {\n        return this._stereo ?? (this._stereo = new _StereoAudio(this._subGraph));\n    }\n    /** @internal */\n    getClassName() {\n        return \"_WebAudioBus\";\n    }\n    _connect(node) {\n        const connected = super._connect(node);\n        if (!connected) {\n            return false;\n        }\n        if (node._inNode) {\n            this._outNode?.connect(node._inNode);\n        }\n        return true;\n    }\n    _disconnect(node) {\n        const disconnected = super._disconnect(node);\n        if (!disconnected) {\n            return false;\n        }\n        if (node._inNode) {\n            this._outNode?.disconnect(node._inNode);\n        }\n        return true;\n    }\n    _initSpatialProperty() {\n        if (!this._spatial) {\n            this._spatial = new _SpatialWebAudio(this._subGraph, this._spatialAutoUpdate, this._spatialMinUpdateTime);\n        }\n        return this._spatial;\n    }\n}\n_WebAudioBus._SubGraph = class extends _WebAudioBusAndSoundSubGraph {\n    get _downstreamNodes() {\n        return this._owner._downstreamNodes ?? null;\n    }\n    get _upstreamNodes() {\n        return this._owner._upstreamNodes ?? null;\n    }\n};\n//# sourceMappingURL=webAudioBus.js.map"],"names":["AudioBus","AbstractAudioBus","name","engine","outBus","_WebAudioBus","options","_HasSpatialAudioOptions","_StereoAudio","node","_SpatialWebAudio","_WebAudioBusAndSoundSubGraph"],"mappings":"+PAQO,MAAMA,UAAiBC,CAAiB,CAC3C,YAAYC,EAAMC,EAAQ,CACtB,MAAMD,EAAMC,CAAM,EAClB,KAAK,QAAU,KACf,KAAK,kBAAoB,IAAM,CAC3B,KAAK,OAAS,KAAK,OAAO,cAC9B,CACJ,CAIA,IAAI,QAAS,CACT,OAAO,KAAK,OAChB,CACA,IAAI,OAAOC,EAAQ,CACf,GAAI,KAAK,UAAYA,EAGrB,IAAI,KAAK,UACL,KAAK,QAAQ,oBAAoB,eAAe,KAAK,iBAAiB,EAClE,CAAC,KAAK,YAAY,KAAK,OAAO,GAC9B,MAAM,IAAI,MAAM,mBAAmB,EAI3C,GADA,KAAK,QAAUA,EACX,KAAK,UACL,KAAK,QAAQ,oBAAoB,IAAI,KAAK,iBAAiB,EACvD,CAAC,KAAK,SAAS,KAAK,OAAO,GAC3B,MAAM,IAAI,MAAM,gBAAgB,EAG5C,CAIA,SAAU,CACN,MAAM,QAAO,EACb,KAAK,QAAU,IACnB,CACJ,CCzCO,MAAMC,UAAqBL,CAAS,CAEvC,YAAYE,EAAMC,EAAQG,EAAS,CAC/B,MAAMJ,EAAMC,CAAM,EAClB,KAAK,SAAW,KAChB,KAAK,mBAAqB,GAC1B,KAAK,sBAAwB,EAC7B,KAAK,QAAU,KACX,OAAOG,EAAQ,mBAAsB,YACrC,KAAK,mBAAqBA,EAAQ,mBAElC,OAAOA,EAAQ,sBAAyB,WACxC,KAAK,sBAAwBA,EAAQ,sBAEzC,KAAK,UAAY,IAAID,EAAa,UAAU,IAAI,CACpD,CAEA,MAAM,WAAWC,EAAS,CAClBA,EAAQ,OACR,KAAK,OAASA,EAAQ,QAGtB,MAAM,KAAK,OAAO,eAClB,KAAK,OAAS,KAAK,OAAO,gBAE9B,MAAM,KAAK,UAAU,UAAUA,CAAO,EAClCC,EAAwBD,CAAO,GAC/B,KAAK,qBAAoB,EAE7B,KAAK,OAAO,SAAS,IAAI,CAC7B,CAEA,SAAU,CACN,MAAM,QAAO,EACb,KAAK,SAAW,KAChB,KAAK,QAAU,KACf,KAAK,OAAO,YAAY,IAAI,CAChC,CAEA,IAAI,SAAU,CACV,OAAO,KAAK,UAAU,OAC1B,CAEA,IAAI,UAAW,CACX,OAAO,KAAK,UAAU,QAC1B,CAEA,IAAI,SAAU,CACV,OAAI,KAAK,SACE,KAAK,SAET,KAAK,qBAAoB,CACpC,CAEA,IAAI,QAAS,CACT,OAAO,KAAK,UAAY,KAAK,QAAU,IAAIE,EAAa,KAAK,SAAS,EAC1E,CAEA,cAAe,CACX,MAAO,cACX,CACA,SAASC,EAAM,CAEX,OADkB,MAAM,SAASA,CAAI,GAIjCA,EAAK,SACL,KAAK,UAAU,QAAQA,EAAK,OAAO,EAEhC,IALI,EAMf,CACA,YAAYA,EAAM,CAEd,OADqB,MAAM,YAAYA,CAAI,GAIvCA,EAAK,SACL,KAAK,UAAU,WAAWA,EAAK,OAAO,EAEnC,IALI,EAMf,CACA,sBAAuB,CACnB,OAAK,KAAK,WACN,KAAK,SAAW,IAAIC,EAAiB,KAAK,UAAW,KAAK,mBAAoB,KAAK,qBAAqB,GAErG,KAAK,QAChB,CACJ,CACAL,EAAa,UAAY,cAAcM,CAA6B,CAChE,IAAI,kBAAmB,CACnB,OAAO,KAAK,OAAO,kBAAoB,IAC3C,CACA,IAAI,gBAAiB,CACjB,OAAO,KAAK,OAAO,gBAAkB,IACzC,CACJ","x_google_ignoreList":[0,1]}
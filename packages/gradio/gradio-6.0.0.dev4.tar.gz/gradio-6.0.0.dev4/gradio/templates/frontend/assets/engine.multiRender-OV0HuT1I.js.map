{"version":3,"file":"engine.multiRender-OV0HuT1I.js","sources":["../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/Engines/Extensions/engine.multiRender.js"],"sourcesContent":["import { InternalTexture } from \"../../Materials/Textures/internalTexture.js\";\nimport { Logger } from \"../../Misc/logger.js\";\n\nimport { ThinEngine } from \"../thinEngine.js\";\nThinEngine.prototype.restoreSingleAttachment = function () {\n    const gl = this._gl;\n    this.bindAttachments([gl.BACK]);\n};\nThinEngine.prototype.restoreSingleAttachmentForRenderTarget = function () {\n    const gl = this._gl;\n    this.bindAttachments([gl.COLOR_ATTACHMENT0]);\n};\nThinEngine.prototype.buildTextureLayout = function (textureStatus, backBufferLayout = false) {\n    const gl = this._gl;\n    const result = [];\n    if (backBufferLayout) {\n        result.push(gl.BACK);\n    }\n    else {\n        for (let i = 0; i < textureStatus.length; i++) {\n            if (textureStatus[i]) {\n                result.push(gl[\"COLOR_ATTACHMENT\" + i]);\n            }\n            else {\n                result.push(gl.NONE);\n            }\n        }\n    }\n    return result;\n};\nThinEngine.prototype.bindAttachments = function (attachments) {\n    const gl = this._gl;\n    gl.drawBuffers(attachments);\n};\nThinEngine.prototype.unBindMultiColorAttachmentFramebuffer = function (rtWrapper, disableGenerateMipMaps = false, onBeforeUnbind) {\n    this._currentRenderTarget = null;\n    if (!rtWrapper.disableAutomaticMSAAResolve) {\n        this.resolveMultiFramebuffer(rtWrapper);\n    }\n    if (!disableGenerateMipMaps) {\n        this.generateMipMapsMultiFramebuffer(rtWrapper);\n    }\n    if (onBeforeUnbind) {\n        if (rtWrapper._MSAAFramebuffer) {\n            // Bind the correct framebuffer\n            this._bindUnboundFramebuffer(rtWrapper._framebuffer);\n        }\n        onBeforeUnbind();\n    }\n    this._bindUnboundFramebuffer(null);\n};\nThinEngine.prototype.createMultipleRenderTarget = function (size, options, initializeBuffers = true) {\n    let generateMipMaps = false;\n    let generateDepthBuffer = true;\n    let generateStencilBuffer = false;\n    let generateDepthTexture = false;\n    let depthTextureFormat = undefined;\n    let textureCount = 1;\n    let samples = 1;\n    const defaultType = 0;\n    const defaultSamplingMode = 3;\n    const defaultUseSRGBBuffer = false;\n    const defaultFormat = 5;\n    const defaultTarget = 3553;\n    let types = [];\n    let samplingModes = [];\n    let useSRGBBuffers = [];\n    let formats = [];\n    let targets = [];\n    let faceIndex = [];\n    let layerIndex = [];\n    let layers = [];\n    let labels = [];\n    let dontCreateTextures = false;\n    const rtWrapper = this._createHardwareRenderTargetWrapper(true, false, size);\n    if (options !== undefined) {\n        generateMipMaps = options.generateMipMaps === undefined ? false : options.generateMipMaps;\n        generateDepthBuffer = options.generateDepthBuffer === undefined ? true : options.generateDepthBuffer;\n        generateStencilBuffer = options.generateStencilBuffer === undefined ? false : options.generateStencilBuffer;\n        generateDepthTexture = options.generateDepthTexture === undefined ? false : options.generateDepthTexture;\n        textureCount = options.textureCount ?? 1;\n        samples = options.samples ?? samples;\n        types = options.types || types;\n        samplingModes = options.samplingModes || samplingModes;\n        useSRGBBuffers = options.useSRGBBuffers || useSRGBBuffers;\n        formats = options.formats || formats;\n        targets = options.targetTypes || targets;\n        faceIndex = options.faceIndex || faceIndex;\n        layerIndex = options.layerIndex || layerIndex;\n        layers = options.layerCounts || layers;\n        labels = options.labels || labels;\n        dontCreateTextures = options.dontCreateTextures ?? false;\n        if (this.webGLVersion > 1 &&\n            (options.depthTextureFormat === 13 ||\n                options.depthTextureFormat === 17 ||\n                options.depthTextureFormat === 16 ||\n                options.depthTextureFormat === 14 ||\n                options.depthTextureFormat === 18)) {\n            depthTextureFormat = options.depthTextureFormat;\n        }\n    }\n    if (depthTextureFormat === undefined) {\n        depthTextureFormat = generateStencilBuffer ? 13 : 14;\n    }\n    const gl = this._gl;\n    // Create the framebuffer\n    const currentFramebuffer = this._currentFramebuffer;\n    const framebuffer = gl.createFramebuffer();\n    this._bindUnboundFramebuffer(framebuffer);\n    const width = size.width ?? size;\n    const height = size.height ?? size;\n    const textures = [];\n    const attachments = [];\n    const useStencilTexture = this.webGLVersion > 1 &&\n        (depthTextureFormat === 13 ||\n            depthTextureFormat === 17 ||\n            depthTextureFormat === 18);\n    rtWrapper.label = options?.label ?? \"MultiRenderTargetWrapper\";\n    rtWrapper._framebuffer = framebuffer;\n    rtWrapper._generateDepthBuffer = generateDepthTexture || generateDepthBuffer;\n    rtWrapper._generateStencilBuffer = generateDepthTexture ? useStencilTexture : generateStencilBuffer;\n    rtWrapper._depthStencilBuffer = this._setupFramebufferDepthAttachments(rtWrapper._generateStencilBuffer, rtWrapper._generateDepthBuffer, width, height, 1, depthTextureFormat);\n    rtWrapper._attachments = attachments;\n    for (let i = 0; i < textureCount; i++) {\n        let samplingMode = samplingModes[i] || defaultSamplingMode;\n        let type = types[i] || defaultType;\n        let useSRGBBuffer = useSRGBBuffers[i] || defaultUseSRGBBuffer;\n        const format = formats[i] || defaultFormat;\n        const target = targets[i] || defaultTarget;\n        const layerCount = layers[i] ?? 1;\n        if (type === 1 && !this._caps.textureFloatLinearFiltering) {\n            // if floating point linear (gl.FLOAT) then force to NEAREST_SAMPLINGMODE\n            samplingMode = 1;\n        }\n        else if (type === 2 && !this._caps.textureHalfFloatLinearFiltering) {\n            // if floating point linear (HALF_FLOAT) then force to NEAREST_SAMPLINGMODE\n            samplingMode = 1;\n        }\n        const filters = this._getSamplingParameters(samplingMode, generateMipMaps);\n        if (type === 1 && !this._caps.textureFloat) {\n            type = 0;\n            Logger.Warn(\"Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type\");\n        }\n        useSRGBBuffer = useSRGBBuffer && this._caps.supportSRGBBuffers && (this.webGLVersion > 1 || this.isWebGPU);\n        const isWebGL2 = this.webGLVersion > 1;\n        const attachment = gl[isWebGL2 ? \"COLOR_ATTACHMENT\" + i : \"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n        attachments.push(attachment);\n        if (target === -1 || dontCreateTextures) {\n            continue;\n        }\n        const texture = new InternalTexture(this, 6 /* InternalTextureSource.MultiRenderTarget */);\n        textures[i] = texture;\n        gl.activeTexture(gl[\"TEXTURE\" + i]);\n        gl.bindTexture(target, texture._hardwareTexture.underlyingResource);\n        gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, filters.mag);\n        gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, filters.min);\n        gl.texParameteri(target, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(target, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        const internalSizedFormat = this._getRGBABufferInternalSizedFormat(type, format, useSRGBBuffer);\n        const internalFormat = this._getInternalFormat(format);\n        const webGLTextureType = this._getWebGLTextureType(type);\n        if (isWebGL2 && (target === 35866 || target === 32879)) {\n            if (target === 35866) {\n                texture.is2DArray = true;\n            }\n            else {\n                texture.is3D = true;\n            }\n            texture.baseDepth = texture.depth = layerCount;\n            gl.texImage3D(target, 0, internalSizedFormat, width, height, layerCount, 0, internalFormat, webGLTextureType, null);\n        }\n        else if (target === 34067) {\n            // We have to generate all faces to complete the framebuffer\n            for (let i = 0; i < 6; i++) {\n                gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, internalSizedFormat, width, height, 0, internalFormat, webGLTextureType, null);\n            }\n            texture.isCube = true;\n        }\n        else {\n            gl.texImage2D(gl.TEXTURE_2D, 0, internalSizedFormat, width, height, 0, internalFormat, webGLTextureType, null);\n        }\n        if (generateMipMaps) {\n            gl.generateMipmap(target);\n        }\n        // Unbind\n        this._bindTextureDirectly(target, null);\n        texture.baseWidth = width;\n        texture.baseHeight = height;\n        texture.width = width;\n        texture.height = height;\n        texture.isReady = true;\n        texture.samples = 1;\n        texture.generateMipMaps = generateMipMaps;\n        texture.samplingMode = samplingMode;\n        texture.type = type;\n        texture._useSRGBBuffer = useSRGBBuffer;\n        texture.format = format;\n        texture.label = labels[i] ?? rtWrapper.label + \"-Texture\" + i;\n        this._internalTexturesCache.push(texture);\n    }\n    if (generateDepthTexture && this._caps.depthTextureExtension && !dontCreateTextures) {\n        // Depth texture\n        const depthTexture = new InternalTexture(this, 14 /* InternalTextureSource.Depth */);\n        let depthTextureType = 5;\n        let glDepthTextureInternalFormat = gl.DEPTH_COMPONENT16;\n        let glDepthTextureFormat = gl.DEPTH_COMPONENT;\n        let glDepthTextureType = gl.UNSIGNED_SHORT;\n        let glDepthTextureAttachment = gl.DEPTH_ATTACHMENT;\n        if (this.webGLVersion < 2) {\n            glDepthTextureInternalFormat = gl.DEPTH_COMPONENT;\n        }\n        else {\n            if (depthTextureFormat === 14) {\n                depthTextureType = 1;\n                glDepthTextureType = gl.FLOAT;\n                glDepthTextureInternalFormat = gl.DEPTH_COMPONENT32F;\n            }\n            else if (depthTextureFormat === 18) {\n                depthTextureType = 0;\n                glDepthTextureType = gl.FLOAT_32_UNSIGNED_INT_24_8_REV;\n                glDepthTextureInternalFormat = gl.DEPTH32F_STENCIL8;\n                glDepthTextureFormat = gl.DEPTH_STENCIL;\n                glDepthTextureAttachment = gl.DEPTH_STENCIL_ATTACHMENT;\n            }\n            else if (depthTextureFormat === 16) {\n                depthTextureType = 0;\n                glDepthTextureType = gl.UNSIGNED_INT;\n                glDepthTextureInternalFormat = gl.DEPTH_COMPONENT24;\n                glDepthTextureAttachment = gl.DEPTH_ATTACHMENT;\n            }\n            else if (depthTextureFormat === 13 || depthTextureFormat === 17) {\n                depthTextureType = 12;\n                glDepthTextureType = gl.UNSIGNED_INT_24_8;\n                glDepthTextureInternalFormat = gl.DEPTH24_STENCIL8;\n                glDepthTextureFormat = gl.DEPTH_STENCIL;\n                glDepthTextureAttachment = gl.DEPTH_STENCIL_ATTACHMENT;\n            }\n        }\n        this._bindTextureDirectly(gl.TEXTURE_2D, depthTexture, true);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.texImage2D(gl.TEXTURE_2D, 0, glDepthTextureInternalFormat, width, height, 0, glDepthTextureFormat, glDepthTextureType, null);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, glDepthTextureAttachment, gl.TEXTURE_2D, depthTexture._hardwareTexture.underlyingResource, 0);\n        this._bindTextureDirectly(gl.TEXTURE_2D, null);\n        rtWrapper._depthStencilTexture = depthTexture;\n        rtWrapper._depthStencilTextureWithStencil = useStencilTexture;\n        depthTexture.baseWidth = width;\n        depthTexture.baseHeight = height;\n        depthTexture.width = width;\n        depthTexture.height = height;\n        depthTexture.isReady = true;\n        depthTexture.samples = 1;\n        depthTexture.generateMipMaps = generateMipMaps;\n        depthTexture.samplingMode = 1;\n        depthTexture.format = depthTextureFormat;\n        depthTexture.type = depthTextureType;\n        depthTexture.label = rtWrapper.label + \"-DepthStencil\";\n        textures[textureCount] = depthTexture;\n        this._internalTexturesCache.push(depthTexture);\n    }\n    rtWrapper.setTextures(textures);\n    if (initializeBuffers) {\n        gl.drawBuffers(attachments);\n    }\n    this._bindUnboundFramebuffer(currentFramebuffer);\n    rtWrapper.setLayerAndFaceIndices(layerIndex, faceIndex);\n    this.resetTextureCache();\n    if (!dontCreateTextures) {\n        this.updateMultipleRenderTargetTextureSampleCount(rtWrapper, samples, initializeBuffers);\n    }\n    else if (samples > 1) {\n        const framebuffer = gl.createFramebuffer();\n        if (!framebuffer) {\n            throw new Error(\"Unable to create multi sampled framebuffer\");\n        }\n        rtWrapper._samples = samples;\n        rtWrapper._MSAAFramebuffer = framebuffer;\n        if (textureCount > 0 && initializeBuffers) {\n            this._bindUnboundFramebuffer(framebuffer);\n            gl.drawBuffers(attachments);\n            this._bindUnboundFramebuffer(currentFramebuffer);\n        }\n    }\n    return rtWrapper;\n};\nThinEngine.prototype.updateMultipleRenderTargetTextureSampleCount = function (rtWrapper, samples, initializeBuffers = true) {\n    if (this.webGLVersion < 2 || !rtWrapper) {\n        return 1;\n    }\n    if (rtWrapper.samples === samples) {\n        return samples;\n    }\n    const gl = this._gl;\n    samples = Math.min(samples, this.getCaps().maxMSAASamples);\n    // Dispose previous render buffers\n    if (rtWrapper._depthStencilBuffer) {\n        gl.deleteRenderbuffer(rtWrapper._depthStencilBuffer);\n        rtWrapper._depthStencilBuffer = null;\n    }\n    if (rtWrapper._MSAAFramebuffer) {\n        gl.deleteFramebuffer(rtWrapper._MSAAFramebuffer);\n        rtWrapper._MSAAFramebuffer = null;\n    }\n    const count = rtWrapper._attachments.length; // We do it this way instead of rtWrapper.textures.length to avoid taking into account the depth/stencil texture, in case it has been created\n    for (let i = 0; i < count; i++) {\n        const texture = rtWrapper.textures[i];\n        const hardwareTexture = texture._hardwareTexture;\n        hardwareTexture?.releaseMSAARenderBuffers();\n    }\n    if (samples > 1 && typeof gl.renderbufferStorageMultisample === \"function\") {\n        const framebuffer = gl.createFramebuffer();\n        if (!framebuffer) {\n            throw new Error(\"Unable to create multi sampled framebuffer\");\n        }\n        rtWrapper._MSAAFramebuffer = framebuffer;\n        this._bindUnboundFramebuffer(framebuffer);\n        const attachments = [];\n        for (let i = 0; i < count; i++) {\n            const texture = rtWrapper.textures[i];\n            const hardwareTexture = texture._hardwareTexture;\n            const attachment = gl[this.webGLVersion > 1 ? \"COLOR_ATTACHMENT\" + i : \"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n            const colorRenderbuffer = this._createRenderBuffer(texture.width, texture.height, samples, -1 /* not used */, this._getRGBABufferInternalSizedFormat(texture.type, texture.format, texture._useSRGBBuffer), attachment);\n            if (!colorRenderbuffer) {\n                throw new Error(\"Unable to create multi sampled framebuffer\");\n            }\n            hardwareTexture.addMSAARenderBuffer(colorRenderbuffer);\n            texture.samples = samples;\n            attachments.push(attachment);\n        }\n        if (initializeBuffers) {\n            gl.drawBuffers(attachments);\n        }\n    }\n    else {\n        this._bindUnboundFramebuffer(rtWrapper._framebuffer);\n    }\n    const depthFormat = rtWrapper._depthStencilTexture ? rtWrapper._depthStencilTexture.format : undefined;\n    rtWrapper._depthStencilBuffer = this._setupFramebufferDepthAttachments(rtWrapper._generateStencilBuffer, rtWrapper._generateDepthBuffer, rtWrapper.width, rtWrapper.height, samples, depthFormat);\n    this._bindUnboundFramebuffer(null);\n    rtWrapper._samples = samples;\n    return samples;\n};\nThinEngine.prototype.generateMipMapsMultiFramebuffer = function (texture) {\n    const rtWrapper = texture;\n    const gl = this._gl;\n    if (!rtWrapper.isMulti) {\n        return;\n    }\n    for (let i = 0; i < rtWrapper._attachments.length; i++) {\n        const texture = rtWrapper.textures[i];\n        if (texture?.generateMipMaps && !texture?.isCube && !texture?.is3D) {\n            this._bindTextureDirectly(gl.TEXTURE_2D, texture, true);\n            gl.generateMipmap(gl.TEXTURE_2D);\n            this._bindTextureDirectly(gl.TEXTURE_2D, null);\n        }\n    }\n};\nThinEngine.prototype.resolveMultiFramebuffer = function (texture) {\n    const rtWrapper = texture;\n    const gl = this._gl;\n    if (!rtWrapper._MSAAFramebuffer || !rtWrapper.isMulti) {\n        return;\n    }\n    let bufferBits = rtWrapper.resolveMSAAColors ? gl.COLOR_BUFFER_BIT : 0;\n    bufferBits |= rtWrapper._generateDepthBuffer && rtWrapper.resolveMSAADepth ? gl.DEPTH_BUFFER_BIT : 0;\n    bufferBits |= rtWrapper._generateStencilBuffer && rtWrapper.resolveMSAAStencil ? gl.STENCIL_BUFFER_BIT : 0;\n    const attachments = rtWrapper._attachments;\n    const count = attachments.length;\n    gl.bindFramebuffer(gl.READ_FRAMEBUFFER, rtWrapper._MSAAFramebuffer);\n    gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, rtWrapper._framebuffer);\n    for (let i = 0; i < count; i++) {\n        const texture = rtWrapper.textures[i];\n        for (let j = 0; j < count; j++) {\n            attachments[j] = gl.NONE;\n        }\n        attachments[i] = gl[this.webGLVersion > 1 ? \"COLOR_ATTACHMENT\" + i : \"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n        gl.readBuffer(attachments[i]);\n        gl.drawBuffers(attachments);\n        gl.blitFramebuffer(0, 0, texture.width, texture.height, 0, 0, texture.width, texture.height, bufferBits, gl.NEAREST);\n    }\n    for (let i = 0; i < count; i++) {\n        attachments[i] = gl[this.webGLVersion > 1 ? \"COLOR_ATTACHMENT\" + i : \"COLOR_ATTACHMENT\" + i + \"_WEBGL\"];\n    }\n    gl.drawBuffers(attachments);\n    gl.bindFramebuffer(this._gl.FRAMEBUFFER, rtWrapper._MSAAFramebuffer);\n};\n//# sourceMappingURL=engine.multiRender.js.map"],"names":["ThinEngine","gl","textureStatus","backBufferLayout","result","attachments","rtWrapper","disableGenerateMipMaps","onBeforeUnbind","size","options","initializeBuffers","generateMipMaps","generateDepthBuffer","generateStencilBuffer","generateDepthTexture","depthTextureFormat","textureCount","samples","defaultType","defaultSamplingMode","defaultUseSRGBBuffer","defaultFormat","defaultTarget","types","samplingModes","useSRGBBuffers","formats","targets","faceIndex","layerIndex","layers","labels","dontCreateTextures","currentFramebuffer","framebuffer","width","height","textures","useStencilTexture","i","samplingMode","type","useSRGBBuffer","format","target","layerCount","filters","Logger","isWebGL2","attachment","texture","InternalTexture","internalSizedFormat","internalFormat","webGLTextureType","depthTexture","depthTextureType","glDepthTextureInternalFormat","glDepthTextureFormat","glDepthTextureType","glDepthTextureAttachment","count","hardwareTexture","colorRenderbuffer","depthFormat","bufferBits","j"],"mappings":"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","x_google_ignoreList":[0]}
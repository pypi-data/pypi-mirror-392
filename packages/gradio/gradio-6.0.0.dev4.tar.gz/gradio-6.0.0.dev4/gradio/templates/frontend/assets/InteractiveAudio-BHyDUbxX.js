const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./module-FFb15TvM.js","./module-BTkNA4K1.js","./module-8x-imyhh.js"])))=>i.map(i=>d[i]);
import{p as o,d as Pe,i as re,t as ot,u as st,e as ge,a as Ne,c as lt,j as dt,s as ut}from"./i18n-5O2R8uRh.js";import{p as je,R as Ve,l as oe,d as w,a as Ce,f as W,h as L,Q as M,r as B,t as le,b as I,c as Le,g as s,k as se,X as Se,U as we,i as e,ac as Ye,ai as et,m as R,j as m,s as U,e as ye,az as C,aY as ct,V as ke,aj as Ge,aB as vt}from"./index-bhUlIv2p.js";import{b as xe}from"./misc-BSG2QtlE.js";import{U as mt}from"./Upload-DUNHTCuE.js";import{M as Je}from"./ModifyUpload-BwV9897O.js";/* empty css                                             *//* empty css                                                        */import"./MarkdownCode.svelte_svelte_type_style_lang-ywXsGwHK.js";import{B as gt}from"./BlockLabel-B0lD-lMe.js";import{M as _t}from"./Music-D57NnSsG.js";import{S as ft}from"./SelectSource-BistOEG2.js";/* empty css                                                   */import{S as ht}from"./StreamingBar-C_AQhOWl.js";import{s as Ke,W as He,a as pt,p as Ze,A as wt}from"./AudioPlayer-DT9GOKRA.js";import{P as yt}from"./Trim-BNRWAQmZ.js";import{f as me}from"./utils.svelte-Baqu2V3e.js";import{S as bt}from"./Spinner-laNWWtqG.js";function Fe(V,t,r,i){return new(r||(r=Promise))((function(v,f){function u(_){try{y(i.next(_))}catch(d){f(d)}}function b(_){try{y(i.throw(_))}catch(d){f(d)}}function y(_){var d;_.done?v(_.value):(d=_.value,d instanceof r?d:new r((function(l){l(d)}))).then(u,b)}y((i=i.apply(V,[])).next())}))}class Rt{constructor(){this.listeners={},this.on=this.addEventListener,this.un=this.removeEventListener}addEventListener(t,r,i){if(this.listeners[t]||(this.listeners[t]=new Set),this.listeners[t].add(r),i?.once){const v=()=>{this.removeEventListener(t,v),this.removeEventListener(t,r)};return this.addEventListener(t,v),v}return()=>this.removeEventListener(t,r)}removeEventListener(t,r){var i;(i=this.listeners[t])===null||i===void 0||i.delete(r)}once(t,r){return this.on(t,r,{once:!0})}unAll(){this.listeners={}}emit(t,...r){this.listeners[t]&&this.listeners[t].forEach((i=>i(...r)))}}class xt extends Rt{constructor(t){super(),this.subscriptions=[],this.options=t}onInit(){}init(t){this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach((t=>t()))}}const kt=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"];class Be extends xt{constructor(t){var r;super(Object.assign(Object.assign({},t),{audioBitsPerSecond:(r=t.audioBitsPerSecond)!==null&&r!==void 0?r:128e3})),this.stream=null,this.mediaRecorder=null}static create(t){return new Be(t||{})}renderMicStream(t){const r=new AudioContext,i=r.createMediaStreamSource(t),v=r.createAnalyser();i.connect(v);const f=v.frequencyBinCount,u=new Float32Array(f),b=f/r.sampleRate;let y;const _=()=>{v.getFloatTimeDomainData(u),this.wavesurfer&&(this.wavesurfer.options.cursorWidth=0,this.wavesurfer.options.interact=!1,this.wavesurfer.load("",[u],b)),y=requestAnimationFrame(_)};return _(),()=>{cancelAnimationFrame(y),i?.disconnect(),r?.close()}}startMic(t){return Fe(this,void 0,void 0,(function*(){let r;try{r=yield navigator.mediaDevices.getUserMedia({audio:!t?.deviceId||{deviceId:t.deviceId}})}catch(v){throw new Error("Error accessing the microphone: "+v.message)}const i=this.renderMicStream(r);return this.subscriptions.push(this.once("destroy",i)),this.stream=r,r}))}stopMic(){this.stream&&(this.stream.getTracks().forEach((t=>t.stop())),this.stream=null,this.mediaRecorder=null)}startRecording(t){return Fe(this,void 0,void 0,(function*(){const r=this.stream||(yield this.startMic(t)),i=this.mediaRecorder||new MediaRecorder(r,{mimeType:this.options.mimeType||kt.find((f=>MediaRecorder.isTypeSupported(f))),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=i,this.stopRecording();const v=[];i.ondataavailable=f=>{f.data.size>0&&v.push(f.data)},i.onstop=()=>{var f;const u=new Blob(v,{type:i.mimeType});this.emit("record-end",u),this.options.renderRecordedAudio!==!1&&((f=this.wavesurfer)===null||f===void 0||f.load(URL.createObjectURL(u)))},i.start(),this.emit("record-start")}))}isRecording(){var t;return((t=this.mediaRecorder)===null||t===void 0?void 0:t.state)==="recording"}isPaused(){var t;return((t=this.mediaRecorder)===null||t===void 0?void 0:t.state)==="paused"}stopRecording(){var t;this.isRecording()&&((t=this.mediaRecorder)===null||t===void 0||t.stop())}pauseRecording(){var t;this.isRecording()&&((t=this.mediaRecorder)===null||t===void 0||t.pause(),this.emit("record-pause"))}resumeRecording(){var t;this.isPaused()&&((t=this.mediaRecorder)===null||t===void 0||t.resume(),this.emit("record-resume"))}static getAvailableAudioDevices(){return Fe(this,void 0,void 0,(function*(){return navigator.mediaDevices.enumerateDevices().then((t=>t.filter((r=>r.kind==="audioinput"))))}))}destroy(){super.destroy(),this.stopRecording(),this.stopMic()}}var Et=W("<option> </option>"),At=W("<option> </option>"),Dt=W('<select class="mic-select svelte-ym1wxn" aria-label="Select input device"><!></select>');function tt(V,t){je(t,!1);let r=o(t,"i18n",12),i=o(t,"micDevices",28,()=>[]);const v=Ve();oe(()=>w(r()),()=>{if(typeof window<"u")try{let d=[];Be.getAvailableAudioDevices().then(l=>{i(l),l.forEach(h=>{h.deviceId&&d.push(h)}),i(d)})}catch(d){throw d instanceof DOMException&&d.name=="NotAllowedError"&&v("error",r()("audio.allow_recording_access")),d}}),Ce();var f={get i18n(){return r()},set i18n(d){r(d),s()},get micDevices(){return i()},set micDevices(d){i(d),s()}};Pe();var u=Dt(),b=L(u);{var y=d=>{var l=Et(),h=L(l,!0);B(l),l.value=l.__value="",le(A=>se(h,A),[()=>(w(r()),M(()=>r()("audio.no_microphone")))]),I(d,l)},_=d=>{var l=Se(),h=we(l);ot(h,1,i,st,(A,x)=>{var k=At(),D=L(k,!0);B(k);var S={};le(()=>{se(D,(e(x),M(()=>e(x).label))),S!==(S=(e(x),M(()=>e(x).deviceId)))&&(k.value=(k.__value=(e(x),M(()=>e(x).deviceId)))??"")}),I(A,k)}),I(d,l)};re(b,d=>{w(i()),M(()=>i().length===0)?d(y):d(_,!1)})}return B(u),le(()=>u.disabled=(w(i()),M(()=>i().length===0))),I(V,u),Le(f)}var Mt=W('<time class="duration-button duration svelte-1xuh0j1"> </time>'),St=W('<div class="controls svelte-1xuh0j1"><div class="wrapper svelte-1xuh0j1"><button class="record record-button svelte-1xuh0j1"> </button> <button> </button> <button id="stop-paused" class="stop-button-paused svelte-1xuh0j1"> </button> <button aria-label="pause" class="pause-button svelte-1xuh0j1"><!></button> <button class="resume-button svelte-1xuh0j1"> </button> <!></div> <!></div>');function Pt(V,t){je(t,!1);let r=o(t,"record",12),i=o(t,"i18n",12),v=o(t,"recording",12,!1),f=R([]),u=R(),b=R(),y=R(),_=R(),d=R(),l=R(!1),h=o(t,"record_time",12),A=o(t,"show_recording_waveform",12),x=o(t,"timing",12,!1);const k=()=>{C(u,e(u).style.display="none"),C(_,e(_).style.display="flex"),C(b,e(b).style.display="block")},D=()=>{r().isPaused()&&(r().resumeRecording(),r().stopRecording()),r().stopMic(),C(u,e(u).style.display="flex"),C(_,e(_).style.display="none"),C(b,e(b).style.display="none"),C(u,e(u).disabled=!1)},S=()=>{C(b,e(b).style.display="none"),C(y,e(y).style.display="block"),C(_,e(_).style.display="none"),C(d,e(d).style.display="flex")},F=()=>{C(b,e(b).style.display="block"),C(y,e(y).style.display="none"),C(u,e(u).style.display="none"),C(_,e(_).style.display="flex"),C(d,e(d).style.display="none")};Ye(()=>{r().on("record-start",k),r().on("record-end",D),r().on("record-pause",S),r().on("record-resume",F)}),et(()=>{r().un("record-start",k),r().un("record-end",D),r().un("record-pause",S),r().un("record-resume",F)}),oe(()=>(w(v()),e(l),w(r())),()=>{v()&&!e(l)?r().startMic().then(()=>{r().startRecording(),m(l,!0)}):!v()&&e(l)&&(r().isPaused()&&r().resumeRecording(),r().stopRecording(),m(l,!1))}),Ce();var ne={get record(){return r()},set record(g){r(g),s()},get i18n(){return i()},set i18n(g){i(g),s()},get recording(){return v()},set recording(g){v(g),s()},get record_time(){return h()},set record_time(g){h(g),s()},get show_recording_waveform(){return A()},set show_recording_waveform(g){A(g),s()},get timing(){return x()},set timing(g){x(g),s()}};Pe();var q=St(),Y=L(q),z=L(Y),ae=L(z,!0);B(z),ge(z,g=>m(u,g),()=>e(u));var c=U(z,2),p=L(c,!0);B(c),ge(c,g=>m(_,g),()=>e(_));var O=U(c,2),K=L(O,!0);B(O),ge(O,g=>m(d,g),()=>e(d));var Z=U(O,2),$=L(Z);yt($),B(Z),ge(Z,g=>m(b,g),()=>e(b));var P=U(Z,2),E=L(P,!0);B(P),ge(P,g=>m(y,g),()=>e(y));var Q=U(P,2);{var X=g=>{var de=Mt(),he=L(de,!0);B(de),le(()=>se(he,h())),I(g,de)};re(Q,g=>{x()&&!A()&&g(X)})}B(Y);var ee=U(Y,2);return tt(ee,{get i18n(){return i()},get micDevices(){return e(f)},set micDevices(g){m(f,g)},$$legacy:!0}),B(q),le((g,de,he,be,_e)=>{se(ae,g),Ne(c,1,`stop-button ${de??""}`,"svelte-1xuh0j1"),se(p,he),se(K,be),se(E,_e)},[()=>(w(i()),M(()=>i()("audio.record"))),()=>(w(r()),M(()=>r().isPaused()?"stop-button-paused":"")),()=>(w(i()),M(()=>i()("audio.stop"))),()=>(w(i()),M(()=>i()("audio.stop"))),()=>(w(i()),M(()=>i()("audio.resume")))]),ye("click",z,()=>r().startRecording()),ye("click",c,()=>{r().isPaused()&&(r().resumeRecording(),r().stopRecording()),r().stopRecording()}),ye("click",O,()=>{r().isPaused()&&(r().resumeRecording(),r().stopRecording()),r().stopRecording()}),ye("click",Z,()=>r().pauseRecording()),ye("click",P,()=>r().resumeRecording()),I(V,q),Le(ne)}var jt=W('<time class="trim-duration svelte-j9q3sk"> </time>'),Lt=W('<time class="duration svelte-j9q3sk"> </time>'),Bt=W('<time class="duration svelte-j9q3sk">0:00</time>'),It=W('<div class="timestamps svelte-j9q3sk"><time class="time svelte-j9q3sk">0:00</time> <div><!> <!></div></div>'),Ut=W('<div class="component-wrapper svelte-j9q3sk"><div class="microphone svelte-j9q3sk" data-testid="microphone-waveform"></div> <div data-testid="recording-waveform"></div> <!> <!> <!></div>');function Tt(V,t){je(t,!1);let r=o(t,"mode",12),i=o(t,"i18n",12),v=o(t,"dispatch_blob",12),f=o(t,"waveform_settings",12),u=o(t,"waveform_options",28,()=>({show_recording_waveform:!0})),b=o(t,"handle_reset_value",12),y=o(t,"editable",12,!0),_=o(t,"recording",12,!1),d,l=R(),h=R(!1),A=R(),x=R(),k=R(),D=R(null),S=R(),F=R(),ne=R(),q=R(0),Y,z=R(!1),ae=R(0);const c=()=>{clearInterval(Y),Y=setInterval(()=>{ct(q)},1e3)},p=Ve();function O(){if(c(),m(z,!0),p("start_recording"),u().show_recording_waveform){let n=e(x);n&&(n.style.display="block")}}async function K(n){m(q,0),m(z,!1),clearInterval(Y);try{const j=await n.arrayBuffer(),ue=await new AudioContext({sampleRate:f().sampleRate}).decodeAudioData(j);ue&&await Ze(ue).then(async fe=>{await v()([fe],"change"),await v()([fe],"stop_recording")})}catch(j){console.error(j)}}let Z=R(!1);const $=()=>{e(x)&&C(x,e(x).innerHTML=""),d!==void 0&&d.destroy(),e(x)&&(d=He.create({...f(),normalize:!1,container:e(x)}),m(k,d.registerPlugin(Be.create())),e(k)?.on("record-end",K),e(k)?.on("record-start",O),e(k)?.on("record-pause",()=>{p("pause_recording"),clearInterval(Y)}),e(k)?.on("record-end",n=>{m(D,URL.createObjectURL(n));const j=e(x),ie=e(A);j&&(j.style.display="none"),ie&&e(D)&&(ie.innerHTML="",P())}),m(Z,!0))},P=()=>{let n=e(A);!e(D)||!n||m(l,He.create({container:n,url:e(D),...f()}))},E=async(n,j)=>{r("edit");const ie=e(l).getDecodedData();ie&&await Ze(ie,n,j).then(async ue=>{await v()([ue],"change"),await v()([ue],"stop_recording"),e(l).destroy(),P()}),p("edit")};Ye(()=>{$(),window.addEventListener("keydown",n=>{e(A)&&e(A).contains(document.activeElement)&&(n.key==="ArrowRight"?Ke(e(l),.1):n.key==="ArrowLeft"&&Ke(e(l),-.1))})}),oe(()=>e(k),()=>{e(k)?.on("record-resume",()=>{c()})}),oe(()=>(e(l),e(F),me),()=>{e(l)?.on("decode",n=>{m(ne,n),e(F)&&C(F,e(F).textContent=me(n))})}),oe(()=>(e(l),e(S),me),()=>{e(l)?.on("timeupdate",n=>e(S)&&C(S,e(S).textContent=me(n)))}),oe(()=>e(l),()=>{e(l)?.on("pause",()=>{p("pause"),m(h,!1)})}),oe(()=>e(l),()=>{e(l)?.on("play",()=>{p("play"),m(h,!0)})}),oe(()=>e(l),()=>{e(l)?.on("finish",()=>{p("stop"),m(h,!1)})}),Ce();var Q={get mode(){return r()},set mode(n){r(n),s()},get i18n(){return i()},set i18n(n){i(n),s()},get dispatch_blob(){return v()},set dispatch_blob(n){v(n),s()},get waveform_settings(){return f()},set waveform_settings(n){f(n),s()},get waveform_options(){return u()},set waveform_options(n){u(n),s()},get handle_reset_value(){return b()},set handle_reset_value(n){b(n),s()},get editable(){return y()},set editable(n){y(n),s()},get recording(){return _()},set recording(n){_(n),s()}};Pe();var X=Ut(),ee=L(X);ge(ee,n=>m(x,n),()=>e(x));var g=U(ee,2);ge(g,n=>m(A,n),()=>e(A));var de=U(g,2);{var he=n=>{var j=It(),ie=L(j);ge(ie,J=>m(S,J),()=>e(S));var ue=U(ie,2),fe=L(ue);{var qe=J=>{var te=jt(),pe=L(te,!0);B(te),le(Ee=>se(pe,Ee),[()=>(w(me),e(ae),M(()=>me(e(ae))))]),I(J,te)};re(fe,J=>{r()==="edit"&&e(ae)>0&&J(qe)})}var Ie=U(fe,2);{var ze=J=>{var te=Lt(),pe=L(te,!0);B(te),le(Ee=>se(pe,Ee),[()=>(w(me),e(q),M(()=>me(e(q))))]),I(J,te)},Ue=J=>{var te=Bt();ge(te,pe=>m(F,pe),()=>e(F)),I(J,te)};re(Ie,J=>{e(z)?J(ze):J(Ue,!1)})}B(ue),B(j),I(n,j)};re(de,n=>{e(z),e(D),w(u()),M(()=>(e(z)||e(D))&&u().show_recording_waveform)&&n(he)})}var be=U(de,2);{var _e=n=>{{let j=ke(()=>(w(me),e(q),M(()=>me(e(q)))));Pt(n,{get i18n(){return i()},get timing(){return e(z)},get recording(){return _()},get show_recording_waveform(){return w(u()),M(()=>u().show_recording_waveform)},get record_time(){return e(j)},get record(){return e(k)},set record(ie){m(k,ie)},$$legacy:!0})}};re(be,n=>{e(x)&&!e(D)&&e(Z)&&n(_e)})}var Qe=U(be,2);{var G=n=>{pt(n,{get container(){return e(A)},get playing(){return e(h)},get audio_duration(){return e(ne)},get i18n(){return i()},get editable(){return y()},interactive:!0,handle_trim_audio:E,show_redo:!0,get handle_reset_value(){return b()},get waveform_options(){return u()},get waveform(){return e(l)},set waveform(j){m(l,j)},get trimDuration(){return e(ae)},set trimDuration(j){m(ae,j)},get mode(){return r()},set mode(j){r(j)},$$legacy:!0})};re(Qe,n=>{e(l)&&e(D)&&n(G)})}return B(X),I(V,X),Le(Q)}var Ct=W('<div class="svelte-m6ymia"></div>'),qt=W('<button><span class="record-icon svelte-m6ymia"><span class="pinger svelte-m6ymia"></span> <span class="dot svelte-m6ymia"></span></span> </button>'),zt=W('<button class="spinner-button svelte-m6ymia"><div class="icon svelte-m6ymia"><!></div> </button>'),Ot=W('<button class="record-button svelte-m6ymia"><span class="record-icon svelte-m6ymia"><span class="dot svelte-m6ymia"></span></span> </button>'),Wt=W('<div class="mic-wrap svelte-m6ymia"><!> <div class="controls svelte-m6ymia"><!> <!></div></div>');function Ft(V,t){je(t,!1);let r=o(t,"recording",12,!1),i=o(t,"paused_recording",12,!1),v=o(t,"stop",12),f=o(t,"record",12),u=o(t,"i18n",12),b=o(t,"waveform_settings",12),y=o(t,"waveform_options",28,()=>({show_recording_waveform:!0})),_=o(t,"waiting",12,!1),d,l=R(),h=R(),A=R([]);Ye(()=>{x()});const x=()=>{d!==void 0&&d.destroy(),e(h)&&(d=He.create({...b(),normalize:!1,container:e(h)}),m(l,d.registerPlugin(Be.create())))};var k={get recording(){return r()},set recording(c){r(c),s()},get paused_recording(){return i()},set paused_recording(c){i(c),s()},get stop(){return v()},set stop(c){v(c),s()},get record(){return f()},set record(c){f(c),s()},get i18n(){return u()},set i18n(c){u(c),s()},get waveform_settings(){return b()},set waveform_settings(c){b(c),s()},get waveform_options(){return y()},set waveform_options(c){y(c),s()},get waiting(){return _()},set waiting(c){_(c),s()}};Pe();var D=Wt(),S=L(D);{var F=c=>{var p=Ct();let O;ge(p,K=>m(h,K),()=>e(h)),le(()=>O=lt(p,"",O,{display:r()?"block":"none"})),I(c,p)};re(S,c=>{w(y()),M(()=>y().show_recording_waveform)&&c(F)})}var ne=U(S,2),q=L(ne);{var Y=c=>{var p=qt(),O=U(L(p));B(p),le(K=>{Ne(p,1,dt(i()?"stop-button-paused":"stop-button"),"svelte-m6ymia"),se(O,` ${K??""}`)},[()=>(w(i()),w(u()),M(()=>i()?u()("audio.pause"):u()("audio.stop")))]),ye("click",p,()=>{e(l)?.stopMic(),v()()}),I(c,p)},z=c=>{var p=Se(),O=we(p);{var K=$=>{var P=zt(),E=L(P),Q=L(E);bt(Q),B(E);var X=U(E);B(P),le(ee=>se(X,` ${ee??""}`),[()=>(w(u()),M(()=>u()("audio.waiting")))]),ye("click",P,()=>{v()()}),I($,P)},Z=$=>{var P=Ot(),E=U(L(P));B(P),le(Q=>se(E,` ${Q??""}`),[()=>(w(u()),M(()=>u()("audio.record")))]),ye("click",P,()=>{e(l)?.startMic(),f()()}),I($,P)};re(O,$=>{r()&&_()?$(K):$(Z,!1)},!0)}I(c,p)};re(q,c=>{r()&&!_()?c(Y):c(z,!1)})}var ae=U(q,2);return tt(ae,{get i18n(){return u()},get micDevices(){return e(A)},set micDevices(c){m(A,c)},$$legacy:!0}),B(ne),B(D),I(V,D),Le(k)}let $e;async function Ht(){const{MediaRecorder:V,register:t}=await Ge(async()=>{const{MediaRecorder:i,register:v}=await import("./module-FFb15TvM.js");return{MediaRecorder:i,register:v}},__vite__mapDeps([0,1]),import.meta.url),{connect:r}=await Ge(async()=>{const{connect:i}=await import("./module-8x-imyhh.js");return{connect:i}},__vite__mapDeps([2,1]),import.meta.url);return t(await r()),$e=V,$e}var Nt=W("<!> <!>",1),Vt=W("<!> <!>",1),Yt=W("<!> <div><!> <!> <!></div>",1);function ur(V,t){je(t,!1);let r=o(t,"value",12,null),i=o(t,"subtitles",12,null),v=o(t,"label",12),f=o(t,"root",12),u=o(t,"loop",12),b=o(t,"show_label",12,!0),y=o(t,"buttons",28,()=>["download","share"]),_=o(t,"sources",28,()=>["microphone","upload"]),d=o(t,"pending",12,!1),l=o(t,"streaming",12,!1),h=o(t,"i18n",12),A=o(t,"waveform_settings",12),x=o(t,"trim_region_settings",28,()=>({})),k=o(t,"waveform_options",28,()=>({})),D=o(t,"dragging",12),S=o(t,"active_source",12),F=o(t,"handle_reset_value",12,()=>{}),ne=o(t,"editable",12,!0),q=o(t,"max_file_size",12,null),Y=o(t,"upload",12),z=o(t,"stream_handler",12),ae=o(t,"stream_every",12,.1),c=o(t,"uploading",12,!1),p=o(t,"recording",12,!1),O=o(t,"class_name",12,""),K=o(t,"upload_promise",12,null),Z=o(t,"initial_value",12,null),$=o(t,"time_limit",12,null),P=o(t,"stream_state",12,"closed"),E=R(),Q=R(""),X=R(void 0),ee=R([]),g=R(!1),de=!1,he;const be=44;let _e=[];typeof window<"u"&&l()&&Ht().then(a=>{he=a});const G=Ve(),n=async(a,T)=>{let ce=new File(a,"audio.wav");const Re=await vt([ce],T==="stream");Z(r()),r((await Y()(Re,f(),void 0,q()||void 0))?.filter(Boolean)[0]),G(T,r())};et(()=>{l()&&e(E)&&e(E).state!=="inactive"&&e(E).stop()});async function j(){let a;try{a=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(T){if(!navigator.mediaDevices){G("error",h()("audio.no_device_support"));return}if(T instanceof DOMException&&T.name=="NotAllowedError"){G("error",h()("audio.allow_recording_access"));return}throw T}a!=null&&(l()?(m(E,new he(a,{mimeType:"audio/wav"})),e(E).addEventListener("dataavailable",ie)):(m(E,new MediaRecorder(a)),e(E).addEventListener("dataavailable",T=>{_e.push(T.data)})),e(E).addEventListener("stop",async()=>{p(!1),await n(_e,"change"),await n(_e,"stop_recording"),_e=[]}),de=!0)}async function ie(a){let T=await a.data.arrayBuffer(),ce=new Uint8Array(T);if(e(X)||(m(X,new Uint8Array(T.slice(0,be))),ce=new Uint8Array(T.slice(be))),d())e(ee).push(ce);else{let Re=[e(X)].concat(e(ee),[ce]);if(!p()||P()==="waiting")return;n(Re,"stream"),m(ee,[])}}async function ue(){p(!0),G("start_recording"),de||await j(),m(X,void 0),l()&&e(E).state!="recording"&&e(E).start(ae()*1e3)}function fe(){G("change",null),G("clear"),m(Q,""),r(null)}function qe({detail:a}){r(a),G("change",a),G("upload",a)}async function Ie(){p(!1),l()&&(G("close_stream"),G("stop_recording"),e(E).stop(),d()&&m(g,!0),n(_e,"stop_recording"),G("clear"),m(Q,""))}oe(()=>w(D()),()=>{G("drag",D())}),oe(()=>(e(g),w(d()),e(X),e(ee)),()=>{if(e(g)&&d()===!1&&(m(g,!1),e(X)&&e(ee))){let a=[e(X)].concat(e(ee));m(ee,[]),n(a,"stream")}}),oe(()=>(w(p()),e(E)),()=>{!p()&&e(E)&&Ie()}),oe(()=>(w(p()),e(E)),()=>{p()&&e(E)&&ue()}),Ce();var ze={get value(){return r()},set value(a){r(a),s()},get subtitles(){return i()},set subtitles(a){i(a),s()},get label(){return v()},set label(a){v(a),s()},get root(){return f()},set root(a){f(a),s()},get loop(){return u()},set loop(a){u(a),s()},get show_label(){return b()},set show_label(a){b(a),s()},get buttons(){return y()},set buttons(a){y(a),s()},get sources(){return _()},set sources(a){_(a),s()},get pending(){return d()},set pending(a){d(a),s()},get streaming(){return l()},set streaming(a){l(a),s()},get i18n(){return h()},set i18n(a){h(a),s()},get waveform_settings(){return A()},set waveform_settings(a){A(a),s()},get trim_region_settings(){return x()},set trim_region_settings(a){x(a),s()},get waveform_options(){return k()},set waveform_options(a){k(a),s()},get dragging(){return D()},set dragging(a){D(a),s()},get active_source(){return S()},set active_source(a){S(a),s()},get handle_reset_value(){return F()},set handle_reset_value(a){F(a),s()},get editable(){return ne()},set editable(a){ne(a),s()},get max_file_size(){return q()},set max_file_size(a){q(a),s()},get upload(){return Y()},set upload(a){Y(a),s()},get stream_handler(){return z()},set stream_handler(a){z(a),s()},get stream_every(){return ae()},set stream_every(a){ae(a),s()},get uploading(){return c()},set uploading(a){c(a),s()},get recording(){return p()},set recording(a){p(a),s()},get class_name(){return O()},set class_name(a){O(a),s()},get upload_promise(){return K()},set upload_promise(a){K(a),s()},get initial_value(){return Z()},set initial_value(a){Z(a),s()},get time_limit(){return $()},set time_limit(a){$(a),s()},get stream_state(){return P()},set stream_state(a){P(a),s()}};Pe();var Ue=Yt(),J=we(Ue);{let a=ke(()=>S()==="upload"&&r()===null),T=ke(()=>(w(v()),w(h()),M(()=>v()||h()("audio.audio"))));gt(J,{get show_label(){return b()},get Icon(){return _t},get float(){return e(a)},get label(){return e(T)}})}var te=U(J,2),pe=L(te);ht(pe,{get time_limit(){return $()}});var Ee=U(pe,2);{var rt=a=>{var T=Se(),ce=we(T);{var Re=H=>{var De=Nt(),Te=we(De);Je(Te,{get i18n(){return h()},$$events:{clear:fe}});var Oe=U(Te,2);{var Me=N=>{{let ve=ke(()=>P()==="waiting");Ft(N,{record:ue,get recording(){return p()},stop:Ie,get i18n(){return h()},get waveform_settings(){return A()},get waveform_options(){return k()},get waiting(){return e(ve)}})}},We=N=>{Tt(N,{get i18n(){return h()},get editable(){return ne()},get recording(){return p()},dispatch_blob:n,get waveform_settings(){return A()},get waveform_options(){return k()},get handle_reset_value(){return F()},get mode(){return e(Q)},set mode(ve){m(Q,ve)},$$events:{start_recording(ve){xe.call(this,t,ve)},pause_recording(ve){xe.call(this,t,ve)},stop_recording(ve){xe.call(this,t,ve)}},$$legacy:!0})};re(Oe,N=>{l()?N(Me):N(We,!1)})}I(H,De)},Ae=H=>{var De=Se(),Te=we(De);{var Oe=Me=>{{let We=ke(()=>(w(h()),M(()=>h()("audio.drop_to_upload"))));mt(Me,{filetype:"audio/aac,audio/midi,audio/mpeg,audio/ogg,audio/wav,audio/x-wav,audio/opus,audio/webm,audio/flac,audio/vnd.rn-realaudio,audio/x-ms-wma,audio/x-aiff,audio/amr,audio/*",get root(){return f()},get max_file_size(){return q()},get upload(){return Y()},get stream_handler(){return z()},get aria_label(){return e(We)},get upload_promise(){return K()},set upload_promise(N){K(N)},get dragging(){return D()},set dragging(N){D(N)},get uploading(){return c()},set uploading(N){c(N)},$$events:{load:qe,error:({detail:N})=>G("error",N)},children:(N,ve)=>{var Xe=Se(),nt=we(Xe);ut(nt,t,"default",{},null),I(N,Xe)},$$slots:{default:!0},$$legacy:!0})}};re(Te,Me=>{S()==="upload"&&Me(Oe)},!0)}I(H,De)};re(ce,H=>{S()==="microphone"?H(Re):H(Ae,!1)})}I(a,T)},at=a=>{var T=Vt(),ce=we(T);{let Ae=ke(()=>(w(y()),w(r()),M(()=>y()===null||y().includes("download")?r().url:null)));Je(ce,{get i18n(){return h()},get download(){return e(Ae)},$$events:{clear:fe,edit:()=>m(Q,"edit")}})}var Re=U(ce,2);{let Ae=ke(()=>(w(i()),M(()=>Array.isArray(i())?i():i()?.url)));wt(Re,{get value(){return r()},get subtitles(){return e(Ae)},get label(){return v()},get i18n(){return h()},dispatch_blob:n,get waveform_settings(){return A()},get waveform_options(){return k()},get trim_region_settings(){return x()},get handle_reset_value(){return F()},get editable(){return ne()},get loop(){return u()},interactive:!0,get mode(){return e(Q)},set mode(H){m(Q,H)},$$events:{stop(H){xe.call(this,t,H)},play(H){xe.call(this,t,H)},pause(H){xe.call(this,t,H)},edit(H){xe.call(this,t,H)}},$$legacy:!0})}I(a,T)};re(Ee,a=>{r()===null||l()?a(rt):a(at,!1)})}var it=U(Ee,2);return ft(it,{get sources(){return _()},handle_clear:fe,get active_source(){return S()},set active_source(a){S(a)},$$legacy:!0}),B(te),le(()=>Ne(te,1,`audio-container ${O()??""}`,"svelte-ocxd3m")),I(V,Ue),Le(ze)}export{ur as I};
//# sourceMappingURL=InteractiveAudio-BHyDUbxX.js.map

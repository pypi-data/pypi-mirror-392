{"version":3,"file":"e9-3Q1ul.js","sources":["../../../../../../../audio/Index.svelte"],"sourcesContent":["<svelte:options accessors={true} />\n\n<script lang=\"ts\">\n\timport { tick } from \"svelte\";\n\timport { Gradio } from \"@gradio/utils\";\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\timport type { LoadingStatus } from \"@gradio/statustracker\";\n\timport { onMount } from \"svelte\";\n\n\timport StaticAudio from \"./static/StaticAudio.svelte\";\n\timport InteractiveAudio from \"./interactive/InteractiveAudio.svelte\";\n\timport { Block, UploadText } from \"@gradio/atoms\";\n\timport type { AudioEvents, AudioProps } from \"./shared/types\";\n\n\tlet props = $props();\n\tlet upload_promise = $state<Promise<any>>();\n\n\tprops.props.stream_every = 0.1; // default to 0.1s stream interval\n\n\tclass AudioGradio extends Gradio<AudioEvents, AudioProps> {\n\t\tasync get_data() {\n\t\t\tif (upload_promise) {\n\t\t\t\tawait upload_promise;\n\t\t\t\tawait tick();\n\t\t\t}\n\n\t\t\tconst data = await super.get_data();\n\n\t\t\treturn data;\n\t\t}\n\t}\n\n\tconst gradio = new AudioGradio(props);\n\tlet label = $derived(gradio.shared.label || gradio.i18n(\"audio.audio\"));\n\n\t// let uploading = $state(false);\n\tlet active_source = $derived.by(() =>\n\t\tgradio.props.sources ? gradio.props.sources[0] : null\n\t);\n\tlet initial_value = gradio.props.value;\n\n\tconst handle_reset_value = (): void => {\n\t\tif (initial_value === null || gradio.props.value === initial_value) {\n\t\t\treturn;\n\t\t}\n\t\tgradio.props.value = initial_value;\n\t};\n\n\tlet dragging: boolean;\n\n\tlet color_accent = \"darkorange\";\n\n\tlet waveform_settings = $derived({\n\t\theight: 50,\n\t\tbarWidth: 2,\n\t\tbarGap: 3,\n\t\tcursorWidth: 2,\n\t\tcursorColor: \"#ddd5e9\",\n\t\tautoplay: gradio.props.autoplay,\n\t\tbarRadius: 10,\n\t\tdragToSeek: true,\n\t\tnormalize: true,\n\t\tminPxPerSec: 20\n\t});\n\n\tconst trim_region_settings = {\n\t\tcolor: gradio.props.waveform_options.trim_region_color,\n\t\tdrag: true,\n\t\tresize: true\n\t};\n\n\tfunction set_trim_region_colour(): void {\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--trim-region-color\",\n\t\t\ttrim_region_settings.color || color_accent\n\t\t);\n\t}\n\n\tfunction handle_error({ detail }: CustomEvent<string>): void {\n\t\tconst [level, status] = detail.includes(\"Invalid file type\")\n\t\t\t? [\"warning\", \"complete\"]\n\t\t\t: [\"error\", \"error\"];\n\t\tif (gradio.shared.loading_status) {\n\t\t\tgradio.shared.loading_status.status = status as LoadingStatus[\"status\"];\n\t\t\tgradio.shared.loading_status.message = detail;\n\t\t}\n\t\tgradio.dispatch(level as \"error\" | \"warning\", detail);\n\t}\n\n\tlet old_value = $state(gradio.props.value);\n\t$effect(() => {\n\t\tif (old_value != gradio.props.value) {\n\t\t\told_value = gradio.props.value;\n\t\t\tgradio.dispatch(\"change\");\n\t\t}\n\t});\n\n\tonMount(() => {\n\t\tcolor_accent = getComputedStyle(document?.documentElement).getPropertyValue(\n\t\t\t\"--color-accent\"\n\t\t);\n\t\tset_trim_region_colour();\n\t\twaveform_settings.waveColor =\n\t\t\tgradio.props.waveform_options.waveform_color || \"#9ca3af\";\n\t\twaveform_settings.progressColor =\n\t\t\tgradio.props.waveform_options.waveform_progress_color || color_accent;\n\t\twaveform_settings.mediaControls =\n\t\t\tgradio.props.waveform_options.show_controls;\n\t\twaveform_settings.sampleRate =\n\t\t\tgradio.props.waveform_options.sample_rate || 44100;\n\t});\n</script>\n\n{#if !gradio.shared.interactive}\n\t<Block\n\t\tvariant={\"solid\"}\n\t\tborder_mode={dragging ? \"focus\" : \"base\"}\n\t\tpadding={false}\n\t\tallow_overflow={false}\n\t\telem_id={gradio.shared.elem_id}\n\t\telem_classes={gradio.shared.elem_classes}\n\t\tvisible={gradio.shared.visible}\n\t\tcontainer={gradio.shared.container}\n\t\tscale={gradio.shared.scale}\n\t\tmin_width={gradio.shared.min_width}\n\t>\n\t\t<StatusTracker\n\t\t\tautoscroll={gradio.shared.autoscroll}\n\t\t\ti18n={gradio.i18n}\n\t\t\t{...gradio.shared.loading_status}\n\t\t\ton:clear_status={() =>\n\t\t\t\tgradio.dispatch(\"clear_status\", gradio.shared.loading_status)}\n\t\t/>\n\n\t\t<StaticAudio\n\t\t\ti18n={gradio.i18n}\n\t\t\tshow_label={gradio.shared.show_label}\n\t\t\tbuttons={gradio.props.buttons ?? [\"download\", \"share\"]}\n\t\t\tvalue={gradio.props.value}\n\t\t\tsubtitles={gradio.props.subtitles}\n\t\t\t{label}\n\t\t\tloop={gradio.props.loop}\n\t\t\t{waveform_settings}\n\t\t\twaveform_options={gradio.props.waveform_options}\n\t\t\teditable={gradio.props.editable}\n\t\t\ton:share={(e) => gradio.dispatch(\"share\", e.detail)}\n\t\t\ton:error={(e) => gradio.dispatch(\"error\", e.detail)}\n\t\t\ton:play={() => gradio.dispatch(\"play\")}\n\t\t\ton:pause={() => gradio.dispatch(\"pause\")}\n\t\t\ton:stop={() => gradio.dispatch(\"stop\")}\n\t\t/>\n\t</Block>\n{:else}\n\t<Block\n\t\tvariant={gradio.props.value === null && active_source === \"upload\"\n\t\t\t? \"dashed\"\n\t\t\t: \"solid\"}\n\t\tborder_mode={dragging ? \"focus\" : \"base\"}\n\t\tpadding={false}\n\t\tallow_overflow={false}\n\t\telem_id={gradio.shared.elem_id}\n\t\telem_classes={gradio.shared.elem_classes}\n\t\tvisible={gradio.shared.visible}\n\t\tcontainer={gradio.shared.container}\n\t\tscale={gradio.shared.scale}\n\t\tmin_width={gradio.shared.min_width}\n\t>\n\t\t<StatusTracker\n\t\t\tautoscroll={gradio.shared.autoscroll}\n\t\t\ti18n={gradio.i18n}\n\t\t\t{...gradio.shared.loading_status}\n\t\t\ton:clear_status={() =>\n\t\t\t\tgradio.dispatch(\"clear_status\", gradio.shared.loading_status)}\n\t\t/>\n\t\t<InteractiveAudio\n\t\t\tbind:upload_promise\n\t\t\tbind:initial_value\n\t\t\t{label}\n\t\t\tshow_label={gradio.shared.show_label}\n\t\t\tbuttons={gradio.props.buttons ?? []}\n\t\t\tvalue={gradio.props.value}\n\t\t\tsubtitles={gradio.props.subtitles}\n\t\t\ton:change={({ detail }) => (gradio.props.value = detail)}\n\t\t\ton:stream={({ detail }) => {\n\t\t\t\tgradio.props.value = detail;\n\t\t\t\tgradio.dispatch(\"stream\", gradio.props.value);\n\t\t\t}}\n\t\t\ton:drag={({ detail }) => (dragging = detail)}\n\t\t\troot={gradio.shared.root}\n\t\t\tsources={gradio.props.sources}\n\t\t\t{active_source}\n\t\t\tpending={gradio.shared.loading_status.pending}\n\t\t\tstreaming={gradio.props.streaming}\n\t\t\tbind:recording={gradio.props.recording}\n\t\t\tloop={gradio.props.loop}\n\t\t\tmax_file_size={gradio.shared.max_file_size}\n\t\t\t{handle_reset_value}\n\t\t\teditable={gradio.props.editable}\n\t\t\tbind:dragging\n\t\t\ton:edit={() => gradio.dispatch(\"edit\")}\n\t\t\ton:play={() => gradio.dispatch(\"play\")}\n\t\t\ton:pause={() => gradio.dispatch(\"pause\")}\n\t\t\ton:stop={() => gradio.dispatch(\"stop\")}\n\t\t\ton:start_recording={() => gradio.dispatch(\"start_recording\")}\n\t\t\ton:pause_recording={() => gradio.dispatch(\"pause_recording\")}\n\t\t\ton:stop_recording={(e) => {\n\t\t\t\tgradio.dispatch(\"stop_recording\");\n\t\t\t\tgradio.dispatch(\"input\");\n\t\t\t}}\n\t\t\ton:upload={() => {\n\t\t\t\tgradio.dispatch(\"upload\");\n\t\t\t\tgradio.dispatch(\"input\");\n\t\t\t}}\n\t\t\ton:clear={() => {\n\t\t\t\tgradio.dispatch(\"clear\");\n\t\t\t\tgradio.dispatch(\"input\");\n\t\t\t}}\n\t\t\ton:error={handle_error}\n\t\t\ton:close_stream={() => gradio.dispatch(\"close_stream\", \"stream\")}\n\t\t\ti18n={gradio.i18n}\n\t\t\t{waveform_settings}\n\t\t\twaveform_options={gradio.props.waveform_options}\n\t\t\t{trim_region_settings}\n\t\t\tstream_every={gradio.props.stream_every}\n\t\t\tstream_state={gradio.shared.loading_status.stream_state}\n\t\t\tupload={(...args) => gradio.shared.client.upload(...args)}\n\t\t\tstream_handler={(...args) => gradio.shared.client.stream(...args)}\n\t\t\ttime_limit={gradio.shared.loading_status.time_limit}\n\t\t>\n\t\t\t<UploadText i18n={gradio.i18n} type=\"audio\" />\n\t\t</InteractiveAudio>\n\t</Block>\n{/if}\n"],"names":["$.rest_props","$.state","$.get","$.derived","$.proxy","$.user_effect","$.set","$0"],"mappings":"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"}
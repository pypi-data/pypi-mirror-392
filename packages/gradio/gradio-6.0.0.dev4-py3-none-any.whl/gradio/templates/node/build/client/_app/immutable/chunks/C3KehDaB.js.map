{"version":3,"file":"C3KehDaB.js","sources":["../../../../../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetPropertyBlock.js"],"sourcesContent":["import { FlowGraphExecutionBlockWithOutSignal } from \"../../flowGraphExecutionBlockWithOutSignal.js\";\nimport { RichTypeAny } from \"../../flowGraphRichTypes.js\";\nimport { RegisterClass } from \"../../../Misc/typeStore.js\";\n/**\n * This block will set a property on a given target asset.\n * The property name can include dots (\".\"), which will be interpreted as a path to the property.\n * The target asset is an input and can be changed at any time.\n * The value of the property is an input and can be changed at any time.\n *\n * For example, with an input of a mesh asset, the property name \"position.x\" will set the x component of the position of the mesh.\n *\n * Note that it is recommended to input the object on which you are working on (i.e. a material) than providing a mesh and then getting the material from it.\n */\nexport class FlowGraphSetPropertyBlock extends FlowGraphExecutionBlockWithOutSignal {\n    constructor(\n    /**\n     * the configuration of the block\n     */\n    config) {\n        super(config);\n        this.config = config;\n        this.object = this.registerDataInput(\"object\", RichTypeAny, config.target);\n        this.value = this.registerDataInput(\"value\", RichTypeAny);\n        this.propertyName = this.registerDataInput(\"propertyName\", RichTypeAny, config.propertyName);\n        this.customSetFunction = this.registerDataInput(\"customSetFunction\", RichTypeAny);\n    }\n    _execute(context, _callingSignal) {\n        try {\n            const target = this.object.getValue(context);\n            const value = this.value.getValue(context);\n            const propertyName = this.propertyName.getValue(context);\n            this._stopRunningAnimations(context, target, propertyName);\n            const setFunction = this.customSetFunction.getValue(context);\n            if (setFunction) {\n                setFunction(target, propertyName, value, context);\n            }\n            else {\n                this._setPropertyValue(target, propertyName, value);\n            }\n        }\n        catch (e) {\n            this._reportError(context, e);\n        }\n        this.out._activateSignal(context);\n    }\n    _stopRunningAnimations(context, target, propertyName) {\n        const currentlyRunningAnimationGroups = context._getGlobalContextVariable(\"currentlyRunningAnimationGroups\", []);\n        for (const uniqueId of currentlyRunningAnimationGroups) {\n            const animationGroup = context.assetsContext.animationGroups.find((animationGroup) => animationGroup.uniqueId === uniqueId);\n            if (animationGroup) {\n                for (const targetedAnimations of animationGroup.targetedAnimations) {\n                    if (targetedAnimations.target === target && targetedAnimations.animation.targetProperty === propertyName) {\n                        animationGroup.stop(true);\n                        animationGroup.dispose();\n                        const index = currentlyRunningAnimationGroups.indexOf(uniqueId);\n                        if (index !== -1) {\n                            currentlyRunningAnimationGroups.splice(index, 1);\n                            context._setGlobalContextVariable(\"currentlyRunningAnimationGroups\", currentlyRunningAnimationGroups);\n                        }\n                    }\n                }\n            }\n        }\n    }\n    _setPropertyValue(target, propertyName, value) {\n        const path = propertyName.split(\".\");\n        let obj = target;\n        for (let i = 0; i < path.length - 1; i++) {\n            const prop = path[i];\n            if (obj[prop] === undefined) {\n                obj[prop] = {};\n            }\n            obj = obj[prop];\n        }\n        obj[path[path.length - 1]] = value;\n    }\n    getClassName() {\n        return \"FlowGraphSetPropertyBlock\" /* FlowGraphBlockNames.SetProperty */;\n    }\n}\nRegisterClass(\"FlowGraphSetPropertyBlock\" /* FlowGraphBlockNames.SetProperty */, FlowGraphSetPropertyBlock);\n//# sourceMappingURL=flowGraphSetPropertyBlock.js.map"],"names":["animationGroup"],"mappings":";;;AAaO,MAAM,kCAAkC,qCAAqC;AAAA,EAChF,YAIA,QAAQ;AACJ,UAAM,MAAM;AACZ,SAAK,SAAS;AACd,SAAK,SAAS,KAAK,kBAAkB,UAAU,aAAa,OAAO,MAAM;AACzE,SAAK,QAAQ,KAAK,kBAAkB,SAAS,WAAW;AACxD,SAAK,eAAe,KAAK,kBAAkB,gBAAgB,aAAa,OAAO,YAAY;AAC3F,SAAK,oBAAoB,KAAK,kBAAkB,qBAAqB,WAAW;AAAA,EACpF;AAAA,EACA,SAAS,SAAS,gBAAgB;AAC9B,QAAI;AACA,YAAM,SAAS,KAAK,OAAO,SAAS,OAAO;AAC3C,YAAM,QAAQ,KAAK,MAAM,SAAS,OAAO;AACzC,YAAM,eAAe,KAAK,aAAa,SAAS,OAAO;AACvD,WAAK,uBAAuB,SAAS,QAAQ,YAAY;AACzD,YAAM,cAAc,KAAK,kBAAkB,SAAS,OAAO;AAC3D,UAAI,aAAa;AACb,oBAAY,QAAQ,cAAc,OAAO,OAAO;AAAA,MACpD,OACK;AACD,aAAK,kBAAkB,QAAQ,cAAc,KAAK;AAAA,MACtD;AAAA,IACJ,SACO,GAAG;AACN,WAAK,aAAa,SAAS,CAAC;AAAA,IAChC;AACA,SAAK,IAAI,gBAAgB,OAAO;AAAA,EACpC;AAAA,EACA,uBAAuB,SAAS,QAAQ,cAAc;AAClD,UAAM,kCAAkC,QAAQ,0BAA0B,mCAAmC,CAAA,CAAE;AAC/G,eAAW,YAAY,iCAAiC;AACpD,YAAM,iBAAiB,QAAQ,cAAc,gBAAgB,KAAK,CAACA,oBAAmBA,gBAAe,aAAa,QAAQ;AAC1H,UAAI,gBAAgB;AAChB,mBAAW,sBAAsB,eAAe,oBAAoB;AAChE,cAAI,mBAAmB,WAAW,UAAU,mBAAmB,UAAU,mBAAmB,cAAc;AACtG,2BAAe,KAAK,IAAI;AACxB,2BAAe,QAAO;AACtB,kBAAM,QAAQ,gCAAgC,QAAQ,QAAQ;AAC9D,gBAAI,UAAU,IAAI;AACd,8CAAgC,OAAO,OAAO,CAAC;AAC/C,sBAAQ,0BAA0B,mCAAmC,+BAA+B;AAAA,YACxG;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AAAA,EACA,kBAAkB,QAAQ,cAAc,OAAO;AAC3C,UAAM,OAAO,aAAa,MAAM,GAAG;AACnC,QAAI,MAAM;AACV,aAAS,IAAI,GAAG,IAAI,KAAK,SAAS,GAAG,KAAK;AACtC,YAAM,OAAO,KAAK,CAAC;AACnB,UAAI,IAAI,IAAI,MAAM,QAAW;AACzB,YAAI,IAAI,IAAI,CAAA;AAAA,MAChB;AACA,YAAM,IAAI,IAAI;AAAA,IAClB;AACA,QAAI,KAAK,KAAK,SAAS,CAAC,CAAC,IAAI;AAAA,EACjC;AAAA,EACA,eAAe;AACX,WAAO;AAAA,EACX;AACJ;AACA,cAAc,6BAAmE,yBAAyB;","x_google_ignoreList":[0]}
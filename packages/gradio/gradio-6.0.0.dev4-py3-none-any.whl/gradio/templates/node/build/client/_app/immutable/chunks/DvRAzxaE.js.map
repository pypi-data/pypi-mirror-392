{"version":3,"file":"DvRAzxaE.js","sources":["../../../../../../../code/shared/frontmatter.ts"],"sourcesContent":["import type {\n\tElement,\n\tMarkdownExtension,\n\tBlockContext,\n\tLine\n} from \"@lezer/markdown\";\nimport { parseMixed } from \"@lezer/common\";\nimport { yaml } from \"@codemirror/legacy-modes/mode/yaml\";\nimport { foldInside, foldNodeProp, StreamLanguage } from \"@codemirror/language\";\nimport { styleTags, tags } from \"@lezer/highlight\";\n\nconst frontMatterFence = /^---\\s*$/m;\n\nexport const frontmatter: MarkdownExtension = {\n\tdefineNodes: [{ name: \"Frontmatter\", block: true }, \"FrontmatterMark\"],\n\tprops: [\n\t\tstyleTags({\n\t\t\tFrontmatter: [tags.documentMeta, tags.monospace],\n\t\t\tFrontmatterMark: tags.processingInstruction\n\t\t}),\n\t\tfoldNodeProp.add({\n\t\t\tFrontmatter: foldInside,\n\t\t\tFrontmatterMark: () => null\n\t\t})\n\t],\n\twrap: parseMixed((node) => {\n\t\tconst { parser } = StreamLanguage.define(yaml);\n\t\tif (node.type.name === \"Frontmatter\") {\n\t\t\treturn {\n\t\t\t\tparser,\n\t\t\t\toverlay: [{ from: node.from + 4, to: node.to - 4 }]\n\t\t\t};\n\t\t}\n\t\treturn null;\n\t}),\n\tparseBlock: [\n\t\t{\n\t\t\tname: \"Frontmatter\",\n\t\t\tbefore: \"HorizontalRule\",\n\t\t\tparse: (cx: BlockContext, line: Line): boolean => {\n\t\t\t\tlet end: number | undefined = undefined;\n\t\t\t\tconst children = new Array<Element>();\n\t\t\t\tif (cx.lineStart === 0 && frontMatterFence.test(line.text)) {\n\t\t\t\t\tchildren.push(cx.elt(\"FrontmatterMark\", 0, 4));\n\t\t\t\t\twhile (cx.nextLine()) {\n\t\t\t\t\t\tif (frontMatterFence.test(line.text)) {\n\t\t\t\t\t\t\tend = cx.lineStart + 4;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (end !== undefined) {\n\t\t\t\t\t\tchildren.push(cx.elt(\"FrontmatterMark\", end - 4, end));\n\t\t\t\t\t\tcx.addElement(cx.elt(\"Frontmatter\", 0, end, children));\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t]\n};\n"],"names":[],"mappings":";;AAWA,MAAM,mBAAmB;AAElB,MAAM,cAAiC;AAAA,EAC7C,aAAa,CAAC,EAAE,MAAM,eAAe,OAAO,KAAA,GAAQ,iBAAiB;AAAA,EACrE,OAAO;AAAA,IACN,UAAU;AAAA,MACT,aAAa,CAAC,KAAK,cAAc,KAAK,SAAS;AAAA,MAC/C,iBAAiB,KAAK;AAAA,IAAA,CACtB;AAAA,IACD,aAAa,IAAI;AAAA,MAChB,aAAa;AAAA,MACb,iBAAiB,MAAM;AAAA,IAAA,CACvB;AAAA,EAAA;AAAA,EAEF,MAAM,WAAW,CAAC,SAAS;AAC1B,UAAM,EAAE,OAAA,IAAW,eAAe,OAAO,IAAI;AAC7C,QAAI,KAAK,KAAK,SAAS,eAAe;AACrC,aAAO;AAAA,QACN;AAAA,QACA,SAAS,CAAC,EAAE,MAAM,KAAK,OAAO,GAAG,IAAI,KAAK,KAAK,EAAA,CAAG;AAAA,MAAA;AAAA,IAEpD;AACA,WAAO;AAAA,EACR,CAAC;AAAA,EACD,YAAY;AAAA,IACX;AAAA,MACC,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,OAAO,CAAC,IAAkB,SAAwB;AACjD,YAAI,MAA0B;AAC9B,cAAM,WAAW,IAAI,MAAA;AACrB,YAAI,GAAG,cAAc,KAAK,iBAAiB,KAAK,KAAK,IAAI,GAAG;AAC3D,mBAAS,KAAK,GAAG,IAAI,mBAAmB,GAAG,CAAC,CAAC;AAC7C,iBAAO,GAAG,YAAY;AACrB,gBAAI,iBAAiB,KAAK,KAAK,IAAI,GAAG;AACrC,oBAAM,GAAG,YAAY;AACrB;AAAA,YACD;AAAA,UACD;AACA,cAAI,QAAQ,QAAW;AACtB,qBAAS,KAAK,GAAG,IAAI,mBAAmB,MAAM,GAAG,GAAG,CAAC;AACrD,eAAG,WAAW,GAAG,IAAI,eAAe,GAAG,KAAK,QAAQ,CAAC;AAAA,UACtD;AACA,iBAAO;AAAA,QACR;AACA,eAAO;AAAA,MACR;AAAA,IAAA;AAAA,EACD;AAEF;"}
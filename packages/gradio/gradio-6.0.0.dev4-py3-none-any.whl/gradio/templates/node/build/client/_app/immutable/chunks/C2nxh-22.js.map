{"version":3,"mappings":";;;;;;;;;;;;;;;oCAAA;;MASY,QAAsBA,KAAA;AACtB,sDAAsD,OAAO;AAC7D,4DAAiD,GAAG,GAAG,GAAG,CAAC;AAC3D,wCAAQ,EAAE;MACV,aAAmBA,KAAA;MACnB,OAAmBA,KAAA;AACnB,kDAAa,CAAC;AACd,gDAAY,CAAC;AAEb,wBAA8DA,KAAA,uCACxE,MACA,MACA;AAEU,kEAAqB,KAAK;MAEjC,mBAAgBC,eAAA;AAAA,IAAK,iCAAe;AAAA,IAAE,uBAAU;AAAA,IAAE,qBAAS;AAAA;AAE3D,gCAAW,KAAK;MAChB,sBAAsCA,eAAA;MACtC,oBAAkCA,eAAA;AACvB,gCAAyC;AACjD,oDAAsB,eAAmB;AACxC,kBAAO;AAAA,EACf;AACe,kCAA6C;AACrD,oDAAsB,eAAqB;AAC1C,kBAAO;AAAA,EACf;MAcI,WAA8BA,eAAA;AACzB,yBAAoB;AAC5BC,QAAA,QAAQ,GAAE,sBAAqB;AAAA,EAChC;;AAhBO,cAAK,GAAE;AACbC,UAAA,UAAW,MAAK,EAAC,KAAK,SAAS,QAAQ,KAAK,MAAK,EAAC,KAAK,SAAS,MAAM;AAClE,UAAAD,IAAA,QAAQ,GAAE;AACb,uBAAc,EAAG,KAAI,CAAEE,eAAc;AACpCD,cAAA,qBAAsBC,UAAS;AAAA,QAChC,CAAC;AAAA,MACF,OAAO;AACN,qBAAY,EAAG,KAAI,CAAEA,eAAc;AAClCD,cAAA,mBAAoBC,UAAS;AAAA,QAC9B,CAAC;AAAA,MACF;AAAA,IACD;AAAA;;;;AASG,sBAAO,gBAAgB,EAAC,iBAAiB,gBAAe,MAAAF,IACzD,gBAAgB,EAAC,eAAe,gBAAUA,IAC1C,gBAAgB,EAAC,cAAc,aAC9B;AACDA,YAAA,QAAQ,GAAE,cAAc,gBAAe,GAAE,WAAU,GAAE,WAAS;YAC9D,kBAAgB;AAAA,UAAK,iCAAe;AAAA,UAAE,uBAAU;AAAA,UAAE,qBAAS;AAAA;MAC5D;AAAA;;;;;;;uDApDU,MAAK,oBAEL,KAAmB,kBAyDvB,MAAK,KAAI,KAAI,EAAC,mBAAmB;;;;;;eADlC;AAAA;;;;;;;;;;;;;;;;;;mDAYS,mBAAkB;;;2BAHvB;AAAA;;;;;2CAEU,YAAW;AAAA;;;;uBALvB,QAAQ;AAAA;;;AAWLG,wBAAA,aAAAC,QAAA,aAAO,eAAe,WAAW,IAAI;;;+DAzErC,KAAmB,IA4EQA,QAAA,WAAI,EAAC,iBAAiB;;;uBAAvC;AAAA;;;;;;;;sDAjFV,MAAsB,IAAAA,QAAA,MA6ExB,QAAM,GAAG;0DA7EP,MAAsB,kBA+EpB,OAAO,eAAe,OAAO,QAAM,aAAa,MAAK,EAAC,IAAI;;;;;;;;;;;sCAQ9D,mBAAmB,IAAAC,WAAA;;;;;;;;;;;;;;;;;;sCAOnB,iBAAiB,IAAAA,WAAA;;;;;;;;;;;;;;;;;;;;;;;+BACZ,UAAQ;AAAA,wBAAR,QAAQ;AAAA;;;;;kBAVhB,QAAQ;AAAA;AAAA;;;;;;UArBV,MAAK;AAAA;;;;AAPV","names":["$.prop","$.mutable_source","$.get","$.set","component","$.set_attribute","$.untrack","$$anchor"],"ignoreList":[],"sources":["../../../../../../../model3D/shared/Model3D.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport type { FileData } from \"@gradio/client\";\n\timport { BlockLabel, IconButton, IconButtonWrapper } from \"@gradio/atoms\";\n\timport { File, Download, Undo } from \"@gradio/icons\";\n\timport type { I18nFormatter } from \"@gradio/utils\";\n\timport { dequal } from \"dequal\";\n\timport type Canvas3DGS from \"./Canvas3DGS.svelte\";\n\timport type Canvas3D from \"./Canvas3D.svelte\";\n\n\texport let value: FileData | null;\n\texport let display_mode: \"solid\" | \"point_cloud\" | \"wireframe\" = \"solid\";\n\texport let clear_color: [number, number, number, number] = [0, 0, 0, 0];\n\texport let label = \"\";\n\texport let show_label: boolean;\n\texport let i18n: I18nFormatter;\n\texport let zoom_speed = 1;\n\texport let pan_speed = 1;\n\t// alpha, beta, radius\n\texport let camera_position: [number | null, number | null, number | null] = [\n\t\tnull,\n\t\tnull,\n\t\tnull\n\t];\n\texport let has_change_history = false;\n\n\tlet current_settings = { camera_position, zoom_speed, pan_speed };\n\n\tlet use_3dgs = false;\n\tlet Canvas3DGSComponent: typeof Canvas3DGS;\n\tlet Canvas3DComponent: typeof Canvas3D;\n\tasync function loadCanvas3D(): Promise<typeof Canvas3D> {\n\t\tconst module = await import(\"./Canvas3D.svelte\");\n\t\treturn module.default;\n\t}\n\tasync function loadCanvas3DGS(): Promise<typeof Canvas3DGS> {\n\t\tconst module = await import(\"./Canvas3DGS.svelte\");\n\t\treturn module.default;\n\t}\n\t$: if (value) {\n\t\tuse_3dgs = value.path.endsWith(\".splat\") || value.path.endsWith(\".ply\");\n\t\tif (use_3dgs) {\n\t\t\tloadCanvas3DGS().then((component) => {\n\t\t\t\tCanvas3DGSComponent = component;\n\t\t\t});\n\t\t} else {\n\t\t\tloadCanvas3D().then((component) => {\n\t\t\t\tCanvas3DComponent = component;\n\t\t\t});\n\t\t}\n\t}\n\n\tlet canvas3d: Canvas3D | undefined;\n\tfunction handle_undo(): void {\n\t\tcanvas3d?.reset_camera_position();\n\t}\n\n\t$: {\n\t\tif (\n\t\t\t!dequal(current_settings.camera_position, camera_position) ||\n\t\t\tcurrent_settings.zoom_speed !== zoom_speed ||\n\t\t\tcurrent_settings.pan_speed !== pan_speed\n\t\t) {\n\t\t\tcanvas3d?.update_camera(camera_position, zoom_speed, pan_speed);\n\t\t\tcurrent_settings = { camera_position, zoom_speed, pan_speed };\n\t\t}\n\t}\n</script>\n\n<BlockLabel\n\t{show_label}\n\tIcon={File}\n\tlabel={label || i18n(\"3D_model.3d_model\")}\n/>\n{#if value}\n\t<div class=\"model3D\" data-testid=\"model3d\">\n\t\t<IconButtonWrapper>\n\t\t\t{#if !use_3dgs}\n\t\t\t\t<!-- Canvas3DGS doesn't implement the undo method (reset_camera_position) -->\n\t\t\t\t<IconButton\n\t\t\t\t\tIcon={Undo}\n\t\t\t\t\tlabel=\"Undo\"\n\t\t\t\t\ton:click={() => handle_undo()}\n\t\t\t\t\tdisabled={!has_change_history}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t\t<a\n\t\t\t\thref={value.url}\n\t\t\t\ttarget={window.__is_colab__ ? \"_blank\" : null}\n\t\t\t\tdownload={window.__is_colab__ ? null : value.orig_name || value.path}\n\t\t\t>\n\t\t\t\t<IconButton Icon={Download} label={i18n(\"common.download\")} />\n\t\t\t</a>\n\t\t</IconButtonWrapper>\n\n\t\t{#if use_3dgs}\n\t\t\t<svelte:component\n\t\t\t\tthis={Canvas3DGSComponent}\n\t\t\t\t{value}\n\t\t\t\t{zoom_speed}\n\t\t\t\t{pan_speed}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<svelte:component\n\t\t\t\tthis={Canvas3DComponent}\n\t\t\t\tbind:this={canvas3d}\n\t\t\t\t{value}\n\t\t\t\t{display_mode}\n\t\t\t\t{clear_color}\n\t\t\t\t{camera_position}\n\t\t\t\t{zoom_speed}\n\t\t\t\t{pan_speed}\n\t\t\t/>\n\t\t{/if}\n\t</div>\n{/if}\n\n<style>\n\t.model3D {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\tborder-radius: var(--block-radius);\n\t\toverflow: hidden;\n\t}\n\t.model3D :global(canvas) {\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\tobject-fit: contain;\n\t\toverflow: hidden;\n\t}\n</style>\n"],"file":"C2nxh-22.js"}
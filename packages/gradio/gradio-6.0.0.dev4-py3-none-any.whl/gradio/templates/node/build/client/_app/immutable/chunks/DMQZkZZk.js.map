{"version":3,"file":"DMQZkZZk.js","sources":["../../../../../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/FlowGraph/Blocks/Execution/flowGraphSetVariableBlock.js"],"sourcesContent":["import { RegisterClass } from \"../../../Misc/typeStore.js\";\nimport { FlowGraphExecutionBlockWithOutSignal } from \"../../flowGraphExecutionBlockWithOutSignal.js\";\nimport { RichTypeAny } from \"../../flowGraphRichTypes.js\";\n/**\n * This block will set a variable on the context.\n */\nexport class FlowGraphSetVariableBlock extends FlowGraphExecutionBlockWithOutSignal {\n    constructor(config) {\n        super(config);\n        // check if the variable is defined\n        if (!config.variable && !config.variables) {\n            throw new Error(\"FlowGraphSetVariableBlock: variable/variables is not defined\");\n        }\n        // check if the variable is an array\n        if (config.variables && config.variable) {\n            throw new Error(\"FlowGraphSetVariableBlock: variable and variables are both defined\");\n        }\n        // check if we have either a variable or variables. If we have variables, set the inputs correctly\n        if (config.variables) {\n            for (const variable of config.variables) {\n                this.registerDataInput(variable, RichTypeAny);\n            }\n        }\n        else {\n            this.registerDataInput(\"value\", RichTypeAny);\n        }\n    }\n    _execute(context, _callingSignal) {\n        if (this.config?.variables) {\n            for (const variable of this.config.variables) {\n                this._saveVariable(context, variable);\n            }\n        }\n        else {\n            this._saveVariable(context, this.config?.variable, \"value\");\n        }\n        this.out._activateSignal(context);\n    }\n    _saveVariable(context, variableName, inputName) {\n        // check if there is an animation(group) running on this variable. If there is, stop the animation - a value was force-set.\n        const currentlyRunningAnimationGroups = context._getGlobalContextVariable(\"currentlyRunningAnimationGroups\", []);\n        for (const animationUniqueId of currentlyRunningAnimationGroups) {\n            const animationGroup = context.assetsContext.animationGroups.find((animationGroup) => animationGroup.uniqueId == animationUniqueId);\n            if (animationGroup) {\n                // check if there is a target animation that has the target set to be the context\n                for (const targetAnimation of animationGroup.targetedAnimations) {\n                    // check if the target property is the variable we are setting\n                    if (targetAnimation.target === context) {\n                        // check the variable name\n                        if (targetAnimation.animation.targetProperty === variableName) {\n                            // stop the animation\n                            animationGroup.stop();\n                            // remove the animation from the currently running animations\n                            const index = currentlyRunningAnimationGroups.indexOf(animationUniqueId);\n                            if (index > -1) {\n                                currentlyRunningAnimationGroups.splice(index, 1);\n                            }\n                            context._setGlobalContextVariable(\"currentlyRunningAnimationGroups\", currentlyRunningAnimationGroups);\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        const value = this.getDataInput(inputName || variableName)?.getValue(context);\n        context.setVariable(variableName, value);\n    }\n    getClassName() {\n        return \"FlowGraphSetVariableBlock\" /* FlowGraphBlockNames.SetVariable */;\n    }\n    serialize(serializationObject) {\n        super.serialize(serializationObject);\n        serializationObject.config.variable = this.config?.variable;\n    }\n}\nRegisterClass(\"FlowGraphSetVariableBlock\" /* FlowGraphBlockNames.SetVariable */, FlowGraphSetVariableBlock);\n//# sourceMappingURL=flowGraphSetVariableBlock.js.map"],"names":["animationGroup"],"mappings":";;;AAMO,MAAM,kCAAkC,qCAAqC;AAAA,EAChF,YAAY,QAAQ;AAChB,UAAM,MAAM;AAEZ,QAAI,CAAC,OAAO,YAAY,CAAC,OAAO,WAAW;AACvC,YAAM,IAAI,MAAM,8DAA8D;AAAA,IAClF;AAEA,QAAI,OAAO,aAAa,OAAO,UAAU;AACrC,YAAM,IAAI,MAAM,oEAAoE;AAAA,IACxF;AAEA,QAAI,OAAO,WAAW;AAClB,iBAAW,YAAY,OAAO,WAAW;AACrC,aAAK,kBAAkB,UAAU,WAAW;AAAA,MAChD;AAAA,IACJ,OACK;AACD,WAAK,kBAAkB,SAAS,WAAW;AAAA,IAC/C;AAAA,EACJ;AAAA,EACA,SAAS,SAAS,gBAAgB;AAC9B,QAAI,KAAK,QAAQ,WAAW;AACxB,iBAAW,YAAY,KAAK,OAAO,WAAW;AAC1C,aAAK,cAAc,SAAS,QAAQ;AAAA,MACxC;AAAA,IACJ,OACK;AACD,WAAK,cAAc,SAAS,KAAK,QAAQ,UAAU,OAAO;AAAA,IAC9D;AACA,SAAK,IAAI,gBAAgB,OAAO;AAAA,EACpC;AAAA,EACA,cAAc,SAAS,cAAc,WAAW;AAE5C,UAAM,kCAAkC,QAAQ,0BAA0B,mCAAmC,CAAA,CAAE;AAC/G,eAAW,qBAAqB,iCAAiC;AAC7D,YAAM,iBAAiB,QAAQ,cAAc,gBAAgB,KAAK,CAACA,oBAAmBA,gBAAe,YAAY,iBAAiB;AAClI,UAAI,gBAAgB;AAEhB,mBAAW,mBAAmB,eAAe,oBAAoB;AAE7D,cAAI,gBAAgB,WAAW,SAAS;AAEpC,gBAAI,gBAAgB,UAAU,mBAAmB,cAAc;AAE3D,6BAAe,KAAI;AAEnB,oBAAM,QAAQ,gCAAgC,QAAQ,iBAAiB;AACvE,kBAAI,QAAQ,IAAI;AACZ,gDAAgC,OAAO,OAAO,CAAC;AAAA,cACnD;AACA,sBAAQ,0BAA0B,mCAAmC,+BAA+B;AACpG;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AACA,UAAM,QAAQ,KAAK,aAAa,aAAa,YAAY,GAAG,SAAS,OAAO;AAC5E,YAAQ,YAAY,cAAc,KAAK;AAAA,EAC3C;AAAA,EACA,eAAe;AACX,WAAO;AAAA,EACX;AAAA,EACA,UAAU,qBAAqB;AAC3B,UAAM,UAAU,mBAAmB;AACnC,wBAAoB,OAAO,WAAW,KAAK,QAAQ;AAAA,EACvD;AACJ;AACA,cAAc,6BAAmE,yBAAyB;","x_google_ignoreList":[0]}
{"version":3,"file":"webAudioSoundSource-CKsg8rr0.js","sources":["../../../../node_modules/.pnpm/@babylonjs+core@8.36.1/node_modules/@babylonjs/core/AudioV2/webAudio/webAudioSoundSource.js"],"sourcesContent":["import { AbstractSoundSource } from \"../abstractAudio/abstractSoundSource.js\";\nimport { _HasSpatialAudioOptions } from \"../abstractAudio/subProperties/abstractSpatialAudio.js\";\nimport { _StereoAudio } from \"../abstractAudio/subProperties/stereoAudio.js\";\nimport { _WebAudioBusAndSoundSubGraph } from \"./subNodes/webAudioBusAndSoundSubGraph.js\";\nimport { _SpatialWebAudio } from \"./subProperties/spatialWebAudio.js\";\n/** @internal */\nexport class _WebAudioSoundSource extends AbstractSoundSource {\n    /** @internal */\n    constructor(name, webAudioNode, engine, options) {\n        super(name, engine);\n        this._spatial = null;\n        this._spatialAutoUpdate = true;\n        this._spatialMinUpdateTime = 0;\n        this._stereo = null;\n        if (typeof options.spatialAutoUpdate === \"boolean\") {\n            this._spatialAutoUpdate = options.spatialAutoUpdate;\n        }\n        if (typeof options.spatialMinUpdateTime === \"number\") {\n            this._spatialMinUpdateTime = options.spatialMinUpdateTime;\n        }\n        this._audioContext = this.engine._audioContext;\n        this._webAudioNode = webAudioNode;\n        this._subGraph = new _WebAudioSoundSource._SubGraph(this);\n    }\n    /** @internal */\n    async _initAsync(options) {\n        if (options.outBus) {\n            this.outBus = options.outBus;\n        }\n        else if (options.outBusAutoDefault !== false) {\n            await this.engine.isReadyPromise;\n            this.outBus = this.engine.defaultMainBus;\n        }\n        await this._subGraph.initAsync(options);\n        if (_HasSpatialAudioOptions(options)) {\n            this._initSpatialProperty();\n        }\n        this.engine._addNode(this);\n    }\n    /** @internal */\n    get _inNode() {\n        return this._webAudioNode;\n    }\n    /** @internal */\n    get _outNode() {\n        return this._subGraph._outNode;\n    }\n    /** @internal */\n    get spatial() {\n        if (this._spatial) {\n            return this._spatial;\n        }\n        return this._initSpatialProperty();\n    }\n    /** @internal */\n    get stereo() {\n        return this._stereo ?? (this._stereo = new _StereoAudio(this._subGraph));\n    }\n    /** @internal */\n    dispose() {\n        super.dispose();\n        this._spatial?.dispose();\n        this._spatial = null;\n        this._stereo = null;\n        this._subGraph.dispose();\n        this.engine._removeNode(this);\n    }\n    /** @internal */\n    getClassName() {\n        return \"_WebAudioSoundSource\";\n    }\n    _connect(node) {\n        const connected = super._connect(node);\n        if (!connected) {\n            return false;\n        }\n        // If the wrapped node is not available now, it will be connected later by the subgraph.\n        if (node._inNode) {\n            this._outNode?.connect(node._inNode);\n        }\n        return true;\n    }\n    _disconnect(node) {\n        const disconnected = super._disconnect(node);\n        if (!disconnected) {\n            return false;\n        }\n        if (node._inNode) {\n            this._outNode?.disconnect(node._inNode);\n        }\n        return true;\n    }\n    _initSpatialProperty() {\n        if (!this._spatial) {\n            this._spatial = new _SpatialWebAudio(this._subGraph, this._spatialAutoUpdate, this._spatialMinUpdateTime);\n        }\n        return this._spatial;\n    }\n}\n_WebAudioSoundSource._SubGraph = class extends _WebAudioBusAndSoundSubGraph {\n    get _downstreamNodes() {\n        return this._owner._downstreamNodes ?? null;\n    }\n    get _upstreamNodes() {\n        return this._owner._upstreamNodes ?? null;\n    }\n    _onSubNodesChanged() {\n        super._onSubNodesChanged();\n        this._owner._inNode.disconnect();\n        if (this._owner._subGraph._inNode) {\n            this._owner._inNode.connect(this._owner._subGraph._inNode);\n        }\n    }\n};\n//# sourceMappingURL=webAudioSoundSource.js.map"],"names":["_WebAudioSoundSource","AbstractSoundSource","name","webAudioNode","engine","options","_HasSpatialAudioOptions","_StereoAudio","node","_SpatialWebAudio","_WebAudioBusAndSoundSubGraph"],"mappings":"kQAMO,MAAMA,UAA6BC,CAAoB,CAE1D,YAAYC,EAAMC,EAAcC,EAAQC,EAAS,CAC7C,MAAMH,EAAME,CAAM,EAClB,KAAK,SAAW,KAChB,KAAK,mBAAqB,GAC1B,KAAK,sBAAwB,EAC7B,KAAK,QAAU,KACX,OAAOC,EAAQ,mBAAsB,YACrC,KAAK,mBAAqBA,EAAQ,mBAElC,OAAOA,EAAQ,sBAAyB,WACxC,KAAK,sBAAwBA,EAAQ,sBAEzC,KAAK,cAAgB,KAAK,OAAO,cACjC,KAAK,cAAgBF,EACrB,KAAK,UAAY,IAAIH,EAAqB,UAAU,IAAI,CAC5D,CAEA,MAAM,WAAWK,EAAS,CAClBA,EAAQ,OACR,KAAK,OAASA,EAAQ,OAEjBA,EAAQ,oBAAsB,KACnC,MAAM,KAAK,OAAO,eAClB,KAAK,OAAS,KAAK,OAAO,gBAE9B,MAAM,KAAK,UAAU,UAAUA,CAAO,EAClCC,EAAwBD,CAAO,GAC/B,KAAK,qBAAoB,EAE7B,KAAK,OAAO,SAAS,IAAI,CAC7B,CAEA,IAAI,SAAU,CACV,OAAO,KAAK,aAChB,CAEA,IAAI,UAAW,CACX,OAAO,KAAK,UAAU,QAC1B,CAEA,IAAI,SAAU,CACV,OAAI,KAAK,SACE,KAAK,SAET,KAAK,qBAAoB,CACpC,CAEA,IAAI,QAAS,CACT,OAAO,KAAK,UAAY,KAAK,QAAU,IAAIE,EAAa,KAAK,SAAS,EAC1E,CAEA,SAAU,CACN,MAAM,QAAO,EACb,KAAK,UAAU,QAAO,EACtB,KAAK,SAAW,KAChB,KAAK,QAAU,KACf,KAAK,UAAU,QAAO,EACtB,KAAK,OAAO,YAAY,IAAI,CAChC,CAEA,cAAe,CACX,MAAO,sBACX,CACA,SAASC,EAAM,CAEX,OADkB,MAAM,SAASA,CAAI,GAKjCA,EAAK,SACL,KAAK,UAAU,QAAQA,EAAK,OAAO,EAEhC,IANI,EAOf,CACA,YAAYA,EAAM,CAEd,OADqB,MAAM,YAAYA,CAAI,GAIvCA,EAAK,SACL,KAAK,UAAU,WAAWA,EAAK,OAAO,EAEnC,IALI,EAMf,CACA,sBAAuB,CACnB,OAAK,KAAK,WACN,KAAK,SAAW,IAAIC,EAAiB,KAAK,UAAW,KAAK,mBAAoB,KAAK,qBAAqB,GAErG,KAAK,QAChB,CACJ,CACAT,EAAqB,UAAY,cAAcU,CAA6B,CACxE,IAAI,kBAAmB,CACnB,OAAO,KAAK,OAAO,kBAAoB,IAC3C,CACA,IAAI,gBAAiB,CACjB,OAAO,KAAK,OAAO,gBAAkB,IACzC,CACA,oBAAqB,CACjB,MAAM,mBAAkB,EACxB,KAAK,OAAO,QAAQ,WAAU,EAC1B,KAAK,OAAO,UAAU,SACtB,KAAK,OAAO,QAAQ,QAAQ,KAAK,OAAO,UAAU,OAAO,CAEjE,CACJ","x_google_ignoreList":[0]}
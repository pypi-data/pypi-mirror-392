{"version":3,"file":"KHR_materials_clearcoat-DtRLldQv.js","sources":["../../../../node_modules/.pnpm/@babylonjs+loaders@8.36.1_@babylonjs+core@8.36.1_babylonjs-gltf2interface@8.36.1/node_modules/@babylonjs/loaders/glTF/2.0/Extensions/KHR_materials_clearcoat.js"],"sourcesContent":["import { GLTFLoader } from \"../glTFLoader.js\";\nimport { registerGLTFExtension, unregisterGLTFExtension } from \"../glTFLoaderExtensionRegistry.js\";\nconst NAME = \"KHR_materials_clearcoat\";\n/**\n * [Specification](https://github.com/KhronosGroup/glTF/blob/main/extensions/2.0/Khronos/KHR_materials_clearcoat/README.md)\n * [Playground Sample](https://www.babylonjs-playground.com/frame.html#7F7PN6#8)\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport class KHR_materials_clearcoat {\n    /**\n     * @internal\n     */\n    constructor(loader) {\n        /**\n         * The name of this extension.\n         */\n        this.name = NAME;\n        /**\n         * Defines a number that determines the order the extensions are applied.\n         */\n        this.order = 190;\n        this._loader = loader;\n        this.enabled = this._loader.isExtensionUsed(NAME);\n    }\n    /** @internal */\n    dispose() {\n        this._loader = null;\n    }\n    /**\n     * @internal\n     */\n    // eslint-disable-next-line no-restricted-syntax\n    loadMaterialPropertiesAsync(context, material, babylonMaterial) {\n        return GLTFLoader.LoadExtensionAsync(context, material, this.name, async (extensionContext, extension) => {\n            const promises = new Array();\n            promises.push(this._loader.loadMaterialPropertiesAsync(context, material, babylonMaterial));\n            promises.push(this._loadClearCoatPropertiesAsync(extensionContext, extension, babylonMaterial));\n            await Promise.all(promises);\n        });\n    }\n    // eslint-disable-next-line @typescript-eslint/promise-function-async, no-restricted-syntax\n    _loadClearCoatPropertiesAsync(context, properties, babylonMaterial) {\n        const adapter = this._loader._getOrCreateMaterialAdapter(babylonMaterial);\n        const promises = new Array();\n        // Set non-texture properties immediately\n        adapter.configureCoat();\n        adapter.coatWeight = properties.clearcoatFactor !== undefined ? properties.clearcoatFactor : 0;\n        adapter.coatRoughness = properties.clearcoatRoughnessFactor !== undefined ? properties.clearcoatRoughnessFactor : 0;\n        // Load textures\n        if (properties.clearcoatTexture) {\n            promises.push(this._loader.loadTextureInfoAsync(`${context}/clearcoatTexture`, properties.clearcoatTexture, (texture) => {\n                texture.name = `${babylonMaterial.name} (ClearCoat)`;\n                adapter.coatWeightTexture = texture;\n            }));\n        }\n        if (properties.clearcoatRoughnessTexture) {\n            properties.clearcoatRoughnessTexture.nonColorData = true;\n            promises.push(this._loader.loadTextureInfoAsync(`${context}/clearcoatRoughnessTexture`, properties.clearcoatRoughnessTexture, (texture) => {\n                texture.name = `${babylonMaterial.name} (ClearCoat Roughness)`;\n                adapter.coatRoughnessTexture = texture;\n            }));\n        }\n        if (properties.clearcoatNormalTexture) {\n            properties.clearcoatNormalTexture.nonColorData = true;\n            promises.push(this._loader.loadTextureInfoAsync(`${context}/clearcoatNormalTexture`, properties.clearcoatNormalTexture, (texture) => {\n                texture.name = `${babylonMaterial.name} (ClearCoat Normal)`;\n                adapter.geometryCoatNormalTexture = texture;\n                if (properties.clearcoatNormalTexture?.scale != undefined) {\n                    adapter.geometryCoatNormalTextureScale = properties.clearcoatNormalTexture.scale;\n                }\n            }));\n            adapter.setNormalMapInversions(!babylonMaterial.getScene().useRightHandedSystem, babylonMaterial.getScene().useRightHandedSystem);\n        }\n        // eslint-disable-next-line github/no-then\n        return Promise.all(promises).then(() => { });\n    }\n}\nunregisterGLTFExtension(NAME);\nregisterGLTFExtension(NAME, true, (loader) => new KHR_materials_clearcoat(loader));\n//# sourceMappingURL=KHR_materials_clearcoat.js.map"],"names":["NAME","KHR_materials_clearcoat","loader","context","material","babylonMaterial","GLTFLoader","extensionContext","extension","promises","properties","adapter","texture","unregisterGLTFExtension","registerGLTFExtension"],"mappings":"4SAEA,MAAMA,EAAO,0BAMN,MAAMC,CAAwB,CAIjC,YAAYC,EAAQ,CAIhB,KAAK,KAAOF,EAIZ,KAAK,MAAQ,IACb,KAAK,QAAUE,EACf,KAAK,QAAU,KAAK,QAAQ,gBAAgBF,CAAI,CACpD,CAEA,SAAU,CACN,KAAK,QAAU,IACnB,CAKA,4BAA4BG,EAASC,EAAUC,EAAiB,CAC5D,OAAOC,EAAW,mBAAmBH,EAASC,EAAU,KAAK,KAAM,MAAOG,EAAkBC,IAAc,CACtG,MAAMC,EAAW,IAAI,MACrBA,EAAS,KAAK,KAAK,QAAQ,4BAA4BN,EAASC,EAAUC,CAAe,CAAC,EAC1FI,EAAS,KAAK,KAAK,8BAA8BF,EAAkBC,EAAWH,CAAe,CAAC,EAC9F,MAAM,QAAQ,IAAII,CAAQ,CAC9B,CAAC,CACL,CAEA,8BAA8BN,EAASO,EAAYL,EAAiB,CAChE,MAAMM,EAAU,KAAK,QAAQ,4BAA4BN,CAAe,EAClEI,EAAW,IAAI,MAErB,OAAAE,EAAQ,cAAa,EACrBA,EAAQ,WAAaD,EAAW,kBAAoB,OAAYA,EAAW,gBAAkB,EAC7FC,EAAQ,cAAgBD,EAAW,2BAA6B,OAAYA,EAAW,yBAA2B,EAE9GA,EAAW,kBACXD,EAAS,KAAK,KAAK,QAAQ,qBAAqB,GAAGN,CAAO,oBAAqBO,EAAW,iBAAmBE,GAAY,CACrHA,EAAQ,KAAO,GAAGP,EAAgB,IAAI,eACtCM,EAAQ,kBAAoBC,CAChC,CAAC,CAAC,EAEFF,EAAW,4BACXA,EAAW,0BAA0B,aAAe,GACpDD,EAAS,KAAK,KAAK,QAAQ,qBAAqB,GAAGN,CAAO,6BAA8BO,EAAW,0BAA4BE,GAAY,CACvIA,EAAQ,KAAO,GAAGP,EAAgB,IAAI,yBACtCM,EAAQ,qBAAuBC,CACnC,CAAC,CAAC,GAEFF,EAAW,yBACXA,EAAW,uBAAuB,aAAe,GACjDD,EAAS,KAAK,KAAK,QAAQ,qBAAqB,GAAGN,CAAO,0BAA2BO,EAAW,uBAAyBE,GAAY,CACjIA,EAAQ,KAAO,GAAGP,EAAgB,IAAI,sBACtCM,EAAQ,0BAA4BC,EAChCF,EAAW,wBAAwB,OAAS,OAC5CC,EAAQ,+BAAiCD,EAAW,uBAAuB,MAEnF,CAAC,CAAC,EACFC,EAAQ,uBAAuB,CAACN,EAAgB,SAAQ,EAAG,qBAAsBA,EAAgB,SAAQ,EAAG,oBAAoB,GAG7H,QAAQ,IAAII,CAAQ,EAAE,KAAK,IAAM,CAAE,CAAC,CAC/C,CACJ,CACAI,EAAwBb,CAAI,EAC5Bc,EAAsBd,EAAM,GAAOE,GAAW,IAAID,EAAwBC,CAAM,CAAC","x_google_ignoreList":[0]}
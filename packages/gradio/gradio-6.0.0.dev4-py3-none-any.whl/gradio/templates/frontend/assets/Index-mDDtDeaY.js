import{p as n,d as Xe,i as z,e as Be,s as Ae,a as Ue,c as He,f as Je,g as Se}from"./i18n-5O2R8uRh.js";import{p as We,R as Ke,l as fe,d as v,i as r,m as de,a as Ne,f as _e,U as I,V as Z,X as Q,b,h as Ie,s as J,t as De,e as Pe,c as Ge,_ as ce,g as o,Q as M,j as c,r as ke,aC as Oe,af as ve,ag as Ye,ah as Ze,a9 as B}from"./index-bhUlIv2p.js";import{G as $e}from"./utils.svelte-Baqu2V3e.js";import{g as et,I as tt}from"./ImagePreview-Cc5JdZW5.js";import{b as ge}from"./misc-BSG2QtlE.js";/* empty css                                                        */import"./MarkdownCode.svelte_svelte_type_style_lang-ywXsGwHK.js";import{B as rt}from"./BlockLabel-B0lD-lMe.js";import{I as at}from"./IconButton-CbXWacxl.js";import{C as st}from"./Clear-DimAkCP_.js";import{I as Re}from"./Image-CR2fNVDq.js";import{S as lt}from"./SelectSource-BistOEG2.js";import{I as nt}from"./IconButtonWrapper-DsFz-pKX.js";import{F as ot}from"./FullscreenButton-0A34tPEK.js";import{W as it}from"./Webcam-BKgcrlSh.js";import{U as ut,a as dt}from"./Upload-DUNHTCuE.js";import{I as gt}from"./Image-CfdJwp5Q.js";/* empty css                                                    */import{B as Ce}from"./Block-CWUxteKJ.js";import{E as ct}from"./Empty-5TrEX-tI.js";import{U as Fe}from"./UploadText-BSp3FKTS.js";import{S as Ee}from"./index-D9STzgM4.js";/* empty css                                                   */import{default as cr}from"./Example-BXVJVyZK.js";import"./DownloadLink-BGikjoQ1.js";import"./ShareButton-2E8myMWE.js";import"./Community-DDp4fj5H.js";import"./Download-CYnkzDbq.js";/* empty css                                                   */import"./prism-python-Bb2K859D.js";import"./svelte-component-Df_c_uts.js";import"./ImagePaste-CAS9twPF.js";import"./Upload-CzlAHTb6.js";import"./Spinner-laNWWtqG.js";import"./Maximize-Dcz8xF4p.js";import"./actions-CwcOrYgf.js";import"./index-VAFKmIBi.js";import"./props-BmhlB8PY.js";import"./DropdownArrow-CjmTE0-H.js";import"./Square-CArgr-u_.js";import"./StreamingBar-C_AQhOWl.js";/* empty css                                             */import"./utils-BsTlurbm.js";/* empty css                                            *//* empty css                                              */var _t=_e("<!> <!>",1),mt=_e("<div><!></div>"),pt=_e('<!> <div data-testid="image" class="image-container svelte-6uxbr3"><!> <div><!> <!></div> <!></div>',1);function ft(he,a){We(a,!1);const R=de();let l=n(a,"value",12,null),$=n(a,"label",12,void 0),ee=n(a,"show_label",12),e=n(a,"sources",28,()=>["upload","clipboard","webcam"]),i=n(a,"streaming",12,!1),h=n(a,"pending",12,!1),w=n(a,"webcam_options",12),T=n(a,"selectable",12,!1),S=n(a,"root",12),V=n(a,"i18n",12),K=n(a,"max_file_size",12,null),N=n(a,"upload",12),X=n(a,"stream_handler",12),te=n(a,"stream_every",12),re=n(a,"time_limit",12),ae=n(a,"show_fullscreen_button",12,!0),m=n(a,"stream_state",12,"closed"),u=n(a,"upload_promise",12,null),D=de(),y=n(a,"uploading",12,!1),g=n(a,"active_source",12,null),A=n(a,"fullscreen",12,!1),j=de([]),L=de();async function P({detail:t}){if(!i()){if(t.path?.toLowerCase().endsWith(".svg")&&t.url){const p=await(await fetch(t.url)).text();l({...t,url:`data:image/svg+xml,${encodeURIComponent(p)}`})}else l(t);await ce(),C("upload")}}function se(){l(null),C("clear"),C("change",null)}function H(t){se(),t.stopPropagation()}async function le(t,_){if(console.log("handle_save",{event:_,img_blob:t}),_==="stream"){C("stream",{value:{url:t},is_value_data:!0});return}c(L,Math.random().toString(36).substring(2,15));const p=new File([t],`image.${i()?"jpeg":"png"}`);c(j,[new Oe({path:p.name,orig_name:p.name,blob:p,size:p.size,mime_type:p.type,is_stream:!1})]),h(!0);const q=await r(D).load_files([p],r(L));console.log("uploaded file",q),(_==="change"||_==="upload")&&(l(q?.[0]||null),await ce(),C("change")),h(!1)}const C=Ke();let U=n(a,"dragging",12,!1);function s(t){let _=et(t);_&&C("select",{index:_,value:null})}async function ze(t){switch(t){case"clipboard":r(D).paste_clipboard();break}}let ne=de();function be(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),U(!0)}async function we(t){t.preventDefault(),t.stopPropagation(),U(!1),l()&&(se(),await ce()),g("upload"),await ce(),r(D).load_files_from_drop(t)}fe(()=>(v(g()),v(e())),()=>{!g()&&e()&&g(e()[0])}),fe(()=>(v(i()),v(g())),()=>{c(R,i()&&g()==="webcam")}),fe(()=>(v(y()),r(R)),()=>{y()&&!r(R)&&l(null)}),fe(()=>v(U()),()=>{C("drag",U())}),Ne();var ye={get value(){return l()},set value(t){l(t),o()},get label(){return $()},set label(t){$(t),o()},get show_label(){return ee()},set show_label(t){ee(t),o()},get sources(){return e()},set sources(t){e(t),o()},get streaming(){return i()},set streaming(t){i(t),o()},get pending(){return h()},set pending(t){h(t),o()},get webcam_options(){return w()},set webcam_options(t){w(t),o()},get selectable(){return T()},set selectable(t){T(t),o()},get root(){return S()},set root(t){S(t),o()},get i18n(){return V()},set i18n(t){V(t),o()},get max_file_size(){return K()},set max_file_size(t){K(t),o()},get upload(){return N()},set upload(t){N(t),o()},get stream_handler(){return X()},set stream_handler(t){X(t),o()},get stream_every(){return te()},set stream_every(t){te(t),o()},get time_limit(){return re()},set time_limit(t){re(t),o()},get show_fullscreen_button(){return ae()},set show_fullscreen_button(t){ae(t),o()},get stream_state(){return m()},set stream_state(t){m(t),o()},get upload_promise(){return u()},set upload_promise(t){u(t),o()},get uploading(){return y()},set uploading(t){y(t),o()},get active_source(){return g()},set active_source(t){g(t),o()},get fullscreen(){return A()},set fullscreen(t){A(t),o()},get dragging(){return U()},set dragging(t){U(t),o()}};Xe();var F=pt(),oe=I(F);{let t=Z(()=>$()||"Image");rt(oe,{get show_label(){return ee()},get Icon(){return Re},get label(){return r(t)}})}var ie=J(oe,2),me=Ie(ie);nt(me,{children:(t,_)=>{var p=Q(),q=I(p);{var f=k=>{var d=_t(),O=I(d);{var ue=x=>{ot(x,{get fullscreen(){return A()},$$events:{fullscreen(Y){ge.call(this,a,Y)}}})};z(O,x=>{ae()&&x(ue)})}var G=J(O,2);at(G,{get Icon(){return st},label:"Remove Image",$$events:{click:H}}),b(k,d)};z(q,k=>{v(l()),r(R),M(()=>l()?.url&&!r(R))&&k(f)})}b(t,p)},$$slots:{default:!0}});var E=J(me,2);let W,pe;var xe=Ie(E);{let t=Z(()=>l()!==null||g()==="webcam"),_=Z(()=>g()==="clipboard"?"clipboard":"image/*"),p=Z(()=>(v(e()),v(l()),M(()=>!e().includes("upload")||l()!==null))),q=Z(()=>(v(V()),M(()=>V()("image.drop_to_upload"))));Be(ut(xe,{get hidden(){return r(t)},get filetype(){return r(_)},get root(){return S()},get max_file_size(){return K()},get disable_click(){return r(p)},get upload(){return N()},get stream_handler(){return X()},get aria_label(){return r(q)},get upload_promise(){return u()},set upload_promise(f){u(f)},get uploading(){return y()},set uploading(f){y(f)},get dragging(){return U()},set dragging(f){U(f)},$$events:{load:P,error(f){ge.call(this,a,f)}},children:(f,k)=>{var d=Q(),O=I(d);{var ue=G=>{var x=Q(),Y=I(x);Ae(Y,a,"default",{},null),b(G,x)};z(O,G=>{l()===null&&G(ue)})}b(f,d)},$$slots:{default:!0},$$legacy:!0}),f=>c(D,f),()=>r(D))}var Te=J(xe,2);{var je=t=>{dt(t,{get root(){return S()},get upload_id(){return r(L)},get stream_handler(){return X()},get files(){return r(j)}})},Le=t=>{var _=Q(),p=I(_);{var q=k=>{it(k,{get root(){return S()},get value(){return l()},get stream_state(){return m()},get mirror_webcam(){return v(w()),M(()=>w().mirror)},get stream_every(){return te()},get streaming(){return i()},mode:"image",include_audio:!1,get i18n(){return V()},get upload(){return N()},get time_limit(){return re()},get webcam_constraints(){return v(w()),M(()=>w().constraints)},$$events:{capture:d=>le(d.detail,"change"),stream:d=>le(d.detail,"stream"),error(d){ge.call(this,a,d)},drag(d){ge.call(this,a,d)},upload:d=>le(d.detail,"upload"),close_stream(d){ge.call(this,a,d)}}})},f=k=>{var d=Q(),O=I(d);{var ue=G=>{var x=mt();let Y;var Qe=Ie(x);{let Ve=Z(()=>(v(l()),M(()=>({alt:l().alt_text}))));gt(Qe,{get src(){return v(l()),M(()=>l().url)},get restProps(){return r(Ve)}})}ke(x),De(()=>Y=Ue(x,1,"image-frame svelte-6uxbr3",null,Y,{selectable:T()})),Pe("click",x,s),b(G,x)};z(O,G=>{l()!==null&&!i()&&G(ue)},!0)}b(k,d)};z(p,k=>{g()==="webcam"&&(i()||!i()&&!l())?k(q):k(f,!1)},!0)}b(t,_)};z(Te,t=>{g()==="webcam"&&!i()&&h()?t(je):t(Le,!1)})}ke(E);var qe=J(E,2);{var Me=t=>{lt(t,{get sources(){return e()},handle_clear:se,handle_select:ze,get active_source(){return g()},set active_source(_){g(_)},$$legacy:!0})};z(qe,t=>{v(e()),M(()=>e().length>1||e().includes("clipboard"))&&t(Me)})}return ke(ie),Be(ie,t=>c(ne,t),()=>r(ne)),De(()=>{W=Ue(E,1,"upload-container svelte-6uxbr3",null,W,{"reduced-height":e().length>1}),pe=He(E,"",pe,{width:l()?"auto":"100%"})}),Pe("dragover",E,be),Pe("drop",E,we),b(he,F),Ge(ye)}var vt=_e("<!> <!>",1),ht=_e("<!> <!>",1);function ur(he,a){We(a,!0);let R={value:null},l=ve(void 0);class $ extends $e{async get_data(){r(l)&&(await r(l),await ce());const u=await super.get_data();return a.props.streaming&&(u.value=R.value),u}}const ee=Je(a,["$$slots","$$events","$$legacy"]),e=new $(ee);let i=ve(!1),h=ve(!1),w=B(()=>e.props.sources?e.props.sources[0]:null),T;const S=m=>{const u=m;u.preventDefault(),u.stopPropagation(),u.type==="dragenter"||u.type==="dragover"?c(h,!0):u.type==="dragleave"&&c(h,!1)},V=m=>{if(e.shared.interactive){const u=m;u.preventDefault(),u.stopPropagation(),c(h,!1),T&&T.loadFilesFromDrop(u)}};let K=ve(Ye(e.props.value));Ze(()=>{r(K)!=e.props.value&&(c(K,e.props.value,!0),e.dispatch("change"))});let N=B(()=>e?.shared?.loading_status.stream_state);var X=Q(),te=I(X);{var re=m=>{{let u=B(()=>r(h)?"focus":"base"),D=B(()=>e.props.height||void 0);Ce(m,{get visible(){return e.shared.visible},variant:"solid",get border_mode(){return r(u)},padding:!1,get elem_id(){return e.shared.elem_id},get elem_classes(){return e.shared.elem_classes},get height(){return r(D)},get width(){return e.props.width},allow_overflow:!1,get container(){return e.shared.container},"scale{gradio.shared.scale}":!0,get min_width(){return e.shared.min_width},get fullscreen(){return r(i)},set fullscreen(y){c(i,y,!0)},children:(y,g)=>{var A=vt(),j=I(A);Ee(j,Se({get autoscroll(){return e.shared.autoscroll},get i18n(){return e.i18n}},()=>e.shared.loading_status));var L=J(j,2);tt(L,{get fullscreen(){return r(i)},get value(){return e.props.value},get label(){return e.shared.label},get show_label(){return e.shared.show_label},get selectable(){return e.props._selectable},get i18n(){return e.i18n},get buttons(){return e.props.buttons},$$events:{select:({detail:P})=>e.dispatch("select",P),share:({detail:P})=>e.dispatch("share",P),error:({detail:P})=>e.dispatch("error",P),fullscreen:({detail:P})=>{c(i,P,!0)}}}),b(y,A)},$$slots:{default:!0}})}},ae=m=>{{let u=B(()=>e.props.value===null?"dashed":"solid"),D=B(()=>r(h)?"focus":"base"),y=B(()=>e.props.height||void 0);Ce(m,{get visible(){return e.shared.visible},get variant(){return r(u)},get border_mode(){return r(D)},padding:!1,get elem_id(){return e.shared.elem_id},get elem_classes(){return e.shared.elem_classes},get height(){return r(y)},get width(){return e.props.width},allow_overflow:!1,get container(){return e.shared.container},get scale(){return e.shared.scale},get min_width(){return e.shared.min_width},get fullscreen(){return r(i)},set fullscreen(g){c(i,g,!0)},$$events:{dragenter:S,dragleave:S,dragover:S,drop:V},children:(g,A)=>{var j=ht(),L=I(j);{var P=H=>{Ee(H,Se({get autoscroll(){return e.shared.autoscroll},get i18n(){return e.i18n}},()=>e.shared.loading_status,{$$events:{clear_status:()=>e.dispatch("clear_status",e.shared.loading_status)}}))};z(L,H=>{e.shared.loading_status.type==="output"&&H(P)})}var se=J(L,2);{let H=B(()=>e.props.buttons===null?!0:e.props.buttons.includes("fullscreen")),le=B(()=>e.shared.loading_status?.status==="pending"||e.shared.loading_status?.status==="streaming"),C=B(()=>e.shared.loading_status?.time_limit),U=B(()=>e.shared.client?.stream);Be(ft(se,{get selectable(){return e.props._selectable},get root(){return e.shared.root},get sources(){return e.props.sources},get fullscreen(){return r(i)},get show_fullscreen_button(){return r(H)},get label(){return e.shared.label},get show_label(){return e.shared.show_label},get pending(){return r(le)},get streaming(){return e.props.streaming},get webcam_options(){return e.props.webcam_options},get stream_every(){return e.props.stream_every},get time_limit(){return r(C)},get max_file_size(){return e.shared.max_file_size},get i18n(){return e.i18n},upload:(...s)=>e.shared.client.upload(...s),get stream_handler(){return r(U)},get stream_state(){return r(N)},get upload_promise(){return r(l)},set upload_promise(s){c(l,s,!0)},get active_source(){return r(w)},set active_source(s){c(w,s)},get value(){return e.props.value},set value(s){e.props.value=s},get dragging(){return r(h)},set dragging(s){c(h,s,!0)},$$events:{edit:()=>e.dispatch("edit"),clear:()=>{c(i,!1),e.dispatch("clear"),e.dispatch("input")},stream:({detail:s})=>{R=s,e.dispatch("stream",s)},drag:({detail:s})=>c(h,s,!0),upload:()=>{e.dispatch("upload"),e.dispatch("input")},select:({detail:s})=>e.dispatch("select",s),share:({detail:s})=>e.dispatch("share",s),error:({detail:s})=>{e.shared.loading_status.status="error",e.dispatch("error",s)},close_stream:()=>{e.dispatch("close_stream")},fullscreen:({detail:s})=>{c(i,s,!0)}},children:(s,ze)=>{var ne=Q(),be=I(ne);{var we=F=>{Fe(F,{get i18n(){return e.i18n},type:"image",get placeholder(){return e.props.placeholder}})},ye=F=>{var oe=Q(),ie=I(oe);{var me=W=>{Fe(W,{get i18n(){return e.i18n},type:"clipboard",mode:"short"})},E=W=>{ct(W,{unpadded_box:!0,size:"large",children:(pe,xe)=>{Re(pe)},$$slots:{default:!0}})};z(ie,W=>{r(w)==="clipboard"?W(me):W(E,!1)},!0)}b(F,oe)};z(be,F=>{r(w)==="upload"||!r(w)?F(we):F(ye,!1)})}b(s,ne)},$$slots:{default:!0}}),s=>T=s,()=>T)}b(g,j)},$$slots:{default:!0}})}};z(te,m=>{e.shared.interactive?m(ae,!1):m(re)})}b(he,X),Ge()}export{cr as BaseExample,gt as BaseImage,ft as BaseImageUploader,tt as BaseStaticImage,it as Webcam,ur as default};
//# sourceMappingURL=Index-mDDtDeaY.js.map

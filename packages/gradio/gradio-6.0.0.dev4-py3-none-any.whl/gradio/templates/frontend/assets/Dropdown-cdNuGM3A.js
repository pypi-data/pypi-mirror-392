import{p as k,d as be,e as se,i as ce,t as ge,a as Q,b as W,c as ie,u as we,r as ye}from"./i18n-5O2R8uRh.js";import{p as pe,R as xe,l as ke,d as C,i as e,m as y,a as Ae,f as G,e as R,U as De,b as H,c as de,g as A,aD as Oe,s as F,j as s,h as z,r as $,t as Z,Q as te,k as fe,af as Y,ag as ne,a9 as x,ah as Te,$ as Ee,aA as ue,_ as Be,W as Ce}from"./index-bhUlIv2p.js";import{b as $e}from"./input-BWfFfFnB.js";import{t as Re,a as Se}from"./index-VAFKmIBi.js";import{b as Ue}from"./window-BwbneT0F.js";import{p as ze}from"./event-modifiers-CdEA5IGF.js";/* empty css                                                        */import{B as He}from"./BlockTitle-FeDv4ORC.js";import"./MarkdownCode.svelte_svelte_type_style_lang-ywXsGwHK.js";import{D as Le}from"./DropdownArrow-CjmTE0-H.js";var Ne=G('<li data-testid="dropdown-option" role="option"><span>âœ“</span> </li>'),je=G('<ul class="options svelte-1ou0lab" role="listbox"></ul>'),qe=G('<div class="reference"></div> <!>',1);function Ie(h,o){pe(o,!1);let p=k(o,"choices",12),t=k(o,"filtered_indices",12),m=k(o,"show_options",12,!1),g=k(o,"disabled",12,!1),u=k(o,"selected_indices",28,()=>[]),w=k(o,"active_index",12,null),b=k(o,"remember_scroll",12,!1),L=k(o,"offset_from_top",12,0),D=k(o,"from_top",12,!1),d=y(),i=y(),S=y(),T=y(),_=y(),c=y(),N=y(),j=y(),q=y(),J=y(),I=y(0);function E(){const{top:r,bottom:v}=e(_).getBoundingClientRect();D()?s(d,L()):s(d,r),s(i,e(J)-v)}let B=null;function K(){m()&&(B!==null&&clearTimeout(B),B=setTimeout(()=>{E(),B=null},10))}function M(){e(c)?.scrollTo?.(0,e(I))}const U=xe();ke(()=>(C(m()),e(_),C(b()),e(c),C(u()),e(S),e(i),e(d),C(D())),()=>{if(m()&&e(_)){if(b())M();else if(e(c)&&u().length>0){let v=e(c).querySelectorAll("li");for(const l of Array.from(v))if(l.getAttribute("data-index")===u()[0].toString()){e(c)?.scrollTo?.(0,l.offsetTop);break}}E();const r=e(_).parentElement?.getBoundingClientRect();s(S,r?.height||0),s(T,r?.width||0)}e(i)>e(d)||D()?(s(N,`${e(d)}px`),s(q,e(i)),s(j,null)):(s(j,`${e(i)+e(S)}px`),s(q,e(d)-e(S)),s(N,null))}),Ae();var V={get choices(){return p()},set choices(r){p(r),A()},get filtered_indices(){return t()},set filtered_indices(r){t(r),A()},get show_options(){return m()},set show_options(r){m(r),A()},get disabled(){return g()},set disabled(r){g(r),A()},get selected_indices(){return u()},set selected_indices(r){u(r),A()},get active_index(){return w()},set active_index(r){w(r),A()},get remember_scroll(){return b()},set remember_scroll(r){b(r),A()},get offset_from_top(){return L()},set offset_from_top(r){L(r),A()},get from_top(){return D()},set from_top(r){D(r),A()}};be();var P=qe();R("scroll",Oe,K);var f=De(P);se(f,r=>s(_,r),()=>e(_));var X=F(f,2);{var ee=r=>{var v=je();let l;ge(v,5,t,we,(n,a)=>{var O=Ne();let le,re;var oe=z(O);let ae;var _e=F(oe);$(O),Z((ve,he,me)=>{le=Q(O,1,"item svelte-1ou0lab",null,le,ve),W(O,"data-index",e(a)),W(O,"aria-label",(C(p()),e(a),te(()=>p()[e(a)][0]))),W(O,"aria-selected",he),re=ie(O,"",re,{width:e(T)+"px"}),ae=Q(oe,1,"inner-item svelte-1ou0lab",null,ae,me),fe(_e,` ${C(p()),e(a),te(()=>p()[e(a)][0])??""}`)},[()=>({selected:u().includes(e(a)),active:e(a)===w(),"bg-gray-100":e(a)===w(),"dark:bg-gray-600":e(a)===w()}),()=>(C(u()),e(a),te(()=>u().includes(e(a)))),()=>({hide:!u().includes(e(a))})]),H(n,O)}),$(v),se(v,n=>s(c,n),()=>e(c)),Z(()=>l=ie(v,"",l,{top:e(N),bottom:e(j),"max-height":`calc(${e(q)}px - var(--window-padding))`,width:e(T)+"px"})),Re(3,v,()=>Se,()=>({duration:200,y:5})),R("mousedown",v,ze(n=>U("change",n))),R("scroll",v,n=>s(I,n.currentTarget.scrollTop)),H(r,v)};ce(X,r=>{m()&&!g()&&r(ee)})}return Ue("innerHeight",r=>s(J,r)),H(h,P),de(V)}function Pe(h,o){return(h%o+o)%o}function Qe(h,o){return h.reduce((p,t,m)=>((!o||t[0].toLowerCase().includes(o.toLowerCase()))&&p.push(m),p),[])}function We(h,o,p){if(h.key==="Escape")return[!1,o];if((h.key==="ArrowDown"||h.key==="ArrowUp")&&p.length>0)if(o===null)o=h.key==="ArrowDown"?p[0]:p[p.length-1];else{const t=p.indexOf(o),m=h.key==="ArrowUp"?-1:1;o=p[Pe(t+m,p.length)]}return[!0,o]}var Fe=G('<div class="icon-wrap svelte-1xfsv4t"><!></div>'),Ge=G('<div><!> <div class="wrap svelte-1xfsv4t"><div><div class="secondary-wrap svelte-1xfsv4t"><input role="listbox" aria-controls="dropdown-options" autocomplete="off"/> <!></div></div> <!></div></div>');function lt(h,o){pe(o,!0);const p=typeof window<"u",t=o.gradio;let m=x(()=>t.shared.label||"Dropdown"),g,u=x(()=>p&&g===document.activeElement),w=x(()=>t.props.choices.map(l=>l[0])),b=x(()=>t.props.choices.map(l=>l[1])),L=x(()=>t.props.value===void 0||Array.isArray(t.props.value)&&t.props.value.length===0?["",null]:e(b).includes(t.props.value)?[e(w)[e(b).indexOf(t.props.value)],e(b).indexOf(t.props.value)]:t.props.allow_custom_value?[t.props.value,null]:["",null]),D=x(()=>ue(e(L),2)),d=x(()=>e(D)[0]),i=x(()=>e(D)[1]),S=Y(!1),T=x(()=>!t.shared.interactive),_=Y(ne(t.props.choices.map((l,n)=>n))),c=Y(null);t.props.value&&(s(i,t.props.choices.map(l=>l[1]).indexOf(t.props.value)),e(i)===-1?s(i,null):s(d,t.props.choices[e(i)][0]));function N(l){if(s(i,parseInt(l.detail.target.dataset.index)),isNaN(e(i))){s(i,null);return}let[n,a]=t.props.choices[e(i)];s(d,n),t.props.value=a,t.dispatch("select",{index:e(i),value:e(b)[e(i)],selected:!0}),s(u,!1),s(c,null),g.blur()}function j(l){s(_,t.props.choices.map((n,a)=>a),!0),s(u,!0),t.dispatch("focus")}function q(){t.props.allow_custom_value?t.props.value=e(d):s(d,e(w)[e(b).indexOf(t.props.value)]),s(u,!1),s(c,null),s(_,t.props.choices.map((l,n)=>n),!0),t.dispatch("blur"),t.dispatch("input")}async function J(l){await Be(),s(_,Qe(t.props.choices,e(d)),!0),s(c,e(_).length>0?e(_)[0]:null,!0),(n=>{var a=ue(n,2);s(u,a[0]),s(c,a[1],!0)})(We(l,e(c),e(_))),l.key==="Enter"&&(e(c)!==null?(s(i,e(c)),t.props.value=e(b)[e(c)],s(u,!1),g.blur(),s(c,null)):e(w).includes(e(d))?(s(i,e(w).indexOf(e(d))),t.props.value=e(b)[e(i)],s(u,!1),s(c,null),g.blur()):t.props.allow_custom_value&&(t.props.value=e(d),s(i,null),s(u,!1),s(c,null),g.blur()))}let I=Y(ne(t.props.value));Te(()=>{e(I)!==t.props.value&&(s(I,t.props.value,!0),t.dispatch("change"))});var E=Ge();let B;var K=z(E);He(K,{get show_label(){return t.shared.show_label},get info(){return t.props.info},children:(l,n)=>{Ce();var a=Ee();Z(()=>fe(a,e(m))),H(l,a)},$$slots:{default:!0}});var M=F(K,2),U=z(M);let V;var P=z(U),f=z(P);ye(f);let X;se(f,l=>g=l,()=>g);var ee=F(f,2);{var r=l=>{var n=Fe(),a=z(n);Le(a),$(n),H(l,n)};ce(ee,l=>{e(T)||l(r)})}$(P),$(U);var v=F(U,2);{let l=x(()=>e(i)===null?[]:[e(i)]);Ie(v,{get show_options(){return e(u)},get choices(){return t.props.choices},get filtered_indices(){return e(_)},get disabled(){return e(T)},get selected_indices(){return e(l)},get active_index(){return e(c)},$$events:{change:N,load:()=>s(S,!0)}})}$(M),$(E),Z(l=>{B=Q(E,1,"svelte-1xfsv4t",null,B,{container:t.shared.container}),V=Q(U,1,"wrap-inner svelte-1xfsv4t",null,V,{show_options:e(u)}),W(f,"aria-expanded",e(u)),W(f,"aria-label",e(m)),X=Q(f,1,"border-none svelte-1xfsv4t",null,X,l),f.disabled=e(T),f.readOnly=!t.props.filterable},[()=>({subdued:!e(w).includes(e(d))&&!t.props.allow_custom_value})]),$e(f,()=>e(d),l=>s(d,l)),R("keydown",f,J),R("keyup",f,l=>{t.dispatch("key_up",{key:l.key,input_value:e(d)})}),R("blur",f,q),R("focus",f,j),H(h,E),de()}export{Ie as D,Qe as a,lt as b,We as h};
//# sourceMappingURL=Dropdown-cdNuGM3A.js.map

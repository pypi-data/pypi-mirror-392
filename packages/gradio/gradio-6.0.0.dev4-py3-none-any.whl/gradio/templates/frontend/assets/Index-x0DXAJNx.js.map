{"version":3,"file":"Index-x0DXAJNx.js","sources":["../../../../js/annotatedimage/Index.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport {\n\t\tBlock,\n\t\tBlockLabel,\n\t\tEmpty,\n\t\tIconButtonWrapper,\n\t\tFullscreenButton\n\t} from \"@gradio/atoms\";\n\timport { Image } from \"@gradio/icons\";\n\timport { StatusTracker } from \"@gradio/statustracker\";\n\timport { Gradio } from \"@gradio/utils\";\n\timport type { AnnotatedImageProps, AnnotatedImageEvents } from \"./types\";\n\n\tconst props = $props();\n\tconst gradio = new Gradio<AnnotatedImageEvents, AnnotatedImageProps>(props);\n\n\tlet old_value = $state(gradio.props.value);\n\tlet active: string | null = $state(null);\n\tlet image_container: HTMLElement;\n\tlet fullscreen = $state(false);\n\tlet label = $derived(\n\t\tgradio.shared.label || gradio.i18n(\"annotated_image.annotated_image\")\n\t);\n\n\t$effect(() => {\n\t\tif (old_value != gradio.props.value) {\n\t\t\told_value = gradio.props.value;\n\t\t\tgradio.dispatch(\"change\");\n\t\t}\n\t});\n\n\tfunction handle_mouseover(_label: string): void {\n\t\tactive = _label;\n\t}\n\n\tfunction handle_mouseout(): void {\n\t\tactive = null;\n\t}\n\n\tfunction handle_click(i: number, value: string): void {\n\t\tgradio.dispatch(\"select\", {\n\t\t\tvalue: value,\n\t\t\tindex: i\n\t\t});\n\t}\n</script>\n\n<Block\n\tvisible={gradio.shared.visible}\n\telem_id={gradio.shared.elem_id}\n\telem_classes={gradio.shared.elem_classes}\n\tpadding={false}\n\theight={gradio.props.height}\n\twidth={gradio.props.width}\n\tallow_overflow={false}\n\tcontainer={gradio.shared.container}\n\tscale={gradio.shared.scale}\n\tmin_width={gradio.shared.min_width}\n\tbind:fullscreen\n>\n\t<StatusTracker\n\t\tautoscroll={gradio.shared.autoscroll}\n\t\ti18n={gradio.i18n}\n\t\t{...gradio.shared.loading_status}\n\t/>\n\t<BlockLabel show_label={gradio.shared.show_label} Icon={Image} {label} />\n\n\t<div class=\"container\">\n\t\t{#if gradio.props.value == null}\n\t\t\t<Empty size=\"large\" unpadded_box={true}><Image /></Empty>\n\t\t{:else}\n\t\t\t<div class=\"image-container\" bind:this={image_container}>\n\t\t\t\t<IconButtonWrapper>\n\t\t\t\t\t{#if gradio.props.buttons.includes(\"fullscreen\") ?? true}\n\t\t\t\t\t\t<FullscreenButton\n\t\t\t\t\t\t\t{fullscreen}\n\t\t\t\t\t\t\ton:fullscreen={({ detail }) => {\n\t\t\t\t\t\t\t\tfullscreen = detail;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/if}\n\t\t\t\t</IconButtonWrapper>\n\n\t\t\t\t<img\n\t\t\t\t\tclass=\"base-image\"\n\t\t\t\t\tclass:fit-height={gradio.props.height && !fullscreen}\n\t\t\t\t\tsrc={gradio.props.value ? gradio.props.value.image.url : null}\n\t\t\t\t\talt=\"the base file that is annotated\"\n\t\t\t\t/>\n\t\t\t\t{#each gradio.props.value ? gradio.props.value.annotations : [] as ann, i}\n\t\t\t\t\t<img\n\t\t\t\t\t\talt=\"segmentation mask identifying {gradio.shared\n\t\t\t\t\t\t\t.label} within the uploaded file\"\n\t\t\t\t\t\tclass=\"mask fit-height\"\n\t\t\t\t\t\tclass:fit-height={!fullscreen}\n\t\t\t\t\t\tclass:active={active == ann.label}\n\t\t\t\t\t\tclass:inactive={active != ann.label && active != null}\n\t\t\t\t\t\tsrc={ann.image.url}\n\t\t\t\t\t\tstyle={gradio.props.color_map && ann.label in gradio.props.color_map\n\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t: `filter: hue-rotate(${Math.round(\n\t\t\t\t\t\t\t\t\t(i * 360) / (gradio.props.value?.annotations.length ?? 1)\n\t\t\t\t\t\t\t\t)}deg);`}\n\t\t\t\t\t/>\n\t\t\t\t{/each}\n\t\t\t</div>\n\t\t\t{#if gradio.props.show_legend && gradio.props.value}\n\t\t\t\t<div class=\"legend\">\n\t\t\t\t\t{#each gradio.props.value.annotations as ann, i}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"legend-item\"\n\t\t\t\t\t\t\tstyle=\"background-color: {gradio.props.color_map &&\n\t\t\t\t\t\t\tann.label in gradio.props.color_map\n\t\t\t\t\t\t\t\t? gradio.props.color_map[ann.label] + '88'\n\t\t\t\t\t\t\t\t: `hsla(${Math.round(\n\t\t\t\t\t\t\t\t\t\t(i * 360) / gradio.props.value.annotations.length\n\t\t\t\t\t\t\t\t\t)}, 100%, 50%, 0.3)`}\"\n\t\t\t\t\t\t\ton:mouseover={() => handle_mouseover(ann.label)}\n\t\t\t\t\t\t\ton:focus={() => handle_mouseover(ann.label)}\n\t\t\t\t\t\t\ton:mouseout={() => handle_mouseout()}\n\t\t\t\t\t\t\ton:blur={() => handle_mouseout()}\n\t\t\t\t\t\t\ton:click={() => handle_click(i, ann.label)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ann.label}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n</Block>\n\n<style>\n\t.base-image {\n\t\tdisplay: block;\n\t\twidth: 100%;\n\t\theight: auto;\n\t}\n\t.container {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t}\n\t.image-container {\n\t\tposition: relative;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tflex-grow: 1;\n\t\twidth: 100%;\n\t\toverflow: hidden;\n\t}\n\t.fit-height {\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tobject-fit: contain;\n\t}\n\t.mask {\n\t\topacity: 0.85;\n\t\ttransition: all 0.2s ease-in-out;\n\t\tposition: absolute;\n\t}\n\t.image-container:hover .mask {\n\t\topacity: 0.3;\n\t}\n\t.mask.active {\n\t\topacity: 1;\n\t}\n\t.mask.inactive {\n\t\topacity: 0;\n\t}\n\t.legend {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t\talign-content: center;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tgap: var(--spacing-sm);\n\t\tpadding: var(--spacing-sm);\n\t}\n\t.legend-item {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tborder-radius: var(--radius-sm);\n\t\tpadding: var(--spacing-sm);\n\t}\n</style>\n"],"names":["props","$.rest_props","$$props","gradio","Gradio","old_value","$.state","$.proxy","active","image_container","fullscreen","label","$.derived","$.user_effect","$.get","$.set","handle_mouseover","_label","handle_mouseout","handle_click","i","value","Image","detail","$$render","consequent_1","$.each","node_5","ann","$.bind_this","div_1","$$value","div_2","consequent_2","classes","$.set_class","img","$.set_attribute","consequent","alternate"],"mappings":"y0CAAA,gBA0BGA,EAAAC,GAAAC,EAAA,CAAA,UAAA,WAAA,UAAA,CAAA,EACAC,EAAA,IAAOC,GAAkBJ,CAAA,EAEzB,IAAAK,EAAAC,EAAAC,GAAAJ,EAAA,MAAA,KAAA,CAAA,EAEFK,IAAwC,IAAA,EACvCC,EACDC,IAAA,EAAA,EAEAC,EAASC,GAAA,IACRT,EAAA,OAAS,OAAIA,EAAA,KAAA,iCAAA,CAAA,EAIbU,GAAA,IAAO,CACNC,EAAAT,CAAO,GAAAF,EAAK,MAAA,QACZY,EAAAV,EAAOF,EAAA,MAAA,MAAA,EAAA,IACN,SAAA,QAAA,EAEH,CAAC,EAED,SAAAa,EAAAC,EAAA,OACgB,EAAA,CAChB,UAESC,GAAK,SACA,CACd,UAESC,EAASC,EAAOC,EAAS,YACpB,UACL,MAAAA,QACJD,EAAA,CAEL,4BAICjB,EAAA,OAAA,gCACW,OAAW,yFAGjBA,EAAO,MAAM,6BACL,MAAM,sBACb,0BACAA,EAAO,OAAM,8BAChBA,EAAA,OAAiB,gCACL,OAAM,0IAIfA,EAAa,OAAM,uBACnB,OAAAA,EAAA,WACFA,EAAC,OAAA,4DAEgBA,EAAA,OAAA,8BAAAmB,6FAIa,mLAOX,WAAA,CAAA,CAAA,OAAAC,KAAU,KACdA,EAAC,EAAA,CAChB,eALIpB,EAAO,MAAM,QAAQ,SAAQ,YAAY,GAAA,KAAAqB,EAAAC,CAAA,mEAgB3CC,EAAAC,EAAA,GAAA,IAAAxB,EAAA,MAAA,MAAAA,EAAA,MAAA,MAAA,oBAAAyB,EAAAR,IAAA,mEAEejB,EAAA,OAChB,OAAK,EAAA,2BAAA,mEAEaO,CAAA,WACXF,CAAW,GAAAM,EAAKc,CAAG,QACb,SAAAd,EAAAN,CAAO,KAAKoB,CAAC,EAAA,OAAAd,EAAAN,CAAA,GAAA,mBACvBoB,CAAA,EAAA,MAAO,GAAM,WACZ,IAAAzB,EAAO,MAAK,WAAKW,EAAAc,CAAA,EAAA,SAAAzB,EAAA,MAAA,UAC5B,KAC8B,sBAAA,KAAA,MACpBiB,EAAA,KAAYjB,EAAK,MAAA,OAAA,YAA2B,QAAA,EAAA,CAAA,wBA9Bb0B,GAAAC,EAAAC,GAAAtB,QAAAA,CAAA,sCAqCjCiB,EAAAM,EAAA,GAAA,IAAA7B,EAAM,MAAA,MAAA,iBAAAyB,EAAA,IAAA,wFAGP,IAAAzB,EAAA,MAAA,WAAAW,EACDc,CAAA,EAAA,SAAAzB,EAAA,MAAA,UACAA,EAAA,MAAA,YAAAyB,CAAA,EAAA,KAAA,EAAA,KACC,QAAA,KAAA,gPARDzB,EAAA,MAAA,aAAAA,EAAA,MAAA,OAAAqB,EAAAS,EAAA,WArBgBC,EAAAC,EAAAC,EAAA,EAAA,4BAAA,KAAAF,EAAA,CAAA,aAAA/B,EAAO,MAAM,WAAOO,CAAY,EAAA,EAC5C2B,EAAAD,EAAA,MAAAjC,EAAM,MAAA,MAAAA,EAAA,MAAA,MAAA,MAAA,IAAA,IAAA,oBAlBXA,EAAO,MAAK,OAAK,KAAAqB,EAAAc,CAAA,EAAAd,EAAAe,EAAA,EAAA,4CAvBtB"}
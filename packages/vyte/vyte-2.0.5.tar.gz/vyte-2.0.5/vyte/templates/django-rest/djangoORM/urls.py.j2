"""
API URLs for Django REST Framework
Generated by presto v2.0
"""
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from drf_spectacular.views import (
    SpectacularAPIView,
    SpectacularSwaggerView,
    SpectacularRedocView,
)
from .views import (
    UserViewSet,
    ItemViewSet,
    {% if auth_enabled -%}
    UserRegisterView,
    ChangePasswordView,
    {% endif -%}
    TokenObtainPairView,
    TokenRefreshView,
    TokenVerifyView,
    health_check,
    api_root,
)

# ============================================================================
# ROUTER CONFIGURATION
# ============================================================================

router = DefaultRouter()
router.register(r'users', UserViewSet, basename='user')
router.register(r'items', ItemViewSet, basename='item')

{% if auth_enabled -%}
# ============================================================================
# AUTHENTICATION URLS
# ============================================================================

auth_urlpatterns = [
    # JWT Token endpoints
    path('login/', TokenObtainPairView.as_view(), name='token_obtain_pair'),
    path('refresh/', TokenRefreshView.as_view(), name='token_refresh'),
    path('verify/', TokenVerifyView.as_view(), name='token_verify'),

    # User registration and management
    path('register/', UserRegisterView.as_view(), name='user-register'),
    path('change-password/', ChangePasswordView.as_view(), name='user-change-password'),
]

{% endif -%}
# ============================================================================
# MAIN URL PATTERNS
# ============================================================================

urlpatterns = [
    # Health check and API root
    path('', health_check, name='health-check'),
    path('api/', api_root, name='api-root'),

    {% if auth_enabled -%}
    # Authentication endpoints
    path('api/auth/', include(auth_urlpatterns)),
    {% endif -%}

    # API endpoints (from router)
    path('api/', include(router.urls)),

    # ============================================================================
    # API DOCUMENTATION (OpenAPI/Swagger)
    # ============================================================================

    # OpenAPI schema
    path('api/schema/', SpectacularAPIView.as_view(), name='schema'),

    # Swagger UI
    path('api/docs/', SpectacularSwaggerView.as_view(url_name='schema'), name='swagger-ui'),

    # ReDoc UI (alternative documentation)
    path('api/redoc/', SpectacularRedocView.as_view(url_name='schema'), name='redoc'),
]

# Optional: Add schema/documentation URLs
# Uncomment to enable
"""
from rest_framework.schemas import get_schema_view
from rest_framework.documentation import include_docs_urls

schema_view = get_schema_view(
    title='{{ name }} API',
    description='API for {{ name }}',
    version='1.0.0'
)

urlpatterns += [
    path('api/schema/', schema_view, name='api-schema'),
    path('api/docs/', include_docs_urls(title='{{ name }} API')),
]
"""

# ============================================================================
# API URL PATTERNS (Alternative organization)
# ============================================================================

# If you prefer to organize by version:
"""
api_v1_patterns = [
    path('', include(router.urls)),
    {% if auth_enabled -%}
    path('auth/', include(auth_urlpatterns)),
    {% endif -%}
]

urlpatterns = [
    path('', health_check, name='health-check'),
    path('api/v1/', include(api_v1_patterns)),
]
"""

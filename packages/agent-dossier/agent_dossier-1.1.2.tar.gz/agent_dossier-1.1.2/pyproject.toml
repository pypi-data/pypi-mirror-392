# Version is managed by uv. To bump:
#   - Patch (0.1.2 -> 0.1.3): uv version --bump patch
#   - Minor (0.1.2 -> 0.2.0): uv version --bump minor
#   - Major (0.1.2 -> 1.0.0): uv version --bump major
# Then create a git tag: git tag v<version> && git push origin v<version>
# The tag will trigger the publish workflow to PyPI

[project]
name = "agent-dossier"
version = "1.1.2"
description = "A structured logging library for AI agents with session management and object unpacking"
readme = "README.md"
requires-python = ">=3.13"
license = "Apache-2.0"
authors = [
    { name = "Ricardo Decal", email = "dossier-project@ricardodecal.com" }
]
keywords = ["logging", "structlog", "ai", "agents", "session-management"]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: Apache Software License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.13",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Topic :: System :: Logging",
]
# Do not edit manually. Use `uv add <dep>` and `uv remove <dep>`
dependencies = [
    "beartype>=0.22.5",
    "better-exceptions>=0.3.3",
    "rich>=14.2.0",
    "structlog>=25.5.0",
]

[project.urls]
Homepage = "https://dossier.ricardodecal.com/"
Documentation = "https://dossier.ricardodecal.com/"
Repository = "https://github.com/crypdick/dossier"
Issues = "https://github.com/crypdick/dossier/issues"

[dependency-groups]
# Note: use `uvx pre-commit run --all-files` to run the pre-commit hooks
dev = [
    "langchain-core>=1.0.5",
    "mkdocs>=1.6.1",
    "mkdocs-autorefs>=1.4.3",
    "mkdocs-gen-files>=0.5.0",
    "mkdocs-literate-nav>=0.6.2",
    "mkdocs-llmstxt>=0.4.0",
    "mkdocs-material>=9.7.0",
    "mkdocstrings[python]>=0.30.1",
    "mypy>=1.18.2",
    "openai>=2.8.1",
    "openai-agents>=0.5.1",
    "pydantic>=2.12.4",
    "pytest>=9.0.1",
    "pytest-asyncio>=1.3.0",
    "pytest-cov>=7.0.0",
    "pytest-xdist>=3.8.0",
    "requests>=2.32.5",
    "ruff>=0.14.5",
    "types-requests>=2.32.0",
]


[tool.pytest.ini_options]
# Run with `uv run pytest`
testpaths = ["tests"]
pythonpath = ["."]
# Enable concurrent testing with pytest-xdist
# Use -n auto to automatically detect number of CPUs
# Or override with: uv run pytest -n <number>
addopts = "-n auto"

[tool.mypy]
# Enforce comprehensive type hinting
python_version = "3.13"
strict = true
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
disallow_incomplete_defs = true
disallow_untyped_calls = true
disallow_untyped_decorators = true
check_untyped_defs = true
no_implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
warn_unreachable = true
strict_equality = true
strict_concatenate = true
# Show error codes
show_error_codes = true
# Pretty output
pretty = true

# Less strict checking for test files
[[tool.mypy.overrides]]
module = [
    "tests.*",
    "test_.*",
]
disallow_untyped_defs = false
disallow_untyped_calls = false
check_untyped_defs = false
ignore_errors = true


[tool.ruff]
# Enable pycodestyle (`E`), Pylint (`PL`), and others
lint.select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "PLC", # Pylint convention
]

# Ignore line-too-long (E501) - many docstrings/messages are naturally longer
lint.ignore = ["E501"]

# PLC0415: Import outside top-level (import-outside-toplevel)
# This catches imports inside functions/classes which should generally be at module level
# Can be disabled per-line with # noqa: PLC0415
lint.extend-select = ["PLC0415"]

# Exclude test files from import-outside-toplevel check
# Tests commonly use function-scoped imports for isolation
[tool.ruff.lint.per-file-ignores]
"tests/**/*.py" = ["PLC0415"]
"**/test_*.py" = ["PLC0415"]

[build-system]
requires = ["uv_build>=0.9.2,<0.10.0"]
build-backend = "uv_build"

[tool.uv.build-backend]
module-name = "dossier"
module-root = ""

# Include py.typed marker for PEP 561 type hint support
[tool.uv.build-backend.package-data]
dossier = ["py.typed"]

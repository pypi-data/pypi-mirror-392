import{q as y,b2 as M,r as n,j as e,B as h,F as Y,Y as z,h as A,C as B}from"./index-DxSNfwTo.js";import{d as H}from"./index-Dj-YiGsJ.js";import{l as I}from"./js-yaml-yTPt38rv.js";const _=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],R=y("history",_);const $=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],q=y("undo-2",$);function P({value:r,onChange:x,onSave:o,readOnly:c=!1,height:N="600px",showToolbar:k=!0,showBackupRestore:S=!1,onRestore:v,canRestore:b=!1,configName:p}){const{theme:w}=M(),[d,m]=n.useState(r),[f,a]=n.useState(null),[l,j]=n.useState(!1),[u,i]=n.useState(!1);n.useEffect(()=>{m(r),i(!1)},[r]);const g=t=>{try{return I(t),a(null),!0}catch(s){return s instanceof Error?a(`YAML syntax error: ${s.message}`):a("Invalid YAML syntax"),!1}},C=t=>{const s=t||"";m(s),i(s!==r),s.trim()?g(s):a(null),x&&x(s)},E=async()=>{if(o&&g(d)){j(!0);try{await o(d),i(!1)}catch(t){t instanceof Error?a(`Save error: ${t.message}`):a("Failed to save configuration")}finally{j(!1)}}},L=()=>{m(r),i(!1),a(null)};return e.jsxs("div",{className:"flex flex-col gap-3",children:[k&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[p&&e.jsxs("div",{className:"text-sm font-medium text-muted-foreground",children:[p,".yml"]}),u&&e.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Unsaved changes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S&&v&&b&&e.jsxs(h,{variant:"outline",size:"sm",onClick:v,disabled:l,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Restore Backup"]}),u&&!c&&e.jsxs(h,{variant:"outline",size:"sm",onClick:L,disabled:l,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Revert"]}),o&&!c&&e.jsxs(h,{onClick:E,disabled:l||!u||!!f,size:"sm",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),l?"Saving...":"Save"]})]})]}),f&&e.jsxs(z,{variant:"destructive",className:"flex items-start gap-2",children:[e.jsx(A,{className:"h-4 w-4 mt-0.5"}),e.jsx("div",{className:"flex-1 text-sm",children:f})]}),e.jsx(B,{className:"overflow-hidden",children:e.jsx(H,{height:N,defaultLanguage:"yaml",value:d,onChange:C,theme:w==="dark"?"vs-dark":"light",options:{readOnly:c,minimap:{enabled:!0},fontSize:13,lineNumbers:"on",scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,tabSize:2,insertSpaces:!0,formatOnPaste:!0,formatOnType:!0}})})]})}export{R as H,P as Y};

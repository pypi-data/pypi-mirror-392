---
adapter_id: book_binder
role_name: Book Binder
abbreviation: BB
version: 2.0.0

# Primary expertise reference
expertise: "@expertise:book_binder_export"

# Mission from L1 charter
mission: "Assemble reproducible, accessible bundles from Cold, stamp snapshot & options, and keep navigation rock-solid."

# Core procedures this role executes
procedures:
  primary:
    - "@procedure:export_view_assembly"
    - "@procedure:front_matter_composition"
    - "@procedure:integrity_enforcement"
  supporting:
    - "@procedure:artifact_validation"
    - "@procedure:spoiler_hygiene"
    - "@procedure:tu_lifecycle"

# Protocol intents from L4
protocol_intents:
  receives:
    - view.export.request
    - tu.open
  sends:
    - view.export.result
    - view.log
    - view.anchor_map
    - view.assembly_notes
    - hook.create
    - ack

# Loop participation
loops:
  - playbook: "@playbook:binding_run"
    raci: responsible
    description: "Assemble view; compose front matter; run link/anchor pass"

  - playbook: "@playbook:narration_dry_run"
    raci: informed
    description: "Informed of view for PN testing"

# Quality bars focus
quality_bars:
  primary:
    - integrity      # TOC works; anchors resolve; crosslinks land; no orphan pages
    - presentation   # No internal labels or technique leaks in any surface
    - accessibility  # Front matter present (alt/captions status, contrast/print-friendly)
  secondary:
    - style          # Consistent heading and labeling (consult Style for changes)
    - reachability   # Navigation enables keystones to be reached

# Cross-cutting concerns
safety_protocols:
  - "@snippet:spoiler_hygiene_check"
  - "@snippet:pn_safety_warning"
  - "@snippet:validation_reminder"
  - "@snippet:cold_only_rule"
  - "@snippet:cold_manifest_validation"
  - "@snippet:accessibility"
  - "@snippet:no_internals"

# Cold-only rule (CRITICAL)
cold_only_rule:
  enforcement:
    - "NEVER export from Hot"
    - "NEVER mix Hot & Cold sources"
    - "Single snapshot source for entire view"
  rationale: "Reproducibility and PN safety require single Cold snapshot"

# Export view assembly
export_assembly:
  source: "Cold snapshot chosen by Showrunner"
  formats: ["MD", "HTML", "EPUB", "PDF"]
  options:
    - art_coverage: "plan-only OR with-assets"
    - audio_coverage: "plan-only OR with-assets"
    - language_coverage: "List of included languages"
    - layout_prefs: "Accessibility and typography settings"

# Front matter composition
front_matter:
  required_fields:
    - snapshot_id     # Reproducibility anchor
    - options         # Art/audio plan-or-assets, languages
    - accessibility_summary  # Alt text status, captions, contrast
    - coverage_notes  # Which sections/languages included
  player_safe: "All front matter must be non-revealing"

# Integrity enforcement
integrity_checks:
  anchors:
    - "All internal anchors resolve"
    - "No broken crosslinks"
    - "TOC entries land correctly"
  navigation:
    - "No orphan pages"
    - "All keystones reachable via navigation"
  artifacts:
    - "Generate anchor maps for debugging"
    - "Record broken links for upstream repair"

# Accessibility enforcement (CRITICAL)
accessibility_enforcement:
  descriptive_links: "No 'click here' - use descriptive link text"
  consistent_headings: "Hierarchy and structure maintained"
  alt_text_check: "All images have alt text"
  audio_captions: "All audio has captions or transcripts"
  print_friendly: "Default styling supports print and high contrast"

# Handoff protocols
handoffs:
  from_showrunner:
    content: "Receive snapshot ID and export options"
    artifacts: ["view.export.request"]

  to_gatekeeper:
    content: "Request export spot-check before view ships"
    trigger: "View assembly complete"

  to_player_narrator:
    content: "Deliver view bundle for dry-run testing"
    artifacts: ["view.export.result"]

  from_gatekeeper:
    content: "Receive export spot-check approval"
    artifacts: ["gatecheck_report"]

  from_translator:
    content: "Receive localized slices with coverage notes"
    artifacts: ["translation_slices"]

  from_style_lead:
    content: "Receive front-matter phrasing guidance"
    artifacts: ["style_notes"]

  to_owners:
    content: "Open TU and ping owner role when content issues found"
    trigger: "Broken links, ambiguous headings, nav friction"
    note: "Request upstream edits instead of 'fixing' in binder step"

# Context awareness requirements
context_requirements:
  - "Cold snapshot ID (single source for entire view)"
  - "Showrunner options (art/audio: plan vs assets; languages; layout prefs)"
  - "Gatekeeper Presentation checks to honor"
  - "Style/Translator cues (register/typography conventions)"
  - "View Log history (prior exports, known limitations)"

# View log maintenance
view_log:
  entry_fields:
    - snapshot_id       # Source snapshot
    - export_timestamp  # When view was generated
    - options           # Art/audio/language coverage
    - tu_title          # Player-safe TU title
    - known_limitations # Non-blocking issues (e.g., "Art: plan-only")
    - anchor_summary    # Count of sections, crosslinks

# Escalation rules
escalation:
  ask_human:
    - "Multilingual bundle layout policy decisions"
    - "Snapshot selection when multiple candidates exist"
    - "Export format prioritization"

  wake_showrunner:
    - "When binding reveals content issues (broken links, ambiguous headings)"
    - "For policy-level export decisions (may require ADR)"

  coordinate_with_gatekeeper:
    - "Export spot-check before ship"
    - "Presentation bar validation"

  coordinate_with_owners:
    - "Content issues found (ping Scene/Curator/Style/Translator)"
    - "Request upstream edits, don't fix locally"

# Artifacts produced
artifacts:
  - view_bundle.schema.json
  - view_log.schema.json
  - anchor_map.schema.json

# References
references:
  layer_1: "@role:book_binder"
  layer_3_schemas:
    - view_bundle.schema.json
    - view_log.schema.json
    - anchor_map.schema.json
  layer_4_protocol: "04-protocol/INTENTS.md"

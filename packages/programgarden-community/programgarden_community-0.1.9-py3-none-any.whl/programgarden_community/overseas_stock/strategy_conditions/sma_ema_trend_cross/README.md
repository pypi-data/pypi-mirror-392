# 해외주식 SMA·EMA 추세 감시 전략

## 전략 ID
`StockSMAEMACross`

## 전략 기여자
ProgramGarden Team

## 간단한 설명

이 전략은 **느린 추세선(SMA)과 빠른 신호선(EMA)의 교차를 자동으로 감시해, 골든/데드 크로스를 간단한 라벨로 정리**해 주는 추세 감시 도구입니다.

복잡한 차트를 다시 보지 않아도, **“지금 추세가 유지되는지, 막 바뀌기 시작했는지”**를 요약된 신호로 빠르게 확인할 수 있습니다.

## 이 전략이 필요한 이유

- 해외주식은 거래 시간이 길어, 장 중에 **추세 유지/전환을 감으로만 판단하기 쉽습니다.**
- 이 전략은 느린 추세선(SMA)과 빠른 신호선(EMA)을 자동으로 비교해,
    **방금 골든/데드 크로스가 났는지와 최근 N일간의 중요 교차만 요약**해서 보여 줍니다.
- 시작·종료일을 따로 넣지 않아도 `qrycnt` 길이만큼 최신 데이터를 불러와 바로 실행할 수 있어,
    모니터링 자동화에 적합합니다.

## 전략 상세 설명

### 어떤 방식으로 동작하나요?

- 설정한 기간의 단순이동평균(SMA, `period_sma`)과 지수이동평균(EMA, `period_ema`)을 계산합니다.
- 두 선의 상대적인 위치와 교차 여부를 체크해, **상승/하락 전환이 발생했는지**를 판단합니다.
- 최근 `lookback` 개의 캔들에서 발생한 교차 이벤트만 골라 `data.crossovers` 같은 형태로 정리해 반환합니다.

### 방향성은 이렇게 고릅니다

- **상승 전환(bullish)**
    - EMA가 SMA를 아래에서 위로 뚫고 올라가는 **골든 크로스** 상황입니다.
    - 단기 가격이 중장기 평균을 상향 돌파했다고 보고, 상승 추세 시작 신호로 자주 활용됩니다.
- **하락 전환(bearish)**
    - EMA가 SMA를 위에서 아래로 내려가는 **데드 크로스** 상황입니다.
    - 단기 가격이 중장기 평균을 하향 돌파했다고 보고, 추세 약화 또는 하락 전환 신호로 해석합니다.
- **양쪽 모두(both)**
    - `focus_direction = "both"`로 두면, 상승/하락 교차를 모두 기록해서 최근 히스토리를 한 번에 확인할 수 있습니다.

### 활용 시나리오

- 장 중에 **“지금 이 종목에 새로운 골든/데드 크로스가 나왔는지”만 빠르게 체크**하고 싶을 때
- 이미 보유 중인 종목에 대해, **데드 크로스 발생 시 비중 축소 또는 전량 매도 규칙**과 연계
- 추세 추종 전략 앞단에서, **EMA 리스크 조정 전략 등 다른 필터와 함께 사용해 노이즈를 줄이는 용도**

## DSL 예시
```python
{
    "condition_id": "StockSMAEMACross",
    "parameters": {
        "appkey": "your_appkey",
        "appsecretkey": "your_appsecret",
        "symbol": "TSLA",
        "timeframe": "days",
        "period_sma": 55,
        "period_ema": 21,
        "lookback": 3,
        "focus_direction": "both",
        "qrycnt": 400
    }
}
```

## 파라미터 설명

| 이름 | 타입 | 기본값 | 설명 |
| --- | --- | --- | --- |
| `period_sma` | int | 55 | 시장의 큰 물결을 잡는 기준선입니다. 길게 잡을수록 부드럽고 안정적이며, 짧게 잡으면 최근 변화를 민감하게 반영합니다. |
| `period_ema` | int | 21 | 최신 가격을 빠르게 따라가는 신호선입니다. 작으면 신호가 빠르지만 가짜 신호가 늘고, 길면 느린 대신 차분합니다. |
| `lookback` | int | 3 | 최근 N개의 캔들에서 발생한 교차만 다뤄, 가장 필요한 신호만 빠르게 확인하도록 돕습니다. |
| `timeframe` | str | `days` | 일봉(`days`), 주봉(`weeks`), 월봉(`months`) 중 원하는 주기를 선택합니다. |
| `focus_direction` | str | `both` | `bullish`(골든/상승) 또는 `bearish`(데드/하락)만 보고 싶을 때 사용합니다. 기본값은 모두 노출합니다. |
| `qrycnt` | int | 400 | 한 번에 불러올 캔들 수입니다. 최소 필요 길이보다 작아도 자동으로 늘립니다. |
| `appkey` | str | - | LS 해외주식 Open API 인증 키입니다. |
| `appsecretkey` | str | - | LS 해외주식 Open API 인증 시크릿입니다. |

## 전략 사용 시 주의사항

- 이동평균 신호는 **거래량, 지지/저항, 뉴스 이벤트 등과 함께** 확인할 때 신뢰도가 높아집니다.
- 교차 신호만으로 모든 매수/매도 결정을 내리기보다는, 손절·분할 매수/매도 규칙과 함께 설계하는 것이 좋습니다.
- 과거 지표는 미래 수익을 보장하지 않으므로, 리스크 관리(포지션 사이징, 최대 손실 한도)를 반드시 병행하세요.
- API 인증 정보(`appkey`, `appsecretkey`)는 반드시 안전하게 보관하고, 외부에 노출되지 않도록 주의하세요.

# SMA 골든/데드 크로스 전략

## 전략 ID
`SMAGoldenDeadCross`

## 전략 기여자
ProgramGarden Team

## 간단한 설명

이 전략은 **해외주식 가격에 단순 이동 평균(SMA)을 씌워, 골든 크로스·데드 크로스 패턴을 자동으로 찾아 주는 조건 필터**입니다.

특히 **데드 크로스(하락 신호) 이후에 다시 골든 크로스(상승 신호)가 나오고, 그때 가격이 더 높아진 경우**에만 관심을 두어,
단순히 한 번 올라갔다 내려가는 노이즈가 아니라 **“하락을 견디고 다시 힘이 붙은” 상승 구간**을 고르는 데 도움을 줍니다.

## 이 전략이 필요한 이유

- 해외주식은 변동성이 커서, 단기 반등인지 진짜 추세 전환인지 감으로만 구분하기 어렵습니다.
- SMA 골든/데드 크로스는 널리 쓰이는 개념이지만, **“어떤 골든 크로스를 진짜로 믿을지”** 는 또 다른 문제입니다.
- `SMAGoldenDeadCross`는
    - 먼저 **데드 크로스(하락 신호)가 나왔다가**,
    - 그 뒤에 **골든 크로스(상승 신호)가 다시 나오며 가격까지 더 높아진 구간**만 골라 줍니다.
- 이렇게 하면 “한 번 하락을 이겨 내고 다시 올라선 자리”에 집중할 수 있어,
    **감정에 휘둘리지 않고 규칙적으로 매수 후보를 찾는 데** 도움이 됩니다.

## 전략 상세 설명

### 먼저, SMA와 골든/데드 크로스를 쉽게 정리해 볼게요

- **SMA(단순 이동 평균)**
    - 일정 기간 동안의 가격을 더해서 **평균 낸 선**입니다.
    - 예를 들어 20일 SMA는 **최근 20일 종가의 평균**이라고 보면 됩니다.
    - 가격이 SMA 위에 있으면 “대체로 상승 쪽”, 아래에 있으면 “대체로 하락 쪽”으로 이해할 수 있습니다.

- **단기 SMA vs 장기 SMA**
    - **단기 SMA**: 최근 20일처럼 비교적 짧은 기간 평균 (가격 변화에 더 민감).
    - **장기 SMA**: 최근 50일처럼 더 긴 기간 평균 (더 느리지만 안정적).

- **골든 크로스**
    - 단기 SMA가 장기 SMA를 **아래에서 위로 뚫고 올라가는 순간**입니다.
    - “단기 흐름이 장기 흐름보다 강해졌다 → 상승 쪽 힘이 붙고 있다”는 신호로 많이 쓰입니다.

- **데드 크로스**
    - 단기 SMA가 장기 SMA를 **위에서 아래로 내려가는 순간**입니다.
    - “단기 흐름이 장기 흐름보다 약해졌다 → 하락 쪽 힘이 커지고 있다”는 신호로 자주 해석합니다.

### 어떤 방식으로 동작하나요?

1. 선택한 종목의 가격 데이터를 불러와, 설정한 기간(`short_period`, `long_period`)에 맞춰 **단기·장기 SMA**를 계산합니다.
2. SMA 두 선이 교차하는 지점을 찾아, 각 날짜가 **골든 크로스인지, 데드 크로스인지**를 기록합니다.
3. 그중에서 **“데드 크로스 → 이후 골든 크로스”** 순서로 나타난 구간을 추립니다.
4. 마지막으로, 골든 크로스가 발생했을 때의 가격이 이전 데드 크로스 시점 가격보다 **더 높아진 경우**만 남깁니다.
5. 이렇게 걸러진 구간을 **매수 후보**로 표시해, 사람이 차트를 일일이 보지 않고도 “의미 있는 반전 패턴”만 모아서 볼 수 있게 돕습니다.

### 방향성은 이렇게 해석하세요

- **매수 후보(long)**
    - 최근에 데드 크로스가 먼저 나오고,
    - 그 뒤 골든 크로스가 다시 나타나며,
    - 골든 크로스 시점 가격이 데드 크로스 시점보다 높다면,
        이 전략은 해당 구간을 **“상승 추세로 전환되었을 가능성이 있는 매수 후보”**로 표시합니다.
- **대기 상태**
    - 단순히 골든·데드 크로스만 자주 섞여 나오거나,
    - 골든 크로스 가격이 데드 크로스 가격보다 충분히 높지 않은 경우,
        **노이즈가 많다고 보고 이번 사이클에선 후보에서 제외**할 수 있습니다.

### 활용 시나리오

- 해외주식 종목 풀에서 **“SMA 기준으로, 어느 정도 하락을 견딘 뒤 다시 살아난 종목만”** 골라 보고 싶을 때
- 이미 보유 중인 종목에서, **추가 매수/보유 근거를 SMA 골든/데드 흐름으로 확인**하고 싶을 때
- 다른 전략(터틀, 모멘텀, 리스크 관리 전략 등)의 **보조 필터**로, “차트 상 추세 전환이 있었는지”를 기계적으로 체크하고 싶을 때

## DSL 예시

```python
{
        "condition_id": "SMAGoldenDeadCross",
        "params": {
                "start_date": "20230101",
                "end_date": "20231231",
                "long_period": 50,
                "short_period": 20,
                "time_category": "days",
                "use_ls": True,
                "alignment": "golden",
                "appkey": "your_appkey",
                "appsecretkey": "your_appsecretkey"
        }
}
```

## 파라미터 설명

| 이름 | 타입 | 기본값 | 설명 |
| --- | --- | --- | --- |
| `start_date` | str | - | 분석 시작 날짜 (예: `"20230101"`). 비워두면 내부 기본값을 따를 수 있습니다. |
| `end_date` | str | - | 분석 종료 날짜 (예: `"20231231"`). |
| `long_period` | int | 50 | 장기 SMA 기간입니다. 값이 클수록 더 느리지만 안정적인 추세선을 만듭니다. |
| `short_period` | int | 20 | 단기 SMA 기간입니다. 값이 작을수록 가격 변화에 더 빠르게 반응합니다. |
| `time_category` | str | `"days"` | 시간 단위입니다. `"days"`(일봉), `"weeks"`(주봉), `"months"`(월봉) 중 선택합니다. |
| `days_prices` | list | None | 직접 가격 데이터를 넘기고 싶은 특수한 경우에만 사용합니다. 일반 사용자는 비워두면 됩니다. |
| `use_ls` | bool | True | LS증권 가격 데이터를 사용할지 여부입니다. 대부분 `True`로 둡니다. |
| `alignment` | str | `"golden"` | 감지할 크로스 종류입니다. `"golden"`이나 `"dead"` 중 선택할 수 있습니다. |
| `appkey` | str | - | LS증권 Open API 앱키입니다. |
| `appsecretkey` | str | - | LS증권 Open API 앱시크릿키입니다. |

## 전략 사용 시 주의사항

- 이 전략은 **과거 가격 흐름을 기반으로 패턴을 찾는 도구**일 뿐, 미래 성과를 보장하지 않습니다.
- `short_period`와 `long_period` 값은 종목 특성과 투자 스타일(단기·중기·장기)에 따라 조정해야 합니다.
- SMA 신호만으로 모든 매수·매도 결정을 내리기보다는, 거래량·재무 상태·뉴스 등 다른 정보와 함께 사용하는 것이 좋습니다.
- API 키(`appkey`, `appsecretkey`)는 항상 안전하게 관리해야 하며, 실제 투자에서는 유효한 키를 사용해야 합니다.
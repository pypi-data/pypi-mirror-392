# 해외선물 RSI·스토캐스틱 과매수/과매도 전략

## 전략 ID
`FuturesRSIStochastic`

## 전략 기여자
ProgramGarden Team

## 간단한 설명

이 전략은 RSI와 스토캐스틱 두 가지 오실레이터를 겹쳐서,
**지금 시장이 과열(과매수)인지, 침체(과매도)인지**를 객관적으로 보여주는 과열 감지 도구입니다.

두 지표가 동시에 높은 구간에 있으면 “수익 실현/헤지 고민 시점”,
동시에 낮은 구간에 있으면 “신중한 저점 매수 검토 시점”으로 해석할 수 있습니다.

## 이 전략이 필요한 이유

- 해외선물은 24시간 가까이 움직여서 “지금이 과열인지, 단순 조정인지”를 눈으로만 구분하기 어렵습니다.
- 특히 초보 투자자는 고점 추격이나 저점 공포 매도를 반복하기 쉬운데,
    이 전략은 두 개의 과열 감지 바를 겹쳐 보여 줌으로써 **과열/침체 구간을 객관적으로 찍어** 줍니다.
- 과매수 신호는 “수익 실현이나 헤지를 생각해야 할 때”를,
    과매도 신호는 “신중하게 저점 매수를 검토할 때”를 알려주어
    **양방향 시장에서도 단순한 의사결정 기준**을 제공합니다.

요약하면, “어느 순간에 리스크를 줄이고 어느 순간에 공격적으로 진입할지”를
숫자로 정리해 주는 **리스크 관리 보조 장치**입니다.

## 전략 상세 설명

`FuturesRSIStochastic` 전략은 가격이 너무 급하게 올라 과열됐는지,
혹은 너무 내려와 침체됐는지를 두 개의 “과열 감지 바(bar)”로 확인합니다.

### 어떤 방식으로 동작하나요?

- **두 감지 바를 겹칩니다.** RSI와 스토캐스틱이 동시에 0~100 점수로 현재 온도를 보여 주며,
    두 값이 같이 높으면 과열, 같이 낮으면 침체로 단정해 줍니다.
- **한 줄 신호로 정리합니다.** 두 바가 동시에 위에 붙으면 `overbought`, 아래에 붙으면 `oversold`로 요약해
    “지금은 쉬어갈 구간인지, 반등을 기다릴 구간인지”를 알려 줍니다.
- **바로 행동에 연결합니다.** 최신 신호를 바탕으로 `position_side`에 롱·숏·관망 중 하나를 제안하고,
    `success`는 “이 조건이 방금이라도 나왔는가”만 체크해 불필요한 고민을 줄여 줍니다.

### 방향성은 이렇게 고릅니다

- 두 지표 모두가 **과열선(보통 70 이상)** 위로 올라오면
    “최근 너무 빨리 올라와서 잠시 쉬어갈 수 있다”는 뜻으로 `signal = "overbought"`가 됩니다.
- 두 지표 모두가 **침체선(보통 30 이하)** 아래로 내려오면
    “너무 많이 내려왔으니 튕겨 오를 수 있다”는 의미이며, 단순히 “과매도(oversold)”라고 표시됩니다.
- 최신 신호가 과매도면 전략은 “지금은 반등 가능성이 있으니 **매수 쪽(long)** 을 우선 검토하자”라고 알려 주고,
    과매수면 “잠시 쉬거나 **매도 쪽(short)** 을 고려하자”라고 안내합니다.
    신호가 중립이면 “관망(flat)” 상태로 남아 무리한 진입을 막습니다.

### 활용 시나리오

- RSI와 스토캐스틱이 동시에 과매수 범위에 머무를 때 부분 청산·헤지 판단
- RSI가 과매도, 스토캐스틱이 20 이하에서 상승 반전을 시도할 때 저점 매수 탐색
- 기존 포지션의 리스크 관리를 위해 오실레이터 다중 신호를 확인

### RSI와 스토캐스틱, 개념을 쉽게 정리하면

두 지표 모두 **0~100 사이의 숫자로 “지금 가격이 얼마나 치우쳐 있는지”** 를 보여 줍니다.

#### RSI(Relative Strength Index)는?

RSI는 최근 N개의 종가를 보고, **얼마나 자주·얼마나 크게 올랐는지 vs 내렸는지**를 비교하는 지표입니다.

- 매일의 상승폭과 하락폭을 따로 평균 내서, 상승 쪽 힘이 더 크면 숫자가 50 위로 올라가고,
    하락 쪽 힘이 크면 50 아래로 내려갑니다.
- 보통:
    - **70 이상**이면 “최근에 너무 빠르게 오른 상태(과열 구간일 수 있음)”
    - **30 이하**이면 “최근에 너무 빠르게 내린 상태(침체 구간일 수 있음)”로 봅니다.

예를 들어, 최근 14일 동안 **상승한 날이 훨씬 많고, 하락 폭도 작았다면** RSI는 70~80대로 올라갈 수 있습니다.
반대로 대부분의 날이 음봉이고 상승폭이 작다면 RSI는 20~30대로 내려갑니다.

#### 스토캐스틱(Stochastic Oscillator)는?

스토캐스틱은 최근 N개의 캔들 사이에서 **현재 가격이 최고가와 최저가 사이 어디쯤인지**를 알려 주는 지표입니다.

- N일 동안의 **최고가와 최저가 구간**을 0~100으로 늘어놓았다고 생각하면,
    - 지금 가격이 그 구간의 맨 위 근처라면 80~100,
    - 중간쯤이면 50,
    - 맨 아래 근처라면 0~20 근처 값이 나옵니다.
- 이 값(`%K`)을 한 번 더 부드럽게 평균 낸 선이 `%D`이며,
    실제로는 `%K`와 `%D` 두 선을 함께 보면서 “위에서 꺾이는지, 아래에서 꺾이는지”를 확인합니다.

예를 들어, 최근 14일 최고가가 110, 최저가가 90인데 현재가가 109라면
스토캐스틱 값은 거의 100에 가까운 숫자가 됩니다. 그만큼 최근 구간의 윗부분에 몰려 있다는 뜻입니다.

## DSL 예시

```python
{
        "condition_id": "FuturesRSIStochastic",
        "parameters": {
                "appkey": "your_appkey",
                "appsecretkey": "your_appsecret",
                "timeframe": "days",
                "rsi_period": 14,
                "stoch_k": 14,
                "stoch_d": 3,
                "stoch_smooth": 3,
                "overbought": 70,
                "oversold": 30,
                "qrycnt": 200
        }
}
```

별도의 시작/종료일을 지정하지 않아도 가장 최근 거래일부터 `qrycnt` 기반 히스토리를 자동으로 불러옵니다.

## 파라미터 설명

| 이름 | 기본값 | 설명 |
| --- | --- | --- |
| `rsi_period` | 14 | 최근 N개 종가의 상승폭과 하락폭을 비교해 RSI를 계산합니다. 숫자를 줄이면 신호가 민감해지고, 늘리면 노이즈가 줄어듭니다. 최소 2보다 크게 입력하세요. |
| `stoch_k` | 14 | 최근 N개 봉 사이에서 **현재 가격이 최고가에 가까운지, 최저가에 가까운지**를 0~100 사이 숫자로 보여주는 기간입니다. 짧으면 민감한 대신 요동이 크고, 길면 큰 흐름만 남습니다. |
| `stoch_d` | 3 | 위의 %K를 한 번 더 평균낸 값입니다. `[stoch_k, stoch_d]` 두 선이 위아래로 교차하면서 꺾이는 지점을 좀 더 깔끔하게 보려는 목적입니다. |
| `stoch_smooth` | 3 | %K를 계산하기 전에 몇 개의 값을 묶어 미리 다듬을지 정합니다. 숫자가 작으면 신호가 빠르지만 요동하고, 숫자가 크면 조금 늦더라도 차분한 곡선이 됩니다. |
| `overbought` / `oversold` | 70 / 30 | RSI와 %D가 동시에 이 임계값을 넘거나 밑돌 때 과열·침체 신호로 해석합니다. 값을 조정해 원하는 민감도로 경고선(차익 실현/저점 매수)을 맞출 수 있습니다. |
| `timeframe` | `days` | 일봉(`days`), 주봉(`weeks`), 월봉(`months`) 중 어떤 캔들을 기준으로 계산할지 고릅니다. 주·월봉은 큰 추세, 일봉은 단기 흐름 확인에 유리합니다. |
| `qrycnt` | 200 | 한 번에 조회할 캔들 수입니다. 길게 설정할수록 지표가 안정적이고, 짧게 설정하면 최신 흐름에 민감합니다. 내부적으로 필요한 최소 길이보다 작게 입력해도 자동으로 보정됩니다. |
| `appkey` / `appsecretkey` | - | LS증권 Open API에서 발급받은 인증 키 쌍입니다. 실거래/모의거래 환경에 맞는 키를 넣고 외부에 노출되지 않게 관리하세요. |

## 전략 사용 시 주의사항

- 일시적 급등락 시 오실레이터가 극단값에 빠르게 도달할 수 있으므로
    거래량, 추세선 등 다른 지표와 함께 확인하는 것이 좋습니다.
- API 호출 시 `appkey`, `appsecretkey`는 안전하게 관리해야 합니다.
- 과거 데이터 기반 분석은 미래 성과를 보장하지 않습니다.


# 해외선물 EMA 리스크 조정 추세 전략

> 출처: [Following a Trend with an Exponential Moving Average – Analytical Results for a Gaussian Model](https://arxiv.org/abs/1308.5658?utm_source=chatgpt.com)

## 전략 ID
`FuturesEMARiskAdjustedTrend`

## 전략 기여자
ProgramGarden Team

## 간단한 설명

이 전략은 **최근 선물 가격을 EMA(지수 이동평균)로 부드럽게 섞어**
“위쪽 힘(매수) vs 아래쪽 힘(매도)”을 점수로 계산한 뒤,
점수의 부호와 크기를 바탕으로 현재 **추천 방향(롱/숏/대기)** 을 알려주는 추세 전략입니다.

차트를 계속 보고 있기 어려운 사람도, 이 점수와 추천 방향만 보면
“지금은 매수 쪽으로 기울었는지, 매도 쪽인지, 아니면 애매한지”를 빠르게 판단할 수 있습니다.

## 이 전략이 필요한 이유

- 해외선물 시장은 24시간 가까이 움직이며, 추세가 생겼다가 사라지는 속도가 빠릅니다.
- 차트를 계속 보지 못하는 초보 트레이더는 **“지금은 매수 힘이 센가, 매도 힘이 센가”** 를 감으로만 판단하기 쉽습니다.
- 이 전략은 EMA 기반 추세 점수를 이용해 **방향(롱/숏)과 신뢰도(점수 크기)** 를 한 번에 보여 줍니다.

요약하면, 이 전략은:

- 차트에 EMA를 직접 그리지 않아도, 
- 지금 시장이 어느 쪽으로 기울었는지를 숫자로 확인하고,
- 그에 맞는 시나리오(롱/숏/대기)를 고를 수 있게 도와주는 **리스크 조정 추세 팔로잉 도구**입니다.

## 전략 상세 설명

이 전략은 다음과 같은 순서로 동작합니다.

1. 지정한 선물 종목의 가격 히스토리를 불러옵니다.
2. 최근 `ema_window` 개의 가격을 지수 이동평균(EMA)으로 부드럽게 섞어 **추세 방향**을 계산합니다.
3. 별도로 `volatility_window` 구간에서 가격이 얼마나 흔들렸는지(변동성)를 측정해, 
	 추세 신호를 **리스크에 맞게 조정**합니다.
4. 논문에 제시된 공식(`market_lambda`, `market_beta`)을 이용해 
	 시장 특성에 맞는 **추천 EMA 속도(추천 `eta` 및 윈도 크기)** 를 함께 계산합니다.
5. 최종적으로 산출된 점수가 `signal_threshold`를 넘으면 
	 - 양수(+)일 때: **롱(매수) 시나리오 추천**
	 - 음수(-)일 때: **숏(매도) 시나리오 추천**
	 - 절댓값이 작으면: **대기/관망** 상태로 둡니다.


## DSL 예시

```python
{
		"condition_id": "FuturesEMARiskAdjustedTrend",
		"parameters": {
				"appkey": "your_appkey",
				"appsecretkey": "your_appsecretkey",
				"ema_window": 20,
				"volatility_window": 60,
				"signal_threshold": 0.6,
				"market_lambda": 0.01,
				"market_beta": 0.1,
				"transaction_cost": 0.05,
				"timeframe": "days",
				"qrycnt": 400,
				"history_limit": 150
		}
}
```

## 파라미터 설명

| 이름 | 타입 | 기본값 | 설명 |
| --- | --- | --- | --- |
| `ema_window` | int | 20 | “몇 개의 봉을 평균 낼지”를 정합니다. 숫자를 키우면 더 느릿느릿, 줄이면 더 민감하게 추세를 따라갑니다. |
| `volatility_window` | int | 60 | 가격이 얼마나 흔들렸는지 살피는 기간입니다. 일반적으로 `ema_window`보다 길게 두면 안정적입니다. |
| `signal_threshold` | float | 0.6 | 점수가 이 값보다 크면 “힘이 충분하다”고 봅니다. 0.5~0.8 사이에서 취향과 시장 특성에 맞게 조절하세요. |
| `market_lambda` | float | 0.01 | 시장이 방향을 얼마나 오래 기억하는지에 대한 값입니다. 일반 지수·통화 선물은 논문에서 제안한 0.01을 그대로 써도 무방합니다. |
| `market_beta` | float | 0.1 | 추세가 어느 정도 강한지 나타내는 숫자입니다. 값을 키우면 “추세가 잘 생기는 시장”으로 본다고 이해하면 됩니다. |
| `transaction_cost` | float | 0.05 | 왕복 수수료 + 슬리피지를 대략 몇 %로 잡을지 입력합니다. 비용이 클수록 전략이 더 보수적으로 움직입니다. |
| `timeframe` | str | `days` | 일봉(`days`)·주봉(`weeks`)·월봉(`months`) 중에서 선택합니다. 스윙 위주의 경우 일봉, 장기 포지션은 주·월봉을 고려할 수 있습니다. |
| `qrycnt` | int | 400 | 데이터를 몇 개나 불러올지 정합니다. 400이면 약 1년 반 분량이라 신호가 비교적 안정적입니다. |
| `history_limit` | int | 150 | 결과 화면에 최근 며칠치 기록을 보여줄지 정합니다. 너무 크게 잡으면 UI가 복잡해질 수 있습니다. |
| `appkey` / `appsecretkey` | str | - | LS증권에서 받은 인증 키입니다. 시스템에 이미 저장돼 있으면 비워 두어도 됩니다. |

## 전략 사용 시 주의사항

- 데이터가 너무 적으면 신호가 비어 있거나 불안정할 수 있습니다. 
	`qrycnt`를 충분히 크게 두면 대부분 해결됩니다.
- 이 전략은 **“방향과 상대적 힘”** 을 알려 줄 뿐, 절대적인 수익을 보장하지 않습니다. 
	항상 손절·포지션 사이징 등 기본 리스크 관리 규칙과 함께 사용하세요.
- 인증 키(`appkey`, `appsecretkey`)는 절대 외부에 올리지 말고, 
	환경 변수나 비밀 보관소 등에 안전하게 보관해야 합니다.

---
*모든 설명은 어려운 수식을 읽지 않아도 되도록 쉽게 풀어 썼습니다. 자세한 원리는 위 논문을 참고하세요.*

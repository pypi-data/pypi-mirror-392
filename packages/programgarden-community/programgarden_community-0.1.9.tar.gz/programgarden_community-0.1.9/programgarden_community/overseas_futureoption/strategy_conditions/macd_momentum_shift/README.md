# 해외선물 MACD 모멘텀 전환 전략

## 전략 ID
`FuturesMACDShift`

## 전략 기여자
ProgramGarden Team

## 간단한 설명

이 전략은 **MACD, 시그널선, 히스토그램** 세 가지 정보를 한 번에 정리해
“지금 모멘텀이 어느 쪽으로 이동 중인지”를 직관적으로 보여주는 모멘텀 전환 체크 도구입니다.

복잡한 차트 대신, 최근 교차 방향과 히스토그램 흐름을 기반으로 `position_side`에 
롱/숏/관망 중 하나를 제안해 **“지금은 어느 쪽에 서 있어야 할지”** 빠르게 결정할 수 있게 돕습니다.

## 이 전략이 필요한 이유

- 해외선물 시장은 갑작스러운 모멘텀 변화가 잦아 “추세가 유지되는지, 꺾이고 있는지”를 즉시 확인하기 어렵습니다.
- 초보 투자자는 골든/데드 크로스가 나왔는지, 히스토그램이 어느 방향으로 기울었는지 매번 직접 확인해야 해서 진입·청산 타이밍을 놓치기 쉽습니다.
- `FuturesMACDShift`는 세 가지 요소(MACD, 시그널선, 히스토그램)를 한 화면에 묶어,
  **“에너지가 어느 쪽으로 이동 중인지”**를 한눈에 보여줍니다.

요약하면, 이 전략은 **MACD를 “선물 시장 체온계”처럼 사용하는 도구**로,
복잡한 해석 없이도 현재 모멘텀 방향과 전환 신호를 빠르게 파악하게 해 줍니다.

## 전략 상세 설명

이 전략은 MACD를 중심으로 다음과 같이 동작합니다.

1. 지정한 선물 종목의 가격 데이터를 기준으로 빠른선/느린선 EMA를 계산해 MACD를 구합니다.
2. MACD를 한 번 더 부드럽게 만든 **시그널선**을 만들고, 두 선의 차이를 **히스토그램**으로 표현합니다.
3. 최근 골든/데드 크로스를 탐지해 “상승/하락 전환” 신호를 정리합니다.
4. 이 정보를 바탕으로 `position_side`에 롱/숏/관망 중 하나를 제안합니다.

### 어떤 방식으로 동작하나요?

- **세 가지 신호를 한 화면에**: 빠른선과 느린선의 간격, 히스토그램, 최근 교차 정보를 묶어 지금 모멘텀이 더해지는지 꺾이는지 직관적으로 요약합니다.
- **추천 포지션까지 제안**: 가장 최근 교차를 바탕으로 `position_side`에 ‘롱/숏/관망’ 중 하나를 제안해 즉시 행동 방향을 정할 수 있습니다.
- **최근 기록만 체크**: `success`와 `data.recent_crossovers`는 “방금 내가 원하는 방향 신호가 나왔는지”만 확인하게 해 주므로, 차트를 되감지 않고 흐름을 복습할 수 있습니다.

### 신호 해석 가이드

- **최근 교차가 상승 신호일 때**: 모멘텀이 아래에서 위로 되돌아오며 상승 압력이 강해지는 구간입니다. 전략 화면에서는 자연스럽게 “롱(매수) 시나리오”를 제안해 단기 반등을 노릴 수 있게 합니다.
- **최근 교차가 하락 신호일 때**: MACD 선이 시그널선 아래로 미끄러지면서 하락 압력이 커지고 있습니다. 이때는 “숏(매도) 시나리오”로 전환해 추가 하락에 대비하거나 기존 롱 포지션을 줄이는 판단을 돕습니다.
- **최근 교차가 없다면**: 명확한 방향 신호가 잡히지 않은 상태입니다. 무리하게 진입하지 않도록 “관망(중립)” 상태로 유지해 과도한 매매를 피합니다.

### 활용 시나리오

- MACD가 시그널선을 상향 돌파한 직후 히스토그램이 양수 확대 중인지 확인하며 **초기 반전 구간** 탐색
- 강한 상승 추세에서 히스토그램이 줄어드는지 살피며 **모멘텀 둔화에 따른 차익 실현** 고민
- 장기 하락 후 히스토그램이 음수에서 수렴하는 모습이 나오면 **공격적인 숏 포지션 축소** 시점 검토

## DSL 예시

```python
{
    "condition_id": "FuturesMACDShift",
    "parameters": {
        "appkey": "your_appkey",
        "appsecretkey": "your_appsecret",
        "fast_period": 12,
        "slow_period": 26,
        "signal_period": 9,
        "timeframe": "days",
        "lookback": 4,
        "qrycnt": 250
    }
}
```

별도의 시작·종료일을 지정하지 않아도 가장 최근 거래일부터 `qrycnt` 길이만큼 히스토리를 자동으로 확보합니다.

## 파라미터 설명

| 이름 | 기본값 | 설명 |
| --- | --- | --- |
| `fast_period` | 5 | MACD의 단기 EMA 길이입니다. 작게 설정할수록 신호는 빨라지지만 노이즈가 늘어납니다. 항상 `slow_period`보다 작아야 합니다. |
| `slow_period` | 10 | 장기 EMA 길이입니다. 값을 늘리면 큰 추세만 남고, 줄이면 단기 흔들림도 민감하게 반영됩니다. |
| `signal_period` | 9 | MACD를 한 번 더 완만하게 만든 시그널선 EMA 기간입니다. 짧게 두면 교차가 잦아지고 길게 두면 확실한 교차만 남습니다. |
| `lookback` | 4 | 최근 몇 개 교차 이벤트를 모아둘지 결정합니다. 1이면 가장 최근 교차만, 4면 최근 4개의 골든/데드 크로스를 보여줍니다. |
| `timeframe` | `days` | 어떤 봉 간격으로 MACD를 계산할지 선택합니다. `weeks`/`months`를 고르면 더 완만한 추세를 확인할 수 있습니다. |
| `qrycnt` | 250 | 조회할 캔들 수입니다. 길게 설정할수록 EMA 초기화 구간이 안정적이고 지표 신뢰도가 높아집니다. |
| `appkey` / `appsecretkey` | - | LS증권 Open API 인증 정보입니다. 실거래·모의거래 환경에 맞는 키를 안전하게 보관하세요. |

## 전략 사용 시 주의사항

- MACD 교차는 모멘텀 방향성을 알려줄 뿐, **추세가 얼마나 오래 갈지**는 보장하지 않습니다.
  거래량, 가격 패턴, 지지/저항 구간 등 다른 지표와 함께 확인하는 것이 좋습니다.
- 과거 데이터 분석 결과는 미래 수익을 보장하지 않습니다.
- API 인증 정보(`appkey`, `appsecretkey`)는 반드시 안전하게 관리해야 합니다.


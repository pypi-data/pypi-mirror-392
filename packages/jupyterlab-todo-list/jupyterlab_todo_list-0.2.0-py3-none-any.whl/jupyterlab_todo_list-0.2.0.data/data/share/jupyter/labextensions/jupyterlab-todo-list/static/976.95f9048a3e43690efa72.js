/*! For license information please see 976.95f9048a3e43690efa72.js.LICENSE.txt */
"use strict";(self.webpackChunkjupyterlab_todo_list=self.webpackChunkjupyterlab_todo_list||[]).push([[976],{20:(t,e,o)=>{var s=o(345),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(t,e,o){var s,n={},d=null,c=null;for(s in void 0!==o&&(d=""+o),void 0!==e.key&&(d=""+e.key),void 0!==e.ref&&(c=e.ref),e)r.call(e,s)&&!l.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps)void 0===n[s]&&(n[s]=e[s]);return{$$typeof:a,type:t,key:d,ref:c,props:n,_owner:i.current}}e.Fragment=n,e.jsx=d,e.jsxs=d},338:(t,e,o)=>{var s=o(628);e.H=s.createRoot,s.hydrateRoot},848:(t,e,o)=>{t.exports=o(20)},976:(t,e,o)=>{o.d(e,{TodoPanel:()=>h,todoIcon:()=>u});var s=o(848),a=o(297),n=o(860),r=o(694),i=o(256),l=o(338),d=o(345),c=o(652);function p({loadTodos:t,saveTodos:e}){const[o,a]=d.useState([]),[n,r]=d.useState(""),[i,l]=d.useState(!1),[p,u]=d.useState(null),[h,m]=d.useState("");d.useEffect(()=>{let e=!1;return(async()=>{try{const o=await t();e||(a(o),(0,c.MD)(`loaded ${o.length} todos`))}catch(t){(0,c.vV)("failed to bootstrap todos",t)}finally{e||l(!0)}})(),()=>{e=!0}},[t]),d.useEffect(()=>{i&&e(o)},[o,i,e]);const v=d.useCallback(()=>{const t=n.trim();t&&(a(e=>[{id:crypto.randomUUID(),text:t,done:!1},...e]),r(""))},[n]),_=d.useCallback(t=>{a(e=>{const o=e.map(e=>{if(e.id!==t)return e;const o=!e.done;return{...e,done:o,completedAt:o?Date.now():void 0}});return[...o.filter(t=>!t.done),...o.filter(t=>t.done).sort((t,e)=>{var o,s;return(null!==(o=e.completedAt)&&void 0!==o?o:0)-(null!==(s=t.completedAt)&&void 0!==s?s:0)})]})},[]),j=d.useCallback(t=>{a(e=>e.filter(e=>e.id!==t))},[]),y=d.useCallback(t=>{t.done||(u(t.id),m(t.text))},[]),f=d.useCallback(()=>{u(null),m("")},[]),b=d.useCallback(t=>{m(t.target.value)},[]),g=d.useCallback(()=>{if(!p)return;const t=h.trim();t?(a(e=>e.map(e=>e.id===p?{...e,text:t}:e)),f()):f()},[f,h,p]),k=d.useCallback(t=>{"Escape"===t.key&&(t.preventDefault(),f())},[f]),x=d.useCallback(t=>{t.preventDefault(),g()},[g]),w=d.useCallback(t=>{t.preventDefault(),v()},[v]),C=o.length>0;return(0,s.jsxs)("div",{className:"jp-TodoApp",children:[(0,s.jsx)("h3",{className:"jp-TodoApp-title",children:"To-Do List"}),(0,s.jsxs)("form",{className:"jp-TodoApp-inputRow",onSubmit:w,children:[(0,s.jsx)("input",{"aria-label":"New task",value:n,onChange:t=>r(t.target.value),placeholder:"Add a task...",className:"jp-TodoApp-input jp-mod-styled"}),(0,s.jsx)("button",{type:"submit",className:"jp-Button jp-mod-accept",children:"Add"})]}),C?(0,s.jsx)("ul",{className:"jp-TodoApp-list",children:o.map(t=>{const e=`todo-item-${t.id}`,o="jp-TodoApp-item"+(t.done?" is-done":""),a="jp-TodoApp-itemLabel"+(t.done?" is-done":""),n=p===t.id;return(0,s.jsxs)("li",{className:o,children:[(0,s.jsx)("input",{id:e,type:"checkbox",checked:t.done,disabled:n,onChange:()=>_(t.id)}),n?(0,s.jsxs)("form",{className:"jp-TodoApp-editForm",onSubmit:x,children:[(0,s.jsx)("input",{value:h,onChange:b,onKeyDown:k,autoFocus:!0,"aria-label":`Rename ${t.text}`,className:"jp-TodoApp-input jp-TodoApp-editInput"}),(0,s.jsx)("button",{type:"submit",className:"jp-Button jp-mod-accept",children:"Save"}),(0,s.jsx)("button",{type:"button",className:"jp-Button",onClick:f,children:"Cancel"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{htmlFor:e,className:a,children:t.text}),!t.done&&(0,s.jsx)("button",{type:"button",className:"jp-Button jp-mod-minimal",onClick:()=>y(t),children:"Edit"})]}),(0,s.jsx)("button",{type:"button",onClick:()=>j(t.id),className:"jp-Button jp-mod-warn","aria-label":`Delete ${t.text}`,children:"Delete"})]},t.id)})}):(0,s.jsx)("p",{className:"jp-TodoApp-empty","aria-live":"polite",children:"No tasks yet. Add one above to get started."})]})}const u=new r.LabIcon({name:"jlab-todo:icon",svgstr:'\n<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/>\n</svg>'});class h extends i.Widget{constructor(t){super(),this._root=null,this._endpointMissing=!1,this._loadTodos=async()=>await this._loadFromServer()||this._loadFromState(),this._saveTodos=async t=>{try{await this._state.save(this._storageKey,t)}catch(t){(0,c.vV)("failed to save todos locally",t)}try{const e=await n.ServerConnection.makeRequest(this._apiUrl(),{method:"PUT",body:JSON.stringify({items:t}),headers:{"Content-Type":"application/json"}},this._serverSettings);if(!e.ok)throw new n.ServerConnection.ResponseError(e)}catch(t){if(this._handleEndpointMissing(t))return;(0,c.vV)("failed to save todos to server",t)}},this._loadFromState=async()=>{try{const t=await this._state.fetch(this._storageKey);return Array.isArray(t)?t:[]}catch(t){return(0,c.vV)("failed to load todos from local cache",t),[]}},this._loadFromServer=async()=>{try{const t=await n.ServerConnection.makeRequest(this._apiUrl(),{method:"GET"},this._serverSettings);if(!t.ok)throw new n.ServerConnection.ResponseError(t);const e=await t.json();return Array.isArray(e.items)?(await this._state.save(this._storageKey,e.items),e.items):[]}catch(t){return this._handleEndpointMissing(t)||(0,c.vV)("failed to load todos from server",t),null}},this.id="jlab-todo-panel",this.title.label="To-Do List",this.title.icon=u,this.title.closable=!0,this.addClass("jp-TodoPanel"),this._state=t.state,this._storageKey=t.storageKey,this._serverSettings=t.serverSettings}onAfterAttach(){this._root=(0,l.H)(this.node),this._root.render((0,s.jsx)(p,{loadTodos:this._loadTodos,saveTodos:this._saveTodos})),(0,c.MD)("panel module attached")}onBeforeDetach(){var t;null===(t=this._root)||void 0===t||t.unmount(),this._root=null}_apiUrl(){return a.URLExt.join(this._serverSettings.baseUrl,"jlab-todo","items")}_handleEndpointMissing(t){var e;return t instanceof n.ServerConnection.ResponseError&&404===(null===(e=t.response)||void 0===e?void 0:e.status)&&(this._endpointMissing||((0,c.MD)("server endpoint not available, skipping remote sync"),this._endpointMissing=!0),!0)}}}}]);
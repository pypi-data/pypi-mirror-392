/*! For license information please see 976.18fb1a329a06890a0bc5.js.LICENSE.txt */
"use strict";(self.webpackChunkjupyterlab_todo_list=self.webpackChunkjupyterlab_todo_list||[]).push([[976],{20:(t,e,o)=>{var s=o(345),a=Symbol.for("react.element"),r=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(t,e,o){var s,l={},d=null,c=null;for(s in void 0!==o&&(d=""+o),void 0!==e.key&&(d=""+e.key),void 0!==e.ref&&(c=e.ref),e)r.call(e,s)&&!i.hasOwnProperty(s)&&(l[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps)void 0===l[s]&&(l[s]=e[s]);return{$$typeof:a,type:t,key:d,ref:c,props:l,_owner:n.current}}e.jsx=l,e.jsxs=l},338:(t,e,o)=>{var s=o(628);e.H=s.createRoot,s.hydrateRoot},848:(t,e,o)=>{t.exports=o(20)},976:(t,e,o)=>{o.d(e,{TodoPanel:()=>u,todoIcon:()=>h});var s=o(848),a=o(297),r=o(860),n=o(694),i=o(256),l=o(338),d=o(345),c=o(652);function p({loadTodos:t,saveTodos:e}){const[o,a]=d.useState([]),[r,n]=d.useState(""),[i,l]=d.useState(!1);d.useEffect(()=>{let e=!1;return(async()=>{try{const o=await t();e||(a(o),(0,c.MD)(`loaded ${o.length} todos`))}catch(t){(0,c.vV)("failed to bootstrap todos",t)}finally{e||l(!0)}})(),()=>{e=!0}},[t]),d.useEffect(()=>{i&&e(o)},[o,i,e]);const p=d.useCallback(()=>{const t=r.trim();t&&(a(e=>[{id:crypto.randomUUID(),text:t,done:!1},...e]),n(""))},[r]),h=d.useCallback(t=>{a(e=>e.map(e=>e.id===t?{...e,done:!e.done}:e))},[]),u=d.useCallback(t=>{a(e=>e.filter(e=>e.id!==t))},[]),_=d.useCallback(t=>{t.preventDefault(),p()},[p]),v=o.length>0;return(0,s.jsxs)("div",{className:"jp-TodoApp",children:[(0,s.jsx)("h3",{className:"jp-TodoApp-title",children:"To-Do"}),(0,s.jsxs)("form",{className:"jp-TodoApp-inputRow",onSubmit:_,children:[(0,s.jsx)("input",{"aria-label":"New task",value:r,onChange:t=>n(t.target.value),placeholder:"Add a task...",className:"jp-TodoApp-input jp-mod-styled"}),(0,s.jsx)("button",{type:"submit",className:"jp-Button jp-mod-accept",children:"Add"})]}),v?(0,s.jsx)("ul",{className:"jp-TodoApp-list",children:o.map(t=>{const e=`todo-item-${t.id}`,o="jp-TodoApp-itemLabel"+(t.done?" is-done":"");return(0,s.jsxs)("li",{className:"jp-TodoApp-item",children:[(0,s.jsx)("input",{id:e,type:"checkbox",checked:t.done,onChange:()=>h(t.id)}),(0,s.jsx)("label",{htmlFor:e,className:o,children:t.text}),(0,s.jsx)("button",{type:"button",onClick:()=>u(t.id),className:"jp-Button jp-mod-warn","aria-label":`Delete ${t.text}`,children:"Delete"})]},t.id)})}):(0,s.jsx)("p",{className:"jp-TodoApp-empty","aria-live":"polite",children:"No tasks yet. Add one above to get started."})]})}const h=new n.LabIcon({name:"jlab-todo:icon",svgstr:'\n<svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/>\n</svg>'});class u extends i.Widget{constructor(t){super(),this._root=null,this._endpointMissing=!1,this._loadTodos=async()=>await this._loadFromServer()||this._loadFromState(),this._saveTodos=async t=>{try{await this._state.save(this._storageKey,t)}catch(t){(0,c.vV)("failed to save todos locally",t)}try{const e=await r.ServerConnection.makeRequest(this._apiUrl(),{method:"PUT",body:JSON.stringify({items:t}),headers:{"Content-Type":"application/json"}},this._serverSettings);if(!e.ok)throw new r.ServerConnection.ResponseError(e)}catch(t){if(this._handleEndpointMissing(t))return;(0,c.vV)("failed to save todos to server",t)}},this._loadFromState=async()=>{try{const t=await this._state.fetch(this._storageKey);return Array.isArray(t)?t:[]}catch(t){return(0,c.vV)("failed to load todos from local cache",t),[]}},this._loadFromServer=async()=>{try{const t=await r.ServerConnection.makeRequest(this._apiUrl(),{method:"GET"},this._serverSettings);if(!t.ok)throw new r.ServerConnection.ResponseError(t);const e=await t.json();return Array.isArray(e.items)?(await this._state.save(this._storageKey,e.items),e.items):[]}catch(t){return this._handleEndpointMissing(t)||(0,c.vV)("failed to load todos from server",t),null}},this.id="jlab-todo-panel",this.title.label="To-Do",this.title.icon=h,this.title.closable=!0,this.addClass("jp-TodoPanel"),this._state=t.state,this._storageKey=t.storageKey,this._serverSettings=t.serverSettings}onAfterAttach(){this._root=(0,l.H)(this.node),this._root.render((0,s.jsx)(p,{loadTodos:this._loadTodos,saveTodos:this._saveTodos})),(0,c.MD)("panel module attached")}onBeforeDetach(){var t;null===(t=this._root)||void 0===t||t.unmount(),this._root=null}_apiUrl(){return a.URLExt.join(this._serverSettings.baseUrl,"jlab-todo","items")}_handleEndpointMissing(t){var e;return t instanceof r.ServerConnection.ResponseError&&404===(null===(e=t.response)||void 0===e?void 0:e.status)&&(this._endpointMissing||((0,c.MD)("server endpoint not available, skipping remote sync"),this._endpointMissing=!0),!0)}}}}]);
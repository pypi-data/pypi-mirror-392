(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6807],{678:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(139);a(8523);var n=a(7296),o=a(8412),r=a(2482);let d=(0,o.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,asChild:o=!1,...l}=e,i=o?n.DX:"span";return(0,s.jsx)(i,{"data-slot":"badge",className:(0,r.cn)(d({variant:a}),t),...l})}},698:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var s=a(139),n=a(5234),o=a(8229),r=a.n(o),d=a(5310),l=a(8523);class i{constructor(e){this.id=e.id,this.name=e.name,this.description=e.description,this.embeddingModelUUID=e.embeddingModelUUID,this.top_k=e.top_k,this.lastUpdatedTimeAgo=e.lastUpdatedTimeAgo}}var c=a(4597),u=a.n(c);function m(e){let{kbCardVO:t}=e,{t:a}=(0,d.Bd)();return(0,s.jsx)("div",{className:"".concat(u().cardContainer),children:(0,s.jsxs)("div",{className:"".concat(u().basicInfoContainer),children:[(0,s.jsxs)("div",{className:"".concat(u().basicInfoNameContainer),children:[(0,s.jsx)("div",{className:"".concat(u().basicInfoNameText,"  ").concat(u().bigText),children:t.name}),(0,s.jsx)("div",{className:"".concat(u().basicInfoDescriptionText),children:t.description})]}),(0,s.jsxs)("div",{className:"".concat(u().basicInfoLastUpdatedTimeContainer),children:[(0,s.jsx)("svg",{className:"".concat(u().basicInfoUpdateTimeIcon),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM13 12H17V14H11V7H13V12Z"})}),(0,s.jsxs)("div",{className:"".concat(u().basicInfoUpdateTimeText),children:[a("knowledge.updateTime"),t.lastUpdatedTimeAgo]})]})]})})}var x=a(2333),p=a(7119),g=a(8581),h=a(9176),f=a(3564),b=a(6491),v=a(4309),j=a(1347),w=a(439),k=a(5241),y=a(9265),C=a(5024);function N(e){let{initKbId:t,onNewKbCreated:a,onKbUpdated:n}=e,{t:o}=(0,d.Bd)(),r=v.Ik({name:v.Yj().min(1,{message:o("knowledge.kbNameRequired")}),description:v.Yj().min(1,{message:o("knowledge.kbDescriptionRequired")}),embeddingModelUUID:v.Yj().min(1,{message:o("knowledge.embeddingModelUUIDRequired")}),top_k:v.ai().min(1,{message:o("knowledge.topKRequired")}).max(30,{message:o("knowledge.topKMax")})}),i=(0,f.mN)({resolver:(0,b.u)(r),defaultValues:{name:"",description:o("knowledge.defaultDescription"),embeddingModelUUID:"",top_k:5}}),[c,u]=(0,l.useState)([]);(0,l.useEffect)(()=>{x().then(()=>{t&&m(t).then(e=>{i.setValue("name",e.name),i.setValue("description",e.description),i.setValue("embeddingModelUUID",e.embeddingModelUUID),i.setValue("top_k",e.top_k||5)})})},[]);let m=async e=>new Promise(t=>{h.ok.getKnowledgeBase(e).then(e=>{t({name:e.base.name,description:e.base.description,embeddingModelUUID:e.base.embedding_model_uuid,top_k:e.base.top_k||5})})}),x=async()=>{u((await h.ok.getProviderEmbeddingModels()).models)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(w.lV,{...i,children:(0,s.jsx)("form",{onSubmit:i.handleSubmit(e=>{if(console.log("data",e),t){let a={name:e.name,description:e.description,embedding_model_uuid:e.embeddingModelUUID,top_k:e.top_k};h.ok.updateKnowledgeBase(t,a).then(e=>{console.log("update knowledge base success",e),n(e.uuid),y.oR.success(o("knowledge.updateKnowledgeBaseSuccess"))}).catch(e=>{console.error("update knowledge base failed",e),y.oR.error(o("knowledge.updateKnowledgeBaseFailed"))})}else{let t={name:e.name,description:e.description,embedding_model_uuid:e.embeddingModelUUID,top_k:e.top_k};h.ok.createKnowledgeBase(t).then(e=>{console.log("create knowledge base success",e),a(e.uuid)}).catch(e=>{console.error("create knowledge base failed",e)})}}),id:"kb-form",className:"space-y-8",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(w.zB,{control:i.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsxs)(w.lR,{children:[o("knowledge.kbName"),(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(j.p,{...t})}),(0,s.jsx)(w.C5,{})]})}}),(0,s.jsx)(w.zB,{control:i.control,name:"description",render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsxs)(w.lR,{children:[o("knowledge.kbDescription"),(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(j.p,{...t})}),(0,s.jsx)(w.C5,{})]})}}),(0,s.jsx)(w.zB,{control:i.control,name:"embeddingModelUUID",render:e=>{let{field:a}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsxs)(w.lR,{children:[o("knowledge.embeddingModelUUID"),(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)(k.l6,{disabled:!!t,onValueChange:e=>{a.onChange(e),console.log("value",e)},value:a.value,children:[(0,s.jsx)(k.bq,{className:"w-[180px] bg-[#ffffff] dark:bg-[#2a2a2e]",children:(0,s.jsx)(k.yv,{placeholder:o("knowledge.selectEmbeddingModel")})}),(0,s.jsx)(k.gC,{className:"fixed z-[1000]",children:(0,s.jsx)(k.s3,{children:c.map(e=>(0,s.jsxs)(C.jc,{openDelay:0,closeDelay:0,children:[(0,s.jsx)(C.d0,{asChild:!0,children:(0,s.jsx)(k.eb,{value:e.uuid,children:e.name})}),(0,s.jsx)(C.Et,{className:"w-80 data-[state=open]:animate-none data-[state=closed]:animate-none",align:"end",side:"right",sideOffset:10,children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("img",{src:h.ok.getProviderRequesterIconURL(e.requester),alt:"icon",className:"w-8 h-8 rounded-full"}),(0,s.jsx)("h4",{className:"font-medium",children:e.name})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),e.requester_config&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M13.0607 8.11097L14.4749 9.52518C17.2086 12.2589 17.2086 16.691 14.4749 19.4247L14.1214 19.7782C11.3877 22.5119 6.95555 22.5119 4.22188 19.7782C1.48821 17.0446 1.48821 12.6124 4.22188 9.87874L5.6361 11.293C3.68348 13.2456 3.68348 16.4114 5.6361 18.364C7.58872 20.3166 10.7545 20.3166 12.7072 18.364L13.0607 18.0105C15.0133 16.0578 15.0133 12.892 13.0607 10.9394L11.6465 9.52518L13.0607 8.11097ZM19.7782 14.1214L18.364 12.7072C20.3166 10.7545 20.3166 7.58872 18.364 5.6361C16.4114 3.68348 13.2456 3.68348 11.293 5.6361L10.9394 5.98965C8.98678 7.94227 8.98678 11.1081 10.9394 13.0607L12.3536 14.4749L10.9394 15.8891L9.52518 14.4749C6.79151 11.7413 6.79151 7.30911 9.52518 4.57544L9.87874 4.22188C12.6124 1.48821 17.0446 1.48821 19.7782 4.22188C22.5119 6.95555 22.5119 11.3877 19.7782 14.1214Z"})}),(0,s.jsx)("span",{className:"font-semibold",children:"Base URL："}),e.requester_config.base_url]}),e.extra_args&&Object.keys(e.extra_args).length>0&&(0,s.jsxs)("div",{className:"text-xs",children:[(0,s.jsx)("div",{className:"font-semibold mb-1",children:o("models.extraParameters")}),(0,s.jsx)("div",{className:"space-y-1",children:Object.entries(e.extra_args).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("span",{className:"text-gray-500",children:[t,"："]}),(0,s.jsx)("span",{className:"break-all",children:JSON.stringify(a)})]},t)})})]})]})})]},e.uuid))})})]})})}),(0,s.jsx)(w.Rr,{children:t?o("knowledge.cannotChangeEmbeddingModel"):o("knowledge.embeddingModelDescription")}),(0,s.jsx)(w.C5,{})]})}}),(0,s.jsx)(w.zB,{control:i.control,name:"top_k",render:e=>{let{field:t}=e;return(0,s.jsxs)(w.eI,{children:[(0,s.jsxs)(w.lR,{children:[o("knowledge.topK"),(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(w.MJ,{children:(0,s.jsx)(j.p,{type:"number",...t,onChange:e=>t.onChange(Number(e.target.value)),className:"w-[180px] h-10 text-base appearance-none"})}),(0,s.jsx)(w.Rr,{children:o("knowledge.topKdescription")}),(0,s.jsx)(w.C5,{})]})}})]})})})})}var _=a(1151),T=a(2798),B=a(678),I=a(8228),U=a(492),D=a(3471);function K(e){var t;let{columns:a,data:n}=e,{t:o}=(0,d.Bd)(),r=(0,I.N4)({data:n,columns:a,getCoreRowModel:(0,U.HT)()});return(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(D.XI,{children:[(0,s.jsx)(D.A0,{children:r.getHeaderGroups().map(e=>(0,s.jsx)(D.Hj,{children:e.headers.map(e=>(0,s.jsx)(D.nd,{children:e.isPlaceholder?null:(0,I.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(D.BF,{children:(null==(t=r.getRowModel().rows)?void 0:t.length)?r.getRowModel().rows.map(e=>(0,s.jsx)(D.Hj,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,s.jsx)(D.nA,{children:(0,I.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(D.Hj,{children:(0,s.jsx)(D.nA,{colSpan:a.length,className:"h-24 text-center",children:o("knowledge.documentsTab.noResults")})})})]})})}var M=a(6975);function z(e){let{kbId:t,onUploadSuccess:a,onUploadError:n}=e,{t:o}=(0,d.Bd)(),[r,i]=(0,l.useState)(!1),[c,u]=(0,l.useState)(!1),m=(0,l.useCallback)(async e=>{if(c)return;if(e.size>0xa00000)return void y.oR.error(o("knowledge.documentsTab.fileSizeExceeded"));u(!0);let s=y.oR.loading(o("knowledge.documentsTab.uploadingFile"));try{let n=await h.ok.uploadDocumentFile(e);await h.ok.uploadKnowledgeBaseFile(t,n.file_id),y.oR.success(o("knowledge.documentsTab.uploadSuccess"),{id:s}),a()}catch(t){console.error("File upload failed:",t);let e=o("knowledge.documentsTab.uploadError");y.oR.error(e,{id:s}),n(e)}finally{u(!1)}},[t,c,a,n,o]),x=(0,l.useCallback)(e=>{e.preventDefault(),i(!0)},[]),p=(0,l.useCallback)(e=>{e.preventDefault(),i(!1)},[]),g=(0,l.useCallback)(e=>{e.preventDefault(),i(!1);let t=Array.from(e.dataTransfer.files);t.length>0&&m(t[0])},[m]),f=(0,l.useCallback)(e=>{let t=e.target.files;t&&t.length>0&&m(t[0])},[m]);return(0,s.jsx)(M.Zp,{className:"mb-4",children:(0,s.jsx)(M.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"\n            relative border-2 border-dashed rounded-lg p-4 text-center transition-colors\n            ".concat(r?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400","\n            ").concat(c?"opacity-50 pointer-events-none":"","\n          "),onDragOver:x,onDragLeave:p,onDrop:g,children:[(0,s.jsx)("input",{type:"file",id:"file-upload",className:"hidden",onChange:f,accept:".pdf,.doc,.docx,.txt,.md,.html,.zip",disabled:c}),(0,s.jsx)("label",{htmlFor:"file-upload",className:"cursor-pointer block",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"mx-auto w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-base font-medium text-gray-900 dark:text-gray-100",children:c?o("knowledge.documentsTab.uploading"):o("knowledge.documentsTab.dragAndDrop")}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1 dark:text-gray-400",children:o("knowledge.documentsTab.supportedFormats")})]})]})})]})})})}function L(e){let t,{kbId:a}=e,[n,o]=(0,l.useState)([]),{t:r}=(0,d.Bd)();async function i(){o((await h.ok.getKnowledgeBaseFiles(a)).files.map(e=>({uuid:e.uuid,name:e.file_name,status:e.status})))}return(0,l.useEffect)(()=>{i();let e=setInterval(()=>{i()},5e3);return()=>{clearInterval(e)}},[a]),(0,s.jsxs)("div",{className:"container mx-auto py-2",children:[(0,s.jsx)(z,{kbId:a,onUploadSuccess:()=>{i()},onUploadError:e=>{console.error("Upload failed:",e)}}),(0,s.jsx)(K,{columns:(t=e=>{h.ok.deleteKnowledgeBaseFile(a,e).then(()=>{i(),y.oR.success(r("knowledge.documentsTab.fileDeleteSuccess"))}).catch(e=>{console.error("Delete failed:",e),y.oR.error(r("knowledge.documentsTab.fileDeleteFailed"))})},[{accessorKey:"name",header:r("knowledge.documentsTab.name")},{accessorKey:"status",header:r("knowledge.documentsTab.status"),cell:e=>{let{row:t}=e,a=t.original;switch(a.status){case"processing":return(0,s.jsx)(B.E,{variant:"secondary",children:r("knowledge.documentsTab.processing")});case"completed":return(0,s.jsx)(B.E,{variant:"outline",className:"bg-blue-500 text-white",children:r("knowledge.documentsTab.completed")});case"failed":return(0,s.jsx)(B.E,{variant:"outline",className:"bg-yellow-500 text-white",children:r("knowledge.documentsTab.failed")});default:return(0,s.jsx)(B.E,{variant:"outline",className:"bg-gray-500 text-white",children:a.status})}}},{id:"actions",cell:e=>{let{row:a}=e,n=a.original;return(0,s.jsxs)(T.rI,{children:[(0,s.jsx)(T.ty,{asChild:!0,children:(0,s.jsxs)(g.$,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,s.jsx)("span",{className:"sr-only",children:r("knowledge.documentsTab.actions")}),(0,s.jsx)(_.A,{className:"h-4 w-4"})]})}),(0,s.jsxs)(T.SQ,{align:"end",className:"bg-white dark:bg-[#2a2a2e]",children:[(0,s.jsx)(T.lp,{children:r("knowledge.documentsTab.actions")}),(0,s.jsx)(T._2,{onClick:()=>t(n.uuid),children:r("knowledge.documentsTab.delete")})]})]})}}]),data:n})]})}function R(e){let{kbId:t}=e,{t:a}=(0,d.Bd)(),[n,o]=(0,l.useState)(""),[r,i]=(0,l.useState)([]),[c,u]=(0,l.useState)([]),[m,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let e=await h.ok.getKnowledgeBaseFiles(t);u(e.files)}catch(e){console.error("Failed to load files:",e)}})()},[t]);let p=async()=>{if(n.trim()){x(!0);try{i([]);let e=await h.ok.retrieveKnowledgeBase(t,n);i(e.results)}catch(e){console.error("Retrieve failed:",e),y.oR.error(a("knowledge.retrieveError"))}finally{x(!1)}}};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(j.p,{value:n,onChange:e=>o(e.target.value),placeholder:a("knowledge.queryPlaceholder"),onKeyPress:e=>"Enter"===e.key&&p()}),(0,s.jsx)(g.$,{onClick:p,disabled:m||!n.trim(),children:a("knowledge.query")})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[0===r.length&&!m&&(0,s.jsx)("p",{className:"text-muted-foreground",children:a("knowledge.noResults")}),m?(0,s.jsx)("p",{className:"text-muted-foreground",children:a("common.loading")}):r.map(e=>(0,s.jsxs)(M.Zp,{className:"w-full",children:[(0,s.jsx)(M.aR,{className:"pb-3",children:(0,s.jsxs)(M.ZB,{className:"text-sm font-medium flex justify-between items-center",children:[(0,s.jsx)("span",{children:(e=>{let t=c.find(t=>t.uuid===e);return(null==t?void 0:t.file_name)||e})(e.metadata.file_id)}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a("knowledge.distance"),": ",e.distance.toFixed(4)]})]})}),(0,s.jsx)(M.Wu,{children:(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.metadata.text})})]},e.id))]})]})}function E(e){let{open:t,onOpenChange:a,kbId:n,onFormCancel:o,onKbDeleted:r,onNewKbCreated:i,onKbUpdated:c}=e,{t:u}=(0,d.Bd)(),[m,f]=(0,l.useState)(n),[b,v]=(0,l.useState)("metadata"),[j,w]=(0,l.useState)(!1);(0,l.useEffect)(()=>{f(n),v("metadata")},[n,t]);let k=[{key:"metadata",label:u("knowledge.metadata"),icon:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M5 7C5 6.17157 5.67157 5.5 6.5 5.5C7.32843 5.5 8 6.17157 8 7C8 7.82843 7.32843 8.5 6.5 8.5C5.67157 8.5 5 7.82843 5 7ZM6.5 3.5C4.567 3.5 3 5.067 3 7C3 8.933 4.567 10.5 6.5 10.5C8.433 10.5 10 8.933 10 7C10 5.067 8.433 3.5 6.5 3.5ZM12 8H20V6H12V8ZM16 17C16 16.1716 16.6716 15.5 17.5 15.5C18.3284 15.5 19 16.1716 19 17C19 17.8284 18.3284 18.5 17.5 18.5C16.6716 18.5 16 17.8284 16 17ZM17.5 13.5C15.567 13.5 14 15.067 14 17C14 18.933 15.567 20.5 17.5 20.5C19.433 20.5 21 18.933 21 17C21 15.067 19.433 13.5 17.5 13.5ZM4 16V18H12V16H4Z"})})},{key:"documents",label:u("knowledge.documents"),icon:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M21 8V20.9932C21 21.5501 20.5552 22 20.0066 22H3.9934C3.44495 22 3 21.556 3 21.0082V2.9918C3 2.45531 3.4487 2 4.00221 2H14.9968L21 8ZM19 9H14V4H5V20H19V9ZM8 7H11V9H8V7ZM8 11H16V13H8V11ZM8 15H16V17H8V15Z"})})},{key:"retrieve",label:u("knowledge.retrieve"),icon:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M18.031 16.617l4.283 4.282-1.415 1.415-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9 9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617zm-2.006-.742A6.977 6.977 0 0 0 18 11c0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7a6.977 6.977 0 0 0 4.875-1.975l.15-.15z"})})}];return m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.lG,{open:t,onOpenChange:a,children:(0,s.jsx)(x.Cf,{className:"overflow-hidden p-0 !max-w-[50rem] max-h-[75vh] flex",children:(0,s.jsxs)(p.GB,{className:"items-start w-full flex",children:[(0,s.jsx)(p.Bx,{collapsible:"none",className:"hidden md:flex h-[80vh] w-40 min-w-[120px] border-r bg-white dark:bg-black",children:(0,s.jsx)(p.Yv,{children:(0,s.jsx)(p.Cn,{children:(0,s.jsx)(p.rQ,{children:(0,s.jsx)(p.wZ,{children:k.map(e=>(0,s.jsx)(p.FX,{children:(0,s.jsx)(p.Uj,{asChild:!0,isActive:b===e.key,onClick:()=>v(e.key),children:(0,s.jsxs)("a",{href:"#",children:[e.icon,(0,s.jsx)("span",{children:e.label})]})})},e.key))})})})})}),(0,s.jsxs)("main",{className:"flex flex-1 flex-col h-[75vh]",children:[(0,s.jsx)(x.c7,{className:"px-6 pt-6 pb-4 shrink-0",children:(0,s.jsx)(x.L3,{children:u("metadata"===b?"knowledge.editKnowledgeBase":"documents"===b?"knowledge.editDocument":"knowledge.retrieveTest")})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:["metadata"===b&&(0,s.jsx)(N,{initKbId:m,onNewKbCreated:i,onKbUpdated:c}),"documents"===b&&(0,s.jsx)(L,{kbId:m}),"retrieve"===b&&(0,s.jsx)(R,{kbId:m})]}),"metadata"===b&&(0,s.jsx)(x.Es,{className:"px-6 py-4 border-t shrink-0",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(g.$,{type:"button",variant:"destructive",onClick:()=>w(!0),children:u("common.delete")}),(0,s.jsx)(g.$,{type:"submit",form:"kb-form",children:u("common.save")}),(0,s.jsx)(g.$,{type:"button",variant:"outline",onClick:o,children:u("common.cancel")})]})})]})]})})}),(0,s.jsx)(x.lG,{open:j,onOpenChange:w,children:(0,s.jsxs)(x.Cf,{children:[(0,s.jsx)(x.c7,{children:(0,s.jsx)(x.L3,{children:u("common.confirmDelete")})}),(0,s.jsx)("div",{className:"py-4",children:u("knowledge.deleteKnowledgeBaseConfirmation")}),(0,s.jsxs)(x.Es,{children:[(0,s.jsx)(g.$,{variant:"outline",onClick:()=>w(!1),children:u("common.cancel")}),(0,s.jsx)(g.$,{variant:"destructive",onClick:()=>{h.ok.deleteKnowledgeBase(null!=m?m:"").then(()=>{r()}),w(!1)},children:u("common.confirmDelete")})]})]})})]}):(0,s.jsx)(x.lG,{open:t,onOpenChange:a,children:(0,s.jsx)(x.Cf,{className:"overflow-hidden p-0 !max-w-[40vw] max-h-[70vh] flex",children:(0,s.jsxs)("main",{className:"flex flex-1 flex-col h-[70vh]",children:[(0,s.jsx)(x.c7,{className:"px-6 pt-6 pb-4 shrink-0",children:(0,s.jsx)(x.L3,{children:u("knowledge.createKnowledgeBase")})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:["metadata"===b&&(0,s.jsx)(N,{initKbId:void 0,onNewKbCreated:i,onKbUpdated:c}),"documents"===b&&(0,s.jsx)("div",{children:"documents"})]}),"metadata"===b&&(0,s.jsx)(x.Es,{className:"px-6 py-4 border-t shrink-0",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(g.$,{type:"submit",form:"kb-form",children:u("common.save")}),(0,s.jsx)(g.$,{type:"button",variant:"outline",onClick:o,children:u("common.cancel")})]})})]})})})}function S(){let{t:e}=(0,d.Bd)(),[t,a]=(0,l.useState)([]),[o,c]=(0,l.useState)(""),[u,x]=(0,l.useState)(!1);async function p(){a((await h.ok.getKnowledgeBases()).bases.map(t=>{var a,s;let n=new Date,o=Math.floor((n.getTime()-new Date(null!=(a=t.updated_at)?a:n.getTime()).getTime())/1e3/60/60/24),r=o>0?" ".concat(o," ").concat(e("knowledge.daysAgo")):e("knowledge.today");return new i({id:t.uuid||"",name:t.name,description:t.description,embeddingModelUUID:t.embedding_model_uuid,top_k:null!=(s=t.top_k)?s:5,lastUpdatedTimeAgo:r})}))}return(0,l.useEffect)(()=>{p()},[]),(0,s.jsxs)("div",{children:[(0,s.jsx)(E,{open:u,onOpenChange:x,kbId:o||void 0,onFormCancel:()=>{x(!1)},onKbDeleted:()=>{p(),x(!1)},onNewKbCreated:e=>{p(),c(e),x(!0)},onKbUpdated:()=>{p()}}),(0,s.jsxs)("div",{className:r().knowledgeListContainer,children:[(0,s.jsx)(n.A,{width:"100%",height:"10rem",plusSize:"90px",onClick:()=>{c(""),x(!0)}}),t.map(e=>(0,s.jsx)("div",{onClick:()=>{c(e.id),x(!0)},children:(0,s.jsx)(m,{kbCardVO:e})},e.id))]})]})}},2333:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,Es:()=>x,L3:()=>p,c7:()=>m,lG:()=>l,rr:()=>g});var s=a(139),n=a(8523),o=a(5475),r=a(5560),d=a(2482);function l(e){let{onOpenChange:t,open:a,...r}=e,d=n.useCallback(e=>{null==t||t(e),e||(document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow"),setTimeout(()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")},0),setTimeout(()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")},50),setTimeout(()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")},150))},[t]);return n.useEffect(()=>{if(!1===a){let e=()=>{document.body.style.removeProperty("pointer-events"),document.body.style.removeProperty("overflow")};e();let t=setTimeout(e,0),a=setTimeout(e,50),s=setTimeout(e,150),n=setTimeout(e,300);return()=>{clearTimeout(t),clearTimeout(a),clearTimeout(s),clearTimeout(n)}}},[a]),(0,s.jsx)(o.bL,{"data-slot":"dialog",open:a,...r,onOpenChange:d})}function i(e){let{...t}=e;return(0,s.jsx)(o.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,s.jsx)(o.hJ,{"data-slot":"dialog-overlay",className:(0,d.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function u(e){let{className:t,children:a,...n}=e;return(0,s.jsxs)(i,{"data-slot":"dialog-portal",children:[(0,s.jsx)(c,{}),(0,s.jsxs)(o.UC,{"data-slot":"dialog-content",className:(0,d.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[a,(0,s.jsxs)(o.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(r.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,d.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,d.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(o.hE,{"data-slot":"dialog-title",className:(0,d.cn)("text-lg leading-none font-semibold",t),...a})}function g(e){let{className:t,...a}=e;return(0,s.jsx)(o.VY,{"data-slot":"dialog-description",className:(0,d.cn)("text-muted-foreground text-sm",t),...a})}},2798:(e,t,a)=>{"use strict";a.d(t,{SQ:()=>l,_2:()=>i,lp:()=>c,rI:()=>r,ty:()=>d});var s=a(139);a(8523);var n=a(1729),o=a(2482);function r(e){let{...t}=e;return(0,s.jsx)(n.bL,{"data-slot":"dropdown-menu",...t})}function d(e){let{...t}=e;return(0,s.jsx)(n.l9,{"data-slot":"dropdown-menu-trigger",...t})}function l(e){let{className:t,sideOffset:a=4,...r}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{"data-slot":"dropdown-menu-content",sideOffset:a,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...r})})}function i(e){let{className:t,inset:a,variant:r="default",...d}=e;return(0,s.jsx)(n.q7,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":r,className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...d})}function c(e){let{className:t,inset:a,...r}=e;return(0,s.jsx)(n.JU,{"data-slot":"dropdown-menu-label","data-inset":a,className:(0,o.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",t),...r})}},3471:(e,t,a)=>{"use strict";a.d(t,{A0:()=>r,BF:()=>d,Hj:()=>l,XI:()=>o,nA:()=>c,nd:()=>i});var s=a(139);a(8523);var n=a(2482);function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})}function r(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,n.cn)("[&_tr]:border-b",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,n.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,n.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,n.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},4597:e=>{e.exports={cardContainer:"KBCard_cardContainer___Sfow",basicInfoContainer:"KBCard_basicInfoContainer__PdiYT",basicInfoNameContainer:"KBCard_basicInfoNameContainer__zsmtE",basicInfoNameText:"KBCard_basicInfoNameText__uSeOC",basicInfoDescriptionText:"KBCard_basicInfoDescriptionText__i6mh7",basicInfoLastUpdatedTimeContainer:"KBCard_basicInfoLastUpdatedTimeContainer__RdKoh",basicInfoUpdateTimeIcon:"KBCard_basicInfoUpdateTimeIcon__Ri4QX",basicInfoUpdateTimeText:"KBCard_basicInfoUpdateTimeText__P95Nc",operationContainer:"KBCard_operationContainer__qOX0i",operationDefaultBadge:"KBCard_operationDefaultBadge__PMsKP",operationDefaultBadgeIcon:"KBCard_operationDefaultBadgeIcon__p0rrD",operationDefaultBadgeText:"KBCard_operationDefaultBadgeText__CS1OK",bigText:"KBCard_bigText__tFw00",debugButtonIcon:"KBCard_debugButtonIcon__k0pCf"}},4894:(e,t,a)=>{Promise.resolve().then(a.bind(a,698))},5024:(e,t,a)=>{"use strict";a.d(t,{Et:()=>l,d0:()=>d,jc:()=>r});var s=a(139);a(8523);var n=a(7258),o=a(2482);function r(e){let{...t}=e;return(0,s.jsx)(n.bL,{"data-slot":"hover-card",...t})}function d(e){let{...t}=e;return(0,s.jsx)(n.l9,{"data-slot":"hover-card-trigger",...t})}function l(e){let{className:t,align:a="center",sideOffset:r=4,...d}=e;return(0,s.jsx)(n.ZL,{"data-slot":"hover-card-portal",children:(0,s.jsx)(n.UC,{"data-slot":"hover-card-content",align:a,sideOffset:r,className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...d})})}},5241:(e,t,a)=>{"use strict";a.d(t,{TR:()=>p,bq:()=>m,eb:()=>g,gC:()=>x,l6:()=>i,s3:()=>c,yv:()=>u});var s=a(139);a(8523);var n=a(6034),o=a(7282),r=a(2932),d=a(8895),l=a(2482);function i(e){let{...t}=e;return(0,s.jsx)(n.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,s.jsx)(n.YJ,{"data-slot":"select-group",...t})}function u(e){let{...t}=e;return(0,s.jsx)(n.WT,{"data-slot":"select-value",...t})}function m(e){let{className:t,size:a="default",children:r,...d}=e;return(0,s.jsxs)(n.l9,{"data-slot":"select-trigger","data-size":a,className:(0,l.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...d,children:[r,(0,s.jsx)(n.In,{asChild:!0,children:(0,s.jsx)(o.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:a,position:o="popper",...r}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsxs)(n.UC,{"data-slot":"select-content",className:(0,l.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:o,...r,children:[(0,s.jsx)(h,{}),(0,s.jsx)(n.LM,{className:(0,l.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(f,{})]})})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(n.JU,{"data-slot":"select-label",className:(0,l.cn)("text-muted-foreground px-2 py-1.5 text-xs",t),...a})}function g(e){let{className:t,children:a,...o}=e;return(0,s.jsxs)(n.q7,{"data-slot":"select-item",className:(0,l.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...o,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(n.VF,{children:(0,s.jsx)(r.A,{className:"size-4"})})}),(0,s.jsx)(n.p4,{children:a})]})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(n.PP,{"data-slot":"select-scroll-up-button",className:(0,l.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(d.A,{className:"size-4"})})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(n.wn,{"data-slot":"select-scroll-down-button",className:(0,l.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(o.A,{className:"size-4"})})}},6975:(e,t,a)=>{"use strict";a.d(t,{BT:()=>l,Wu:()=>i,ZB:()=>d,Zp:()=>o,aR:()=>r});var s=a(139);a(8523);var n=a(2482);function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function r(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...a})}},8229:e=>{e.exports={configPageContainer:"knowledgeBase_configPageContainer__RRvoG",knowledgeListContainer:"knowledgeBase_knowledgeListContainer__DmJ8H"}}},e=>{e.O(0,[2861,5310,8508,9265,9264,2144,3180,3811,6627,1731,8228,5756,7260,9462,4976,7358],()=>e(e.s=4894)),_N_E=e.O()}]);
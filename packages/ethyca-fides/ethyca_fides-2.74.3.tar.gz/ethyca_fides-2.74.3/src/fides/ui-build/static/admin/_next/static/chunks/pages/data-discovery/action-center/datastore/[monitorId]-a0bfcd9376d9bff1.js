(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6721],{74833:function(e,t,r){var n=r(56127),l=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(l,""):e}},56632:function(e,t,r){var n=r(89278),l=r(80068),a=r(50098);e.exports=function(e){return function(t,r,i){var o=Object(t);if(!l(t)){var s=n(r,3);t=a(t),r=function(e){return s(o[e],e,o)}}var c=e(t,r,i);return c>-1?o[s?t[c]:c]:void 0}}},56127:function(e){var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},66726:function(e,t,r){var n=r(11611),l=r(82846),a=r(91936),i=Math.max,o=Math.min;e.exports=function(e,t,r){var s,c,d,u,p,f,h=0,g=!1,m=!1,y=!0;if("function"!=typeof e)throw TypeError("Expected a function");function v(t){var r=s,n=c;return s=c=void 0,h=t,u=e.apply(n,r)}function x(e){var r=e-f,n=e-h;return void 0===f||r>=t||r<0||m&&n>=d}function _(){var e,r,n,a=l();if(x(a))return S(a);p=setTimeout(_,(e=a-f,r=a-h,n=t-e,m?o(n,d-r):n))}function S(e){return(p=void 0,y&&s)?v(e):(s=c=void 0,u)}function A(){var e,r=l(),n=x(r);if(s=arguments,c=this,f=r,n){if(void 0===p)return h=e=f,p=setTimeout(_,t),g?v(e):u;if(m)return clearTimeout(p),p=setTimeout(_,t),v(f)}return void 0===p&&(p=setTimeout(_,t)),u}return t=a(t)||0,n(r)&&(g=!!r.leading,d=(m="maxWait"in r)?i(a(r.maxWait)||0,t):d,y="trailing"in r?!!r.trailing:y),A.cancel=function(){void 0!==p&&clearTimeout(p),h=0,s=f=c=p=void 0},A.flush=function(){return void 0===p?u:S(l())},A}},64925:function(e,t,r){var n=r(56632)(r(66259));e.exports=n},66259:function(e,t,r){var n=r(95372),l=r(89278),a=r(47991),i=Math.max;e.exports=function(e,t,r){var o=null==e?0:e.length;if(!o)return -1;var s=null==r?0:a(r);return s<0&&(s=i(o+s,0)),n(e,l(t,3),s)}},82846:function(e,t,r){var n=r(77400);e.exports=function(){return n.Date.now()}},94919:function(e,t,r){var n=r(91936),l=1/0;e.exports=function(e){return e?(e=n(e))===l||e===-l?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,r){var n=r(94919);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},91936:function(e,t,r){var n=r(74833),l=r(11611),a=r(55193),i=0/0,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,d=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return i;if(l(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=l(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=s.test(e);return r||c.test(e)?d(e.slice(2),r?2:8):o.test(e)?i:+e}},83806:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/datastore/[monitorId]",function(){return r(66792)}])},30952:function(e,t,r){"use strict";r.d(t,{f:function(){return s}});var n=r(24246),l=r(66726),a=r.n(l),i=r(27378),o=r(26917);let s=e=>{let{value:t,onChange:r,placeholder:l,...s}=e,[c,d]=(0,i.useState)(t);(0,i.useEffect)(()=>{d(t||"")},[t]);let u=a()(r,500),p=(0,i.useCallback)(e=>{d(e),u(e)},[]);return(0,n.jsx)(o.Z,{value:c,onChange:p,onClear:()=>{d(""),r("")},placeholder:l,...s})}},35287:function(e,t,r){"use strict";var n=r(24246),l=r(98227),a=r(88038),i=r.n(a);r(27378),t.Z=e=>{let{children:t,title:r,fullHeight:a,fullWidth:o,mainProps:s}=e;return(0,n.jsxs)(l.kCb,{"data-testid":r,direction:"column",height:a?"100vh":"calc(100vh - 48px)",width:o?"100vw":"calc(100vw - 240px)",children:[(0,n.jsxs)(i(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",r]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(l.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...s,children:t})]})}},12627:function(e,t,r){"use strict";var n=r(24246),l=r(79283),a=r(34929);t.Z=e=>{let{selectedTaxonomies:t,showDisabled:r=!1,...i}=e,{getDataCategoryDisplayNameProps:o,getDataCategories:s}=(0,a.Z)(),c=(r?s():s().filter(e=>e.active)).filter(e=>!(null==t?void 0:t.includes(e.fides_key))).map(e=>{let{name:t,primaryName:r}=o(e.fides_key);return{value:e.fides_key,name:t,primaryName:r,description:e.description||""}});return(0,n.jsx)(l.l,{options:c,...i})}},79283:function(e,t,r){"use strict";r.d(t,{l:function(){return d}});var n=r(24246),l=r(98227),a=r(72707),i=r.n(a);let o=e=>{let{data:{formattedTitle:t,description:r,name:a,primaryName:i}}=e;return(0,n.jsxs)(l.jqI,{gap:12,title:"".concat(t," - ").concat(r),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:i||a}),i&&": ".concat(a)]}),(0,n.jsx)("em",{children:r})]})},s=e=>"options"in e&&Array.isArray(e.options),c=e=>({...e,className:i().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),d=e=>{let{options:t,...r}=e,a=null==t?void 0:t.map(e=>s(e)?{...e,options:e.options.map(c)}:c(e));return(0,n.jsx)(l.WPr,{options:a,filterOption:(e,t)=>{var r,n;return(null==t?void 0:null===(r=t.formattedTitle)||void 0===r?void 0:r.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(n=t.value)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:o,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...r})}},34929:function(e,t,r){"use strict";var n=r(24246),l=r(64925),a=r.n(l),i=r(27378),o=r(16134),s=r(30002),c=r(28079),d=r(57072);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,o.C)(c.U3),{isLoading:r}=(0,d.MO)(),n=(0,o.C)(d.qb),{isLoading:l}=(0,s.te)();return{dataUses:t,dataSubjects:(0,o.C)(s.ZL),dataCategories:n,isLoading:e||r||l}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:r,isLoading:l}=u(),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},s=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t(e);if(!n)return{};let l=t(o(e,r)),a=!!n.parent_key;return{name:n.name||void 0,primaryName:a&&(null==l?void 0:l.name)!==n.name&&(null==l?void 0:l.name)||void 0}},c=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:l,primaryName:a}=s(e,t,r);return l?a?(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)("strong",{children:[a,":"]})," ",l]},e):(0,n.jsx)("strong",{children:l},e):e},d=t=>a()(e,{fides_key:t}),p=e=>a()(t,{fides_key:e}),f=e=>a()(r,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataUseDisplayNameProps:e=>s(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>c(e,p,2),getDataCategoryDisplayNameProps:e=>s(e,p,2),getDataSubjects:()=>r,getDataSubjectByKey:f,getDataSubjectDisplayName:e=>{let t=f(e);return t?t.name:e},getPrimaryKey:o,isLoading:l}}},9270:function(e,t,r){"use strict";r.d(t,{S:function(){return a}});var n=r(27378),l=r(36866);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.h)(e),{pageIndex:r,pageSize:a,updatePageIndex:i,updatePageSize:o,pageSizeOptions:s,showSizeChanger:c}=t,d=(0,n.useMemo)(()=>({current:r,pageSize:a,showSizeChanger:c,pageSizeOptions:s.map(String),onChange:i,onShowSizeChange:(e,t)=>{o(t)}}),[r,a,c,s,i,o]);return{...t,paginationProps:d}}},57072:function(e,t,r){"use strict";r.d(t,{Bd:function(){return n.Bd},L5:function(){return n.L5},MO:function(){return n.MO},qb:function(){return n.qb}});var n=r(5785)},66792:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return e1}});var n,l,a,i,o=r(24246),s=r(98227),c=r(25980),d=r(86677),u=r(27378),p=r(43929),f=r(30952),h=r(35287),g=r(17245),m=r(77830),y=r(58754),v=r(9270),x=r(37059),_=r(65735);(n=a||(a={})).CLASSIFY="classify",n.APPROVE="approve",n.UN_APPROVE="un-approve",n.PROMOTE="promote",n.PROMOTE_REMOVALS="promote-removals",n.MUTE="mute",n.UN_MUTE="un-mute",n.ASSIGN_CATEGORIES="assign-categories";let{APPROVE:S,CLASSIFY:A,PROMOTE:b,MUTE:I,UN_MUTE:E}=a,j={approve:"Approve","assign-categories":"Assign categories",classify:"Classify",mute:"Ignore",promote:"Confirm","promote-removals":"Promote removals","un-approve":"Un-approve","un-mute":"Restore"},L={approve:"Approving","assign-categories":"Updating data categories",classify:"Classifying",mute:"Ignoring",promote:"Confirming","promote-removals":"Promoting removals","un-approve":"Un-approving","un-mute":"Restoring"},T={approve:"Approved","assign-categories":"Data category updated",classify:"Classified",mute:"Ignored",promote:"Confirmed","promote-removals":"Promoted removals","un-approve":"Un-approved","un-mute":"Restored"},C=[S,b],O=[A,S,b,I,E],k=[A,b],R={[S]:"You can only approve resources with a data category applied",[A]:"You cannot classify resources that are already in classification or ignored",[I]:"You cannot ignore resources that are already ignored",[b]:"You can only confirm resources that have a data category applied",[E]:"You can only restore resources that are ignored"},D={classify:[_.LL.ADDITION,_.LL.CLASSIFICATION_ADDITION,_.LL.CLASSIFICATION_UPDATE,_.LL.CLASSIFICATION_ERROR],approve:[_.LL.CLASSIFICATION_ADDITION,_.LL.CLASSIFICATION_UPDATE,_.LL.APPROVED],"un-approve":[_.LL.APPROVED],promote:[_.LL.CLASSIFICATION_ADDITION,_.LL.CLASSIFICATION_UPDATE,_.LL.APPROVED,_.LL.PROMOTION_ERROR],"promote-removals":[_.LL.REMOVAL,_.LL.REMOVAL_PROMOTION_ERROR],mute:[_.LL.ADDITION,_.LL.CLASSIFICATION_ADDITION,_.LL.CLASSIFICATION_UPDATE,_.LL.APPROVED,_.LL.REMOVAL,_.LL.CLASSIFICATION_ERROR,_.LL.PROMOTION_ERROR,_.LL.REMOVAL_PROMOTION_ERROR],"un-mute":[_.LL.MUTED],"assign-categories":[_.LL.ADDITION,_.LL.CLASSIFICATION_ADDITION,_.LL.CLASSIFICATION_UPDATE,_.LL.APPROVED,_.LL.CLASSIFICATION_ERROR,_.LL.PROMOTION_ERROR]},P={"assign-categories":null,"promote-removals":null,"un-approve":null,"un-mute":(0,o.jsx)(s.PJP.G7x,{}),approve:(0,o.jsx)(s.PJP.MCw,{}),classify:(0,o.jsx)(s.QMR,{size:14}),mute:(0,o.jsx)(s.PJP.uzw,{}),promote:(0,o.jsx)(s.PJP.MCw,{})},w={"assign-categories":e=>null,"promote-removals":e=>null,"un-approve":e=>null,"un-mute":e=>"Are you sure you want to restore ".concat(e.toLocaleString()," resources?"),approve:e=>"Are you sure you want to approve ".concat(e.toLocaleString()," resources?"),classify:e=>"Are you sure you want to run the classifier and apply data categories to ".concat(e.toLocaleString()," unlabeled resources?"),mute:e=>"Are you sure you want to ignore ".concat(e.toLocaleString()," resources? After ignoring, these resources may reappear in future scans."),promote:e=>"Are you sure you want to confirm these ".concat(e.toLocaleString()," resources? After confirming this data can be used for policy automation and DSRs. ")},N={onCancel:async()=>!1,onOk:async()=>!0,icon:null,width:542};var M=r(98784),U=r.n(M);let F="space",q=e=>e.map(e=>{let{itemKey:t}=e;return t}),z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeListItem:t=null,enableKeyboardShortcuts:r=!1}=e,[n,l]=(0,u.useState)("inclusive"),[a,i]=(0,u.useState)([]),[o,s]=(0,u.useState)([]),c=e=>{s(U().uniqBy(e,"itemKey"))},d=(e,t)=>{let r=a.find(t=>e===t.itemKey);r&&((("inclusive"===n?t:!t)?"add":"remove")=="add"?c([...o,r]):c(o.filter(t=>t.itemKey!==e)))},f=e=>{l(e),s([])},h=a.filter(e=>{let{itemKey:t}=e;return!o.find(e=>e.itemKey===t)}),g="inclusive"===n?o:h,m="exclusive"===n?o:h;return(0,p.y1)("h",()=>{f("exclusive")},{enabled:r}),(0,p.y1)("l",()=>{f("inclusive")},{enabled:r}),(0,p.y1)(F,e=>{if(t){e.preventDefault();let r=g.some(e=>e.itemKey===t.itemKey);d(t.itemKey,!r)}},{enabled:r},[t,g,d]),{excludedListItems:m,indeterminate:"inclusive"===n?g.length>0&&a.length!==g.length:m.length>0,isBulkSelect:"inclusive"===n?g.length>0&&a.length===g.length:0===m.length,listSelectMode:n,resetListSelect:()=>{s([]),l("inclusive")},selectedListItems:g,updateListItems:i,updateListSelectMode:f,updateSelectedListItem:d}},V=e=>{let{...t}=e;return(0,o.jsx)(s.$zI,{title:"Keyboard shortcuts",footer:null,...t,children:(0,o.jsx)(s.Yfl,{bordered:!0,column:1,items:[{key:"".concat(s.dHR.NAVIGATE_UP,"-").concat(s.dHR.NAVIGATE_DOWN),label:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:s.dHR.NAVIGATE_DOWN})," ","/"," ",(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:s.dHR.NAVIGATE_UP})]}),children:"Activate the next/previous field"},{key:F,label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:F}),children:"Toggle checkbox of the active field"},{key:"h",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"h"}),children:"Select all fields"},{key:"l",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"l"}),children:"Deselect all fields"},{key:s.dHR.CLEAR_FOCUS,label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:s.dHR.CLEAR_FOCUS}),children:"Clear the active field"},{key:"o",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"o"}),children:"Open/close details drawer for active field"},{key:"a",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"a"}),children:"Approve the active field"},{key:"c",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"c"}),children:"Confirm the active field"},{key:"i",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"i"}),children:"Ignore the active field"},{key:"r",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"r"}),children:"Restore the active field"},{key:"e",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"e"}),children:"Edit data categories for the active field"},{key:"?",label:(0,o.jsx)(s.AntTypography.Text,{keyboard:!0,children:"?"}),children:"Open/close this modal"}]})})};var $=r(78780),K=r(16394);let{useFieldActionsMutation:G,useGetMonitorFieldsQuery:J,useLazyGetAllowedActionsQuery:W}=$.u.injectEndpoints({endpoints:e=>({getMonitorFields:e.query({query:e=>{let{path:{monitor_config_id:t},query:{page:r=1,size:n=20,search:l,diff_status:a,confidence_score:i,...o}}=e,s=(0,K.$J)({...o,...l?{search:[l]}:{},...a?{diff_status:a}:{},...i?{confidence_score:i}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields?").concat(null==s?void 0:s.toString()),params:{page:r,size:n}}},providesTags:["Monitor Field Results"]}),fieldActions:e.mutation({query:e=>{let{path:{monitor_config_id:t,action_type:r},query:{search:n,diff_status:l,confidence_score:a,...i},...o}=e,s=(0,K.$J)({...i,...n?{search:[n]}:{},...l?{diff_status:l}:{},...a?{confidence_score:a}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields/").concat(r,"?").concat(s.toString()),method:"POST",body:o}},invalidatesTags:["Monitor Field Results","Monitor Field Details"]}),getAllowedActions:e.query({query:e=>{let{path:{monitor_config_id:t},query:{search:r,diff_status:n,confidence_score:l,...a},...i}=e,o=(0,K.$J)({...a,...r?{search:[r]}:{},...n?{diff_status:n}:{},...l?{confidence_score:l}:{}});return{url:"/plus/discovery-monitor/".concat(t,"/fields/allowed-actions?").concat(o.toString()),method:"POST",body:i}},providesTags:["Allowed Monitor Field Actions"]})})});var Y=r(83766),H=r.n(Y),Z=r(59001),B=r(90673),Q=r(39864),X=r(3124),ee=r.n(X);let et="load_more",er="skeleton",en=["Unlabeled","Classifying","In Review","Approved","Confirming...","Confirmed","Removed","Ignored","Error"],el=["Confirmed","Ignored","Confirming..."],ea=e=>e.filter(e=>!el.includes(e)),ei={addition:{label:"Unlabeled"},approved:{label:"Approved",color:s.tAb.SUCCESS},classification_addition:{label:"In Review",color:s.tAb.CAUTION},classification_error:{label:"Error",color:s.tAb.ERROR},classification_queued:{label:"Classifying",color:s.tAb.INFO},classification_update:{label:"In Review",color:s.tAb.CAUTION},classifying:{label:"Classifying",color:s.tAb.INFO},monitored:{label:"Confirmed",color:s.tAb.MINOS},muted:{label:"Ignored",color:s.tAb.DEFAULT},promoting:{label:"Confirming...",color:s.tAb.DEFAULT},promotion_error:{label:"Error",color:s.tAb.ERROR},removal:{label:"Removed",color:s.tAb.ERROR},removing:{label:"In Review",color:s.tAb.CAUTION},removal_promotion_error:{label:"Error",color:s.tAb.ERROR}},eo={[_.D$.DATABASE]:s.PJP.S9g,[_.D$.FIELD]:s.PJP.sgG,[_.D$.SCHEMA]:s.PJP.ehp,[_.D$.TABLE]:s.PJP.iA_},es={STATUS:"status-section",DATA_CATEGORY:"data-category-section",CONFIDENCE:"confidence-section"},ec={[_.Ag.ADDITION]:{color:ee().FIDESUI_SUCCESS,tooltip:"This resource was added in the latest scan"},[_.Ag.REMOVAL]:{color:ee().FIDESUI_ERROR,tooltip:"This resource was removed in the latest scan"},[_.Ag.CHANGE]:{color:ee().FIDESUI_WARNING,tooltip:"This resource was modified in the latest scan"}},ed=(e,t)=>{if(!e||0===e.length)return[];let r=(e,t)=>{let n=t=>{if(t.value===e)return{title:t.label||e,children:t.children||[]};if(t.children&&t.children.length>0){let n=r(e,t.children);if(n)return n}return null};return t.reduce((e,t)=>null!=e?e:n(t),null)},n=new Map;e.forEach(e=>{let l=e.split(".");l.forEach((e,a)=>{let i=l.slice(0,a+1).join(".");if(!n.has(i)){let e=r(i,t);n.set(i,{title:(null==e?void 0:e.title)||(0,K.kC)(i.split(".").pop()||i),key:i,checkable:!0,selectable:!1})}})});let l=Array.from(n.values()),a=new Map;l.forEach(e=>{let t=e.key.toString().split(".");if(t.length>1){let r=t.slice(0,-1).join(".");a.has(r)||a.set(r,[]),a.get(r).push(e)}});let i=e=>(a.get(e)||[]).map(e=>{let t=i(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}});return l.filter(e=>1===e.key.toString().split(".").length).map(e=>{let t=i(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}})},eu=e=>{let{resourceStatus:t,setResourceStatus:r,dataCategory:n,setDataCategory:l,resetToInitialState:a,monitorId:i,stagedResourceUrn:c}=e,[d,p]=(0,u.useState)(t),[f,h]=(0,u.useState)(n),[g,m]=(0,u.useState)([es.STATUS]);(0,u.useEffect)(()=>{p(t)},[t]),(0,u.useEffect)(()=>{h(n)},[n]);let y=c.join(",");(0,u.useEffect)(()=>{a()},[y]);let{data:v,refetch:_}=(0,x.S0)({monitor_config_id:i,staged_resource_urn:c},{refetchOnMountOrArgChange:!0}),[S,{data:A=[]}]=(0,Q.ci)();(0,u.useEffect)(()=>{S(Z.ac.DATA_CATEGORY)},[S]);let b=(0,u.useMemo)(()=>(0,B.Cd)(A),[A]),I=(0,u.useMemo)(()=>en.map(e=>({title:e.replace(/\.{3}$/,""),key:e,checkable:!0,selectable:!1,isLeaf:!0})),[]),E=(0,u.useMemo)(()=>(null==v?void 0:v.data_category)&&0!==v.data_category.length?ed(v.data_category,b):[],[null==v?void 0:v.data_category,b]),j=(0,u.useMemo)(()=>{let e=[];return I.length>0&&e.push({title:"Status",key:es.STATUS,checkable:!0,selectable:!1,isLeaf:!1,children:I}),E.length>0&&e.push({title:"Data category",key:es.DATA_CATEGORY,checkable:!0,selectable:!1,isLeaf:!1,children:E}),e},[I,E]),L=(0,u.useMemo)(()=>H()([...null!=d?d:[],...null!=f?f:[]]),[d,f]),T=(0,u.useMemo)(()=>{let e=0;return t&&(e+=new Set(t).size),n&&(e+=new Set(n).size),e},[t,n]);return(0,o.jsx)(s.wn$,{treeProps:{checkable:!0,checkedKeys:L,onCheck:e=>{let t=Array.isArray(e)?e:e.checked,r=[],n=[],l=Object.values(es),a=(e,t)=>t.some(t=>t!==e&&t.startsWith("".concat(e,"."))),i=t.map(e=>e.toString());t.forEach(e=>{let t=e.toString();if(l.some(e=>e===t))return;let o=en.find(e=>e===t);o?r.push(o):a(t,i)||n.push(t)}),p(r.length>0?r:[]),h(n.length>0?n:[])},treeData:j,expandedKeys:g,onExpand:e=>{m(e)}},onApply:()=>{r(d&&d.length>0?Array.from(new Set(d)):d),l(f&&f.length>0?Array.from(new Set(f)):f)},onReset:()=>{a(),p(ea([...en])),h([])},onClear:()=>{p([]),h([])},onOpenChange:e=>{if(e){_();return}p(t),h(n)},activeFiltersCount:T})};(l=i||(i={})).LOW="low",l.HIGH="high",l.MANUAL="manual";let ep=e=>{let{percent:t,confidenceScore:r}=e;return null},ef=e=>{switch(e){case 1:return _.D$.DATABASE;case 2:return _.D$.SCHEMA;case 3:return _.D$.TABLE;default:return _.D$.FIELD}},eh=e=>{if(!e||"string"!=typeof e)return[];let t=e.trim();if(!t)return[];let r=t.split(".");if(r.length<2)return[];let n=r.filter(e=>e&&e.trim().length>0);return n.length<2?[]:(n.shift(),n.length>0&&n.pop(),0===n.length)?[]:n.map((e,t)=>{let r=eo[ef(t+1)];return{title:e.trim(),IconComponent:r}})};var eg=r(79283),em=r(34929),ey=e=>{let{onSelectDataCategory:t,urn:r,...n}=e,{getDataCategoryDisplayNameProps:l,getDataCategories:a}=(0,em.Z)(),i=a().filter(e=>e.active),[c,d]=(0,u.useState)(!1),p=i.map(e=>{let{name:t,primaryName:r}=l(e.fides_key);return{value:e.fides_key,label:(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:r||t}),r&&": ".concat(t)]}),name:t,primaryName:r,description:e.description||""}});return(0,o.jsx)(eg.l,{options:p,prefix:(0,o.jsx)(s.wpx,{"aria-label":"Add Data Category",type:"text",size:"small",icon:(0,o.jsx)(s.PJP.mm_,{}),disabled:n.disabled}),placeholder:"",suffixIcon:null,classNames:{root:"w-full max-w-full overflow-hidden p-0 cursor-pointer -ml-5"},style:{"--ant-select-multiple-selector-bg-disabled":"transparent"},variant:"borderless",autoFocus:!1,maxTagCount:"responsive",open:c,onOpenChange:e=>d(e),onSelect:e=>{t(e),d(!1)},"data-classification-select":r,...n})},ev=r(97947),ex=r.n(ev);let e_=e=>{let{label:t,closable:r,onClose:n,isFromClassifier:l}=e;return(0,o.jsx)(s.j8w,{color:"white",bordered:!0,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:r,onClose:n,style:{marginInlineEnd:"calc((var(--ant-padding-xs) * 0.5))"},icon:l&&(0,o.jsx)(s.QMR,{}),children:(0,o.jsx)(s.lKn,{size:"sm",children:t})})},eS=e=>{let{title:t,IconComponent:r}=e;return{title:r?(0,o.jsxs)(s.jqI,{gap:3,align:"center",children:[(0,o.jsx)(r,{}),(0,o.jsx)("span",{children:t})]}):t}};var eA=e=>{let{urn:t,classifications:r,name:n,diff_status:l,selected:a,onSelect:c,onSetDataCategories:d,dataCategoriesDisabled:u,onNavigate:p,preferred_data_categories:f,actions:h}=e;return(0,o.jsx)(s.krs.Item,{actions:[r&&r.length>0&&(0,o.jsx)(ep,{percent:r.find(e=>e.confidence_score===i.HIGH)?100:25}),...null!=h?h:[]],children:(0,o.jsx)(s.krs.Item.Meta,{avatar:(0,o.jsx)("div",{className:"ml-2",children:(0,o.jsx)(s.E_O,{checked:a,onChange:e=>c&&c(t,e.target.checked)})}),title:(0,o.jsxs)(s.jqI,{gap:12,align:"center",className:ex()["monitor-field__title"],children:[(0,o.jsx)(s.wpx,{type:"text",size:"small",className:"-mx-2",onClick:()=>p&&p(t),children:n}),l&&l!==_.LL.ADDITION&&(0,o.jsx)(s.j8w,{bordered:!1,color:ei[l].color,children:ei[l].label}),(0,o.jsx)(s.esZ,{title:t,mouseEnterDelay:.5,children:(0,o.jsx)(s.zrq,{className:ex()["monitor-field__breadcrumb"],items:eh(t).map(eS),role:"presentation",style:{overflow:"hidden"}})})]}),description:(0,o.jsx)(ey,{mode:"multiple",value:null!=f?f:[],urn:t,tagRender:e=>{let n=!!(null==r?void 0:r.find(t=>t.label===e.value));return e_({...e,isFromClassifier:n,onClose:()=>{var r;d(t,null!==(r=null==f?void 0:f.filter(t=>t!==e.value))&&void 0!==r?r:[])}})},onSelectDataCategory:e=>{(null==f?void 0:f.includes(e))||d(t,[...null!=f?f:[],e])},disabled:u})})},t)},eb=r(812);let eI=(e,t)=>e.find(e=>{let{children:r}=e;return r&&!!r.find(e=>e.key.toString()===t)}),eE=(e,t)=>e.reduce((e,r)=>{if(r.children){var n;return null!==(n=eI(r.children,t))&&void 0!==n?n:eE(r.children,t)}return e},null),ej=e=>{let{node:t,treeData:r,onLoadMore:n}=e;if(!t.title)return null;if(t.key.toString().startsWith(et)){let e=eE(r,t.key.toString());return(0,o.jsx)(s.wpx,{type:"link",block:!0,onClick:()=>{(null==e?void 0:e.key)&&n(e.key.toString())},className:"p-0",children:t.title})}if(t.key.toString().startsWith(er))return(0,o.jsx)(s.N_L,{paragraph:!1,title:{width:"80px"},active:!0,children:t.title});let l=t.status?ec[t.status]:null;return(0,o.jsxs)(s.jqI,{gap:4,align:"center",className:"inline-flex",children:[l&&(0,o.jsx)(s.esZ,{title:l.tooltip,children:(0,o.jsx)(s.PJP.fRw,{className:"size-2",style:{color:l.color}})}),(0,o.jsx)(s.lKn,{ellipsis:{tooltip:t.title},children:t.title})]})},eL=(e,t,r)=>e.map(e=>e.key===t?{...e,status:r}:e.children?{...e,children:eL(e.children,t,r)}:e),eT=(e,t)=>e.map(e=>{if(e.key===t){let{children:t,...r}=e;return r}return e.children?{...e,children:eT(e.children,t)}:e}),eC=e=>{let t=[];return e.children&&e.children.length>0&&e.children.forEach(e=>{"string"==typeof e.key&&(t.push(e.key),t.push(...eC(e)))}),t},eO=(e,t)=>{for(let r of e){if(r.key===t)return r;if(r.children){let e=eO(r.children,t);if(e)return e}}},ek=(e,t)=>{var r;let n=e.items.map(e=>{let t=e.resource_type?eo[e.resource_type]:void 0;return{title:e.name,key:e.urn,selectable:!0,icon:t?()=>(0,o.jsx)(t,{className:"h-full"}):void 0,status:e.update_status,isLeaf:e.resource_type===_.D$.FIELD||!e.has_grandchildren,classifyable:[_.D$.SCHEMA,_.D$.TABLE,_.D$.ENDPOINT,_.D$.FIELD].includes(e.resource_type)}});return(null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0)<100?n:[...n,{title:"Load more...",key:"".concat(et,"-").concat(e.page,"-").concat(t),selectable:!1,isLeaf:!0}]},eR=(e,t,r)=>e.map(e=>{if(e.key===t){var n,l;return{...e,children:[...null!==(l=null===(n=e.children)||void 0===n?void 0:n.filter(e=>!(e.key.toString().startsWith(et)||e.key.toString().startsWith(er))))&&void 0!==l?l:[],...r]}}return e.children?{...e,children:eR(e.children,t,r)}:e}),eD=(e,t,r)=>e.map(e=>e.key===t?{...e,children:r}:e.children?{...e,children:eD(e.children,t,r)}:e),eP=(e,t,r)=>e.map(e=>{if(e.key===t){var n;let t=(null!==(n=e.children)&&void 0!==n?n:[]).filter(e=>!(e.key.toString().startsWith(et)||e.key.toString().startsWith(er))),l=new Map(r.map(e=>[e.key,e])),a=new Map(t.map(e=>[e.key,e])),i=t.map(e=>{let t=l.get(e.key);return null!=t?t:e});return r.forEach(e=>{a.has(e.key)||i.push(e)}),{...e,children:i}}return e.children?{...e,children:eP(e.children,t,r)}:e}),ew=(0,u.forwardRef)((e,t)=>{let{selectedNodeKeys:r,setSelectedNodeKeys:n,onClickClassifyButton:l}=e,a=(0,d.useRouter)(),{errorAlert:i}=(0,g.VY)(),c=decodeURIComponent(a.query.monitorId),[p]=(0,x.RV)(),[f]=(0,x.M8)(),[h,m]=(0,u.useState)({}),[y,v]=(0,u.useState)([]),[_,S]=(0,u.useState)([]),A=(0,u.useRef)({}),b=(0,u.useRef)({}),I=(0,u.useCallback)(async e=>{var t;let{nodeKey:r,queryParams:n,fastUpdateFn:l,detailedUpdateFn:a}=e,i=(null!==(t=A.current[r])&&void 0!==t?t:0)+1;A.current[r]=i;let o=p({...n,include_descendant_details:!1}),s=p({...n,include_descendant_details:!0});o.then(e=>{let{data:t}=e;t&&A.current[r]===i&&b.current[r]!==i&&l(t)}),s.then(e=>{let{data:t}=e;t&&A.current[r]===i&&(b.current[r]=i,(null!=a?a:l)(t))})},[p]),E=(0,u.useCallback)(e=>new Promise(t=>{let{children:r,key:n}=e;if(r){t();return}let l=n.toString();I({nodeKey:l,queryParams:{monitor_config_id:c,staged_resource_urn:l,size:100},fastUpdateFn:e=>{v(t=>eD(t,n,ek(e,l))),m(e=>({...e,[l]:{pageSize:100,pageIndex:1}}))}}),t()}),[I,c]),j=(0,u.useCallback)(e=>{let t=h[e];t&&(v(t=>eR(t,e,[...Array(100)].map((t,r)=>({key:"".concat(er,"-").concat(e,"-").concat(r),title:"SKELETON",isLeaf:!0})))),I({nodeKey:e,queryParams:{monitor_config_id:c,staged_resource_urn:e,size:100,page:t.pageIndex+1},fastUpdateFn:t=>{v(r=>eR(r,e,ek(t,e)))},detailedUpdateFn:t=>{v(r=>eP(r,e,ek(t,e))),m(t=>{var r,n;return{...t,[e]:{pageSize:100,pageIndex:(null!==(n=null===(r=t[e])||void 0===r?void 0:r.pageIndex)&&void 0!==n?n:0)+1}}})}}))},[h,I,c]),L=(0,u.useCallback)(e=>{v(t=>{let r=eO(t,e),n=[e];return r&&n.push(...eC(r)),S(e=>e.filter(e=>!n.includes(e.toString()))),m(e=>{let t={...e};return n.forEach(e=>{delete t[e]}),t}),n.forEach(e=>{delete A.current[e],delete b.current[e]}),eT(t,e)})},[]),T=(0,u.useCallback)(async e=>{let t=async e=>{try{let t=await f({monitor_config_id:c,...e&&{staged_resource_urn:e}});if(t.error){i((0,eb.e$)(t.error),"Failed to get schema explorer ancestors statuses");return}let r=t.data;if(!r)return;e?L(e):r.forEach(e=>{L(e.urn)}),v(e=>r.reduce((e,t)=>eL(e,t.urn,t.update_status),e))}catch(e){i("An unexpected error occurred while refreshing the schema explorer")}};if(0===e.length){await t();return}await Promise.all(e.map(e=>t(e)))},[f,c,L,i]),C=(0,u.useCallback)((e,t)=>{S(e),t.expanded&&!t.node.children&&E&&E(t.node)},[E]);return(0,u.useImperativeHandle)(t,()=>({refreshResourcesAndAncestors:T})),(0,u.useEffect)(()=>{(async()=>{y.length>0||I({nodeKey:"root",queryParams:{monitor_config_id:c,size:100},fastUpdateFn:e=>{v(ek(e))}})})()},[I,c,v,y.length]),(0,o.jsxs)(s.jqI,{gap:"middle",vertical:!0,className:"h-full",children:[(0,o.jsx)(s.lQT,{level:3,className:"sticky top-0",children:"Schema explorer"}),(0,o.jsx)(s.a$q,{loadData:E,treeData:y,expandedKeys:_,onExpand:C,onSelect:(e,t)=>{n(t.selectedNodes.filter(e=>e.classifyable).map(e=>e.key))},showIcon:!0,showLine:!0,blockNode:!0,rootClassName:"h-full overflow-x-hidden",titleRender:e=>(0,o.jsx)(ej,{node:e,treeData:y,onLoadMore:j})}),r.length>0&&(0,o.jsxs)(s.jqI,{justify:"space-between",align:"center",children:[(0,o.jsxs)("span",{children:[r.length," selected"]}),(0,o.jsx)(s.wpx,{"aria-label":"Classify ".concat(r.length," Selected Nodes"),icon:(0,o.jsx)(s.QMR,{size:12}),size:"small",onClick:l})]})]})});ew.displayName="MonitorTree";var eN=r(12627),eM=r(84418);let eU=(e,t)=>(0,o.jsx)(t,{...e,className:"!sticky top-0 z-[2] bg-white"}),eF=e=>{var t;let{resource:r,fieldActions:n,...l}=e;return(0,o.jsx)(eM.d,{...l,classNames:{body:"!pt-0 !mt-[var(--ant-padding-lg)] max-h-full"},children:r?(0,o.jsx)(s.A5g,{defaultActiveKey:"details",renderTabBar:eU,items:[{key:"details",label:"Details",children:(0,o.jsxs)(s.jqI,{gap:"middle",vertical:!0,children:[(0,o.jsx)(s.Yfl,{bordered:!0,size:"small",column:1,items:[{key:"system",label:"System",children:r.system_key},{key:"path",label:"Path",children:r.urn},{key:"data-type",label:"Data type",children:"source_data_type"in r?r.source_data_type:void 0},{key:"description",label:"Description",children:r.description}]}),(0,o.jsx)(s.PPS,{layout:"vertical",children:(0,o.jsx)(s.PPS.Item,{label:"Data categories",children:(0,o.jsx)(eN.Z,{variant:"outlined",mode:"multiple",maxTagCount:"responsive",value:"preferred_data_categories"in r?r.preferred_data_categories:[],autoFocus:!1,disabled:null==r||!r.diff_status||!D["assign-categories"].some(e=>e===r.diff_status),onChange:e=>n["assign-categories"]([r.urn],{user_assigned_data_categories:e})})})}),r.classifications&&r.classifications.length>0&&(0,o.jsx)(s.krs,{dataSource:r.classifications,renderItem:e=>(0,o.jsx)(s.krs.Item,{children:(0,o.jsx)(s.krs.Item.Meta,{avatar:(0,o.jsx)(s.t3Z,{style:{backgroundColor:null===ee()||void 0===ee()?void 0:ee().FIDESUI_BG_DEFAULT},icon:(0,o.jsx)(s.QMR,{color:"black"})}),title:(0,o.jsxs)(s.jqI,{align:"center",gap:"middle",children:[(0,o.jsx)("div",{children:e.label}),(0,o.jsx)(ep,{percent:100*e.score})]}),description:e.rationale})})})]})},{key:"activity",label:"Activity",children:(0,o.jsx)(s.krs,{dataSource:"errors"in r&&r.errors?null===(t=r.errors)||void 0===t?void 0:t.map((e,t)=>({key:t,title:e.phase,description:new Date(e.timestamp).toLocaleString(),content:e.message})):[],renderItem:(e,t)=>(0,o.jsxs)(s.krs.Item,{children:[(0,o.jsx)(s.krs.Item.Meta,{title:e.title,description:e.description}),(0,o.jsx)(s.FUI,{ellipsis:{expandable:"collapsible",rows:3},copyable:{icon:(0,o.jsx)(s.PJP.CKM,{className:"pt-1",size:18})},children:e.content})]},t),itemLayout:"vertical"})}]}):null})};var eq=r(31883);let ez=(e,t)=>({title:e,okText:e,content:t,...N}),eV=(e,t)=>"".concat(T[e]).concat((0,K._6)(null!=t?t:0,"","".concat(e===a.ASSIGN_CATEGORIES?" for":""," ").concat(null==t?void 0:t.toLocaleString()," resources"))),e$=e=>"".concat(T[e]," failed").concat(e===a.CLASSIFY||e===a.PROMOTE?": View summary in the activity tab":""),eK=(e,t,r,n)=>{let[l]=G(),i=i=>async(o,s,c)=>{let d=Date.now();if(!await t.confirm(ez(j[i],w[i](c))))return;r.open({key:d,type:"loading",content:"".concat(L[i]," ").concat(c," ").concat((0,K._6)(c,"resource","resources"),"..."),duration:0});let u=await l({query:{...o.query},path:{monitor_config_id:e,action_type:i},body:{excluded_resource_urns:s}});if((0,eq.D4)(u)){r.open({key:d,type:"error",content:e$(i),duration:5});return}if(r.open({key:d,type:"success",content:eV(i,c),duration:5}),n&&i!==a.APPROVE){let e=o.query.staged_resource_urn||[];await n(e)}};return{"assign-categories":i(a.ASSIGN_CATEGORIES),"promote-removals":i(a.PROMOTE_REMOVALS),"un-approve":i(a.UN_APPROVE),"un-mute":i(a.UN_MUTE),approve:i(a.APPROVE),classify:i(a.CLASSIFY),mute:i(a.MUTE),promote:i(a.PROMOTE)}},eG={DRAWER_OPEN:".ant-drawer-open",DRAWER_SELECT:".ant-drawer-open .ant-select",SELECT:".ant-select",SELECT_SELECTOR:".ant-select-selector",SELECT_DISABLED:"ant-select-disabled",INPUT:"input",LIST_ITEM_SELECT:"[data-classification-select]"},eJ=(e,t,r,n,l,i)=>{let o=e=>{let t=e.querySelector(eG.SELECT_SELECTOR);if(!t)return!1;if(e.classList.contains(eG.SELECT_DISABLED))return l.warning("You cannot assign categories to this resource in its current state"),!1;let r=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(r);let n=e.querySelector(eG.INPUT);return n&&n.focus(),!0},s=r=>{var n;e&&(e.diff_status&&(null===(n=D[r])||void 0===n?void 0:n.includes(e.diff_status))?t[r]([e.urn]):l.warning(R[r]))};(0,p.y1)("a",()=>s(a.APPROVE),[e,t]),(0,p.y1)("c",()=>s(a.PROMOTE),[e,t]),(0,p.y1)("i",()=>s(a.MUTE),[e,t]),(0,p.y1)("r",()=>s(a.UN_MUTE),[e,t]),(0,p.y1)("o",()=>{e&&i?n(void 0):e&&!i&&n(e.urn)},[e,n,i]),(0,p.y1)("e",t=>{if(t.preventDefault(),!e)return;let r=null;if(i){let e=document.querySelector(eG.DRAWER_OPEN);e&&(r=e.querySelector(eG.SELECT))}else{let t=CSS.escape(e.urn);r=document.querySelector('[data-classification-select="'.concat(t,'"]'))}r&&o(r)},[e,l,i]),(0,p.y1)("escape",e=>{let t=document.activeElement;if((null==t?void 0:t.tagName)!=="INPUT")return;let r=t.closest(eG.LIST_ITEM_SELECT),n=t.closest(eG.DRAWER_SELECT);(r||n)&&(e.preventDefault(),e.stopPropagation(),t.blur())},{enableOnFormTags:["INPUT"]},[i])};var eW=r(70675);let eY=e=>{let[t,...r]=e.map(e=>Object.values(a).flatMap(t=>D[t].some(t=>t===e)?[t]:[]));return r.reduce((e,t)=>U().intersection(e,[...t]),null!=t?t:[])},eH=(e,t,r,n)=>{let[l]=(0,eW.LI)(),[i]=(0,x.Av)(),[o]=(0,eW.zV)(),[s]=(0,eW.Hf)(),[c]=(0,eW._J)(),[d]=(0,eW.NA)(),u=(e,l)=>async(a,i)=>{let o=Date.now();if(!(1===a.length||await t.confirm(ez(j[e],w[e](a.length)))))return;r.open({key:o,type:"loading",content:"".concat(L[e]," ").concat(a.length," ").concat((0,K._6)(a.length,"resource","resources"),"..."),duration:0});let s=await l(a,i);if((0,eq.D4)(s)){r.open({key:o,type:"error",content:e$(e),duration:5});return}r.open({key:o,type:"success",content:eV(e,a.length),duration:5}),n&&await n(a)},p=async e=>o({staged_resource_urns:e}),f=async e=>c({staged_resource_urns:e}),h=async e=>s({staged_resource_urns:e}),g=async t=>i({monitor_config_key:e,staged_resource_urns:t}),m=async(t,r)=>{var n;let[l]=t;return d({monitor_config_id:e,staged_resource_urn:l,user_assigned_data_categories:null!==(n=null==r?void 0:r.user_assigned_data_categories)&&void 0!==n?n:void 0})},y=async t=>l({monitor_config_key:e,staged_resource_urns:t});return{"assign-categories":u(a.ASSIGN_CATEGORIES,m),"promote-removals":()=>{},"un-approve":()=>{},"un-mute":u(a.UN_MUTE,f),approve:u(a.APPROVE,y),classify:u(a.CLASSIFY,g),mute:u(a.MUTE,p),promote:u(a.PROMOTE,h)}};var eZ=r(40431);let eB=()=>{let[e,t]=(0,eZ.v1)("resourceStatus",(0,eZ.S$)((0,eZ.km)(en))),[r,n]=(0,eZ.v1)("confidenceScore",(0,eZ.S$)((0,eZ.jx)(Object.values(i)))),[l,a]=(0,eZ.v1)("dataCategory",(0,eZ.S$)(eZ.Oi));return(0,u.useEffect)(()=>{if(null===e){let e=ea([...en]);t(e.length>0?e:[])}},[]),{resourceStatus:e,setResourceStatus:t,confidenceScore:r,setConfidenceScore:n,dataCategory:l,setDataCategory:a,reset:()=>{t([]),n([]),a([])},resetToInitialState:()=>{t(ea([...en])),n(null),a(null)}}},eQ=e=>Object.values(_.LL).flatMap(t=>ei[t].label===e?[t]:[]);var eX=()=>{var e,t,r,n,l;let a=decodeURIComponent((0,d.useRouter)().query.monitorId),i=(0,u.useRef)(null),[c,_]=s.Pg3.useMessage(),[S,A]=s.$zI.useModal(),[b,I]=(0,u.useState)(!1),{paginationProps:E,pageIndex:L,pageSize:T,resetPagination:w}=(0,v.S)({defaultPageSize:25}),N=(0,g.Rx)(),{resourceStatus:M,confidenceScore:U,dataCategory:F,...$}=eB(),{data:K}=(0,x.vc)({monitor_config_id:a}),[G,Y]=(0,u.useState)([]),H={path:{monitor_config_id:a},query:{staged_resource_urn:G.map(e=>e.toString()),search:N.searchProps.value,diff_status:M?M.flatMap(eQ):void 0,confidence_score:U||void 0,data_category:F||void 0}},{data:Z,isFetching:B,refetch:Q}=J({...H,query:{...H.query,size:T,page:L}}),[X,ee]=(0,u.useState)(),[et,er]=(0,u.useState)(),[en,el]=(0,x.mC)(),[ea,{data:eo,isFetching:es}]=W(),ec=el.data,ed=eK(a,S,c,async e=>{var t;await (null===(t=i.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),ep=eH(a,S,c,async e=>{var t;await (null===(t=i.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),{excludedListItems:ef,indeterminate:eh,isBulkSelect:eg,listSelectMode:em,resetListSelect:ey,selectedListItems:ev,updateListItems:ex,updateListSelectMode:e_,updateSelectedListItem:eS}=z({activeListItem:et,enableKeyboardShortcuts:!0}),eb=async e=>{ee(e)};(0,p.y1)("?",()=>I(!b),{useKey:!0},[b]);let eI=eg?null==eo?void 0:eo.allowed_actions:eY(ev.flatMap(e=>{let{diff_status:t}=e;return t?[t]:[]})),eE=null!==(r=null==Z?void 0:Z.total)&&void 0!==r?r:0,ej="exclusive"===em&&(null==Z?void 0:Z.total)?eE-ef.length:ev.length;return(0,u.useEffect)(()=>{Z&&ex(Z.items.map(e=>{let{urn:t,...r}=e;return{itemKey:t,urn:t,...r}}))},[null==Z?void 0:Z.items]),(0,u.useEffect)(()=>{X&&en({stagedResourceUrn:X})},[X]),(0,u.useEffect)(()=>{w(),ey()},[M,U,G,N.searchQuery,F]),eJ(et,ep,eS,eb,c,!!X),(0,o.jsxs)(h.Z,{title:"Action center - Discovered assets by system",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,o.jsx)(y.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:m.vi},{title:a}],isSticky:!1}),(0,o.jsxs)(s.LgQ,{className:"h-[calc(100%-48px)] overflow-hidden",children:[(0,o.jsx)(s.LgQ.Panel,{defaultSize:250,style:{paddingRight:"var(--ant-padding-md)"},children:(0,o.jsx)(ew,{ref:i,selectedNodeKeys:G,setSelectedNodeKeys:Y,onClickClassifyButton:()=>{ep.classify(G.map(e=>e.toString()))}})}),(0,o.jsx)(s.LgQ.Panel,{style:{paddingLeft:"var(--ant-padding-md)"},children:(0,o.jsxs)(s.jqI,{vertical:!0,gap:"middle",className:"h-full",children:[(0,o.jsxs)(s.jqI,{justify:"space-between",children:[(0,o.jsx)(s.lQT,{level:2,children:"Monitor results"}),(0,o.jsx)(s.jqI,{align:"center",children:(null==K?void 0:K.last_monitored)&&(0,o.jsxs)(s.lKn,{type:"secondary",children:["Last scan:"," ",new Date(null==K?void 0:K.last_monitored).toLocaleString()]})})]}),(0,o.jsxs)(s.jqI,{justify:"space-between",children:[(0,o.jsxs)(s.jqI,{gap:"small",children:[(0,o.jsx)(f.f,{value:N.searchQuery,onChange:N.updateSearch,placeholder:"Search"}),(0,o.jsx)(s.esZ,{title:"Display keyboard shortcuts",children:(0,o.jsx)(s.wpx,{"aria-label":"Display keyboard shortcuts",icon:(0,o.jsx)(s.PJP.N1d,{}),onClick:()=>I(!0)})})]}),(0,o.jsxs)(s.jqI,{gap:"small",children:[(0,o.jsx)(eu,{resourceStatus:M,confidenceScore:U,dataCategory:F,...$,monitorId:a,stagedResourceUrn:G.map(e=>e.toString())}),(0,o.jsx)(s.S0p,{onOpenChange:e=>{e&&eg&&ea({...H,query:{...H.query},body:{excluded_resource_urns:q(ef).map(e=>e.toString())}})},menu:{items:[...O.map(e=>({key:e,label:!es&&(null==eI?void 0:eI.includes(e))?j[e]:(0,o.jsx)(s.esZ,{title:R[e],children:j[e]}),disabled:es||!(null==eI?void 0:eI.includes(e)),onClick:()=>{eg?ed[e](H,ef.map(e=>e.itemKey.toString()),ej):ep[e](ev.map(e=>{let{itemKey:t}=e;return t.toString()}))}}))]},disabled:ev.length<=0,children:(0,o.jsx)(s.wpx,{type:"primary",icon:(0,o.jsx)(s.PJP._ME,{}),iconPosition:"end",loading:es,children:"Actions"})}),(0,o.jsx)(s.esZ,{title:"Refresh",children:(0,o.jsx)(s.wpx,{icon:(0,o.jsx)(s.PJP.CQM,{}),onClick:()=>Q(),"aria-label":"Refresh"})})]})]}),(0,o.jsxs)(s.jqI,{gap:"middle",align:"center",children:[(0,o.jsx)(s.E_O,{id:"select-all",checked:eg,indeterminate:eh,onChange:e=>e_(e.target.checked?"exclusive":"inclusive")}),(0,o.jsx)("label",{htmlFor:"select-all",children:"Select all"}),!!ej&&(0,o.jsxs)(s.lKn,{strong:!0,children:[ej.toLocaleString()," selected"]})]}),(0,o.jsx)(s.krs,{dataSource:null==Z?void 0:Z.items,className:"-ml-3 h-full overflow-y-scroll pl-1",loading:B,enableKeyboardShortcuts:!0,onActiveItemChange:(0,u.useCallback)(e=>{(null==e?void 0:e.urn)?(er({...e,itemKey:e.urn}),X&&e.urn!==X&&ee(e.urn)):er(void 0)},[X]),renderItem:e=>eA({...e,selected:q(ev).includes(e.urn),onSelect:eS,onNavigate:eb,onSetDataCategories:(e,t)=>ep["assign-categories"]([e],{user_assigned_data_categories:t}),dataCategoriesDisabled:null==e||!e.diff_status||!D["assign-categories"].some(t=>t===e.diff_status),actions:(null==e?void 0:e.diff_status)?k.map(t=>(0,o.jsx)(s.esZ,{title:j[t],children:(0,o.jsx)(s.wpx,{"aria-label":j[t],icon:P[t],onClick:()=>ep[t]([e.urn]),disabled:null==e||!e.diff_status||!D[t].some(t=>t===e.diff_status),style:{fontSize:"var(--ant-button-content-font-size-lg)"}})},t)):[]})}),(0,o.jsx)(s.B7X,{...E,showSizeChanger:{suffixIcon:(0,o.jsx)(s.PJP._ME,{})},total:(null==Z?void 0:Z.total)||0,hideOnSinglePage:(null===(e=E.pageSize)||void 0===e?void 0:e.toString())===(null===(t=E.pageSizeOptions)||void 0===t?void 0:t[0])})]})})]}),(0,o.jsx)(eF,{itemKey:null!==(n=null==ec?void 0:ec.urn)&&void 0!==n?n:"",title:null!==(l=null==ec?void 0:ec.name)&&void 0!==l?l:null,titleIcon:(0,o.jsx)(s.PJP.sgG,{}),titleTag:{bordered:!1,color:(null==ec?void 0:ec.diff_status)?ei[ec.diff_status].color:void 0,className:"font-normal text-[var(--ant-font-size-sm)]",children:(null==ec?void 0:ec.diff_status)?ei[ec.diff_status].label:null},actions:C.map(e=>({label:j[e],callback:t=>ep[e]([t]),disabled:null==ec||!ec.diff_status||!D[e].some(e=>e===ec.diff_status)})),open:!!X,onClose:()=>ee(void 0),resource:ec,fieldActions:ep}),(0,o.jsx)(V,{open:b,onCancel:()=>I(!1)}),A,_]})};let e0=()=>(0,o.jsx)(o.Fragment,{children:"Attempting to access monitor results without the required feature flag enabled"});var e1=()=>{let{flags:e}=(0,c.hz)();return e.heliosV2?(0,o.jsx)(eX,{}):(0,o.jsx)(s.ux6,{status:"error",title:(0,o.jsx)(e0,{})})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},97947:function(e){e.exports={"monitor-field__title":"MonitorFieldListItem_monitor-field__title__YrxOU","monitor-field__breadcrumb":"MonitorFieldListItem_monitor-field__breadcrumb__Rn4vE"}}},function(e){e.O(0,[431,7245,7059,9341,2888,9774,179],function(){return e(e.s=83806)}),_N_E=e.O()}]);
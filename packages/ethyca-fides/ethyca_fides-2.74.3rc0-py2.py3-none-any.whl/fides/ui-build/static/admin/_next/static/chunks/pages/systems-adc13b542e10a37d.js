(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3785],{58095:function(e,t,n){var s=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&s(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var s=-1,l=null==e?0:e.length;++s<l;)if(n(t,e[s]))return!0;return!1}},8817:function(e,t,n){var s=n(95372),l=n(1129),a=n(58263);e.exports=function(e,t,n){return t==t?a(e,t,n):s(e,l,n)}},1129:function(e){e.exports=function(e){return e!=e}},74833:function(e,t,n){var s=n(56127),l=/^\s+/;e.exports=function(e){return e?e.slice(0,s(e)+1).replace(l,""):e}},92198:function(e,t,n){var s=n(52485),l=n(58095),a=n(21796),r=n(65581),i=n(47111),o=n(43735);e.exports=function(e,t,n){var d=-1,u=l,c=e.length,p=!0,m=[],h=m;if(n)p=!1,u=a;else if(c>=200){var f=t?null:i(e);if(f)return o(f);p=!1,u=r,h=new s}else h=t?[]:m;e:for(;++d<c;){var g=e[d],v=t?t(g):g;if(g=n||0!==g?g:0,p&&v==v){for(var x=h.length;x--;)if(h[x]===v)continue e;t&&h.push(v),m.push(g)}else u(h,v,n)||(h!==m&&h.push(v),m.push(g))}return m}},47111:function(e,t,n){var s=n(46151),l=n(50344),a=n(43735),r=s&&1/a(new s([,-0]))[1]==1/0?function(e){return new s(e)}:l;e.exports=r},58263:function(e){e.exports=function(e,t,n){for(var s=n-1,l=e.length;++s<l;)if(e[s]===t)return s;return -1}},56127:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},66726:function(e,t,n){var s=n(11611),l=n(82846),a=n(91936),r=Math.max,i=Math.min;e.exports=function(e,t,n){var o,d,u,c,p,m,h=0,f=!1,g=!1,v=!0;if("function"!=typeof e)throw TypeError("Expected a function");function x(t){var n=o,s=d;return o=d=void 0,h=t,c=e.apply(s,n)}function y(e){var n=e-m,s=e-h;return void 0===m||n>=t||n<0||g&&s>=u}function j(){var e,n,s,a=l();if(y(a))return b(a);p=setTimeout(j,(e=a-m,n=a-h,s=t-e,g?i(s,u-n):s))}function b(e){return(p=void 0,v&&o)?x(e):(o=d=void 0,c)}function k(){var e,n=l(),s=y(n);if(o=arguments,d=this,m=n,s){if(void 0===p)return h=e=m,p=setTimeout(j,t),f?x(e):c;if(g)return clearTimeout(p),p=setTimeout(j,t),x(m)}return void 0===p&&(p=setTimeout(j,t)),c}return t=a(t)||0,s(n)&&(f=!!n.leading,u=(g="maxWait"in n)?r(a(n.maxWait)||0,t):u,v="trailing"in n?!!n.trailing:v),k.cancel=function(){void 0!==p&&clearTimeout(p),h=0,o=m=d=p=void 0},k.flush=function(){return void 0===p?c:b(l())},k}},56141:function(e,t,n){var s=n(32866);e.exports=function(e,t){return s(e,t)}},50344:function(e){e.exports=function(){}},82846:function(e,t,n){var s=n(77400);e.exports=function(){return s.Date.now()}},91936:function(e,t,n){var s=n(74833),l=n(11611),a=n(55193),r=0/0,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,d=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return r;if(l(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=l(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var n=o.test(e);return n||d.test(e)?u(e.slice(2),n?2:8):i.test(e)?r:+e}},83766:function(e,t,n){var s=n(92198);e.exports=function(e){return e&&e.length?s(e):[]}},90988:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/systems",function(){return n(74233)}])},30952:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var s=n(24246),l=n(66726),a=n.n(l),r=n(27378),i=n(26917);let o=e=>{let{value:t,onChange:n,placeholder:l,...o}=e,[d,u]=(0,r.useState)(t);(0,r.useEffect)(()=>{u(t||"")},[t]);let c=a()(n,500),p=(0,r.useCallback)(e=>{u(e),c(e)},[]);return(0,s.jsx)(i.Z,{value:d,onChange:p,onClear:()=>{u(""),n("")},placeholder:l,...o})}},35287:function(e,t,n){"use strict";var s=n(24246),l=n(98227),a=n(88038),r=n.n(a);n(27378),t.Z=e=>{let{children:t,title:n,fullHeight:a,fullWidth:i,mainProps:o}=e;return(0,s.jsxs)(l.kCb,{"data-testid":n,direction:"column",height:a?"100vh":"calc(100vh - 48px)",width:i?"100vw":"calc(100vw - 240px)",children:[(0,s.jsxs)(r(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)(l.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...o,children:t})]})}},58754:function(e,t,n){"use strict";var s=n(24246),l=n(98227),a=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:r=!0,children:i,rightContent:o,style:d,...u}=e;return(0,s.jsxs)("div",{...u,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,s.jsxs)(l.jqI,{justify:"space-between",children:["string"==typeof t?(0,s.jsx)(l.lQT,{className:n||i?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,s.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!n&&(0,s.jsx)(a.m,{className:i?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),i]})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return r}});var s=n(24246),l=n(16134),a=n(31793);let r=e=>(0,l.C)(a.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return r(t)?(0,s.jsx)(s.Fragment,{children:n}):null}},97181:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var s=n(24246),l=n(98227),a=n(34090),r=n(27378),i=n(46238),o=n(40324);let d=e=>{let{name:t,label:n,labelProps:d,tooltip:u,isRequired:c,layout:p="inline",helperText:m,...h}=e,[f,g,{setValue:v}]=(0,a.U$)(t),x=!!(g.touched&&g.error),[y,j]=(0,r.useState)("");f.value||"tags"!==h.mode&&"multiple"!==h.mode||(f.value=[]),"tags"===h.mode&&"string"==typeof f.value&&(f.value=[f.value]);let b="tags"===h.mode?(e,t)=>e?e.value!==y||f.value.includes(y)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(y,'"'):void 0:h.optionRender||void 0,k=e=>{j(e),h.onSearch&&h.onSearch(e)},_=(e,t)=>{v(e),h.onChange&&h.onChange(e,t)};return"inline"===p?(0,s.jsx)(l.NIc,{isInvalid:x,isRequired:c,children:(0,s.jsxs)(l.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,s.jsx)(o.__,{htmlFor:h.id||t,...d,children:n}):null,(0,s.jsxs)(l.jqI,{align:"center",children:[(0,s.jsxs)(l.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,s.jsx)(l.WPr,{...f,id:h.id||t,"data-testid":"controlled-select-".concat(f.name),...h,optionRender:b,onSearch:"tags"===h.mode?k:void 0,onChange:_,value:f.value||void 0,status:x?"error":void 0}),m&&(0,s.jsx)(l.Q6r,{children:m}),(0,s.jsx)(o.Bc,{isInvalid:x,message:g.error,fieldName:f.name})]}),(0,s.jsx)(i.b,{label:u,className:x?"mt-2 self-start":void 0})]})]})}):(0,s.jsx)(l.NIc,{isInvalid:x,isRequired:c,children:(0,s.jsxs)(l.gCW,{alignItems:"start",children:[(0,s.jsxs)(l.jqI,{align:"center",children:[n?(0,s.jsx)(o.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:n}):null,(0,s.jsx)(i.b,{label:u})]}),(0,s.jsx)(l.WPr,{...f,id:h.id||t,"data-testid":"controlled-select-".concat(f.name),...h,optionRender:b,onSearch:"tags"===h.mode?k:void 0,onChange:_,value:f.value||void 0,status:x?"error":void 0}),m&&(0,s.jsx)(l.Q6r,{style:{marginTop:0},children:m}),(0,s.jsx)(o.Bc,{isInvalid:x,message:g.error,fieldName:f.name})]})})}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var s=n(24246),l=n(98227),a=n(79894),r=n.n(a),i=n(27378);let{Text:o}=l.AntTypography,d=e=>{let{items:t,...n}=e,a=(0,i.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let a=n===t.length-1,i={...e},d=i.onClick&&!i.href;return("string"==typeof i.title&&(i.title=(0,s.jsx)(o,{style:{color:"inherit",maxWidth:a?void 0:400},ellipsis:!a,id:a?"breadcrumb-current-page":void 0,children:i.title})),d)?i.title=(0,s.jsx)(l.wpx,{type:"text",size:"small",icon:i.icon,onClick:i.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:i.title}):(i.icon&&(i.title=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"anticon align-text-bottom",children:i.icon}),i.title]})),i.href&&i.title&&(i.title=(0,s.jsx)(r(),{href:i.href,className:"ant-breadcrumb-link",children:i.title}),delete i.href)),i}),[t]);return(0,s.jsx)(l.zrq,{items:a,...n})}},33335:function(e,t,n){"use strict";n.d(t,{E:function(){return s}});let s=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},22583:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var s=n(98227),l=n(65735);let a={[l.Ej.TAXONOMY_WHITE]:s.tAb.DEFAULT,[l.Ej.TAXONOMY_RED]:s.tAb.ERROR,[l.Ej.TAXONOMY_ORANGE]:s.tAb.WARNING,[l.Ej.TAXONOMY_YELLOW]:s.tAb.CAUTION,[l.Ej.TAXONOMY_GREEN]:s.tAb.SUCCESS,[l.Ej.TAXONOMY_BLUE]:s.tAb.INFO,[l.Ej.TAXONOMY_PURPLE]:s.tAb.ALERT,[l.Ej.SANDSTONE]:s.tAb.SANDSTONE,[l.Ej.MINOS]:s.tAb.MINOS}},92818:function(e,t,n){"use strict";n.d(t,{r:function(){return o}});var s=n(24246),l=n(27378),a=n(97181),r=n(22583),i=n(65735);let o={[i.Ej.TAXONOMY_WHITE]:"White",[i.Ej.TAXONOMY_RED]:"Red",[i.Ej.TAXONOMY_ORANGE]:"Orange",[i.Ej.TAXONOMY_YELLOW]:"Yellow",[i.Ej.TAXONOMY_GREEN]:"Green",[i.Ej.TAXONOMY_BLUE]:"Blue",[i.Ej.TAXONOMY_PURPLE]:"Purple",[i.Ej.SANDSTONE]:"Sandstone",[i.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...n}=e;return(0,s.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(r.j[t],")"),border:t===i.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})},u=e=>{let t=null==e?void 0:e.value,n=null==e?void 0:e.label;return(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(d,{color:t}),(0,s.jsx)("span",{children:n})]})};t.Z=e=>{let t=Object.values(i.Ej).map(e=>({value:e,label:o[e]})),[n,r]=(0,l.useState)(void 0);return(0,s.jsx)(a.d,{...e,options:t,optionRender:u,layout:"stacked",value:n,onChange:e=>{r(e)},prefix:(0,s.jsx)(d,{color:null!=n?n:i.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},74233:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var s=n(24246),l=n(98227),a=n(27378),r=n(35287),i=n(58754),o=n(86677),d=n(25980),u=n(77830),c=()=>{let{dictionaryService:e}=(0,d.hz)(),t=(0,o.useRouter)();return(0,s.jsxs)(l.jqI,{className:"absolute right-8 top-8",children:[e&&(0,s.jsx)(l.S0p,{trigger:["click"],menu:{items:[{label:"Create new system",key:"add-system",onClick:()=>t.push(u.N5)},{label:"Add multiple systems",key:"add-multiple-systems",onClick:()=>t.push(u.bJ)}]},children:(0,s.jsx)(l.wpx,{type:"primary","data-testid":"add-system-btn",icon:(0,s.jsx)(l.PJP._ME,{}),children:"Add system"})}),!e&&(0,s.jsx)(l.wpx,{type:"primary","data-testid":"add-system-btn",onClick:()=>t.push(u.N5),children:"Add new system"})]})},p=n(30952),m=n(812),h=n(65450),f=n(34090),g=n(83766),v=n.n(g),x=n(55484),y=n(97181),j=n(40324),b=n(28079),k=n(1315),_=n(92818);let E="all-suggested";var S=e=>{let{options:t,loading:n,name:r,suggestedDataUses:i,...o}=e,[d,u,{setValue:c}]=(0,f.U$)(r),p=!!(u.touched&&u.error),m=(0,a.useMemo)(()=>{let e=[],n=[];return null==t||t.forEach(t=>{i.includes(t.value)?e.push(t):n.push(t)}),{suggested:e,all:n}},[t,i]),h=m.suggested.length?[{label:"Select all suggested",value:E},{label:(0,s.jsxs)(l.vyj,{children:[(0,s.jsx)(l.QMR,{size:14}),(0,s.jsx)("span",{children:"Suggested data uses"})]}),value:"suggested",options:m.suggested},{label:(0,s.jsxs)(l.vyj,{children:[(0,s.jsx)(l.PJP.BBB,{}),(0,s.jsx)("span",{children:"All data uses"})]}),value:"all",options:m.all}]:m.all;return(0,s.jsxs)(l.jqI,{vertical:!0,gap:"small",children:[(0,s.jsx)(l.jqI,{align:"center",children:(0,s.jsx)(j.__,{htmlFor:o.id||r,fontSize:"xs",my:0,mr:1,children:"Data uses"})}),(0,s.jsx)(l.WPr,{options:h,mode:"multiple",placeholder:"Select data uses",allowClear:!0,loading:n,value:d.value,onChange:e=>{e.includes(E)?c(v()([...i,...e.filter(e=>e!==E)])):c(e)},status:p?"error":void 0,virtual:!1,...o}),(0,s.jsx)(j.Bc,{isInvalid:p,message:u.error,fieldName:d.name})]})},N=n(65735);let C=x.Ry().shape({name:x.Z_().required("Name is required").label("Name"),label_color:x.Z_().required("Color is required").label("Color"),systems:x.IX().of(x.Z_()).label("Systems"),data_uses:x.IX().of(x.Z_()).label("Data uses")});var T=e=>{let{selectedSystemKeys:t=[],onSubmit:n,onCancel:r,isSubmitting:i=!1}=e,{data:o=[],isLoading:d}=(0,b.fd)(),{data:u,isLoading:c}=(0,k.K3)(),p=(0,a.useMemo)(()=>o.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[o]),m=(0,a.useMemo)(()=>{var e;let n=null!==(e=null==u?void 0:u.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return v()(null==n?void 0:n.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[u,t]),h=(0,a.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[u]),g={name:"",description:"",label_color:N.Ej.TAXONOMY_WHITE,systems:t,data_uses:[],active:!0};return(0,s.jsx)(f.J9,{initialValues:g,validationSchema:C,onSubmit:n,enableReinitialize:!0,children:e=>{let{isValid:t,dirty:n}=e;return(0,s.jsx)(f.l0,{children:(0,s.jsxs)(l.jqI,{vertical:!0,gap:"middle",children:[(0,s.jsx)(l.AntTypography.Title,{level:2,children:"Create system group"}),(0,s.jsx)(j.j0,{name:"name",label:"Name",isRequired:!0,variant:"stacked",placeholder:"Enter system group name"}),(0,s.jsx)(j.Ks,{name:"description",label:"Description",variant:"stacked",placeholder:"Enter system group description",resize:!1}),(0,s.jsx)(y.d,{name:"systems",label:"Systems",mode:"multiple",placeholder:"Select systems",options:h,layout:"stacked",allowClear:!0,loading:c}),(0,s.jsx)(_.Z,{name:"label_color",label:"Color"}),(0,s.jsx)(S,{name:"data_uses",options:p,loading:d,suggestedDataUses:m}),(0,s.jsxs)(l.jqI,{gap:"small",justify:"space-between",className:"pt-4",children:[(0,s.jsx)(l.wpx,{onClick:r,disabled:i,children:"Cancel"}),(0,s.jsx)(l.wpx,{type:"primary",htmlType:"submit",loading:i,disabled:!t||!n||i,"data-testid":"save-btn",children:"Create group"})]})]})})}})},w=n(31793),A=n(31883),O=e=>{let{selectedRowKeys:t,createModalIsOpen:n,setCreateModalIsOpen:r,handleCreateSystemGroup:i,handleBulkAddToGroup:o,groupMenuItems:u}=e,[c,p]=l.Pg3.useMessage(),[f,g]=(0,a.useState)(!1),[v]=(0,h.WP)(),{plus:x}=(0,d.hz)(),{data:y}=(0,w.wv)({page:1,size:100,include_external:!1}),[j]=(0,h.C9)(),b=(0,a.useCallback)(async e=>{let n=await v({data_steward:e,system_keys:t});(0,A.D4)(n)?c.error((0,m.e$)(n.error,"A problem occurred assigning stewards")):c.success("".concat(t.length," systems assigned to ").concat(e," successfully"))},[v,t,c]),k=async()=>{let e=await j(t);(0,A.D4)(e)?c.error((0,m.e$)(e.error,"A problem occurred deleting systems")):c.success("".concat(t.length," systems deleted successfully"))},_=(0,a.useMemo)(()=>{let e=[];return u.length&&x&&e.push(t.length?{key:"add-to-system-group",label:"Add to system group",children:[{key:"new-group",label:"Create new group +",onClick:()=>r(!0)},{type:"divider"},...u.map(e=>({key:e.key,label:e.label,onClick:()=>o(e.key)}))]}:{key:"new-group",label:"Create system group +",onClick:()=>r(!0)}),(null==y?void 0:y.items.length)&&e.push({key:"assign-data-steward",label:"Assign data steward",disabled:!t.length,children:y.items.map(e=>({key:e.username,label:e.username,onClick:()=>b(e.username)}))},{type:"divider"}),e.push({key:"delete",label:"Delete",disabled:!t.length,onClick:()=>{g(!0)}}),e},[u,x,null==y?void 0:y.items,t.length,r,o,b]);return(0,s.jsxs)(s.Fragment,{children:[p,(0,s.jsx)(l.$zI,{open:f,onCancel:()=>g(!1),onOk:k,okText:"Delete",okType:"danger",centered:!0,children:(0,s.jsxs)(l.AntTypography.Paragraph,{children:["Delete ",t.length," systems? This action cannot be undone."]})}),(0,s.jsx)(l.$zI,{open:n,destroyOnHidden:!0,onCancel:()=>r(!1),centered:!0,width:768,footer:null,children:(0,s.jsx)(T,{selectedSystemKeys:t.map(e=>e.toString()),onSubmit:i,onCancel:()=>r(!1)})}),(0,s.jsx)(l.S0p,{trigger:["click"],menu:{items:_},children:(0,s.jsx)(l.wpx,{icon:(0,s.jsx)(l.PJP._ME,{}),children:"Actions"})})]})},I=n(19904),M=n(26070),P=n(3110),D=n(99640),R=n(8125),z=n(16394),W=n(33335),q=n(69353),X=n(88832),Y=n(34929),Z=e=>{let{privacyDeclarations:t,...n}=e,{getDataUseDisplayName:l}=(0,Y.Z)(),a=t.map(e=>e.data_use).map(e=>({label:l(e),key:e}));return(0,s.jsx)(M.Q,{values:a,...n})},B=n(56141),L=n.n(B),F=n(22583);let U="update-system-groups-msg";var $=e=>{let{selectedGroups:t,allGroups:n,system:r,columnState:i,...o}=e,[d,u]=(0,a.useState)(!1),[c,p]=(0,a.useState)(t.map(e=>e.fides_key)),[h,f]=l.Pg3.useMessage(),[g]=(0,k.qQ)(),v=async()=>{if(u(!1),L()(c,t.map(e=>e.fides_key)))return;h.open({key:U,type:"loading",content:"Updating groups for ".concat(r.name,"...")});let e=await g({...r,system_groups:c});(0,A.D4)(e)?h.open({key:U,type:"error",content:(0,m.e$)(e.error,"Failed to update system groups")}):h.open({key:U,type:"success",content:"Groups updated for ".concat(r.name)}),setTimeout(()=>{h.destroy(U)},3e3)};return(0,s.jsxs)(l.jqI,{gap:"small",...o,children:[f,!d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.j8w,{onClick:()=>u(!0),addable:!0,"data-testid":"group-add-btn","aria-label":"Add group"}),(0,s.jsx)(M.Q,{values:t.map(e=>e&&{label:e.name,key:e.fides_key,tagProps:{color:e.label_color?"".concat(F.j[e.label_color]):void 0,bordered:!1}}),columnState:i})]}),d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.WPr,{options:n.map(e=>({label:e.name,value:e.fides_key})),mode:"tags",defaultValue:t.map(e=>e.fides_key),defaultOpen:!0,onChange:e=>{p(e)},onOpenChange:e=>{e||v()},onBlur:()=>u(!1),"aria-label":"Select groups"}),(0,s.jsx)(l.wpx,{"aria-label":"Update groups",icon:(0,s.jsx)(l.PJP.MCw,{}),onClick:v})]})]})},G=()=>{let{data:e}=(0,q.QD)(),t=(0,a.useMemo)(()=>e?e.reduce((e,t)=>({...e,[t.fides_key]:t}),{}):{},[e]),{data:n}=(0,w.wv)({page:1,size:100,include_external:!1}),[r]=(0,h.DW)(),[i]=(0,q.Xz)(),[u]=(0,q.Nr)(),[c,p]=(0,a.useState)(!1),[f,g]=(0,a.useState)(!1),[x,y]=(0,a.useState)(!1),[j,b]=(0,a.useState)(!1),[k,_]=(0,a.useState)(null),E=(0,R.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},search:{defaultSearchQuery:""},sorting:{defaultSortKey:X.E.NAME,defaultSortOrder:"ascend",validColumns:[X.E.NAME]}}),{columnFilters:S,pageIndex:C,pageSize:T,searchQuery:O,updateSearch:Y,sortKey:B,sortOrder:L}=E,{data:F,isLoading:U,isFetching:G}=(0,h.xF)({page:C,size:T,search:O,sort_by:B,sort_asc:"ascend"===L,show_deleted:!0,...S}),Q=(0,a.useMemo)(()=>{var e,t;return{enableSelection:!0,dataSource:null!==(e=null==F?void 0:F.items)&&void 0!==e?e:[],totalRows:null!==(t=null==F?void 0:F.total)&&void 0!==t?t:0,isLoading:U,isFetching:G,getRowKey:e=>e.fides_key,customTableProps:{locale:{emptyText:(0,s.jsx)("div",{children:"No systems found"})}}}},[F,U,G]),{tableProps:J,selectionProps:H}=(0,R.V)(E,Q),{selectedRowKeys:K}=null!=H?H:{},[V,ee]=l.Pg3.useMessage(),{plus:et}=(0,d.hz)(),en=(0,o.useRouter)(),es=(0,I.Tg)([N.Sh.SYSTEM_DELETE]),el=async e=>{let t=await r(e.fides_key);(0,A.D4)(t)?V.error((0,m.e$)(t.error,"Failed to delete system")):V.success("Successfully deleted system"),b(!1)},ea=async e=>{let t={...e,fides_key:(0,W.E)(e.name),active:!0},n=await u(t);if((0,A.D4)(n))V.error((0,m.e$)(n.error));else{var s,l;let e="System group '".concat(n.data.name,"' created");(null===(s=n.data.systems)||void 0===s?void 0:s.length)===1?e+=" with system '".concat(n.data.systems[0],"'"):(null===(l=n.data.systems)||void 0===l?void 0:l.length)&&(e+=" with ".concat(n.data.systems.length," systems")),V.success(e)}y(!1)},er=(0,a.useCallback)(async e=>{var n;if(!K)return;let s=t[e],l=await i({...s,systems:v()([...null!==(n=s.systems)&&void 0!==n?n:[],...K.map(e=>e.toString())])});(0,A.D4)(l)?V.error((0,m.e$)(l.error)):V.success("".concat(null==K?void 0:K.length," systems added to group '").concat(e,"'"))},[t,i,K,V]),ei=(0,a.useMemo)(()=>{var t;return null!==(t=null==e?void 0:e.map(e=>({key:e.fides_key,label:e.name,onClick:()=>er(e.fides_key)})))&&void 0!==t?t:[]},[e,er]);return{tableProps:J,selectionProps:H,columns:(0,a.useMemo)(()=>{var a;return[{title:"Name",dataIndex:"name",key:X.E.NAME,render:(e,t)=>(0,s.jsx)(D.Z,{href:"/systems/configure/".concat(t.fides_key),"data-testid":"system-link-".concat(t.fides_key),children:e||t.fides_key}),ellipsis:!0,fixed:"left",sorter:!0,sortOrder:B===X.E.NAME?L:null},{dataIndex:"system_groups",key:X.E.SYSTEM_GROUPS,render:(n,l)=>{var a;return(0,s.jsx)($,{selectedGroups:null!==(a=null==n?void 0:n.map(e=>null==t?void 0:t[e]).filter(e=>!!e))&&void 0!==a?a:[],allGroups:e,system:{...l,system_groups:null!=n?n:[]},columnState:{isWrapped:!0,isExpanded:c},className:"w-[432px]"})},title:"Groups",hidden:!et,menu:{items:P.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?p(!0):"collapse-all"===e.key&&p(!1)}},filters:(0,z.nZ)(null==e?void 0:e.map(e=>e.fides_key),e=>{var n,s;return null!==(s=null===(n=t[e])||void 0===n?void 0:n.name)&&void 0!==s?s:e}),filteredValue:(null==S?void 0:S.system_groups)||null},{title:"Data uses",menu:{items:P.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?g(!0):"collapse-all"===e.key&&g(!1)}},dataIndex:"privacy_declarations",key:X.E.DATA_USES,render:e=>(0,s.jsx)(Z,{privacyDeclarations:e,columnState:{isWrapped:!0,isExpanded:f}})},{title:"Data stewards",dataIndex:"data_stewards",key:X.E.DATA_STEWARDS,render:e=>(0,s.jsx)(M.v,{values:null!=e?e:[],valueSuffix:"users"}),filters:(0,z.nZ)(null==n?void 0:null===(a=n.items)||void 0===a?void 0:a.map(e=>e.username)),filteredValue:(null==S?void 0:S.data_stewards)||null},{title:"Description",dataIndex:"description",key:X.E.DESCRIPTION,render:e=>(0,s.jsx)("div",{className:"max-w-96",children:(0,s.jsx)(l.AntTypography.Text,{ellipsis:{tooltip:e},children:e})}),ellipsis:!0},{title:"Actions",key:X.E.ACTIONS,render:(e,t)=>(0,s.jsxs)(l.jqI,{gap:"small",children:[(0,s.jsx)(l.wpx,{size:"small",onClick:()=>en.push("/systems/configure/".concat(t.fides_key)),icon:(0,s.jsx)(l.PJP.I8b,{}),"data-testid":"edit-btn",children:"Edit"}),es&&(0,s.jsx)(l.wpx,{size:"small",onClick:()=>{_(t),b(!0)},icon:(0,s.jsx)(l.PJP.ZNm,{}),"data-testid":"delete-btn",children:"Delete"})]}),fixed:"right"}]},[B,L,et,e,null==S?void 0:S.system_groups,null==S?void 0:S.data_stewards,null==n?void 0:n.items,c,t,f,es,en]),searchQuery:O,updateSearch:Y,columnFilters:S,pageIndex:C,pageSize:T,createModalIsOpen:x,setCreateModalIsOpen:y,deleteModalIsOpen:j,setDeleteModalIsOpen:b,setSelectedSystemForDelete:_,handleCreateSystemGroup:ea,handleDelete:el,handleBulkAddToGroup:er,messageContext:ee,groupMenuItems:ei,selectedSystemForDelete:k}},Q=()=>{var e,t;let{tableProps:n,selectionProps:a,columns:r,searchQuery:i,updateSearch:o,createModalIsOpen:d,setCreateModalIsOpen:u,deleteModalIsOpen:c,setDeleteModalIsOpen:m,handleDelete:h,handleCreateSystemGroup:f,handleBulkAddToGroup:g,messageContext:v,groupMenuItems:x,selectedSystemForDelete:y}=G();return(0,s.jsxs)(s.Fragment,{children:[v,(0,s.jsxs)(l.jqI,{justify:"space-between",className:"mb-4",children:[(0,s.jsx)(p.f,{value:i,onChange:o,"data-testid":"system-search"}),(0,s.jsxs)(l.jqI,{gap:"small",children:[(0,s.jsx)(O,{selectedRowKeys:null!==(e=null==a?void 0:a.selectedRowKeys)&&void 0!==e?e:[],createModalIsOpen:d,setCreateModalIsOpen:u,handleCreateSystemGroup:f,handleBulkAddToGroup:g,groupMenuItems:x}),(0,s.jsx)(l.$zI,{open:c,onCancel:()=>m(!1),onOk:()=>!!y&&h(y),okText:"Delete",okType:"danger",cancelText:"Cancel",centered:!0,children:(0,s.jsxs)(l.AntTypography.Paragraph,{children:["Are you sure you want to delete"," ",null!==(t=null==y?void 0:y.name)&&void 0!==t?t:null==y?void 0:y.fides_key,"? This action cannot be undone."]})})]})]}),(0,s.jsx)(l.V5H,{...n,columns:r,rowSelection:a})]})},J=()=>(0,s.jsx)(r.Z,{title:"System inventory",children:(0,s.jsxs)(l.xuv,{"data-testid":"system-management",children:[(0,s.jsx)(i.Z,{heading:"System inventory",breadcrumbItems:[{title:"All systems"}],rightContent:(0,s.jsx)(c,{})}),(0,s.jsx)(Q,{})]})})},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return s.Bw},D4:function(){return s.D4}});var s=n(19043)}},function(e){e.O(0,[431,7245,9965,2888,9774,179],function(){return e(e.s=90988)}),_N_E=e.O()}]);
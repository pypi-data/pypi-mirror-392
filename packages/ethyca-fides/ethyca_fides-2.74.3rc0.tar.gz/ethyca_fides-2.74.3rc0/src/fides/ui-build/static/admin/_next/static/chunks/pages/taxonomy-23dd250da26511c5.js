(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4202],{75733:function(e){e.exports=function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(r);++i<r;)a[i]=e[i+t];return a}},70830:function(e,t,n){var i=n(76747),r=n(31159),a=n(64373),s=n(37948);e.exports=function(e,t){return t=i(t,e),null==(e=a(e,t))||delete e[s(r(t))]}},64373:function(e,t,n){var i=n(79867),r=n(75733);e.exports=function(e,t){return t.length<2?e:i(e,r(t,0,-1))}},43551:function(e,t,n){var i=n(70830);e.exports=function(e,t){return null==e||i(e,t)}},71180:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/taxonomy",function(){return n(65847)}])},79806:function(e,t,n){"use strict";n.d(t,{Gn:function(){return l},zR:function(){return s}});var i=n(24246),r=n(98227),a=n(56358);let s=e=>{let{title:t}=e;return(0,i.jsx)(r.OXI,{py:0,display:"flex",alignItems:"flex-start",children:(0,i.jsx)(r.xvT,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},l=e=>{let{onDelete:t,onEditYaml:n,formId:s,isSaving:l}=e;return(0,i.jsxs)(r.zeN,{justifyContent:"space-between",children:[t?(0,i.jsx)(r.wpx,{"aria-label":"delete",icon:(0,i.jsx)(a.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,i.jsxs)("div",{className:"flex gap-2",children:[n&&(0,i.jsx)(r.wpx,{onClick:n,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,i.jsx)(r.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:s,loading:l,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:n,isOpen:a,onClose:s,children:l,footer:o}=e;return(0,i.jsxs)(r.dys,{placement:"right",isOpen:a,onClose:s,size:"md",children:[(0,i.jsx)(r.P1B,{}),(0,i.jsxs)(r.scA,{"data-testid":"edit-drawer-content",py:2,children:[(0,i.jsxs)(r.xuv,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,i.jsx)(r.xuv,{flex:1,minH:8,children:t}),(0,i.jsx)(r.xuv,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,i.jsx)(r.wpx,{"aria-label":"Close editor",onClick:s,"data-testid":"close-drawer-btn",icon:(0,i.jsx)(r.Two,{fontSize:"smaller"})})})]}),(0,i.jsxs)(r.Ng0,{pt:1,children:[n?(0,i.jsx)(r.xvT,{fontSize:"sm",mb:4,color:"gray.600",children:n}):null,l]}),o]})]})}},18225:function(e,t,n){"use strict";var i=n(24246),r=n(98227);t.Z=e=>{let{alignment:t="center",...n}=e;return(0,i.jsx)(r.kCb,{boxSize:"full",align:"center",justify:t,children:(0,i.jsx)(r.$jN,{color:"primary",...n})})}},56358:function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var i=n(24246);let r=(0,n(98227).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,i.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},77213:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var i=n(24246),r=n(98227),a=n(88038),s=n.n(a),l=n(86677);n(27378);var o=n(25980),d=n(90867),u=n(42478),c=n(77830),m=()=>{let e=(0,l.useRouter)();return(0,i.jsx)(r.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(r.xuv,{children:[(0,i.jsxs)(r.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(r.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(r.wpx,{onClick:()=>{e.push(c.AD)},children:"Configure"})]}),(0,i.jsxs)(r.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},f=e=>{let{children:t,title:n,padded:a=!0,mainProps:c}=e,f=(0,o.hz)(),h=(0,l.useRouter)(),p="/privacy-requests"===h.pathname||"/datastore-connection"===h.pathname,g=!(f.flags.messagingConfiguration&&p),{data:x}=(0,u.JE)(void 0,{skip:g}),{data:y}=(0,d.PW)(void 0,{skip:g}),v=f.flags.messagingConfiguration&&(!x||!y)&&p;return(0,i.jsxs)(r.kCb,{"data-testid":n,direction:"column",h:"100vh",children:[(0,i.jsxs)(s(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(r.kCb,{as:"main",direction:"column",py:a?6:0,px:a?10:0,h:a?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...c,children:[v?(0,i.jsx)(m,{}):null,t]})]})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return s}});var i=n(24246),r=n(16134),a=n(31793);let s=e=>(0,r.C)(a.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return s(t)?(0,i.jsx)(i.Fragment,{children:n}):null}},94799:function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var i=n(76649);let r=e=>(0,i.Ln)({id:"string"},e),a=e=>(null!=e?e:[]).filter(r)},30320:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var i=n(27378),r=n(25980),a=n(17245),s=n(32885),l=n(94799);let o=e=>{let{resourceFidesKey:t,resourceType:n}=e,{errorAlert:o}=(0,a.VY)(),{plus:d}=(0,r.hz)(),u=(0,i.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d||!n}),m=(0,s.VN)(n,{skip:!d||!n}),{data:f,isLoading:h,error:p,isError:g}=(0,s.PV)(null!=t?t:"",{skip:!n||""!==u&&!(d&&u)}),[x]=(0,s._D)(),y=c.isLoading||m.isLoading||h,v=(0,i.useMemo)(()=>new Map((0,l.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),j=(0,i.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),_=(0,i.useMemo)(()=>new Map((0,l.k)(j).map(e=>[e.id,e])),[j]),T=(0,i.useMemo)(()=>g&&(null==p?void 0:p.status)===404?new Map:new Map((0,l.k)(f).map(e=>[e.custom_field_definition_id,e])),[f,g,p]),C=(0,i.useMemo)(()=>{let e=[..._.keys()];return e.sort(),e},[_]),b=(0,i.useMemo)(()=>{let e={};return j&&T&&j.forEach(t=>{let n=T.get(t.id||"");n&&(t.allow_list_id&&"string[]"===t.field_type?e[n.custom_field_definition_id]=n.value:e[n.custom_field_definition_id]=n.value.toString())}),e},[j,T]),E=(0,i.useCallback)(async e=>{if(!d||!n)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!i)return;let{customFieldValues:r}=e;if(!r||0===Object.keys(r).length)return;let a=[],s=[];C.forEach(e=>{let t=T.get(e),n=r[e];void 0===n||""===n||Array.isArray(n)&&0===n.length?(null==t?void 0:t.id)&&s.push(t.id):a.push({custom_field_definition_id:e,resource_id:i,id:null==t?void 0:t.id,value:n})});try{await x({resource_type:n,resource_id:i,upsert:a,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,C,x,n]);return{customFieldValues:b,definitionIdToCustomField:T,idToAllowListWithOptions:v,idToCustomFieldDefinition:_,isEnabled:d,isLoading:y,sortedCustomFieldDefinitionIds:C,upsertCustomFields:E}}},33162:function(e,t,n){"use strict";n.d(t,{uc:function(){return c},mZ:function(){return u.m}});var i=n(24246),r=n(98227),a=n(34090),s=n(30234),l=n(65735),o=n(97181),d=n(40324),u=n(30320);let c=e=>{let{resourceFidesKey:t,resourceType:n}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:f,isLoading:h,sortedCustomFieldDefinitionIds:p}=(0,u.m)({resourceFidesKey:t,resourceType:n});return f&&0!==p.length?(0,i.jsx)(s.Z,{heading:"Custom fields",children:(0,i.jsx)(r.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,i.jsx)(r.kCb,{flexDir:"column",gap:"24px",children:h?(0,i.jsx)(r.M5Y,{children:(0,i.jsx)(r.$jN,{})}):p.length>0&&(0,i.jsx)(r.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:p.map(e=>{let t=m.get(e);if(!t)return null;let n="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===l.AL.STRING)return(0,i.jsx)(a.gN,{name:n,children:e=>{let{field:n}=e;return(0,i.jsx)(d.j0,{...n,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let r=c.get(t.allow_list_id);if(!r)return null;let{options:s}=r;return(0,i.jsx)(o.d,{name:n,allowClear:!0,mode:t.field_type!==l.AL.STRING?"multiple":void 0,label:t.name,options:s,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};n(94799)},97181:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var i=n(24246),r=n(98227),a=n(34090),s=n(27378),l=n(46238),o=n(40324);let d=e=>{let{name:t,label:n,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:f,...h}=e,[p,g,{setValue:x}]=(0,a.U$)(t),y=!!(g.touched&&g.error),[v,j]=(0,s.useState)("");p.value||"tags"!==h.mode&&"multiple"!==h.mode||(p.value=[]),"tags"===h.mode&&"string"==typeof p.value&&(p.value=[p.value]);let _="tags"===h.mode?(e,t)=>e?e.value!==v||p.value.includes(v)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(v,'"'):void 0:h.optionRender||void 0,T=e=>{j(e),h.onSearch&&h.onSearch(e)},C=(e,t)=>{x(e),h.onChange&&h.onChange(e,t)};return"inline"===m?(0,i.jsx)(r.NIc,{isInvalid:y,isRequired:c,children:(0,i.jsxs)(r.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,i.jsx)(o.__,{htmlFor:h.id||t,...d,children:n}):null,(0,i.jsxs)(r.jqI,{align:"center",children:[(0,i.jsxs)(r.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(r.WPr,{...p,id:h.id||t,"data-testid":"controlled-select-".concat(p.name),...h,optionRender:_,onSearch:"tags"===h.mode?T:void 0,onChange:C,value:p.value||void 0,status:y?"error":void 0}),f&&(0,i.jsx)(r.Q6r,{children:f}),(0,i.jsx)(o.Bc,{isInvalid:y,message:g.error,fieldName:p.name})]}),(0,i.jsx)(l.b,{label:u,className:y?"mt-2 self-start":void 0})]})]})}):(0,i.jsx)(r.NIc,{isInvalid:y,isRequired:c,children:(0,i.jsxs)(r.gCW,{alignItems:"start",children:[(0,i.jsxs)(r.jqI,{align:"center",children:[n?(0,i.jsx)(o.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:n}):null,(0,i.jsx)(l.b,{label:u})]}),(0,i.jsx)(r.WPr,{...p,id:h.id||t,"data-testid":"controlled-select-".concat(p.name),...h,optionRender:_,onSearch:"tags"===h.mode?T:void 0,onChange:C,value:p.value||void 0,status:y?"error":void 0}),f&&(0,i.jsx)(r.Q6r,{style:{marginTop:0},children:f}),(0,i.jsx)(o.Bc,{isInvalid:y,message:g.error,fieldName:p.name})]})})}},33335:function(e,t,n){"use strict";n.d(t,{E:function(){return i}});let i=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},42478:function(e,t,n){"use strict";n.d(t,{FU:function(){return d},JE:function(){return r},Ki:function(){return c},SU:function(){return m},W:function(){return f},h9:function(){return a},jc:function(){return i},qt:function(){return o},sn:function(){return u}});let{useGetEmailInviteStatusQuery:i,useGetActiveMessagingProviderQuery:r,useCreateMessagingConfigurationMutation:a,useCreateMessagingConfigurationSecretsMutation:s,useGetMessagingConfigurationDetailsQuery:l,useGetMessagingConfigurationsQuery:o,useGetMessagingConfigurationByKeyQuery:d,useUpdateMessagingConfigurationByKeyMutation:u,useUpdateMessagingConfigurationSecretsByKeyMutation:c,useCreateTestConnectionMessageMutation:m,useDeleteMessagingConfigurationByKeyMutation:f}=n(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,t,n,i)=>{let r=await i({url:"messaging/default/active"});return r.error&&404===r.error.status?{data:null}:r},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},30234:function(e,t,n){"use strict";var i=n(24246),r=n(98227);t.Z=e=>{let{heading:t,HeadingButton:n,children:a}=e;return(0,i.jsx)(r.Kqy,{spacing:4,children:(0,i.jsxs)(r.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(r.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(r.X6q,{as:"h3",size:"xs",children:t}),n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.LZC,{}),(0,i.jsx)(n,{})]}):null]}),(0,i.jsx)(r.Kqy,{spacing:4,px:6,py:6,children:a})]})})}},22583:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var i=n(98227),r=n(65735);let a={[r.Ej.TAXONOMY_WHITE]:i.tAb.DEFAULT,[r.Ej.TAXONOMY_RED]:i.tAb.ERROR,[r.Ej.TAXONOMY_ORANGE]:i.tAb.WARNING,[r.Ej.TAXONOMY_YELLOW]:i.tAb.CAUTION,[r.Ej.TAXONOMY_GREEN]:i.tAb.SUCCESS,[r.Ej.TAXONOMY_BLUE]:i.tAb.INFO,[r.Ej.TAXONOMY_PURPLE]:i.tAb.ALERT,[r.Ej.SANDSTONE]:i.tAb.SANDSTONE,[r.Ej.MINOS]:i.tAb.MINOS}},92818:function(e,t,n){"use strict";n.d(t,{r:function(){return o}});var i=n(24246),r=n(27378),a=n(97181),s=n(22583),l=n(65735);let o={[l.Ej.TAXONOMY_WHITE]:"White",[l.Ej.TAXONOMY_RED]:"Red",[l.Ej.TAXONOMY_ORANGE]:"Orange",[l.Ej.TAXONOMY_YELLOW]:"Yellow",[l.Ej.TAXONOMY_GREEN]:"Green",[l.Ej.TAXONOMY_BLUE]:"Blue",[l.Ej.TAXONOMY_PURPLE]:"Purple",[l.Ej.SANDSTONE]:"Sandstone",[l.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...n}=e;return(0,i.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(s.j[t],")"),border:t===l.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})},u=e=>{let t=null==e?void 0:e.value,n=null==e?void 0:e.label;return(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(d,{color:t}),(0,i.jsx)("span",{children:n})]})};t.Z=e=>{let t=Object.values(l.Ej).map(e=>({value:e,label:o[e]})),[n,s]=(0,r.useState)(void 0);return(0,i.jsx)(a.d,{...e,options:t,optionRender:u,layout:"stacked",value:n,onChange:e=>{s(e)},prefix:(0,i.jsx)(d,{color:null!=n?n:l.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},65847:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eH}});var i,r,a=n(24246),s=n(98227),l=n(69238),o=n.n(l),d=n(63662),u=n(27378),c=n(25980),m=n(812),f=n(77213),h=n(58754),p=n(19904),g=n(33335),x=n(39864),y=e=>{let{onClose:t,messageApi:n}=e,[i,{isLoading:r}]=(0,x.Hb)(),l=async e=>{var r;let a={...e,taxonomy_type:(0,g.E)(null!==(r=e.name)&&void 0!==r?r:"")},s=await i(a);if((0,m.D4)(s)){n.error((0,m.e$)(s.error));return}n.success("Taxonomy created successfully"),t()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.AntTypography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,a.jsxs)(s.PPS,{layout:"vertical",onFinish:l,validateTrigger:["onBlur","onChange"],children:[(0,a.jsx)(s.PPS.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,a.jsx)(s.AntInput,{"data-testid":"input-name"})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.AntInput.TextArea,{rows:2,"data-testid":"input-description"})}),(0,a.jsxs)(s.jqI,{gap:"small",justify:"space-between",children:[(0,a.jsx)(s.wpx,{onClick:t,disabled:r,children:"Cancel"}),(0,a.jsx)(s.wpx,{type:"primary",htmlType:"submit",loading:r,disabled:r,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},v=n(84418),j=e=>{let{taxonomy:t,onSubmit:n,formId:i}=e;if(!t)return null;let{fides_key:r,...l}=t;return(0,a.jsxs)(s.jqI,{vertical:!0,gap:"large",children:[(0,a.jsx)(s.Yfl,{children:(0,a.jsx)(s.Yfl.Item,{label:"Fides key",children:r})}),(0,a.jsxs)(s.PPS,{id:i,layout:"vertical",initialValues:l,onFinish:n,children:[(0,a.jsx)(s.PPS.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,a.jsx)(s.AntInput,{})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.AntInput.TextArea,{})})]})]})};let _="custom-taxonomy-form";var T=e=>{let{taxonomy:t,onClose:n,onDelete:i,messageApi:r,...l}=e,[o,{isLoading:d}]=(0,x.Km)(),u=async e=>{if(!(null==t?void 0:t.fides_key)){r.error("Taxonomy not found");return}let n=await o({fides_key:t.fides_key,...e});if((0,m.D4)(n)){r.error((0,m.e$)(n.error));return}r.success("Taxonomy updated successfully")};return(0,a.jsx)(v.d,{title:"Edit ".concat(null==t?void 0:t.name),...l,itemKey:"",open:!!t,onClose:n,destroyOnHidden:!0,footer:(0,a.jsxs)(s.jqI,{justify:"space-between",className:"w-full",children:[(0,a.jsx)(s.wpx,{onClick:i,children:"Delete"}),(0,a.jsx)(s.wpx,{type:"primary",htmlType:"submit",form:_,loading:d,children:"Save"})]}),children:(0,a.jsx)(j,{taxonomy:t,onSubmit:u,formId:_})})},C=n(33162),b=n(79806),E=n(56358),A=n(46628),I=n(59001),S=n(90673),N=n(30002),k=n(28079),O=n(69353),P=n(5785),w=e=>{let{taxonomyType:t}=e,[n,i]=(0,P.Vj)(),[r,a]=(0,N.nC)(),[s,l]=(0,k.dk)(),[o,d]=(0,O.cw)(),[c,m]=(0,P.Ti)(),[f,h]=(0,k.Ql)(),[p,g]=(0,N.wG)(),[y,v]=(0,O.Nr)(),[j]=(0,P.jU)(),[_]=(0,k.LG)(),[T]=(0,N.h8)(),[C]=(0,O.Xz)(),[b]=(0,P.K9)(),[E]=(0,k.gu)(),[A]=(0,N.Kv)(),[S]=(0,O.Uv)(),[w,M]=(0,x.ci)(),[R,L]=(0,x.J1)(),[D]=(0,x.Cy)(),[V]=(0,x.d9)(),F=(0,u.useCallback)(()=>t?w(t):Promise.resolve(void 0),[t,w]),H=(0,u.useCallback)(e=>t?R({taxonomyType:t,...e}):Promise.resolve(void 0),[t,R]),z=(0,u.useCallback)(e=>t?D({taxonomyType:t,...e}):Promise.resolve(void 0),[t,D]),q=(0,u.useCallback)(e=>t?V({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,V]);return t===I.ac.DATA_CATEGORY?{getAllTrigger:n,taxonomyItems:i.data||[],updateTrigger:j,deleteTrigger:b,createTrigger:c,isLoading:i.isLoading,isError:i.isError,isCreating:m.isLoading}:t===I.ac.DATA_USE?{getAllTrigger:s,taxonomyItems:l.data||[],updateTrigger:_,deleteTrigger:E,createTrigger:f,isLoading:l.isLoading,isError:l.isError,isCreating:h.isLoading}:t===I.ac.DATA_SUBJECT?{getAllTrigger:r,taxonomyItems:a.data||[],updateTrigger:T,deleteTrigger:A,createTrigger:p,isLoading:a.isLoading,isError:a.isError,isCreating:g.isLoading}:t===I.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:C,deleteTrigger:S,createTrigger:y,isLoading:d.isLoading,isError:d.isError,isCreating:v.isLoading}:{getAllTrigger:F,taxonomyItems:(null==M?void 0:M.data)||[],updateTrigger:z,deleteTrigger:q,createTrigger:H,isLoading:(null==M?void 0:M.isLoading)||!1,isError:(null==M?void 0:M.isError)||!1,isCreating:L.isLoading}},M=n(31883),R=n(90104),L=n.n(R),D=n(18225),V=n(65735),F=e=>{let{customFields:t,formId:n,form:i}=e,{idToAllowListWithOptions:r,idToCustomFieldDefinition:l,isEnabled:o,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return o&&0!==u.length?(0,a.jsxs)(s.PPS,{form:i,name:n,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(s.AntTypography.Title,{level:3,children:"Custom fields"})}),d?(0,a.jsx)(D.Z,{}):(0,a.jsx)("div",{children:!L()(u)&&(0,a.jsx)("div",{children:u.map(e=>{let t=l.get(e);if(!t)return null;let{id:n,name:i,description:o,allow_list_id:d,field_type:u}=t;if(!d&&u===V.AL.STRING)return(0,a.jsx)(s.PPS.Item,{name:n,label:i,tooltip:o,children:(0,a.jsx)(s.AntInput,{})},e);let c=r.get(t.allow_list_id);if(!c)return null;let{options:m}=c;return(0,a.jsx)(s.PPS.Item,{name:n,label:i,tooltip:o,children:(0,a.jsx)(s.WPr,{mode:"string"!==u?"multiple":void 0,allowClear:!0,options:m})},e)})})})]}):null},H=n(43551),z=n.n(H),q=()=>{let e=s.PPS.useFormInstance(),t=s.PPS.useWatch(["rights","values"],e);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.PPS.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,a.jsx)(s.E_O,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,a.jsx)(s.PPS.Item,{name:["rights","values"],label:"Rights",children:(0,a.jsx)(s.WPr,{mode:"multiple",options:(0,m.MM)(V.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!L()(t)&&(0,a.jsx)(s.PPS.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,a.jsx)(s.WPr,{options:(0,m.MM)(V.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},U=n(83766),B=n.n(U),Y=n(1315),W=n(22583),Z=n(92818);let G=e=>{let{color:t,...n}=e;return(0,a.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(W.j[t],")"),border:t===V.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...n.style}})};var X=e=>{let t=Object.values(V.Ej).map(e=>({value:e,label:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(G,{color:e}),(0,a.jsx)("span",{children:Z.r[e]})]})}));return(0,a.jsx)(s.WPr,{...e,options:t,placeholder:"Select color"})};let K="all-suggested";var $=e=>{let{initialValues:t,onSubmit:n,form:i,formId:r,isDisabled:l}=e,{data:o=[],isLoading:d}=(0,k.fd)(),{data:c,isLoading:m}=(0,Y.K3)(),f=(0,u.useMemo)(()=>o.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[o]),h=s.PPS.useWatch("systems",i),p=(0,u.useMemo)(()=>{var e;let t=h||[];if(!c||0===t.length)return[];let n=null!==(e=null==c?void 0:c.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return B()(null==n?void 0:n.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[c,h]),g=(0,u.useMemo)(()=>{var e;return null!==(e=null==c?void 0:c.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[c]),x=(0,u.useMemo)(()=>{let e=[],t=[];return(f.forEach(n=>{p.includes(n.value)?e.push(n):t.push(n)}),0===e.length)?t:[{label:"Select all suggested",value:K},{label:(0,a.jsxs)(s.vyj,{children:[(0,a.jsx)(s.QMR,{size:14}),(0,a.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,a.jsxs)(s.vyj,{children:[(0,a.jsx)(s.PJP.BBB,{}),(0,a.jsx)("span",{children:"All data uses"})]}),options:t}]},[f,p]);return(0,a.jsxs)(s.PPS,{name:r,initialValues:t,onFinish:e=>{var i,r;let a={...t,...e};(!(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values)||L()(null==a?void 0:null===(r=a.rights)||void 0===r?void 0:r.values))&&z()(a,"rights"),n(a)},layout:"vertical",form:i,children:[(0,a.jsx)(s.PPS.Item,{label:"Name",name:"name",children:(0,a.jsx)(s.AntInput,{"data-testid":"edit-taxonomy-form_name",disabled:l})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.AntInput.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:l})}),(0,a.jsx)(s.PPS.Item,{label:"Systems",name:"systems",children:(0,a.jsx)(s.WPr,{mode:"multiple",placeholder:"Select systems",options:g,allowClear:!0,loading:m,disabled:l,"data-testid":"edit-taxonomy-form_systems"})}),(0,a.jsx)(s.PPS.Item,{label:"Color",name:"label_color",children:(0,a.jsx)(X,{disabled:l,"data-testid":"edit-taxonomy-form_color"})}),(0,a.jsx)(s.PPS.Item,{label:"Data uses",name:"data_uses",children:(0,a.jsx)(s.WPr,{mode:"multiple",placeholder:"Select data uses",options:x,allowClear:!0,loading:d,disabled:l,onChange:e=>{if(e.includes(K)){let t=B()([...p,...e.filter(e=>e!==K)]);i.setFieldsValue({data_uses:t})}else i.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},J=e=>{let{initialValues:t,onSubmit:n,form:i,formId:r,taxonomyType:l,isDisabled:o}=e,d=l===I.ac.DATA_SUBJECT;return l===I.ac.SYSTEM_GROUP?(0,a.jsx)($,{initialValues:t,onSubmit:n,form:i,formId:r,isDisabled:o}):(0,a.jsxs)(s.PPS,{name:r,initialValues:t,onFinish:e=>{var i,r;let a={...t,...e};(!(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values)||L()(null==a?void 0:null===(r=a.rights)||void 0===r?void 0:r.values))&&z()(a,"rights"),n(a)},layout:"vertical",form:i,children:[(0,a.jsx)(s.PPS.Item,{label:"Name",name:"name",children:(0,a.jsx)(s.AntInput,{"data-testid":"edit-taxonomy-form_name",disabled:o})}),(0,a.jsx)(s.PPS.Item,{label:"Description",name:"description",children:(0,a.jsx)(s.AntInput.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:o})}),d&&(0,a.jsx)(q,{})]})},Q=e=>{let{taxonomyItem:t,taxonomyType:n,onClose:i}=e,r="edit-taxonomy-form",[l]=s.PPS.useForm(),[o]=s.PPS.useForm(),d=(0,s.pmc)(),{isOpen:u,onOpen:c,onClose:f}=(0,s.qY0)(),{updateTrigger:h}=w({taxonomyType:n}),g=(0,S.Xl)(n),x=(0,C.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:g}),y=(0,p.Tg)([(0,I.aq)(n).UPDATE]),v=(0,p.Tg)([(0,I.aq)(n).DELETE]),j=async e=>{let n=await h(e);if((0,M.D4)(n)){d((0,A.Vo)((0,m.e$)(n.error)));return}if(x.isEnabled&&g){let e=o.getFieldsValue();await x.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,A.t5)("Taxonomy successfully updated")),i()},_=async()=>{await h({...t,active:!1}),f(),i()},T=async()=>{await h({...t,active:!0}),f(),i()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(b.ZP,{isOpen:!!t,onClose:i,header:(0,a.jsx)(b.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,a.jsxs)(s.zeN,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&v&&(0,a.jsx)(s.esZ,{title:"Delete label",children:(0,a.jsx)(s.wpx,{"aria-label":"delete",icon:(0,a.jsx)(E.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&y&&(0,a.jsx)(s.esZ,{title:"Enable label",children:(0,a.jsx)(s.wpx,{"aria-label":"enable",onClick:T,"data-testid":"enable-btn",icon:(0,a.jsx)(s.tEF,{fontSize:"small"})})}),(0,a.jsx)("div",{className:"flex gap-2",children:y&&(0,a.jsx)(s.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:r,children:"Save"})})]}),children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)(s.AntTypography.Title,{level:3,children:"Details"})}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,a.jsx)(s.esZ,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,a.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,a.jsx)(J,{initialValues:t,onSubmit:j,form:l,formId:r,taxonomyType:n,isDisabled:!y}),x.isEnabled&&!x.isLoading&&g&&(0,a.jsx)(F,{form:o,formId:"custom-fields-form",customFields:x})]}),(0,a.jsx)(s.cVQ,{isOpen:u,onClose:f,onConfirm:_,title:"Delete ".concat(n),message:(0,a.jsx)(s.Kqy,{children:(0,a.jsxs)(s.xvT,{children:["You are about to permanently delete the ",n," ",(0,a.jsx)(s.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};n(51901);var ee=n(86298),et=n(3124),en=n.n(et);(i=r||(r={})).DEFAULT="DEFAULT",i.ACTIVE_HOVER="ACTIVE_HOVER",i.PARENT_OF_HOVER="PARENT_OF_HOVER",i.CHILD_OF_HOVER="CHILD_OF_HOVER",i.SIBLING_OF_HOVER="SIBLING_OF_HOVER",i.INACTIVE="INACTIVE";let ei=(0,u.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),er=e=>{let{children:t}=e,[n,i]=(0,u.useState)(null),r=(0,u.useCallback)(e=>{e!==n&&i(e)},[n]),s=(0,u.useCallback)(()=>{i(null)},[]),l=(0,u.useCallback)(e=>n?e===n?"ACTIVE_HOVER":n.startsWith("".concat(e,"."))||e===I.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(n,"."))||n===I.Ch?"CHILD_OF_HOVER":n.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[n]),o=(0,u.useMemo)(()=>({activeNodeKey:n,setActiveNodeKey:i,onMouseEnter:r,onMouseLeave:s,getNodeHoverStatus:l}),[n,i,r,s,l]);return(0,a.jsx)(ei.Provider,{value:o,children:t})};function ea(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function es(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=eo)):void 0===t&&(t=el);for(var n,i,r,a,s,l=new ec(e),o=[l];n=o.pop();)if((r=t(n.data))&&(s=(r=Array.from(r)).length))for(n.children=r,a=s-1;a>=0;--a)o.push(i=r[a]=new ec(r[a])),i.parent=n,i.depth=n.depth+1;return l.eachBefore(eu)}function el(e){return e.children}function eo(e){return Array.isArray(e)?e[1]:null}function ed(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function eu(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ec(e){this.data=e,this.depth=this.height=0,this.parent=null}function em(e,t){return e.parent===t.parent?1:2}function ef(e){var t=e.children;return t?t[0]:e.t}function eh(e){var t=e.children;return t?t[t.length-1]:e.t}function ep(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function eg(e){return null==e?null:function(e){if("function"!=typeof e)throw Error();return e}(e)}ec.prototype=es.prototype={constructor:ec,count:function(){return this.eachAfter(ea)},each:function(e,t){let n=-1;for(let i of this)e.call(t,i,++n,this);return this},eachAfter:function(e,t){for(var n,i,r,a=this,s=[a],l=[],o=-1;a=s.pop();)if(l.push(a),n=a.children)for(i=0,r=n.length;i<r;++i)s.push(n[i]);for(;a=l.pop();)e.call(t,a,++o,this);return this},eachBefore:function(e,t){for(var n,i,r=this,a=[r],s=-1;r=a.pop();)if(e.call(t,r,++s,this),n=r.children)for(i=n.length-1;i>=0;--i)a.push(n[i]);return this},find:function(e,t){let n=-1;for(let i of this)if(e.call(t,i,++n,this))return i},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)i.push(t=t.parent);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return es(this).eachBefore(ed)},[Symbol.iterator]:function*(){var e,t,n,i,r=this,a=[r];do for(e=a.reverse(),a=[];r=e.pop();)if(yield r,t=r.children)for(n=0,i=t.length;n<i;++n)a.push(t[n]);while(a.length)}},ep.prototype=Object.create(ec.prototype);var ex={depth:-1},ey={},ev={};function ej(e){return e.id}function e_(e){return e.parentId}function eT(e){let t=e.length;if(t<2)return"";for(;--t>1&&!eC(e,t););return e.slice(0,t)}function eC(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if((1&n)==0)return!0}return!1}let eb=function(){var e=em,t=1,n=1,i=null;function r(r){var o=function(e){for(var t,n,i,r,a,s=new ep(e,0),l=[s];t=l.pop();)if(i=t._.children)for(t.children=Array(a=i.length),r=a-1;r>=0;--r)l.push(n=t.children[r]=new ep(i[r],r)),n.parent=t;return(s.parent=new ep(null,0)).children=[s],s}(r);if(o.eachAfter(a),o.parent.m=-o.z,o.eachBefore(s),i)r.eachBefore(l);else{var d=r,u=r,c=r;r.eachBefore(function(e){e.x<d.x&&(d=e),e.x>u.x&&(u=e),e.depth>c.depth&&(c=e)});var m=d===u?1:e(d,u)/2,f=m-d.x,h=t/(u.x+m+f),p=n/(c.depth||1);r.eachBefore(function(e){e.x=(e.x+f)*h,e.y=e.depth*p})}return r}function a(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n){!function(e){for(var t,n=0,i=0,r=e.children,a=r.length;--a>=0;)t=r[a],t.z+=n,t.m+=n,n+=t.s+(i+=t.c)}(t);var a=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-a):t.z=a}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,a,s,l=t,o=t,d=n,u=l.parent.children[0],c=l.m,m=o.m,f=d.m,h=u.m;d=eh(d),l=ef(l),d&&l;)u=ef(u),(o=eh(o)).a=t,(s=d.z+f-l.z-c+e(d._,l._))>0&&(function(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}((r=d,a=i,r.a.parent===t.parent?r.a:a),t,s),c+=s,m+=s),f+=d.m,c+=l.m,h+=u.m,m+=o.m;d&&!eh(o)&&(o.t=d,o.m+=f-m),l&&!ef(u)&&(u.t=l,u.m+=c-h,i=t)}return i}(t,r,t.parent.A||i[0])}function s(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function l(e){e.x*=t,e.y=e.depth*n}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(e){return arguments.length?(i=!1,t=+e[0],n=+e[1],r):i?null:[t,n]},r.nodeSize=function(e){return arguments.length?(i=!0,t=+e[0],n=+e[1],r):i?[t,n]:null},r}();var eE=e=>{let{nodes:t,edges:n,options:i}=e;return(0,u.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:n};let e=(function(){var e,t=ej,n=e_;function i(i){var r,a,s,l,o,d,u,c,m=Array.from(i),f=t,h=n,p=new Map;if(null!=e){let t=m.map((t,n)=>{var r;let a;return r=e(t,n,i),a=(r=`${r}`).length,eC(r,a-1)&&!eC(r,a-2)&&(r=r.slice(0,-1)),"/"===r[0]?r:`/${r}`}),n=t.map(eT),r=new Set(t).add("");for(let e of n)r.has(e)||(r.add(e),t.push(e),n.push(eT(e)),m.push(ev));f=(e,n)=>t[n],h=(e,t)=>n[t]}for(s=0,r=m.length;s<r;++s)a=m[s],d=m[s]=new ec(a),null!=(u=f(a,s,i))&&(u+="")&&(c=d.id=u,p.set(c,p.has(c)?ey:d)),null!=(u=h(a,s,i))&&(u+="")&&(d.parent=u);for(s=0;s<r;++s)if(u=(d=m[s]).parent){if(!(o=p.get(u)))throw Error("missing: "+u);if(o===ey)throw Error("ambiguous: "+u);o.children?o.children.push(d):o.children=[d],d.parent=o}else{if(l)throw Error("multiple roots");l=d}if(!l)throw Error("no root");if(null!=e){for(;l.data===ev&&1===l.children.length;)l=l.children[0],--r;for(let e=m.length-1;e>=0&&(d=m[e]).data===ev;--e)d.data=null}if(l.parent=ex,l.eachBefore(function(e){e.depth=e.parent.depth+1,--r}).eachBefore(eu),l.parent=null,r>0)throw Error("cycle");return l}return i.id=function(e){return arguments.length?(t=eg(e),i):t},i.parentId=function(e){return arguments.length?(n=eg(e),i):n},i.path=function(t){return arguments.length?(e=eg(t),i):e},i})().id(e=>e.id).parentId(e=>{var t;return null===(t=n.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),r="LR"===i.direction?[35,320]:[320,35];return{nodes:eb.nodeSize(r).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===i.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:n}},[t,n,i])},eA=e=>{let{positionAbsoluteX:t,positionAbsoluteY:n,nodeWidth:i}=e,{setCenter:r,getZoom:a}=(0,ee._K)();return{centerScreenOnNode:(0,u.useCallback)(()=>r(t+i/2,n,{duration:500,zoom:a()}),[a,t,n,i,r])}},eI=n(1945),eS=n.n(eI),eN=n(8335),ek=e=>{let{type:t,inactive:n=!1}=e;return(0,a.jsx)(ee.HH,{type:t,position:"source"===t?eN.Ly.Right:eN.Ly.Left,style:{width:8,height:8,backgroundColor:n?en().FIDESUI_NEUTRAL_400:en().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},eO=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:i}=e,{onCancel:r,onSubmit:l,parentKey:o,isLoading:d=!1}=t,c=(0,u.useRef)(null),[m,f]=(0,u.useState)(""),{centerScreenOnNode:h}=eA({positionAbsoluteX:n,positionAbsoluteY:i,nodeWidth:200});(0,u.useEffect)(()=>{f("");let e=()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await h(),e()})()},[o,h,n,i]);let p=()=>{!d&&m.trim()&&l(m)},g=()=>{d||r()};return(0,a.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,a.jsx)(s.AntInput,{placeholder:"Type label name...",ref:c,onBlur:g,onSubmit:p,value:m,onChange:e=>f(e.target.value),onKeyUp:e=>{"Escape"===e.key&&g()},onPressEnter:p,className:eS().input,suffix:d&&(0,a.jsx)(s.ZJQ,{size:"small"})}),(0,a.jsx)(ek,{type:"target"})]})},eP=e=>{let{getNodeHoverStatus:t}=(0,u.useContext)(ei),{target:n}=e,i=t(n),s=(0,u.useCallback)(()=>{switch(i){case r.ACTIVE_HOVER:case r.PARENT_OF_HOVER:return en().FIDESUI_MINOS;case r.INACTIVE:return en().NEUTRAL_400;default:return en().FIDESUI_SANDSTONE}},[i]),l=(0,u.useCallback)(()=>{switch(i){case r.ACTIVE_HOVER:case r.PARENT_OF_HOVER:return 2;default:return 1}},[i]);return(0,a.jsx)(ee.Jd,{...e,style:{stroke:s(),strokeWidth:l(),transition:"stroke 0.3s ease 0s"}})},ew=n(34770),eM=n.n(ew),eR=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:i}=e,{onMouseEnter:l,onMouseLeave:o,getNodeHoverStatus:d}=(0,u.useContext)(ei),{taxonomyType:c,taxonomyItem:m,onAddButtonClick:f,onTaxonomyItemClick:h,label:p,hasChildren:g,isLastCreatedItem:x,resetLastCreatedItemKey:y,userCanAddLabels:v}=t,{centerScreenOnNode:j}=eA({positionAbsoluteX:n,positionAbsoluteY:i,nodeWidth:200});(0,u.useEffect)(()=>{let e=async()=>{await j(),l(null==m?void 0:m.fides_key)};x&&(e(),y())},[x,l,null==m?void 0:m.fides_key,y,j]);let _=d(null==m?void 0:m.fides_key),T=(0,u.useCallback)(()=>{switch(_){case r.ACTIVE_HOVER:return eM()["button--hover"];case r.PARENT_OF_HOVER:return eM()["button--parent-hover"];case r.INACTIVE:return eM()["button--inactive"];case r.DEFAULT:case r.CHILD_OF_HOVER:case r.SIBLING_OF_HOVER:default:return""}},[_]),C=(null==m?void 0:m.fides_key)===I.Ch,b=c===I.ac.DATA_SUBJECT;return(0,a.jsxs)("div",{className:eM().container,onMouseEnter:()=>l(null==m?void 0:m.fides_key),onMouseLeave:()=>o(null==m?void 0:m.fides_key),"data-testid":"taxonomy-node-".concat(null==m?void 0:m.fides_key),children:[(0,a.jsx)(s.wpx,{className:"".concat(eM().button," ").concat(T()),onClick:()=>null==h?void 0:h(m),disabled:!h,type:"text",children:(0,a.jsxs)(s.AntTypography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==m?void 0:m.active)===!1?"(disabled) ":"",p]})}),!C&&(0,a.jsx)(ek,{type:"target",inactive:_===r.INACTIVE}),g&&(0,a.jsx)(ek,{type:"source",inactive:_===r.INACTIVE}),v&&(!b||C)&&(0,a.jsx)("div",{className:eM()["add-button-container"],children:(0,a.jsx)(s.wpx,{type:"default",className:"".concat(eM()["add-button"]," ").concat(_===r.ACTIVE_HOVER?eM()["add-button--visible"]:""),icon:(0,a.jsx)(s.PJP.mm_,{size:20}),onClick:()=>null==f?void 0:f(m),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(p)})})]})};let eL=e=>{let{taxonomyType:t,taxonomyItems:n,draftNewItem:i,lastCreatedItemKey:r,resetLastCreatedItemKey:s,onRootItemClick:l,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:c,onSubmitDraftItem:m,userCanAddLabels:f,isCreating:h=!1,rootNodeLabel:p}=e,{fitView:g}=(0,ee._K)();(0,u.useEffect)(()=>{setTimeout(()=>g(),150)},[g,t,n.length]);let x=[(0,u.useMemo)(()=>({id:I.Ch,position:{x:0,y:0},data:{label:p||t,taxonomyItem:{fides_key:I.Ch},taxonomyType:t,onTaxonomyItemClick:l,onAddButtonClick:d,hasChildren:0!==n.length,userCanAddLabels:f},type:"taxonomyTreeNode"}),[p,t,l,d,n.length,f])],y=[];if(n.forEach(e=>{let n=e.name||e.fides_key.split(".").pop()||"",i={id:e.fides_key,position:{x:0,y:0},data:{label:n,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:r===e.fides_key,resetLastCreatedItemKey:s,userCanAddLabels:f},type:"taxonomyTreeNode"};x.push(i);let a=e.parent_key?x.find(t=>t.id===e.parent_key):null,l=a?a.id:I.Ch,u=e.fides_key,c={id:"".concat(l,"-").concat(u),source:l,target:u,type:"taxonomyTreeEdge"};y.push(c),a&&(a.data.hasChildren=!0)}),i){let e=i.parent_key||I.Ch;x.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:c,onSubmit:m,isLoading:h},hidden:!i}),y.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=x.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:v,edges:j}=eE({nodes:x,edges:y,options:{direction:"LR"}}),_=(0,u.useMemo)(()=>({taxonomyTreeNode:eR,textInputNode:eO}),[]),T=(0,u.useMemo)(()=>({taxonomyTreeEdge:eP}),[]);return(0,a.jsx)("div",{className:"size-full",style:{backgroundColor:en().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,a.jsx)(er,{children:(0,a.jsxs)(ee.x$,{nodes:v,edges:j,nodeTypes:_,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,a.jsx)(ee.Aq,{color:en().FIDESUI_NEUTRAL_100,variant:ee.T7.Dots,size:3}),(0,a.jsx)(ee.a9,{nodeStrokeWidth:3,pannable:!0}),(0,a.jsx)(ee.ZX,{showInteractive:!1})]})})})};var eD=e=>(0,a.jsx)(ee.tV,{children:(0,a.jsx)(eL,{...e})});let eV="add new item",eF=I.ac.DATA_CATEGORY;var eH=()=>{let[e,t]=(0,u.useState)(eF),n=!Object.values(I.ac).includes(e),i=(0,c.hz)().plus,{data:r}=(0,x.MU)(void 0,{skip:!i}),{createTrigger:l,getAllTrigger:g,taxonomyItems:v=[],isCreating:j}=w({taxonomyType:e}),_=(0,d.useSearchParams)(),C=(null==_?void 0:_.get("showDisabledItems"))==="true",[b,E]=s.Pg3.useMessage();(0,u.useEffect)(()=>{g()},[g,e]);let[A,S]=(0,u.useState)(null),[N,k]=(0,u.useState)(null),[O,P]=(0,u.useState)(null),[M,R]=(0,u.useState)(null),[L,D]=s.$zI.useModal(),[V]=(0,x.EO)(),F=async()=>{if(!(null==N?void 0:N.fides_key)){b.error("Taxonomy not found");return}let e=await V(N.fides_key);if((0,m.D4)(e)){b.error((0,m.e$)(e.error));return}b.success("Taxonomy deleted successfully"),k(null),t(eF)},H=(0,u.useMemo)(()=>{var t;if(!r)return null;let n=r.find(t=>t.fides_key===e);return null!==(t=null==n?void 0:n.name)&&void 0!==t?t:null==n?void 0:n.fides_key},[r,e]),[z,q]=(0,u.useState)(!1);(0,u.useEffect)(()=>{P(null),R(null),S(null)},[e]),(0,u.useEffect)(()=>{e!==I.ac.SYSTEM_GROUP||i||t(I.ac.DATA_CATEGORY)},[e,i]);let U=(0,u.useCallback)(async e=>{if(!O)return;let t=(null==O?void 0:O.parent_key)===I.Ch,n={...O,name:e,parent_key:t?null:O.parent_key},i=await l(n);if((0,m.D4)(i)){b.error((0,m.e$)(i.error));return}R(i.data.fides_key),b.success("New label successfully created"),P(null)},[l,O,b]),B=o()(v,"active"),Y=(0,p.Tg)([(0,I.aq)(e).CREATE]);return(0,a.jsxs)(f.Z,{title:"Taxonomy",children:[E,D,(0,a.jsxs)(s.jqI,{vertical:!0,className:"h-full",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h.Z,{heading:"Taxonomy"}),(0,a.jsx)("div",{className:"hidden",children:(0,a.jsx)("div",{className:"mb-5 flex justify-between",children:(0,a.jsxs)(s.vyj.Compact,{children:[(0,a.jsx)(s.AntInput,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,a.jsx)(s.wpx,{type:"default",children:"Clear"})]})})})]}),(0,a.jsxs)("div",{className:"relative grow",children:[(0,a.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,a.jsx)(s.AHg,{selectedKeys:[e],onSelect:e=>{let{key:n}=e;if(n===eV){q(!0);return}t(n)},items:(()=>{let e={[I.Lo.DATA_CATEGORIES]:I.ac.DATA_CATEGORY,[I.Lo.DATA_USES]:I.ac.DATA_USE,[I.Lo.DATA_SUBJECTS]:I.ac.DATA_SUBJECT,[I.Lo.SYSTEM_GROUPS]:I.ac.SYSTEM_GROUP},t=(0,m.MM)(I.Lo).filter(e=>i||e.value!==I.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==r?void 0:r.length)&&r.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),i&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:eV})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,a.jsx)(s.$zI,{open:z,destroyOnHidden:!0,onCancel:()=>q(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,a.jsx)(y,{onClose:()=>q(!1),messageApi:b})}),(0,a.jsx)(eD,{userCanAddLabels:Y,taxonomyItems:C?v:B,draftNewItem:O,lastCreatedItemKey:M,resetLastCreatedItemKey:()=>R(null),onTaxonomyItemClick:e=>{S(e)},onRootItemClick:n?()=>{let t=null==r?void 0:r.find(t=>t.fides_key===e);t&&k(t)}:null,onAddButtonClick:e=>{var t;P({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:e,onCancelDraftItem:()=>P(null),onSubmitDraftItem:U,isCreating:j,rootNodeLabel:null!=H?H:(0,I._g)(e)})]})]}),A&&(0,a.jsx)(Q,{taxonomyItem:A,taxonomyType:e,onClose:()=>S(null)}),i&&(0,a.jsx)(T,{title:H?"Edit ".concat(H):"Edit taxonomy",onClose:()=>k(null),onDelete:()=>{L.confirm({title:"Delete ".concat(null==N?void 0:N.name,"?"),icon:null,content:(0,a.jsx)(s.AntTypography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:F,centered:!0})},taxonomy:N,messageApi:b})]})}},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}},function(e){e.O(0,[1096,431,3662,1533,7245,9341,2888,9774,179],function(){return e(e.s=71180)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3422],{80594:function(e){e.exports=function(e,a){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==a(e[n],n,e););return e}},52033:function(e,a,n){var r=n(26194),t=n(26789)(r);e.exports=t},49819:function(e,a,n){var r=n(18911)();e.exports=r},26194:function(e,a,n){var r=n(49819),t=n(50098);e.exports=function(e,a){return e&&r(e,a,t)}},62079:function(e,a,n){var r=n(31137);e.exports=function(e){return"function"==typeof e?e:r}},26789:function(e,a,n){var r=n(80068);e.exports=function(e,a){return function(n,t){if(null==n)return n;if(!r(n))return e(n,t);for(var i=n.length,o=a?i:-1,s=Object(n);(a?o--:++o<i)&&!1!==t(s[o],o,s););return n}}},18911:function(e){e.exports=function(e){return function(a,n,r){for(var t=-1,i=Object(a),o=r(a),s=o.length;s--;){var l=o[e?s:++t];if(!1===n(i[l],l,i))break}return a}}},47003:function(e,a,n){var r=n(80594),t=n(52033),i=n(62079),o=n(19785);e.exports=function(e,a){return(o(e)?r:t)(e,i(a))}},15806:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/consent/reporting",function(){return n(45113)}])},35287:function(e,a,n){"use strict";var r=n(24246),t=n(98227),i=n(88038),o=n.n(i);n(27378),a.Z=e=>{let{children:a,title:n,fullHeight:i,fullWidth:s,mainProps:l}=e;return(0,r.jsxs)(t.kCb,{"data-testid":n,direction:"column",height:i?"100vh":"calc(100vh - 48px)",width:s?"100vw":"calc(100vw - 240px)",children:[(0,r.jsxs)(o(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(t.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...l,children:a})]})}},58754:function(e,a,n){"use strict";var r=n(24246),t=n(98227),i=n(70788);a.Z=e=>{let{heading:a,breadcrumbItems:n,isSticky:o=!0,children:s,rightContent:l,style:_,...c}=e;return(0,r.jsxs)("div",{...c,style:o?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",..._}:{paddingBottom:"24px",..._},children:[(0,r.jsxs)(t.jqI,{justify:"space-between",children:["string"==typeof a?(0,r.jsx)(t.lQT,{className:n||s?"pb-4":void 0,level:1,"data-testid":"page-heading",children:a}):a,l&&(0,r.jsx)("div",{"data-testid":"page-header-right-content",children:l})]}),!!n&&(0,r.jsx)(i.m,{className:s?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),s]})}},70788:function(e,a,n){"use strict";n.d(a,{m:function(){return _}});var r=n(24246),t=n(98227),i=n(79894),o=n.n(i),s=n(27378);let{Text:l}=t.AntTypography,_=e=>{let{items:a,...n}=e,i=(0,s.useMemo)(()=>null==a?void 0:a.map((e,n)=>{let i=n===a.length-1,s={...e},_=s.onClick&&!s.href;return("string"==typeof s.title&&(s.title=(0,r.jsx)(l,{style:{color:"inherit",maxWidth:i?void 0:400},ellipsis:!i,id:i?"breadcrumb-current-page":void 0,children:s.title})),_)?s.title=(0,r.jsx)(t.wpx,{type:"text",size:"small",icon:s.icon,onClick:s.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:s.title}):(s.icon&&(s.title=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"anticon align-text-bottom",children:s.icon}),s.title]})),s.href&&s.title&&(s.title=(0,r.jsx)(o(),{href:s.href,className:"ant-breadcrumb-link",children:s.title}),delete s.href)),s}),[a]);return(0,r.jsx)(t.zrq,{items:i,...n})}},8411:function(e,a,n){"use strict";n.d(a,{NA:function(){return i},Z8:function(){return t}});var r=n(65735);let t={[r._F.ER]:"Eritrea",[r._F.DJ]:"Djibouti",[r._F.MR]:"Mauritania",[r._F.NA]:"Namibia",[r._F.GH]:"Ghana",[r._F.SS]:"South Sudan",[r._F.SC]:"Seychelles",[r._F.IO]:"British Indian Ocean Territory",[r._F.GQ]:"Equatorial Guinea",[r._F.AO]:"Angola",[r._F.CG]:"Republic of the Congo",[r._F.BW]:"Botswana",[r._F.BI]:"Burundi",[r._F.DZ]:"Algeria",[r._F.TD]:"Chad",[r._F.NG]:"Nigeria",[r._F.TZ]:"Tanzania",[r._F.EH]:"Western Sahara",[r._F.SN]:"Senegal",[r._F.LR]:"Liberia",[r._F.ZA]:"South Africa",[r._F.CV]:"Cape Verde",[r._F.GM]:"Gambia",[r._F.SD]:"Sudan",[r._F.KM]:"Comoros",[r._F.SZ]:"Eswatini",[r._F.UG]:"Uganda",[r._F.MG]:"Madagascar",[r._F.RW]:"Rwanda",[r._F.CD]:"DR Congo",[r._F.CM]:"Cameroon",[r._F.SH]:"Saint Helena, Ascension and Tristan da Cunha",[r._F.TG]:"Togo",[r._F.MU]:"Mauritius",[r._F.NE]:"Niger",[r._F.BJ]:"Benin",[r._F.EG]:"Egypt",[r._F.LS]:"Lesotho",[r._F.ET]:"Ethiopia",[r._F.MA]:"Morocco",[r._F.YT]:"Mayotte",[r._F.BF]:"Burkina Faso",[r._F.RE]:"R\xe9union",[r._F.ST]:"S\xe3o Tom\xe9 and Pr\xedncipe",[r._F.CF]:"Central African Republic",[r._F.MZ]:"Mozambique",[r._F.MW]:"Malawi",[r._F.ML]:"Mali",[r._F.ZM]:"Zambia",[r._F.LY]:"Libya",[r._F.GW]:"Guinea-Bissau",[r._F.SO]:"Somalia",[r._F.KE]:"Kenya",[r._F.GN]:"Guinea",[r._F.ZW]:"Zimbabwe",[r._F.TN]:"Tunisia",[r._F.SL]:"Sierra Leone",[r._F.GA]:"Gabon",[r._F.CI]:"Ivory Coast",[r._F.JO]:"Jordan",[r._F.PK]:"Pakistan",[r._F.KP]:"North Korea",[r._F.MO]:"Macau",[r._F.AM]:"Armenia",[r._F.SY]:"Syria",[r._F.TJ]:"Tajikistan",[r._F.SA]:"Saudi Arabia",[r._F.KR]:"South Korea",[r._F.NP]:"Nepal",[r._F.PH]:"Philippines",[r._F.IQ]:"Iraq",[r._F.LB]:"Lebanon",[r._F.MN]:"Mongolia",[r._F.PS]:"Palestine",[r._F.YE]:"Yemen",[r._F.JP]:"Japan",[r._F.KZ]:"Kazakhstan",[r._F.LK]:"Sri Lanka",[r._F.MM]:"Myanmar",[r._F.KG]:"Kyrgyzstan",[r._F.CN]:"China",[r._F.AF]:"Afghanistan",[r._F.OM]:"Oman",[r._F.IN]:"India",[r._F.LA]:"Laos",[r._F.UZ]:"Uzbekistan",[r._F.MV]:"Maldives",[r._F.ID]:"Indonesia",[r._F.VN]:"Vietnam",[r._F.MY]:"Malaysia",[r._F.TW]:"Taiwan",[r._F.KH]:"Cambodia",[r._F.AE]:"United Arab Emirates",[r._F.HK]:"Hong Kong",[r._F.GE]:"Georgia (Country)",[r._F.BD]:"Bangladesh",[r._F.KW]:"Kuwait",[r._F.TM]:"Turkmenistan",[r._F.QA]:"Qatar",[r._F.BH]:"Bahrain",[r._F.BN]:"Brunei",[r._F.TH]:"Thailand",[r._F.BT]:"Bhutan",[r._F.SG]:"Singapore",[r._F.IL]:"Israel",[r._F.AZ]:"Azerbaijan",[r._F.TL]:"Timor-Leste",[r._F.IR]:"Iran",[r._F.TR]:"Turkey",[r._F.MK]:"North Macedonia",[r._F.IE]:"Ireland",[r._F.DK]:"Denmark",[r._F.SK]:"Slovakia",[r._F.MD]:"Moldova",[r._F.AX]:"\xc5land Islands",[r._F.PL]:"Poland",[r._F.BA]:"Bosnia and Herzegovina",[r._F.SM]:"San Marino",[r._F.CZ]:"Czechia",[r._F.EE]:"Estonia",[r._F.XK]:"Kosovo",[r._F.FO]:"Faroe Islands",[r._F.SJ]:"Svalbard and Jan Mayen",[r._F.GG]:"Guernsey",[r._F.FR]:"France",[r._F.NL]:"Netherlands",[r._F.FI]:"Finland",[r._F.PT]:"Portugal",[r._F.DE]:"Germany",[r._F.MT]:"Malta",[r._F.JE]:"Jersey",[r._F.IS]:"Iceland",[r._F.ES]:"Spain",[r._F.GI]:"Gibraltar",[r._F.NO]:"Norway",[r._F.CY]:"Cyprus",[r._F.RS]:"Serbia",[r._F.LT]:"Lithuania",[r._F.MC]:"Monaco",[r._F.LU]:"Luxembourg",[r._F.UA]:"Ukraine",[r._F.IM]:"Isle of Man",[r._F.RO]:"Romania",[r._F.BE]:"Belgium",[r._F.SE]:"Sweden",[r._F.ME]:"Montenegro",[r._F.LV]:"Latvia",[r._F.VA]:"Vatican City",[r._F.AT]:"Austria",[r._F.AL]:"Albania",[r._F.LI]:"Liechtenstein",[r._F.GR]:"Greece",[r._F.IT]:"Italy",[r._F.AD]:"Andorra",[r._F.GB]:"United Kingdom",[r._F.RU]:"Russia",[r._F.SI]:"Slovenia",[r._F.BY]:"Belarus",[r._F.CH]:"Switzerland",[r._F.HU]:"Hungary",[r._F.BG]:"Bulgaria",[r._F.HR]:"Croatia",[r._F.TC]:"Turks and Caicos Islands",[r._F.CW]:"Cura\xe7ao",[r._F.GP]:"Guadeloupe",[r._F.UM]:"United States Minor Outlying Islands",[r._F.GT]:"Guatemala",[r._F.PM]:"Saint Pierre and Miquelon",[r._F.BQ]:"Caribbean Netherlands",[r._F.GL]:"Greenland",[r._F.SX]:"Sint Maarten",[r._F.PA]:"Panama",[r._F.AW]:"Aruba",[r._F.MQ]:"Martinique",[r._F.AG]:"Antigua and Barbuda",[r._F.BM]:"Bermuda",[r._F.CU]:"Cuba",[r._F.GD]:"Grenada",[r._F.NI]:"Nicaragua",[r._F.LC]:"Saint Lucia",[r._F.KN]:"Saint Kitts and Nevis",[r._F.DO]:"Dominican Republic",[r._F.VC]:"Saint Vincent and the Grenadines",[r._F.BZ]:"Belize",[r._F.HT]:"Haiti",[r._F.JM]:"Jamaica",[r._F.BS]:"Bahamas",[r._F.MX]:"Mexico",[r._F.MF]:"Saint Martin",[r._F.SV]:"El Salvador",[r._F.BL]:"Saint Barth\xe9lemy",[r._F.AI]:"Anguilla",[r._F.MS]:"Montserrat",[r._F.VG]:"British Virgin Islands",[r._F.BB]:"Barbados",[r._F.HN]:"Honduras",[r._F.KY]:"Cayman Islands",[r._F.DM]:"Dominica",[r._F.TT]:"Trinidad and Tobago",[r._F.CR]:"Costa Rica",[r._F.SR]:"Suriname",[r._F.CX]:"Christmas Island",[r._F.WS]:"Samoa",[r._F.PF]:"French Polynesia",[r._F.AS]:"American Samoa",[r._F.NC]:"New Caledonia",[r._F.TK]:"Tokelau",[r._F.PW]:"Palau",[r._F.KI]:"Kiribati",[r._F.VU]:"Vanuatu",[r._F.PN]:"Pitcairn Islands",[r._F.CK]:"Cook Islands",[r._F.FJ]:"Fiji",[r._F.PG]:"Papua New Guinea",[r._F.MP]:"Northern Mariana Islands",[r._F.NU]:"Niue",[r._F.TV]:"Tuvalu",[r._F.NF]:"Norfolk Island",[r._F.TO]:"Tonga",[r._F.FM]:"Micronesia",[r._F.SB]:"Solomon Islands",[r._F.NR]:"Nauru",[r._F.WF]:"Wallis and Futuna",[r._F.GU]:"Guam",[r._F.AU]:"Australia",[r._F.NZ]:"New Zealand",[r._F.MH]:"Marshall Islands",[r._F.CC]:"Cocos (Keeling) Islands",[r._F.VE]:"Venezuela",[r._F.PY]:"Paraguay",[r._F.BR]:"Brazil",[r._F.CO]:"Colombia",[r._F.PE]:"Peru",[r._F.CL]:"Chile",[r._F.UY]:"Uruguay",[r._F.AR]:"Argentina",[r._F.GY]:"Guyana",[r._F.BO]:"Bolivia",[r._F.GF]:"French Guiana",[r._F.EC]:"Ecuador",[r._F.FK]:"Falkland Islands",[r._F.US_AL]:"Alabama",[r._F.US_AK]:"Alaska",[r._F.US_AZ]:"Arizona",[r._F.US_AR]:"Arkansas",[r._F.US_CA]:"California",[r._F.US_CO]:"Colorado",[r._F.US_CT]:"Connecticut",[r._F.US_DE]:"Delaware",[r._F.US_DC]:"District of Columbia (DC)",[r._F.US_FL]:"Florida",[r._F.US_GA]:"Georgia",[r._F.US_HI]:"Hawaii",[r._F.US_ID]:"Idaho",[r._F.US_IL]:"Illinois",[r._F.US_IN]:"Indiana",[r._F.US_IA]:"Iowa",[r._F.US_KS]:"Kansas",[r._F.US_KY]:"Kentucky",[r._F.US_LA]:"Louisiana",[r._F.US_ME]:"Maine",[r._F.US_MD]:"Maryland",[r._F.US_MA]:"Massachusetts",[r._F.US_MI]:"Michigan",[r._F.US_MN]:"Minnesota",[r._F.US_MS]:"Mississippi",[r._F.US_MO]:"Missouri",[r._F.US_MT]:"Montana",[r._F.US_NE]:"Nebraska",[r._F.US_NV]:"Nevada",[r._F.US_NH]:"New Hampshire",[r._F.US_NJ]:"New Jersey",[r._F.US_NM]:"New Mexico",[r._F.US_NY]:"New York",[r._F.US_NC]:"North Carolina",[r._F.US_ND]:"North Dakota",[r._F.US_OH]:"Ohio",[r._F.US_OK]:"Oklahoma",[r._F.US_OR]:"Oregon",[r._F.US_PA]:"Pennsylvania",[r._F.US_PR]:"Puerto Rico",[r._F.US_RI]:"Rhode Island",[r._F.US_SC]:"South Carolina",[r._F.US_SD]:"South Dakota",[r._F.US_TN]:"Tennessee",[r._F.US_TX]:"Texas",[r._F.US_UT]:"Utah",[r._F.US_VA]:"Virginia",[r._F.US_VI]:"United States Virgin Islands",[r._F.US_VT]:"Vermont",[r._F.US_WA]:"Washington",[r._F.US_WV]:"West Virginia",[r._F.US_WI]:"Wisconsin",[r._F.US_WY]:"Wyoming",[r._F.CA_AB]:"Alberta",[r._F.CA_BC]:"British Columbia",[r._F.CA_MB]:"Manitoba",[r._F.CA_NB]:"New Brunswick",[r._F.CA_NL]:"Newfoundland and Labrador",[r._F.CA_NS]:"Nova Scotia",[r._F.CA_ON]:"Ontario",[r._F.CA_PE]:"Prince Edward Island",[r._F.CA_QC]:"Quebec",[r._F.CA_SK]:"Saskatchewan",[r._F.CA_NT]:"Northwest Territories",[r._F.CA_NU]:"Nunavut",[r._F.CA_YT]:"Yukon",[r._F.CA]:"Canada",[r._F.US]:"United States",[r._F.MEXICO_CENTRAL_AMERICA]:"Mexico and Central America",[r._F.CARIBBEAN]:"Caribbean",[r._F.EEA]:"European Economic Area (EEA)",[r._F.NON_EEA]:"Non European Economic Area",[r._F.GLOBAL]:"Global"},i=new Map(Object.entries(t));Object.entries(t).map(e=>({value:e[0],label:e[1]}))},45113:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return V}});var r=n(24246),t=n(59003),i=n(92222),o=n(27693),s=n.n(o),l=n(98227),_=n(27378),c=n(35287),d=n(17245),u=n(58754);let F=e=>{let{disableNext:a,pagination:n}=e;return(0,r.jsxs)(l.jqI,{gap:"middle",align:"center",justify:"right",children:[(0,r.jsx)(l.wpx,{onClick:n.previousPage,disabled:1===n.pageIndex,icon:(0,r.jsx)(l.PJP.s$$,{"aria-hidden":!0}),"aria-label":"Previous"}),(0,r.jsx)("span",{"aria-label":"Page ".concat(n.pageIndex),children:n.pageIndex}),(0,r.jsx)(l.wpx,{onClick:n.nextPage,disabled:a,icon:(0,r.jsx)(l.PJP._Qn,{"aria-hidden":!0}),"aria-label":"Next"}),(0,r.jsx)(l.WPr,{className:"w-auto",value:n.pageSize,onChange:n.updatePageSize,options:n.pageSizeOptions.map(e=>({label:e,value:e})),labelRender:e=>{let{value:a}=e;return(0,r.jsxs)("span",{children:[a," / page"]})},"aria-label":"Select page size"})]})};var p=n(47935),h=n(46628),m=n(78780);let S=e=>{var a,n;return null==e?void 0:null===(n=e.startOf("day"))||void 0===n?void 0:null===(a=n.utc())||void 0===a?void 0:a.toISOString()},g=e=>{var a,n;return null==e?void 0:null===(n=e.endOf("day"))||void 0===n?void 0:null===(a=n.utc())||void 0===a?void 0:a.toISOString()},{useLazyDownloadReportQuery:x,useGetAllHistoricalPrivacyPreferencesQuery:C,useLazyGetCurrentPrivacyPreferencesQuery:j}=m.u.injectEndpoints({endpoints:e=>({getCurrentPrivacyPreferences:e.query({query:e=>{let{search:a}=e;return{url:"current-privacy-preferences",params:{email:a,phone_number:a,fides_user_device_id:a,external_id:a}}},providesTags:["Current Privacy Preferences"]}),downloadReport:e.query({query:e=>{let{startDate:a,endDate:n}=e;return{url:"plus/consent_reporting",params:{created_gt:S(a),created_lt:g(n),download_csv:"true"},responseHandler:"content-type"}},providesTags:["Consent Reporting Export"]}),getAllHistoricalPrivacyPreferences:e.query({query:e=>{let{page:a,size:n,startDate:r,endDate:t,includeTotal:i=!0}=e;return{url:"historical-privacy-preferences",params:{page:a,size:n,request_timestamp_gt:S(r),request_timestamp_lt:g(t),include_total:i}}},providesTags:["Consent Reporting"]})})});var v=n(90104),b=n.n(v),f=n(812),A=n(65735);let y={[A.pq.OPT_IN]:"Opt in",[A.pq.OPT_OUT]:"Opt out",[A.pq.ACKNOWLEDGE]:"Acknowledge",[A.pq.TCF]:"TCF"},N={[A.pq.OPT_IN]:l.tAb.SUCCESS,[A.pq.OPT_OUT]:l.tAb.ERROR,[A.pq.ACKNOWLEDGE]:l.tAb.DEFAULT,[A.pq.TCF]:l.tAb.SANDSTONE},I={[A.jP.ACCEPT]:"Accept",[A.jP.BUTTON]:"Button",[A.jP.DISMISS]:"Dismiss",[A.jP.GPC]:"GPC",[A.jP.REJECT]:"Reject",[A.jP.SAVE]:"Save",[A.jP.SCRIPT]:"Script",[A.jP.INDIVIDUAL_NOTICE]:"Individual Notice",[A.jP.ACKNOWLEDGE]:"Acknowledge",[A.jP.EXTERNAL_PROVIDER]:"External Provider"},M={[A.Tz.API]:"API",[A.Tz.BANNER_AND_MODAL]:"Banner and Modal",[A.Tz.MODAL]:"Modal",[A.Tz.OVERLAY]:"Overlay",[A.Tz.PRIVACY_CENTER]:"Privacy Center",[A.Tz.TCF_OVERLAY]:"TCF Overlay"},P=(0,i.Cl)();var T=()=>(0,_.useMemo)(()=>[P.accessor(e=>e.notice_name,{id:"notice_name",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Privacy notice",...e}),enableSorting:!1}),P.accessor(e=>e.notice_key,{id:"notice_key",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Notice Key",...e}),enableSorting:!1}),P.accessor(e=>e.preference,{id:"preference",cell:e=>{let{getValue:a}=e,n=a(),t=n&&y[n]||n,i=n&&N[n]||"";return(0,r.jsx)(p.A4,{color:i,value:t})},header:e=>(0,r.jsx)(p.Rr,{value:"Preference",...e}),enableSorting:!1,size:100}),P.accessor(e=>e.privacy_notice_history_id,{id:"privacy_notice_history_id",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Privacy Notice History Id",...e}),enableSorting:!1})],[]),E=n(47003),R=n.n(E);let U=(0,i.Cl)();var w=()=>{let e=(0,_.useCallback)(e=>{let a=[];if(e){let{preferences:n,...r}=e;R()(r,(e,n)=>{e&&e.forEach(e=>{a.push({key:n,id:e.id,preference:e.preference})})})}return a},[]),a=(0,_.useCallback)(e=>e.filter(e=>!(e.key.startsWith("system_")||e.key.startsWith("vendor_"))),[]);return{tcfColumns:(0,_.useMemo)(()=>[U.accessor(e=>e.key,{id:"key",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Type",...e}),enableSorting:!1}),U.accessor(e=>e.id,{id:"id",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"ID",...e}),enableSorting:!1}),U.accessor(e=>e.preference,{id:"preference",cell:e=>{let{getValue:a}=e,n=a(),t=n&&y[n]||n,i=n&&N[n]||"";return(0,r.jsx)(p.A4,{color:i,value:t})},header:e=>(0,r.jsx)(p.Rr,{value:"Preference",...e}),enableSorting:!1,size:100})],[]),mapTcfPreferencesToRowColumns:e,filterTcfConsentPreferences:a}},k=e=>{let{isOpen:a,onClose:n}=e,[o,s]=(0,_.useState)(!1),[c,d]=(0,_.useState)(),[u]=j(),F=(0,l.pmc)();(0,_.useEffect)(()=>{a||(d(void 0),s(!1))},[a]);let h=async e=>{s(!0);let{data:a,isError:n,error:r}=await u({search:e}),t=r&&"status"in r&&(null==r?void 0:r.status);n&&404!==t?F({status:"error",description:(0,f.e$)(r,"A problem occurred while looking up the preferences.")}):d(a||null),s(!1)},m=T(),S=(null==c?void 0:c.preferences)||[],g=!b()(S),x=(0,t.b7)({getCoreRowModel:(0,i.sC)(),data:S,columns:m,getRowId:e=>"".concat(e.privacy_notice_history_id),manualPagination:!0}),{tcfColumns:C,mapTcfPreferencesToRowColumns:v,filterTcfConsentPreferences:A}=w(),y=A(v(c)),N=!b()(y),I=(0,t.b7)({getCoreRowModel:(0,i.sC)(),data:y,columns:C,getRowId:e=>"".concat(e.key,"-").concat(e.id),manualPagination:!0});return(0,r.jsxs)(l.u_l,{id:"consent-lookup-modal",isOpen:a,onClose:n,size:"6xl",returnFocusOnClose:!1,isCentered:!0,children:[(0,r.jsx)(l.ZAr,{}),(0,r.jsxs)(l.hzk,{children:[(0,r.jsx)(l.olH,{}),(0,r.jsx)(l.xBx,{pb:2,children:"Consent preference lookup"}),(0,r.jsxs)(l.fef,{children:[(0,r.jsx)(l.AntTypography.Paragraph,{children:"Use this search to look up an individual's latest consent record. You can search by phone number, email, external ID or device ID to retrieve the most recent consent preference associated with that exact identifier."}),(0,r.jsxs)(l.AntTypography.Paragraph,{children:[(0,r.jsx)("strong",{children:"Note:"})," This is an exact match searchâ€”partial entries or similar results will not be returned. This lookup retrieves only the most recent consent preference, not the full consent history."]}),(0,r.jsx)(l.PPS,{layout:"vertical",className:"w-1/2",children:(0,r.jsx)(l.PPS.Item,{label:"Subject search",className:"mb-4 mt-6",children:(0,r.jsx)(l.AntInput.Search,{"data-testid":"subject-search-input",placeholder:"Enter email, phone number, external ID or device ID",enterButton:"Search",onSearch:h,loading:o})})}),(0,r.jsxs)("div",{className:"mb-4",children:[(!N||g)&&(0,r.jsx)(p.ZK,{tableInstance:x,emptyTableNotice:(0,r.jsx)(l.oj8,{description:void 0===c?"Search for an email, phone number, or device ID.":"No results found.",image:l.oj8.PRESENTED_IMAGE_SIMPLE,imageStyle:{marginBottom:15}})}),N&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(p.ZK,{tableInstance:I})})]})]})]})]})},G=()=>{let e=(0,l.pmc)(),[a,{isFetching:n}]=x();return{downloadReport:async n=>{let{startDate:r,endDate:t}=n,i=await a({startDate:r,endDate:t});if(i.isError)e({status:"error",description:(0,f.e$)(i.error,"A problem occurred while generating your consent report.  Please try again.")});else{let e=document.createElement("a"),a=new Blob([i.data],{type:"text/csv"}),n=window.URL.createObjectURL(a);e.href=n,e.download="consent-reports.csv",e.click(),window.URL.revokeObjectURL(n)}},isDownloadingReport:n}},O=e=>{let{isOpen:a,onClose:n,startDate:t,endDate:i}=e,{downloadReport:o,isDownloadingReport:s}=G(),_=async()=>{await o({startDate:t,endDate:i}),n()};return(0,r.jsxs)(l.u_l,{id:"consent-report-download-modal",isOpen:a,onClose:n,size:"xl",returnFocusOnClose:!1,isCentered:!0,children:[(0,r.jsx)(l.ZAr,{}),(0,r.jsxs)(l.hzk,{children:[(0,r.jsx)(l.olH,{}),(0,r.jsx)(l.xBx,{pb:2,children:"Download consent report"}),(0,r.jsxs)(l.fef,{children:[(0,r.jsx)(l.AntTypography.Paragraph,{children:"The downloaded CSV may differ from the UI in Fides, including column order and naming."}),(0,r.jsx)(l.AntTypography.Paragraph,{children:'For large datasets, file generation may take a few minutes after selecting "Download".'}),(0,r.jsx)(l.jqI,{justify:"flex-end",children:(0,r.jsx)(l.wpx,{loading:s,onClick:_,"data-testid":"download-report-btn",type:"primary",className:"mb-2",children:"Download"})})]})]})]})},B=e=>{let{isOpen:a,onClose:n,tcfPreferences:o}=e,{tcfColumns:s,mapTcfPreferencesToRowColumns:_,filterTcfConsentPreferences:c}=w(),d=c(_(o)),u=(0,t.b7)({getCoreRowModel:(0,i.sC)(),data:d||[],columns:s,getRowId:e=>"".concat(e.key,"-").concat(e.id),manualPagination:!0});return(0,r.jsxs)(l.u_l,{id:"consent-lookup-modal",isOpen:a,onClose:n,size:"4xl",returnFocusOnClose:!1,isCentered:!0,children:[(0,r.jsx)(l.ZAr,{}),(0,r.jsxs)(l.hzk,{"data-testid":"consent-tcf-detail-modal",children:[(0,r.jsx)(l.olH,{}),(0,r.jsx)(l.xBx,{pb:2,children:"TCF Consent Details"}),(0,r.jsx)(l.fef,{children:(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(p.ZK,{tableInstance:u,emptyTableNotice:(0,r.jsx)(l.oj8,{description:" No data found",image:l.oj8.PRESENTED_IMAGE_SIMPLE,imageStyle:{marginBottom:15}})})})})]})]})},L=n(8411),D=n(72625);let K=(0,i.Cl)();var z=e=>{let{onTcfDetailViewClick:a}=e;return(0,_.useMemo)(()=>[K.accessor(e=>e.fides_user_device_id,{id:"fides_user_device_id",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"User device ID",...e}),enableSorting:!1}),K.accessor(e=>e.user_geography,{id:"user_geography",cell:e=>{let{getValue:a}=e,n=a(),t=n&&(0,l.QCN)(n),i=n&&L.Z8[n]||n,o=t?(0,l.c1K)({isoEntry:t}):i;return(0,r.jsx)(p.G3,{value:o})},header:e=>(0,r.jsx)(p.Rr,{value:"User geography",...e}),enableSorting:!1}),K.accessor(e=>e.preference,{id:"preference",cell:e=>{let{getValue:n,row:t}=e,i=n(),o=i&&y[i]||i,s=i&&N[i]||void 0;return"tcf"===i&&t.original.tcf_preferences?(0,r.jsx)(l.j8w,{color:s,closeIcon:(0,r.jsx)(l.PJP.daM,{}),closeButtonLabel:"View details",onClose:()=>a(t.original.tcf_preferences),children:o}):(0,r.jsx)(p.A4,{color:s,value:o})},header:e=>(0,r.jsx)(p.Rr,{value:"Preference",...e}),enableSorting:!1,size:100}),K.accessor(e=>e.notice_name,{id:"notice_name",cell:e=>{let{getValue:a}=e,n=a(),t="tcf"===n?n.toUpperCase():n;return(0,r.jsx)(p.G3,{value:t})},header:e=>(0,r.jsx)(p.Rr,{value:"Privacy notice",...e}),enableSorting:!1}),K.accessor(e=>e.method,{id:"method",cell:e=>{let{getValue:a}=e,n=a(),t=n&&I[n]||n;return(0,r.jsx)(p.G3,{value:t})},header:e=>(0,r.jsx)(p.Rr,{value:"Method",...e}),enableSorting:!1,size:100}),K.accessor(e=>e.request_origin,{id:"request_origin",cell:e=>{let{getValue:a}=e,n=a(),t=n&&M[n]||n;return(0,r.jsx)(p.G3,{value:t})},header:e=>(0,r.jsx)(p.Rr,{value:"Request origin",...e}),enableSorting:!1,size:120}),K.accessor(e=>e.request_timestamp,{id:"request_timestamp",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(D.Cy,{time:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Request timestamp",...e}),size:120}),K.accessor(e=>e.url_recorded,{id:"url_recorded",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Recorded URL",...e})}),K.accessor(e=>e.external_id,{id:"external_id",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"External ID",...e}),enableSorting:!1}),K.accessor(e=>e.email,{id:"email",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:(0,r.jsx)(l.AntTypography.Link,{href:"mailto:".concat(a()),children:a()})})},header:e=>(0,r.jsx)(p.Rr,{value:"Email",...e}),enableSorting:!1}),K.accessor(e=>e.id,{id:"id",cell:e=>{let{getValue:a}=e;return(0,r.jsx)(p.G3,{value:a()})},header:e=>(0,r.jsx)(p.Rr,{value:"Preference ID",...e}),enableSorting:!1})],[a])},V=()=>{var e,a;let n=(0,d.h0)(),{pageIndex:o,pageSize:m,updatePageIndex:S}=n,g=(0,_.useMemo)(()=>s()(),[]),[x,j]=(0,_.useState)(null),[v,b]=(0,_.useState)(null),[f,A]=(0,_.useState)(!1),[y,N]=(0,_.useState)(!1),[I,M]=(0,_.useState)(!1),[P,T]=(0,_.useState)(),E=(0,l.pmc)(),{data:R,isLoading:U,isFetching:w,refetch:G}=C({page:o,size:m,startDate:x,endDate:v,includeTotal:!1}),{items:L}=(0,_.useMemo)(()=>R||{items:[],total:0,pages:0},[R]),D=z({onTcfDetailViewClick:e=>{M(!0),T(e)}}),K=(0,t.b7)({getCoreRowModel:(0,i.sC)(),data:L,columns:D,getRowId:e=>"".concat(e.id),manualPagination:!0}),V=async()=>{S(1),await G(),E((0,h.t5)("Consent report refreshed successfully.","Report Refreshed"))};return(0,r.jsxs)(c.Z,{title:"Consent reporting",children:[(0,r.jsx)(u.Z,{heading:"Consent reporting",rightContent:(0,r.jsx)(l.wpx,{type:"primary",onClick:V,loading:w,children:"Refresh"})}),(0,r.jsx)("div",{"data-testid":"consent-reporting",className:"overflow-auto",children:(0,r.jsxs)(l.jqI,{vertical:!0,gap:"middle",children:[U?(0,r.jsx)("div",{className:"border p-2",children:(0,r.jsx)(p.I4,{rowHeight:26,numRows:10})}):(0,r.jsxs)("div",{children:[(0,r.jsxs)(p.Q$,{children:[(0,r.jsx)(l.gwi,{placeholder:["From","To"],maxDate:g,"data-testid":"input-date-range",onChange:e=>{j(e&&e[0]),b(e&&e[1])}}),(0,r.jsxs)(l.jqI,{gap:12,children:[(0,r.jsx)(l.wpx,{icon:(0,r.jsx)(l.PJP.UWx,{}),"data-testid":"download-btn",onClick:()=>N(!0),"aria-label":"Download Consent Report"}),(0,r.jsx)(l.S0p,{menu:{items:[{key:"1",label:(0,r.jsx)("span",{"data-testid":"consent-preference-lookup-btn",children:"Consent preference lookup"}),onClick:()=>A(!0)}]},overlayStyle:{width:"220px"},trigger:["click"],children:(0,r.jsx)(l.wpx,{"aria-label":"Menu",icon:(0,r.jsx)(l.PJP.r43,{}),"data-testid":"consent-reporting-dropdown-btn"})})]})]}),(0,r.jsx)(p.ZK,{tableInstance:K,emptyTableNotice:(0,r.jsx)(l.oj8,{description:"No results.",image:l.oj8.PRESENTED_IMAGE_SIMPLE,styles:{image:{marginBottom:15}}})})]}),(0,r.jsx)(F,{disableNext:(null!==(a=null==R?void 0:null===(e=R.items)||void 0===e?void 0:e.length)&&void 0!==a?a:0)<m,pagination:n})]})}),(0,r.jsx)(k,{isOpen:f,onClose:()=>A(!1)}),(0,r.jsx)(O,{isOpen:y,onClose:()=>N(!1),startDate:x,endDate:v}),(0,r.jsx)(B,{isOpen:I,onClose:()=>{M(!1),T(void 0)},tcfPreferences:P})]})}}},function(e){e.O(0,[431,7245,2888,9774,179],function(){return e(e.s=15806)}),_N_E=e.O()}]);
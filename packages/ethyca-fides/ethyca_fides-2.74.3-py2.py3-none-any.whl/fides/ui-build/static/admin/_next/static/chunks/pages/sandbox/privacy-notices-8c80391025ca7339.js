(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7093],{16207:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sandbox/privacy-notices",function(){return n(98109)}])},58754:function(e,t,n){"use strict";var s=n(24246),r=n(98227),i=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:a=!0,children:l,rightContent:c,style:o,...d}=e;return(0,s.jsxs)("div",{...d,style:a?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...o}:{paddingBottom:"24px",...o},children:[(0,s.jsxs)(r.jqI,{justify:"space-between",children:["string"==typeof t?(0,s.jsx)(r.lQT,{className:n||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,c&&(0,s.jsx)("div",{"data-testid":"page-header-right-content",children:c})]}),!!n&&(0,s.jsx)(i.m,{className:l?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),l]})}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var s=n(24246),r=n(98227),i=n(79894),a=n.n(i),l=n(27378);let{Text:c}=r.AntTypography,o=e=>{let{items:t,...n}=e,i=(0,l.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let i=n===t.length-1,l={...e},o=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,s.jsx)(c,{style:{color:"inherit",maxWidth:i?void 0:400},ellipsis:!i,id:i?"breadcrumb-current-page":void 0,children:l.title})),o)?l.title=(0,s.jsx)(r.wpx,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,s.jsx)(a(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,s.jsx)(r.zrq,{items:i,...n})}},98109:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var s=n(24246),r=n(98227),i=n(27378),a=n(58754),l=e=>{let{isEnabled:t,onToggle:n}=e;return(0,s.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,s.jsx)(r.AntTypography.Text,{className:"text-sm font-medium",children:"Cascade consent to children:"}),(0,s.jsx)(r.rsf,{isChecked:t,onChange:e=>n(e.target.checked),size:"sm"})]})},c=e=>{let{mechanism:t,onMechanismChange:n}=e,a=(0,i.useCallback)(e=>{n(e.target.value)},[n]);return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)(r.AntTypography.Text,{className:"text-sm font-medium",children:"Consent Mechanism:"}),(0,s.jsxs)(r.y02.Group,{onChange:a,value:t,className:"ml-2",children:[(0,s.jsx)(r.y02,{value:"opt-out",children:"Opt-out"}),(0,s.jsx)(r.y02,{value:"opt-in",children:"Opt-in"})]}),(0,s.jsxs)(r.AntTypography.Text,{type:"secondary",className:"ml-2 text-xs",children:["(","opt-out"===t?"All checked by default":"All unchecked by default",")"]})]})},o=e=>{let{title:t,height:n="400px",children:i}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-4 block text-base",children:t}),(0,s.jsx)("div",{className:"overflow-auto rounded-lg border border-gray-200 bg-gray-50 p-4 font-mono text-xs",style:{height:n},children:i})]})},d=e=>{let{dbState:t}=e;return(0,s.jsxs)(o,{title:"Current DB State",children:[(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-2 block text-sm text-purple-600",children:"Raw DB State"}),(0,s.jsx)("pre",{className:"m-0 whitespace-pre-wrap",children:JSON.stringify(t,null,2)})]})};let p="email_marketing",u="".concat(p,"-a1b2c3d4-e5f6-7890-abcd-ef1234567890"),h=[{title:"reward_points",key:"reward_points-b2c3d4e5-f6g7-8901-bcde-f23456789012"},{title:"current_account_benefits",key:"current_account_benefits-c3d4e5f6-g7h8-9012-cdef-345678901234"},{title:"credit_card_offers",key:"credit_card_offers-d4e5f6g7-h8i9-0123-defg-456789012345"},{title:"checking_and_saving_offers",key:"checking_and_saving_offers-e5f6g7h8-i9j0-1234-efgh-567890123456"},{title:"credit_monitoring",key:"credit_monitoring-f6g7h8i9-j0k1-2345-fghi-678901234567"},{title:"auto_financing",key:"auto_financing-g7h8i9j0-k1l2-3456-ghij-789012345678"}],x=[u,...h.map(e=>e.key)],m=[u];var y=e=>{let{checkedKeys:t,onCheckedKeysChange:n,cascadeConsent:a}=e,[l,c]=(0,i.useState)(m),[o,d]=(0,i.useState)(!0),x=(0,i.useCallback)(e=>Array.isArray(e)?e:e.checked||[],[]),y=!(0,i.useCallback)(e=>x(e).includes(u),[x])(t),g=(0,i.useCallback)(e=>{c(e),d(!1)},[]),f=(0,i.useCallback)(e=>{let s=x(e),r=x(t).includes(u),i=s.includes(u);if(a&&r!==i){let e=h.map(e=>e.key);i?n([...s,...e]):n(s.filter(t=>!e.includes(t)))}else n(e)},[n,a,t,x]),k=(0,i.useMemo)(()=>[{title:p,key:u,children:h.map(e=>({title:e.title,key:e.key,disabled:y}))}],[y]);return(0,s.jsx)(r.a$q,{checkable:!0,checkStrictly:!0,onExpand:g,expandedKeys:l,autoExpandParent:o,onCheck:f,checkedKeys:t,selectable:!1,treeData:k})},g=e=>{let{dbState:t,consentMechanism:n}=e,a=(0,i.useCallback)(()=>{let e;let s=t[p];e=void 0!==s?s:"opt-in"===n?"opt_out":"opt_in";let r=[];return r.push({notice_key:p,preference:e,notice_history_id:u,parent_key:null}),h.forEach(n=>{let s;s="opt_out"===e?"opt_out":t[n.title]||e,r.push({notice_key:n.title,preference:s,notice_history_id:n.key,parent_key:p})}),{preferences:r}},[t,n])();return(0,s.jsxs)(o,{title:"Current Preferences (consolidated)",children:[(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-2 block text-sm text-green-600",children:"GET /api/v3/privacy-preferences/current?notice_key=email_marketing"}),(0,s.jsx)("pre",{className:"m-0 whitespace-pre-wrap",children:JSON.stringify(a,null,2)})]})},f=e=>{let{currentSavedKeys:t,previousSavedKeys:n,cascadeConsent:a}=e,l=(0,i.useCallback)(()=>{let e=Array.isArray(t)?t:t.checked||[],s=Array.isArray(n)?n:n.checked||[],r=x.filter(t=>e.includes(t)!==s.includes(t)),i=r.includes(u),l=a&&i?[u]:r;return 0===l.length?null:{preferences:l.map(t=>{let n;let s=e.includes(t);if(t===u)n=p;else{let e=h.find(e=>e.key===t);n=e?e.title:t.toString()}return{notice_key:n,value:s?"opt_in":"opt_out",notice_history_id:t.toString(),meta:{timestamp:new Date().toISOString()}}})}},[t,n,a])(),c=a&&l?"POST /api/v3/privacy-preferences?override_children=true":"POST /api/v3/privacy-preferences";return(0,s.jsx)(o,{title:"API Calls Preview",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-2 block text-sm text-blue-600",children:c}),(0,s.jsx)("pre",{className:"m-0 whitespace-pre-wrap",children:JSON.stringify(l,null,2)})]}):(0,s.jsx)(r.AntTypography.Text,{type:"secondary",italic:!0,className:"text-sm",children:"No API request made because preferences were not changed from last save."})})};let{Content:k}=r.AntLayout;var b=()=>{let[e,t]=(0,i.useState)("opt-out"),[n,o]=(0,i.useState)(!1),[m,b]=(0,i.useState)(x),[j,_]=(0,i.useState)(x),[v,N]=(0,i.useState)(x),[C,T]=(0,i.useState)({}),A=(0,i.useMemo)(()=>"opt-out"===e?x:[],[e]),S=(0,i.useCallback)(e=>{t(e);let n="opt-out"===e?x:[];b(n),_(n),N(n),T({})},[]),w=(0,i.useCallback)(e=>{o(e),b(A),_(A),N(A),T({})},[A]),E=(0,i.useCallback)(()=>{N(j),_(m);let e=Array.isArray(m)?m:m.checked||[],t=Array.isArray(j)?j:j.checked||[],s=x.filter(n=>e.includes(n)!==t.includes(n));T(t=>{let r={...t};return s.forEach(t=>{var s;let i=t===u?p:(null===(s=h.find(e=>e.key===t))||void 0===s?void 0:s.title)||t.toString(),a=e.includes(t);if(r[i]=a?"opt_in":"opt_out",n&&t===u){let e=a?"opt_in":"opt_out";h.forEach(t=>{r[t.title]=e})}}),r})},[m,j,n]);return(0,s.jsx)(r.AntLayout,{children:(0,s.jsxs)(k,{className:"overflow-auto px-10 py-6",children:[(0,s.jsx)(a.Z,{heading:"Privacy Notices Sandbox"}),(0,s.jsxs)("div",{className:"mt-5 flex gap-6",children:[(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-4 block text-base",children:"Notice configuration"}),(0,s.jsx)(c,{mechanism:e,onMechanismChange:S}),(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-4 block text-base",children:"Consent behavior"}),(0,s.jsx)(l,{isEnabled:n,onToggle:w}),(0,s.jsx)(r.AntTypography.Text,{strong:!0,className:"mb-4 block text-base",children:"User preferences"}),(0,s.jsx)(y,{checkedKeys:m,onCheckedKeysChange:b,cascadeConsent:n}),(0,s.jsx)(r.wpx,{type:"primary",onClick:E,className:"mt-4",children:"Save preferences"})]}),(0,s.jsx)("div",{className:"min-w-0 flex-1",children:(0,s.jsx)(f,{currentSavedKeys:j,previousSavedKeys:v,cascadeConsent:n})})]}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(g,{dbState:C,consentMechanism:e})}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(d,{dbState:C})})]})})}}},function(e){e.O(0,[2888,9774,179],function(){return e(e.s=16207)}),_N_E=e.O()}]);
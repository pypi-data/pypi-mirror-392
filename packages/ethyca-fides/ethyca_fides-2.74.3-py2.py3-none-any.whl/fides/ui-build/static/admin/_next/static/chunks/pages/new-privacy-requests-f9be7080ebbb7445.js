(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9609,9676],{89987:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new-privacy-requests",function(){return i(78293)}])},58754:function(e,t,i){"use strict";var s=i(24246),a=i(98227),n=i(70788);t.Z=e=>{let{heading:t,breadcrumbItems:i,isSticky:r=!0,children:l,rightContent:o,style:c,...d}=e;return(0,s.jsxs)("div",{...d,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...c}:{paddingBottom:"24px",...c},children:[(0,s.jsxs)(a.jqI,{justify:"space-between",children:["string"==typeof t?(0,s.jsx)(a.lQT,{className:i||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,s.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!i&&(0,s.jsx)(n.m,{className:l?"pb-4":void 0,items:i,"data-testid":"page-breadcrumb"}),l]})}},45259:function(e,t,i){"use strict";var s=i(24246),a=i(98227);let n={approved:{color:a.tAb.SUCCESS,label:"Approved"},complete:{color:a.tAb.SUCCESS,label:"Completed"},awaiting_email_send:{color:a.tAb.MARBLE,label:"Awaiting Email Send"},denied:{color:a.tAb.WARNING,label:"Denied"},canceled:{color:a.tAb.MARBLE,label:"Canceled"},error:{color:a.tAb.ERROR,label:"Error"},in_processing:{color:a.tAb.CAUTION,label:"In Progress"},paused:{color:a.tAb.MARBLE,label:"Paused"},pending:{color:a.tAb.INFO,label:"New"},identity_unverified:{color:a.tAb.MARBLE,label:"Unverified"},requires_input:{color:a.tAb.MINOS,label:"Requires Input"},requires_manual_finalization:{color:a.tAb.MINOS,label:"Requires Finalization"},duplicate:{color:a.tAb.DEFAULT,label:"Duplicate"}};t.Z=e=>{let{status:t}=e;return(0,s.jsx)(a.j8w,{color:n[t].color,className:"justify-center","data-testid":"request-status-badge",children:n[t].label})}},70788:function(e,t,i){"use strict";i.d(t,{m:function(){return c}});var s=i(24246),a=i(98227),n=i(79894),r=i.n(n),l=i(27378);let{Text:o}=a.AntTypography,c=e=>{let{items:t,...i}=e,n=(0,l.useMemo)(()=>null==t?void 0:t.map((e,i)=>{let n=i===t.length-1,l={...e},c=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,s.jsx)(o,{style:{color:"inherit",maxWidth:n?void 0:400},ellipsis:!n,id:n?"breadcrumb-current-page":void 0,children:l.title})),c)?l.title=(0,s.jsx)(a.wpx,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,s.jsx)(r(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,s.jsx)(a.zrq,{items:n,...i})}},42478:function(e,t,i){"use strict";i.d(t,{FU:function(){return c},JE:function(){return a},Ki:function(){return u},SU:function(){return g},W:function(){return p},h9:function(){return n},jc:function(){return s},qt:function(){return o},sn:function(){return d}});let{useGetEmailInviteStatusQuery:s,useGetActiveMessagingProviderQuery:a,useCreateMessagingConfigurationMutation:n,useCreateMessagingConfigurationSecretsMutation:r,useGetMessagingConfigurationDetailsQuery:l,useGetMessagingConfigurationsQuery:o,useGetMessagingConfigurationByKeyQuery:c,useUpdateMessagingConfigurationByKeyMutation:d,useUpdateMessagingConfigurationSecretsByKeyMutation:u,useCreateTestConnectionMessageMutation:g,useDeleteMessagingConfigurationByKeyMutation:p}=i(78780).u.injectEndpoints({endpoints:e=>({getEmailInviteStatus:e.query({query:()=>({url:"/messaging/email-invite/status"}),providesTags:()=>["Email Invite Status"]}),createMessagingConfiguration:e.mutation({query:e=>({url:"messaging/config",method:"POST",body:e}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getActiveMessagingProvider:e.query({queryFn:async(e,t,i,s)=>{let a=await s({url:"messaging/default/active"});return a.error&&404===a.error.status?{data:null}:a},providesTags:["Messaging Config"]}),createMessagingConfigurationSecrets:e.mutation({query:e=>({url:"messaging/default/".concat(e.service_type,"/secret"),method:"PUT",body:e.details}),invalidatesTags:["Messaging Config","Configuration Settings"]}),getMessagingConfigurationDetails:e.query({query:e=>({url:"messaging/default/".concat(e.type)}),providesTags:["Messaging Config"]}),getMessagingConfigurations:e.query({query:()=>({url:"messaging/config"}),providesTags:["Messaging Config"]}),getMessagingConfigurationByKey:e.query({query:e=>({url:"messaging/config/".concat(e.key)}),providesTags:["Messaging Config"]}),createTestConnectionMessage:e.mutation({query:e=>({url:"messaging/test/".concat(e.service_type),method:"POST",body:e.details}),invalidatesTags:["Messaging Config"]}),updateMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"PATCH",body:e.config}),invalidatesTags:["Messaging Config","Configuration Settings"]}),updateMessagingConfigurationSecretsByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key,"/secret"),method:"PUT",body:e.secrets}),invalidatesTags:["Messaging Config","Configuration Settings"]}),deleteMessagingConfigurationByKey:e.mutation({query:e=>({url:"messaging/config/".concat(e.key),method:"DELETE"}),invalidatesTags:["Messaging Config","Configuration Settings"]})})})},59676:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return y}});var s=i(24246),a=i(98227),n=i(16134),r=i(27378),l=i(812),o=i(17245),c=i(90867);let d=(0,a.Gpc)((e,t)=>{let{handleBlur:i,subjectRequest:d}=e,u=(0,n.T)(),[g,p]=(0,r.useState)(!1),{errorAlert:m,successAlert:f}=(0,o.VY)(),{errorRequests:h}=(0,n.C)(c.fe),[x]=(0,c.JD)(),[y]=(0,c.Fq)(),j=async()=>{p(!0);let e=await x(h);(0,l.D4)(e)?(u((0,c.uT)({checkAll:!1,errorRequests:[]})),m((0,l.e$)(e.error),"DSR batch automation has failed due to the following:",{duration:null})):(e.data.failed.length>0&&m((0,s.jsxs)(a.xuv,{children:["DSR automation has failed for"," ",(0,s.jsx)(a.xvT,{as:"span",fontWeight:"semibold",children:e.data.failed.length})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null}),e.data.succeeded.length>0&&f("Privacy request(s) are now being reprocessed.")),p(!1)},v=async()=>{if(!d)return;p(!0);let e=await y(d);(0,l.D4)(e)?m((0,l.e$)(e.error),"DSR automation has failed for this privacy request due to the following:",{duration:null}):f("Privacy request is now being reprocessed."),p(!1),i&&i(t)};return(0,s.jsx)(a.wpx,{disabled:g,loading:g,onClick:d?v:j,ref:t,size:"small",icon:(0,s.jsx)(a.AyE,{}),children:"Reprocess"})});var u=i(34090),g=i(55484);let p=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,m=e=>p.test(e),f=(0,a.Gpc)((e,t)=>{let{isRequired:i=!1,...n}=e,{emails:l}=n.form.values,[o,c]=(0,r.useState)(""),d=e=>l.includes(e),u=e=>{e.map(e=>e.trim()).filter(e=>m(e)&&!d(e)).forEach(e=>n.push(e)),c("")};return(0,s.jsxs)(a.NIc,{alignItems:"baseline",display:"inline-flex",isInvalid:!!n.form.errors[n.name],isRequired:i,children:[(0,s.jsx)(a.lXp,{fontSize:"md",htmlFor:"email",children:"Email"}),(0,s.jsxs)(a.gCW,{align:"flex-start",w:"inherit",children:[(0,s.jsx)(a.IIB,{autoComplete:"off",placeholder:"Type or paste email addresses separated by commas and press `Enter` or `Tab`...",onChange:e=>{c(e.target.value)},onKeyDown:e=>{["Enter","Tab",","].includes(e.key)&&(e.preventDefault(),u([o]))},onPaste:e=>{e.preventDefault(),u(e.clipboardData.getData("text").split(","))},ref:t,size:"sm",type:"email",value:o}),(0,s.jsx)(a.J1D,{children:n.form.errors[n.name]}),l.length>0&&(0,s.jsx)(a.Eq9,{spacing:1,mb:3,pt:"8px",children:l.map((e,t)=>(0,s.jsxs)(a.Vp9,{borderRadius:"full",backgroundColor:"primary.400",color:"white",size:"sm",variant:"solid",children:[(0,s.jsx)(a.Sn0,{children:e}),(0,s.jsx)(a.SD9,{onClick:()=>{n.remove(t)}})]},e))})]})]})}),h=g.Ry().shape({emails:g.IX(g.Z_()).when(["notify"],{is:!0,then:()=>g.IX(g.Z_()).min(1,"Must enter at least one valid email").label("Email")}),notify:g.O7(),minErrorCount:g.Rx().required()});var x=()=>{let{isOpen:e,onOpen:t,onClose:i}=(0,a.qY0)(),[n,d]=(0,r.useState)({emails:[],notify:!1,minErrorCount:1}),g=(0,r.useRef)(null),{errorAlert:p,successAlert:m}=(0,o.VY)(),[x,y]=(0,r.useState)(!0),{data:j}=(0,c.tE)(void 0,{skip:x}),[v]=(0,c.SC)(),b=async(e,t)=>{t.setSubmitting(!0);let s=await v({email_addresses:e.emails,notify_after_failures:e.notify?e.minErrorCount:0});(0,l.D4)(s)?p((0,l.e$)(s.error),"Configure alerts and notifications has failed to save due to the following:"):m("Configure alerts and notifications saved successfully."),t.setSubmitting(!1),i()};return(0,r.useEffect)(()=>{e&&y(!1),j&&d({emails:j.email_addresses,notify:0!==j.notify_after_failures,minErrorCount:j.notify_after_failures})},[j,e]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.wpx,{onClick:t,title:"Configure alerts","aria-label":"Configure alerts",icon:(0,s.jsx)(a.Dkj,{})}),(0,s.jsx)(u.J9,{enableReinitialize:!0,initialValues:n,onSubmit:b,validationSchema:h,children:t=>(0,s.jsxs)(a.dys,{isOpen:e,placement:"right",initialFocusRef:g,onClose:()=>{t.resetForm(),i()},size:"lg",children:[(0,s.jsx)(a.P1B,{}),(0,s.jsxs)(a.scA,{color:"gray.900",children:[(0,s.jsx)(a.cCv,{}),(0,s.jsxs)(a.OXI,{color:"gray.900",children:[(0,s.jsx)(a.xvT,{fontSize:"2xl",fontWeight:"normal",mb:4,children:"Configure alerts and notifications"}),(0,s.jsx)(a.xuv,{mt:"26px",children:(0,s.jsx)(a.xvT,{fontSize:"md",fontWeight:"normal",children:"Setup your alerts to send you a notification when there are any processing failures. You can also setup a threshold for connector failures for Fides to notify you after X amount of failures have occurred."})})]}),(0,s.jsx)(a.Ng0,{mt:"20px",children:(0,s.jsxs)(u.l0,{id:"configure-alerts-form",noValidate:!0,children:[(0,s.jsx)(a.xvT,{fontSize:"md",children:"Contact details"}),(0,s.jsxs)(a.gCW,{align:"stretch",gap:"29px",mt:"14px",children:[(0,s.jsx)(a.Ugi,{children:(0,s.jsx)(u.F2,{name:"emails",render:e=>(0,s.jsx)(f,{...e,isRequired:t.values.notify,ref:g})})}),(0,s.jsx)(a.Ugi,{children:(0,s.jsx)(u.gN,{id:"notify",name:"notify",children:e=>{let{field:i}=e;return(0,s.jsxs)(a.NIc,{alignItems:"center",display:"flex",mt:"45px",children:[(0,s.jsx)(a.lXp,{fontSize:"md",mb:"0",children:"Notify me immediately if there are any DSR processing errors"}),(0,s.jsx)(a.rAg,{checked:t.values.notify,onChange:(e,s)=>{i.onChange(s),t.setFieldValue(i.name,e),t.setFieldValue("minErrorCount",1),e||setTimeout(()=>{t.setFieldTouched("emails",!1)},0)}})]})}})})]}),(0,s.jsx)(a.xvT,{color:"#757575",fontSize:"sm",mt:"11px",children:"If selected, then Fides will notify you by your chosen method of communication every time the system encounters a data subject request processing error. You can turn this off anytime and setup a more suitable notification method below if you wish."}),t.values.notify&&(0,s.jsx)(a.Ugi,{mt:"34px",children:(0,s.jsx)(u.gN,{id:"minErrorCount",name:"minErrorCount",children:e=>{let{field:i,meta:n}=e;return(0,s.jsxs)(a.NIc,{alignItems:"center",display:"flex",isInvalid:!!(n.error&&n.touched),isRequired:!0,children:[(0,s.jsx)(a.xvT,{children:"Notify me after"}),(0,s.jsxs)(a.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:t.values.minErrorCount||1,min:1,ml:"8px",mr:"8px",onChange:(e,i)=>{t.setFieldValue("minErrorCount",i)},size:"sm",w:"80px",children:[(0,s.jsx)(a.zuI,{...i}),(0,s.jsxs)(a.FiK,{children:[(0,s.jsx)(a.WQu,{}),(0,s.jsx)(a.Y_d,{})]})]}),(0,s.jsx)(a.xvT,{children:"DSR processing errors "})]})}})})]})}),(0,s.jsx)(a.zeN,{justifyContent:"flex-start",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(a.wpx,{onClick:()=>{t.resetForm(),i()},children:"Cancel"}),(0,s.jsx)(a.wpx,{form:"configure-alerts-form",disabled:t.isSubmitting,loading:t.isSubmitting,htmlType:"submit",children:"Save"})]})})]})]})})]})},y=()=>{let{errorRequests:e}=(0,n.C)(c.fe);return(0,s.jsxs)(a.kCb,{gap:4,children:[(null==e?void 0:e.length)>0&&(0,s.jsx)(d,{}),(0,s.jsx)(x,{})]})}},78293:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return er}});var s,a,n=i(24246),r=i(98227),l=i(27378),o=i(25980),c=i(35287),d=i(58754),u=i(19904),g=i(28686),p=i(59676),m=i(3124),f=i.n(m);let{Text:h}=r.AntTypography,x=e=>{let{selectedIds:t,menuItems:i}=e,s=t.length>0;return(0,n.jsxs)(r.jqI,{gap:8,align:"center",children:[s&&(0,n.jsxs)(h,{type:"secondary","data-testid":"selected-count",children:[t.length," selected"]}),(0,n.jsx)(r.S0p,{menu:{items:i},disabled:!s,children:(0,n.jsxs)(r.wpx,{"data-testid":"bulk-actions-btn",disabled:!s,children:["Actions",(0,n.jsx)(r.PJP._ME,{})]})})]})},y=()=>{let[e,t]=(0,l.useState)([]),i=(0,l.useCallback)(()=>{t([])},[]);return{selectedIds:e,setSelectedIds:t,clearSelectedIds:i}};var j=i(14048),v=i(47935),b=i(90867),E=i(9270),q=i(16394),C=i(65735);(s=a||(a={})).APPROVE="approve",s.DENY="deny",s.DELETE="delete";let _={[C.q2.PENDING]:["approve","deny","delete"],[C.q2.IDENTITY_UNVERIFIED]:["delete"],[C.q2.REQUIRES_INPUT]:["delete"],[C.q2.APPROVED]:["delete"],[C.q2.DENIED]:["delete"],[C.q2.IN_PROCESSING]:["delete"],[C.q2.COMPLETE]:["delete"],[C.q2.PAUSED]:["delete"],[C.q2.AWAITING_EMAIL_SEND]:["delete"],[C.q2.REQUIRES_MANUAL_FINALIZATION]:["delete"],[C.q2.CANCELED]:["delete"],[C.q2.ERROR]:["delete"],[C.q2.DUPLICATE]:["delete"]},I=e=>_[e.status],S=(e,t)=>t.some(t=>I(t).includes(e)),P=e=>{let{form:t}=e;return(0,n.jsx)(r.PPS,{form:t,layout:"vertical",children:(0,n.jsx)(r.PPS.Item,{name:"denialReason",rules:[{required:!0,message:"Please enter a reason for denial"}],children:(0,n.jsx)(r.AntInput.TextArea,{placeholder:"Enter reason for denial...",rows:4})})})},w=e=>{let{openFormModal:t}=(0,r.U8S)(e);return{openDenyPrivacyRequestModal:(0,l.useCallback)(async e=>{let i=await t({title:"Privacy request denial",content:t=>(0,n.jsxs)(r.jqI,{vertical:!0,gap:2,children:[e&&(0,n.jsx)(r.FUI,{children:e}),(0,n.jsx)(r.FUI,{children:"Please enter a reason for denying this privacy request. Please note: this can be seen by the user in their notification email."}),(0,n.jsx)(P,{form:t})]}),okText:"Confirm",cancelText:"Cancel",width:500,centered:!0});return i?null==i?void 0:i.denialReason:null},[t])}},A={[a.APPROVE]:"approved",[a.DENY]:"denied",[a.DELETE]:"deleted"},T={[a.APPROVE]:{title:"Approve privacy requests",verb:"approve"},[a.DENY]:{title:"Privacy request denial",verb:"deny"},[a.DELETE]:{title:"Delete privacy requests",verb:"delete",okType:"danger"}},R=(e,t,i)=>{let s=A[e];return i>0&&t>0?{type:"warning",message:"Successfully ".concat(s," ").concat(t," ").concat((0,q._6)(t,"request","requests"),". ").concat(i," ").concat((0,q._6)(i,"request","requests")," failed.")}:i>0?{type:"error",message:"Failed to ".concat(e," ").concat(i," ").concat((0,q._6)(i,"request","requests"),".")}:{type:"success",message:"Successfully ".concat(s," ").concat(t," privacy ").concat((0,q._6)(t,"request","requests"))}},D=e=>{let{requests:t,selectedIds:i,clearSelectedIds:s,messageApi:o,modalApi:c}=e,d=(0,l.useMemo)(()=>t.filter(e=>i.includes(e.id)),[t,i]);(0,l.useEffect)(()=>{s()},[t,s]);let[u]=(0,b.AG)(),[g]=(0,b.ZZ)(),[p]=(0,b.AL)(),{openDenyPrivacyRequestModal:m}=w(c),f=(0,l.useCallback)(async e=>{let t;let i=d.length,s=d.filter(t=>I(t).includes(e)),n=s.length;t=n===i?"You are about to ".concat(T[e].verb," ").concat(i," privacy ").concat((0,q._6)(i,"request","requests"),". Are you sure you want to continue?"):"You have selected ".concat(i," ").concat((0,q._6)(i,"request","requests"),", but only ").concat(n," ").concat((0,q._6)(n,"request","requests")," can perform this action. If you continue, the bulk action will only be applied to ").concat(n," ").concat((0,q._6)(n,"request","requests"),".");let r=s.map(e=>e.id);if(e===a.DENY){let i=await m(t);if(!i)return;let s=r.length,a=o.loading("Executing bulk action on ".concat(s," privacy ").concat((0,q._6)(s,"request","requests"),"..."),0),n=await g({request_ids:r,reason:i});if(a(),"error"in n)o.error("Failed to deny requests. Please try again.",5);else if("data"in n){var l,f;let{type:t,message:i}=R(e,(null===(l=n.data.succeeded)||void 0===l?void 0:l.length)||0,(null===(f=n.data.failed)||void 0===f?void 0:f.length)||0);o[t](i,5)}}else c.confirm({title:T[e].title,content:t,okText:"Continue",cancelText:"Cancel",okType:T[e].okType,onOk:async()=>{let t;if(0===r.length)return;let i=r.length,s=o.loading("Executing bulk action on ".concat(i," privacy ").concat((0,q._6)(i,"request","requests"),"..."),0);if(e===a.APPROVE?t=await u({request_ids:r}):e===a.DELETE&&(t=await p({request_ids:r})),s(),t){if("error"in t){let t=e===a.APPROVE?"approve":"delete";o.error("Failed to ".concat(t," requests. Please try again."),5)}else if("data"in t){var n,l;let{type:i,message:s}=R(e,(null===(n=t.data.succeeded)||void 0===n?void 0:n.length)||0,(null===(l=t.data.failed)||void 0===l?void 0:l.length)||0);o[i](s,5)}}}})},[d,m,g,u,p,o,c]);return{bulkActionMenuItems:(0,l.useMemo)(()=>{let e=S(a.APPROVE,d),t=S(a.DENY,d),i=S(a.DELETE,d);return[{key:a.APPROVE,label:"Approve",icon:(0,n.jsx)(r.PJP.MCw,{}),onClick:()=>f(a.APPROVE),disabled:!e},{key:a.DENY,label:"Deny",icon:(0,n.jsx)(r.PJP.x8P,{}),onClick:()=>f(a.DENY),disabled:!t},{type:"divider"},{key:a.DELETE,label:"Delete",icon:(0,n.jsx)(r.PJP.ZNm,{}),danger:!0,onClick:()=>f(a.DELETE),disabled:!i}]},[d,f])}};var N=i(40431),k=e=>{let{pagination:t}=e,[i,s]=(0,N.v1)("search",N.Oi.withOptions({throttleMs:300})),[a,n]=(0,N.XI)({from:N.Oi,to:N.Oi,status:(0,N.S$)((0,N.jx)(Object.values(C.q2))),action_type:(0,N.S$)((0,N.jx)(Object.values(C.Us)))},{history:"push"}),r=(0,l.useMemo)(()=>Object.values({...a,to:void 0}).filter(e=>e&&e.length>0).length,[a]),[o,c]=(0,N.XI)({sort_field:N.Oi,sort_direction:(0,N.jx)(Object.values(C.AV))},{history:"push"}),d=(0,l.useMemo)(()=>({fuzzy_search_str:i,from:a.from,to:a.to,status:a.status,action_type:a.action_type,sort_field:o.sort_field,sort_direction:o.sort_direction}),[i,a.from,a.to,a.status,a.action_type,o.sort_field,o.sort_direction]),{resetPagination:u}=t;return(0,l.useEffect)(()=>{u()},[d,u]),{fuzzySearchTerm:i,setFuzzySearchTerm:s,modalFilters:a,modalFiltersCount:r,setModalFilters:n,sortState:o,setSortState:c,filterQueryParams:d}},M=i(19785),F=i.n(M),O=i(65567),Y=i.n(O),U=i(98855),L=i(90449),z=i(27693),V=i.n(z);let Z=[C.q2.COMPLETE,C.q2.CANCELED,C.q2.DENIED,C.q2.IDENTITY_UNVERIFIED],K=e=>{let{status:t,daysLeft:i,timeframe:s=45}=e;if(null!=i&&null!=s&&!Z.includes(t)){let e=100*i/s<25?r.tAb.ERROR:r.tAb.DEFAULT;return(0,n.jsx)("div",{children:(0,n.jsx)(r.j8w,{color:e,bordered:!1,children:(0,n.jsx)(r.esZ,{title:(0,q.p6)(V()().add(i,"day").toDate()),children:(0,n.jsxs)(n.Fragment,{children:[i," days left"]})})})})}return null};var W=i(86677),B=i(77830),X=i(45259),G=i(71784);let J=e=>{var t;let{privacyRequest:i}=e,s=(0,W.useRouter)();return(0,n.jsxs)(r.jqI,{gap:12,wrap:!0,align:"center",children:[(0,n.jsx)("div",{className:"flex min-w-[100px] gap-2",children:(0,n.jsx)(r.AntTypography.Title,{level:3,children:(0,n.jsxs)(r.AntTypography.Link,{href:"/privacy-requests/".concat(i.id),variant:"primary",onClick:e=>{e.preventDefault(),s.push({pathname:B.ld,query:{id:i.id}})},children:[null===(t=i.policy.rules)||void 0===t?void 0:t.map(e=>G.rE.get(e.action_type)).join("/")," ","request"]})})}),(0,n.jsx)(X.Z,{status:i.status}),(0,n.jsx)(r.AntTypography.Text,{type:"secondary",copyable:{text:i.id,icon:(0,n.jsx)(r.PJP.CKM,{className:"size-4 text-[var(--ant-color-text-secondary)]"}),tooltips:["Copy request ID","Copied"]},children:i.id})]})},Q=e=>{let{label:t,children:i}=e;return(0,n.jsxs)(r.jqI,{gap:"small",wrap:!0,children:[(0,n.jsxs)(r.lKn,{type:"secondary",children:[t,":"]}),(0,n.jsx)(r.lKn,{ellipsis:{tooltip:!0},className:"!max-w-60",children:i})]})};var $=i(51980);let H=e=>{let{createdAt:t}=e;return t?(0,n.jsx)(Q,{label:"Received",children:(0,n.jsx)(r.lKn,{type:"secondary",children:(0,n.jsx)(r.esZ,{title:(0,q.p6)(new Date(t)),children:(0,q.G8)((0,$.B)(new Date(t),new Date,{addSuffix:!0}))})})}):null},ee=e=>{let{item:t,checkbox:i}=e,s=(0,L.o8)(t.identity),a=(0,L.Ub)(t.identity,s),l=(0,L.aP)(t.custom_privacy_request_fields),o=a.length>0||l.length>0||!!t.location,c=t.location?(()=>{try{return(0,r.QCN)(t.location)}catch(e){return}})():void 0;return(0,n.jsxs)(r.krs.Item,{children:[(0,n.jsx)("div",{className:"pr-4",children:i}),(0,n.jsxs)(r.jqI,{vertical:!0,gap:"small",className:"grow pr-8",children:[(0,n.jsx)(J,{privacyRequest:t}),(0,n.jsxs)(r.jqI,{vertical:!0,gap:"small",wrap:!0,children:[(0,n.jsxs)(r.jqI,{gap:"small",wrap:!0,children:[s&&(0,n.jsx)(Q,{label:s.label,children:s.value}),(0,n.jsx)(r.j8w,{children:t.policy.name}),(0,n.jsx)(r.j8w,{children:t.source})]}),o&&(0,n.jsxs)(r.jqI,{wrap:!0,className:"gap-x-3 gap-y-2",children:[t.location&&(0,n.jsx)(Q,{label:"Location",children:c?(0,r.c1K)({isoEntry:c,showFlag:!0}):t.location},"location"),a.map(e=>(0,n.jsx)(Q,{label:e.label,children:e.value},e.key)),l.map(e=>(0,n.jsx)(Q,{label:e.label,children:F()(e.value)?e.value.join(" - "):Y()(e.value)},e.key))]})]})]}),(0,n.jsxs)("div",{className:"flex shrink-0 flex-col items-end gap-2 pr-2 2xl:flex-row 2xl:gap-4",children:[(0,n.jsx)(K,{daysLeft:t.days_left,status:t.status,timeframe:t.policy.execution_timeframe}),(0,n.jsx)(H,{createdAt:t.created_at})]}),(0,n.jsx)(r.jqI,{className:"min-w-[90px]",align:"center",justify:"end",gap:"small",children:(0,n.jsx)(U.q,{subjectRequest:t},"other-actions")})]})},et=e=>{let{open:t,onClose:i,modalFilters:s,setModalFilters:a}=e,[l]=r.PPS.useForm(),o={dateRange:s.from&&s.to?[V()(s.from),V()(s.to)]:s.from?[V()(s.from),null]:s.to?[null,V()(s.to)]:null,status:s.status,action_type:s.action_type},c=async()=>{let e=await l.validateFields(),[t,s]=e.dateRange||[null,null];a({from:t?t.format("YYYY-MM-DD"):"",to:s?s.format("YYYY-MM-DD"):"",status:e.status||[],action_type:e.action_type||[]}),i()};return(0,n.jsx)(r.$zI,{open:t,onCancel:i,title:"All filters",footer:[(0,n.jsx)(r.wpx,{type:"text",onClick:()=>{l.setFieldsValue({dateRange:void 0,status:[],action_type:[]}),a({from:"",to:"",status:[],action_type:[]})},"data-testid":"clear-all-filters-btn","aria-label":"Clear all filters",children:"Clear all"},"clear"),(0,n.jsx)(r.wpx,{type:"primary",onClick:c,"data-testid":"done-filters-btn","aria-label":"Apply filters",children:"Done"},"done")],children:(0,n.jsxs)(r.PPS,{form:l,layout:"vertical",initialValues:o,children:[(0,n.jsx)(r.PPS.Item,{label:"Date range",name:"dateRange",children:(0,n.jsx)(r.cv2.RangePicker,{format:"YYYY-MM-DD","data-testid":"date-range-picker",className:"w-full"})}),(0,n.jsx)(r.PPS.Item,{label:"Status",name:"status",children:(0,n.jsx)(r.WPr,{mode:"multiple",placeholder:"Select status",options:G.I3,"data-testid":"request-status-filter","aria-label":"Status"})}),(0,n.jsx)(r.PPS.Item,{label:"Request type",name:"action_type",children:(0,n.jsx)(r.WPr,{mode:"multiple",placeholder:"Select request type",options:G.kN,"data-testid":"request-action-type-filter","aria-label":"Request type"})})]})})},ei=()=>{let e=(0,E.S)(),{filterQueryParams:t,fuzzySearchTerm:i,setFuzzySearchTerm:s,modalFilters:a,modalFiltersCount:o,setModalFilters:c}=k({pagination:e}),[d,u]=r.Pg3.useMessage(),[g,p]=r.$zI.useModal(),{selectedIds:m,setSelectedIds:h,clearSelectedIds:q}=y(),{isOpen:C,onOpen:_,onClose:I}=(0,r.qY0)(),{data:S,isLoading:P,isFetching:w}=(0,b.R2)({...t,page:e.pageIndex,size:e.pageSize}),{items:A,total:T}=(0,l.useMemo)(()=>{let e=S||{items:[],total:0,pages:0},t=e.items.map(e=>({...e,key:e.id}));return{...e,items:t}},[S]),[R]=(0,b.YO)(),N=async()=>{let e;try{await R(t)}catch(t){e=t instanceof Error?t.message:"Unknown error occurred"}e&&d.error(e,5e3)},{bulkActionMenuItems:M}=D({requests:A,selectedIds:m,clearSelectedIds:q,messageApi:d,modalApi:g});return(0,n.jsxs)("div",{children:[(0,n.jsxs)(r.jqI,{justify:"space-between",align:"center",className:"my-2",children:[(0,n.jsx)(v.HO,{globalFilter:i,setGlobalFilter:s,placeholder:"Search by request ID or identity value"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(x,{selectedIds:m,menuItems:M}),(0,n.jsxs)(r.wpx,{"data-testid":"filter-btn",onClick:_,children:["Filter",(0,n.jsx)(r.y4X,{size:"small",color:f().FIDESUI_MINOS,count:o})]}),(0,n.jsx)(r.wpx,{"aria-label":"Export report","data-testid":"export-btn",icon:(0,n.jsx)(j.nM,{ml:"1.5px"}),onClick:N})]}),(0,n.jsx)(r.h_i,{children:(0,n.jsx)(et,{open:C,onClose:I,modalFilters:a,setModalFilters:c})})]}),P?(0,n.jsx)("div",{className:" p-2",children:(0,n.jsx)(r.krs,{dataSource:Array(25).fill({}),renderItem:()=>(0,n.jsx)(r.krs.Item,{children:(0,n.jsx)(r.N_L,{})})})}):(0,n.jsxs)(r.jqI,{vertical:!0,gap:"middle",children:[(0,n.jsx)(r.ZJQ,{spinning:w,children:(0,n.jsx)(r.krs,{dataSource:A,rowSelection:{selectedRowKeys:m,onChange:h},renderItem:(e,t,i)=>(0,n.jsx)(ee,{item:e,checkbox:i})})}),(0,n.jsx)(r.B7X,{...e.paginationProps,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items"),total:null!=T?T:0,align:"start"})]}),u,p]})};var es=i(88152),ea=i(72281),en=i(86291),er=()=>{let{processing:e}=(0,es.Y)(),{plus:t}=(0,o.hz)(),{activeTab:i,handleTabChange:s,availableTabs:a}=(0,ea.d)();(0,l.useEffect)(()=>{e()},[e]);let m=(0,l.useMemo)(()=>{let e=[];return a.request&&e.push({key:ea.G.REQUEST,label:"Request",children:(0,n.jsx)(ei,{})}),a.manualTask&&e.push({key:ea.G.MANUAL_TASK,label:"Manual tasks",children:(0,n.jsx)(g.m,{})}),e},[a.manualTask,a.request]);return(0,n.jsxs)(c.Z,{title:"Privacy Requests",mainProps:{minWidth:"784px"},children:[(0,n.jsx)(d.Z,{heading:"Privacy Requests",breadcrumbItems:[{title:"All requests"}],rightContent:(0,n.jsxs)(r.vyj,{children:[t&&(0,n.jsx)(u.ZP,{scopes:[C.Sh.PRIVACY_REQUEST_CREATE],children:(0,n.jsx)(en.Z,{})}),(0,n.jsx)(p.default,{})]}),"data-testid":"privacy-requests"}),(0,n.jsx)(r.A5g,{activeKey:i,onChange:s,items:m})]})}}},function(e){e.O(0,[431,7245,3655,7654,2888,9774,179],function(){return e(e.s=89987)}),_N_E=e.O()}]);
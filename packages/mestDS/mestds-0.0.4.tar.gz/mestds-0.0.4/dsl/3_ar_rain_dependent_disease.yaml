model:
  simulation_name: "ar_rain_lag_3_month_season_dependent"
  time_granularity: "W"
  simulation_length: 350
  features:
    - name: "population"
      function: |
        def get_population():
          return 100
    - name: "rainfall"
      function: |
        def get_rainfall():
          random_value = np.random.rand()
          if random_value >= 0.5:
              return np.random.gamma(shape=6, scale=1.0) * 4
          else:
              return np.random.gamma(shape=2, scale=0.5) * 2
    - name: "mean_temperature"
      function: |
        def get_temperature(i):
          i = (i - 1) % 52 + 1
          seasonal_temp = 24 + 5 * np.sin(2 * np.pi * i / 52)
          random_noise = np.random.normal(0, 2)
          return seasonal_temp + random_noise

    - name: "lagged_rainfall"
      function: |
        def get_lagged_rainfall(rainfall):
          if len(rainfall) < 2:
              return rainfall[-1]  
          last_two = rainfall[-2:]
          return sum(last_two) / len(last_two)

    - name: "disease_cases"
      function: |
        def get_disease_cases(population, disease_cases, lagged_rainfall):
          random_noise = np.random.normal(0, 2)
          if (len(disease_cases) < 2):
            new_case = disease_cases[-1] + random_noise
          else: 
            prev_case_1 = disease_cases[-1]
            prev_case_2 = disease_cases[-2]
            new_case = (prev_case_1 * 0.4) + (prev_case_2 * 0.3) + random_noise

          new_case = new_case + (lagged_rainfall[-1] * 0.3)

          if (new_case < 0):
            new_case = np.random.randint(1,3)
          return min(new_case,population[-1])
  regions:
    - name: "Finnmark"
      region_id: 1
      rain_season: [[10, 15], [40, 45]]
      neighbour: [2]

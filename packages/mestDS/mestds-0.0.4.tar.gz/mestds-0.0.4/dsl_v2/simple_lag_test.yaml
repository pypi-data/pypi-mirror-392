public:
  functions:
    get_population: |
      def get_pop():
        return 100 + np.random.randint(1,3)

    get_flat_value: |
      def get_flat_value(value):
        return value + np.random.randint(1,3)

    get_spiky_value: |
      def get_spiky_value(i, spikes, high_val, low_val):
        if i in spikes:
          return high_val + np.random.randint(1,3)
        return low_val + np.random.randint(1,3)

    get_lag_value: |
      def get_lag_value(variable, lag_length):
        if(len(variable) < (lag_length+1)):
          return variable[-1]
        return variable[-(lag_length+1)]

    get_disease_cases: |
      def get_disease_cases(variable):
        return int(variable[-1]* 0.5)

    get_ar_disease_cases: |
      def get_ar_disease_cases(disease_cases, rainfall, mean_temperature):
        new_case = disease_cases[-1] * 0.5
        new_case += rainfall[-1] * 0.3
        new_case += mean_temperature[-1] * 0.2
        return int(new_case)

  lists:
    spikes: [10, 20, 30, 40, 55, 75, 92, 97, 110, 120, 135, 150, 170, 190]

simulators:
  - id: 1
    name: dc = 1 time step lag for rainfall
    length: 200
    x:
      - name: population
        function_ref: get_population
      - name: mean_temperature
        function_ref: get_flat_value
        params:
          value: 20
      - name: rainfall
        function_ref: get_spiky_value
        params:
          high_val: 50
          low_val: 5
      - name: lag_rainfall
        function_ref: get_lag_value
        params:
          variable: rainfall
          lag_length: 1
    y:
      - name: disease_cases
        function_ref: get_disease_cases
        params:
          variable: lag_rainfall

  # - id: 2
  #   inherit: 1
  #   name: dc = 2 time step lag for rainfall
  #   x:
  #     - name: lag_rainfall
  #       params:
  #         lag_length: 2
  # - id: 3
  #   inherit: 1
  #   name: dc = 3 time step lag for rainfall
  #   x:
  #     - name: lag_rainfall
  #       params:
  #         lag_length: 3
  # - id: 4
  #   inherit: 1
  #   name: dc = 4 time step lag for rainfall
  #   x:
  #     - name: lag_rainfall
  #       params:
  #         lag_length: 4

  # - id: 5
  #   name: dc = 1 time step lag for temperature
  #   length: 200
  #   x:
  #     - name: population
  #       function_ref: get_population
  #     - name: rainfall
  #       function_ref: get_flat_value
  #       params:
  #         value: 5
  #     - name: mean_temperature
  #       function_ref: get_spiky_value
  #       params:
  #         high_val: 40
  #         low_val: 20
  #     - name: lag_temperature
  #       function_ref: get_lag_value
  #       params:
  #         variable: mean_temperature
  #         lag_length: 1
  #   y:
  #     - name: disease_cases
  #       function_ref: get_disease_cases
  #       params:
  #         variable: lag_temperature
  # - id: 6
  #   inherit: 5
  #   name: dc = 2 time step lag for temperature
  #   x:
  #     - name: lag_temperature
  #       params:
  #         lag_length: 2
  # - id: 7
  #   inherit: 5
  #   name: dc = 3 time step lag for rainfall
  #   x:
  #     - name: lag_temperature
  #       params:
  #         lag_length: 3
  # - id: 8
  #   inherit: 5
  #   name: dc = 4 time step lag for rainfall
  #   x:
  #     - name: lag_temperature
  #       params:
  #         lag_length: 4
  # - id: 9
  #   inherit: 1
  #   name: dc = rainfall (no lag)
  #   y:
  #     - name: disease_cases
  #       params:
  #         variable: rainfall

  # - id: 10
  #   inherit: 5
  #   name: dc = temperature (no lag)
  #   y:
  #     - name: disease_cases
  #       params:
  #         variable: mean_temperature

  - id: 11
    name: Autoregressive disease cases + rainfall and temperature
    inherit: 1
    y:
      - name: disease_cases
        function_ref: get_ar_disease_cases
evaluators:
  - model: "https://github.com/sandvelab/chap_auto_ewars@58d56f86641f4c7b09bbb635afd61740deff0640"
    prediction_length: 3
    stride: 2
    n_test_sets: 6
    time_delta: M
    metrics: [mse, pocid, theils_u]
    plot_length: 40
    simulation_length: 100
  # - model: https://github.com/sandvelab/monthly_ar_model@cadd785872624b4bcd839a39f5e7020c25254c31
  #   prediction_length: 3
  #   stride: 2
  #   n_test_sets: 6
  #   metrics: [mse, pocid, theils_u]
  #   time_delta: M
  #   plot_length: 40
  #   simulation_length: 100
  # - time_delta: "W"
  #   prediction_length: 12
  #   model: "https://github.com/sandvelab/chap_auto_ewars_weekly@737446a7accf61725d4fe0ffee009a682e7457f6"
  #   stride: 11
  #   n_test_sets: 3
  #   metrics: [mse, pocid, theils_u]
  # - model: "models/weekly_ar_model"
  #   time_delta: "W"
  #   n_test_sets: 3
  #   stride: 11
  #   prediction_lengt: 12
  #   metrics: [mse, pocid, theils_u]

# Example configuration for ISO Financial MCP data sources
# 
# INSTALLATION:
# 1. Copy this file to: ~/.iso_financial_mcp/config/datasources.yaml
# 2. Customize settings as needed
# 3. Restart the MCP server
#
# ENVIRONMENT VARIABLES:
# - Use ${VAR_NAME} syntax for environment variable substitution
# - Use ${VAR_NAME:default_value} to provide defaults
# - Example: api_key_env: ${SERPAPI_KEY:your_key_here}
#
# PRIORITY:
# - Lower numbers = higher priority (1 is highest)
# - Sources are tried in priority order
# - Unhealthy sources are automatically skipped
#
# For more information, see: MIGRATION_GUIDE.md

# SEC data sources configuration
sec:
  sources:
    - name: edgar_api
      enabled: true
      priority: 1
      timeout: 10
      max_retries: 2
      
    - name: rss_feed
      enabled: true
      priority: 2
      timeout: 5
      max_retries: 1
      
  lookback_extension:
    enabled: true
    initial_days: 30
    extended_days: 90

# Google Trends configuration
trends:
  sources:
    - name: pytrends_direct
      enabled: true
      priority: 1
      rate_limit: 0.2  # 1 req / 5 sec
      timeout: 15
      
    - name: pytrends_proxy
      enabled: true
      priority: 2
      requires_proxy: true
      
    - name: serpapi_fallback
      enabled: false
      priority: 3
      requires_api_key: true
      api_key_env: SERPAPI_KEY
      
  retry_strategy:
    max_attempts: 3
    initial_delay: 10
    max_delay: 60
    exponential_base: 2.0
    jitter_range: [1.0, 3.0]
    
  adaptive_rate_limit:
    enabled: true
    error_threshold: 0.5  # 50% error rate triggers slow mode
    slow_mode_delay: 10

# Earnings calendar configuration
earnings:
  sources:
    - name: yahoo_finance
      enabled: true
      priority: 1
      
    - name: nasdaq_api
      enabled: true
      priority: 2
      
    - name: alpha_vantage
      enabled: false
      priority: 3
      requires_api_key: true
      api_key_env: ALPHA_VANTAGE_KEY
      
  merge_strategy: deduplicate_by_date
  estimate_fallback: true
  require_future_date: true

# Cache configuration
cache:
  memory:
    max_size: 1000
    ttl_seconds: 3600  # 1 hour
    
  disk:
    enabled: true
    path: ~/.iso_financial_mcp/cache
    ttl_seconds: 604800  # 7 days
    max_size_mb: 500
    
  stale_fallback: true

# Health monitoring configuration
health_monitor:
  enabled: true
  window_size: 100  # Track last 100 requests per source
  unhealthy_threshold: 0.3  # 30% failure rate = unhealthy
  metrics_retention_days: 7
  log_path: ~/.iso_financial_mcp/health_metrics.jsonl

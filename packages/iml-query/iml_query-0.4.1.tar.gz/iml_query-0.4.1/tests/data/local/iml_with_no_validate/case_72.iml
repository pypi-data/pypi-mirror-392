let calculate_tile_arrangements (size : int) : int =
  let rec helper (memo : int list) (idx : int) : int list =
    if idx > size then
      memo
    else
      let new_value =
        if idx < 4 then
          1
        else if idx = 4 then
          2
        else
          let prev_1 = Option.get_or ~default:0 (List.nth (idx - 1) memo) in
          let prev_4 = Option.get_or ~default:0 (List.nth (idx - 4) memo) in
          prev_1 + prev_4
      in
      let updated_memo = List.mapi (fun i x -> if i = idx then new_value else x) memo in
      helper updated_memo (idx + 1)
  in
  let initial_memo = List.map (fun _ -> 0) (0 -- size) in
  let final_memo = helper initial_memo 1 in
  Option.get_or ~default:0 (List.nth size final_memo)
[@@no_validate]
let count_trees (length : int) : int =
  let rec build_memo memo i =
    if i > length then
      memo
    else
      let rec calculate_total left_size acc =
        if left_size >= i then
          acc
        else
          let right_size = i - left_size - 1 in
          let left_count = List.nth left_size memo |> Option.get_or ~default:0 in
          let right_count = List.nth right_size memo |> Option.get_or ~default:0 in
          calculate_total (left_size + 1) (acc + (left_count * right_count))
      in
      let total = calculate_total 0 0 in
      build_memo (List.append memo [total]) (i + 1)
  in
  let final_memo = build_memo [1; 1] 2 in
  List.nth length final_memo |> Option.get_or ~default:0
[@@no_validate]
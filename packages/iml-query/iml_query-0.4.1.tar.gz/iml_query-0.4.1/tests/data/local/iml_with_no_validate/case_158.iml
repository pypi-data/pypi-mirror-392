let bitwise_and : int -> int -> int = fun a b -> 1 [@@opaque]

let is_power_of_2 (x : int) : bool =
  x <> 0 && bitwise_and x (x - 1) = 0

let rec find_next_power (res : int) (x : int) : int =
  if res >= x then
    res
  else
    find_next_power (res * 2) x
[@@no_validate]

let next_pow2 (x : int) : int =
  if is_power_of_2 x then
    x
  else
    find_next_power 1 x
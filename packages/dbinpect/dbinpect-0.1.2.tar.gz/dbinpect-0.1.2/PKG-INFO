Metadata-Version: 2.4
Name: dbinpect
Version: 0.1.2
Summary: Outil d'inspection et d'analyse de bases de donnÃ©es
Author-email: Herolde GUIELLE <ashguiell@gmail.com>
License: MIT
Project-URL: Homepage, https://github.com/AshBrud/dbinpect
Project-URL: Documentation, https://github.com/AshBrud/dbinpect#readme
Project-URL: Repository, https://github.com/AshBrud/dbinpect
Project-URL: Issues, https://github.com/AshBrud/dbinpect/issues
Keywords: database,inspection,sqlalchemy,analysis
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Database
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: SQLAlchemy>=2.0
Requires-Dist: pydantic>=2.0
Requires-Dist: pydantic-settings>=2.0
Requires-Dist: python-dotenv>=1.0
Dynamic: license-file

# ğŸ—‚ï¸ DB Inspector

A powerful and flexible tool to inspect and analyze any SQLAlchemy-compatible database.  
Visualize your table structures, browse data, analyze relationships, and manage your database schema directly from the command line.

---

## âœ¨ Features

- ğŸ” **Complete Inspection** : Analyze the structure of all your tables
- ğŸ“Š **Data Visualization** : Browse the content of your tables
- ğŸ”— **Relationships** : Discover foreign keys and relationships between tables
- ğŸ—‘ï¸ **Management** : Delete tables if needed (with confirmation)
- ğŸ¯ **Multi-database** : Support for PostgreSQL, MySQL, SQLite and all SQLAlchemy-compatible databases
- âš™ï¸ **Flexible Configuration** : Full URL or separate variables

---

## ğŸ“‹ Prerequisites

- Python 3.8 or higher
- Access to a database (PostgreSQL, MySQL, SQLite, etc.)

---

## ğŸš€ Installation

### Installation from PyPI

```bash
pip install dbinpect
```

This will install the `analyze-db` command in your environment.

### Installation from Source

Clone the project and install dependencies:

```bash
git clone https://github.com/AshBrud/dbinpect.git
cd dbinpect
pip install -r requirements.txt
```

### Development Installation

To install the package in development mode (useful if you modify the code):

```bash
pip install -e .
```

This will also install the `analyze-db` command in your environment.

### Installation from GitHub

```bash
pip install git+https://github.com/AshBrud/dbinpect.git
```

---

## âš™ï¸ Configuration

The project offers **three methods** to configure the database connection, with a clear priority order:

**Priority order** : CLI Arguments > Environment Variables > `.env` File > Default

### Method 1: CLI Arguments (Highest Priority) â­

Configure directly from the command line:

```bash
# With full URL
analyze-db --database-url "postgresql://user:password@localhost:5432/mydb" --all

# With separate variables
analyze-db --db-host localhost --db-port 5432 --db-user user --db-password pass --db-name mydb --all

# Mixed: partial override
analyze-db --db-password "new_password" --all
```

**Available arguments** :
- `--database-url`, `--db-url`, `-u` : Full database URL
- `--db-type` : Database type (postgresql, mysql, sqlite, etc.)
- `--db-host` : Database host
- `--db-port` : Database port
- `--db-user` : Username
- `--db-password` : Password
- `--db-name` : Database name

### Method 2: Environment Variables

Set variables in your shell before executing the command:

```bash
# Linux/Mac/Windows Git Bash
DATABASE_URL="postgresql://user:password@localhost:5432/mydb" analyze-db --all

# Or export for the session
export DATABASE_URL="postgresql://user:password@localhost:5432/mydb"
analyze-db --all

# Separate variables
DB_HOST=localhost DB_USER=user DB_NAME=mydb analyze-db --all
```

**Windows PowerShell** :
```powershell
$env:DATABASE_URL="postgresql://user:password@localhost:5432/mydb"
analyze-db --all
```

**Windows CMD** :
```cmd
set DATABASE_URL=postgresql://user:password@localhost:5432/mydb
analyze-db --all
```

### Method 3: `.env` File (For Local Development)

Create a `.env` file at the project root:

```env
# Option 1: Full URL
DATABASE_URL=postgresql://user:password@localhost:5432/mydb

# Option 2: Separate variables
DB_TYPE=postgresql
DB_HOST=localhost
DB_PORT=5432
DB_USER=user
DB_PASSWORD=password
DB_NAME=mydb
```

**Create the file** :
```bash
# Linux/Mac
cp env.example .env

# Windows
copy env.example .env
```

Then edit the `.env` file with your connection information.

### Supported Database Types

- **PostgreSQL** : `postgresql://user:pass@host:port/db`
- **MySQL** : `mysql://user:pass@host:port/db`
- **SQLite** : `sqlite:///path/to/database.db`
- **Others** : All databases supported by SQLAlchemy

### Configuration Examples

```bash
# PostgreSQL via CLI
analyze-db --database-url "postgresql://postgres:mypass@localhost:5432/testdb" --all

# MySQL via environment variables
DATABASE_URL="mysql://root:password@localhost:3306/mydb" analyze-db --table users

# SQLite via CLI
analyze-db --database-url "sqlite:///./database.db" --all

# Partial override: .env contains DB_HOST, DB_USER, DB_NAME, override only password
analyze-db --db-password "new_password" --all
```

> ğŸ’¡ **Note** : If `DATABASE_URL` is defined (via CLI, env or .env), it takes priority over separate variables.

---

## ğŸ“– Usage

Once installed, you can use the `analyze-db` command:

```bash
analyze-db --help
```

### Available Options

#### Inspection Options

| Option | Description |
|--------|-------------|
| `--all`, `-a` | Display details of all tables |
| `--table <name>`, `-t <name>` | Display the schema of a specific table |
| `--data [n]`, `-d [n]` | Display the first rows of data (default 10) |
| `--drop <name>` | Delete a specific table âš ï¸ **irreversible** |

#### Configuration Options (see Configuration section)

| Option | Description |
|--------|-------------|
| `--database-url`, `--db-url`, `-u` | Full database URL |
| `--db-host` | Database host |
| `--db-port` | Database port |
| `--db-user` | Username |
| `--db-password` | Password |
| `--db-name` | Database name |
| `--db-type` | Database type (postgresql, mysql, sqlite, etc.) |

### Usage Examples

#### List all tables

```bash
analyze-db
```

Displays the list of all tables with the number of rows.

#### Display details of all tables

```bash
analyze-db --all
```

Displays the complete schema (columns, types, primary keys, foreign keys) of all tables.

#### Inspect a specific table

```bash
analyze-db --table users
```

Displays the detailed schema of the `users` table:
- Columns with their types
- Primary keys
- Foreign keys
- Number of rows

#### Browse table data

```bash
# Display the first 10 rows (default)
analyze-db --table users --data

# Display the first 20 rows
analyze-db --table users --data 20
```

#### Delete a table

```bash
analyze-db --drop old_table
```

âš ï¸ **Warning** : This action is irreversible. A confirmation will be requested before deletion.

---

## ğŸ› ï¸ Development

### Project Structure

```
dbinpect/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ core/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ config.py          # Configuration with Pydantic Settings
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ db_inspector.py        # Main script
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ plan-action-configurations-base.md
â”‚
â”œâ”€â”€ .env.example               # Configuration example
â”œâ”€â”€ requirements.txt           # Python dependencies
â”œâ”€â”€ setup.py                   # Package configuration
â”œâ”€â”€ pyproject.toml             # Modern package configuration
â””â”€â”€ README.md                  # This file
```

### Technologies Used

- **SQLAlchemy** : ORM and database connection management
- **Pydantic** : Data validation and configuration management
- **Python-dotenv** : Environment variable loading

### Development Dependencies Installation

```bash
pip install -r requirements.txt
```

---

## ğŸ› Troubleshooting

### Error: "DATABASE_URL is not configured"

**Solution** : Check that your `.env` file exists and contains `DATABASE_URL` or the variables `DB_HOST`, `DB_USER`, `DB_NAME`.

### Error: "Unable to connect to database"

**Solutions** :
1. Check that your database is accessible
2. Verify credentials in your `.env` file
3. Check that the database service is running
4. For PostgreSQL, verify that port 5432 is open

### Command `analyze-db` not found

**Solution** : Reinstall the package in development mode:
```bash
pip install -e .
```

---

## ğŸ¤ Contributing

Contributions are welcome! To contribute:

1. **Fork** the repository
2. **Create** a branch for your feature (`git checkout -b feature/my-feature`)
3. **Commit** your changes (`git commit -m 'Add a new feature'`)
4. **Push** to the branch (`git push origin feature/my-feature`)
5. **Open** a Pull Request

### Future Improvements

See the [action plan](docs/plan-action-configurations-base.md) to view planned improvements.

---

## ğŸ“œ License

This project is licensed under the MIT License. You are free to use, modify, and share it.

See the [LICENSE](LICENSE) file for more details.

---

## ğŸ™ Acknowledgments

- [SQLAlchemy](https://www.sqlalchemy.org/) for the excellent ORM
- [Pydantic](https://docs.pydantic.dev/) for data validation
- All contributors who improve this project

---

## ğŸ“ Support

To report a bug or suggest a feature, open an [issue](https://github.com/AshBrud/dbinpect/issues) on GitHub.

---

**Made with â¤ï¸ for the Python community**

# Q2

## **Question 2 – (toyato.csv), (Kasol.csv)**

---

## **1. (Using toyato.csv)**

- Read the data
- For numerical columns, display the **min, max, mode**
- Display the **number of categorical and numerical columns**
- Perform **univariate analysis** for continuous variables using **swarm plot**
- Perform **mode imputation** for a categorical column if missing values > 10%

---

## **2. (Using Kasol.csv)**

Develop a **multiple linear regression model** for predicting **‘Discharge’** from Kasol dataset using scikit-learn:

- Read and divide the dataset into **training (75%)** and **testing (25%)**
- Build the model to understand the impact of multiple features on Discharge and display the **intercept** & **regression coefficients**
- Predict discharge using the test dataset
- Display the **regression line**
- Analyse performance metrics: **MSE** and **RMSE**

---

# **1. Answer**

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

df = pd.read_csv("toyato.csv")

# Numerical summary: min, max, mode
num_cols = df.select_dtypes(include='number')
num_summary = pd.DataFrame({
    "min": num_cols.min(),
    "max": num_cols.max(),
    "mode": num_cols.mode().iloc[0]
})
print(num_summary)

# Count numerical & categorical columns
cat_cols = df.select_dtypes(exclude='number')
print("Numerical columns:", len(num_cols.columns))
print("Categorical columns:", len(cat_cols.columns))

# Swarm plot for any continuous column (example: 'Price')
sns.swarmplot(x=df['Price'])
plt.title("Swarm Plot of Price")
plt.show()

# Mode imputation for categorical columns with >10% missing
for col in cat_cols.columns:
    if df[col].isnull().mean() > 0.10:
        df[col].fillna(df[col].mode()[0], inplace=True)

df.head()

```

---

# **2. Answer**

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

data = pd.read_csv("Kasol.csv")

X = data.drop(columns=['Discharge'])
y = data['Discharge']

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.25, random_state=42
)

model = LinearRegression()
model.fit(X_train, y_train)

intercept = model.intercept_
coefficients = model.coef_

print("Intercept:", intercept)
print("Coefficients:", coefficients)

y_pred = model.predict(X_test)

# Regression line for a single feature example (first feature)
plt.scatter(X_test.iloc[:, 0], y_test)
plt.plot(X_test.iloc[:, 0], model.predict(X_test), linewidth=2)
plt.xlabel(X_test.columns[0])
plt.ylabel("Discharge")
plt.title("Regression Line (Kasol Dataset)")
plt.show()

mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)

mse, rmse

```

---
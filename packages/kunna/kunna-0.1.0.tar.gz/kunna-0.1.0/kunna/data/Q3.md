# Q3

## **Question 3 – (Customers.csv), (Solar.csv)**

---

## **1. (Using Customers.csv)**

- Read the data
- Display the features with:
    - High **positive correlation**
    - High **negative correlation**
    - **No correlation**
- Perform **univariate analysis** for categorical variables using **bar plot**
- Display features with missing values >10% and **drop such columns**
- Replace missing values with **mean** for numerical columns (if missing <10%)

---

## **2. (Using Solar.csv)**

Develop a **logistic regression model** for classifying data into **2 categories based on ‘Solar Radiation’**:

- Divide the dataset into **75% training** and **25% testing**
- Design the classifier & evaluate with test data
- Display **confusion matrix**
- Calculate **Accuracy, Precision, Recall, F1-score**
- Plot the results

---

# **1. Answer**

```python
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

df = pd.read_csv("Customers.csv")

# Correlation matrix
corr = df.corr(numeric_only=True)

high_pos = corr[corr > 0.5].stack().index.tolist()
high_neg = corr[corr < -0.5].stack().index.tolist()
no_corr = corr[(corr > -0.1) & (corr < 0.1)].stack().index.tolist()

print("High Positive Correlation:", high_pos)
print("High Negative Correlation:", high_neg)
print("No Correlation:", no_corr)

# Univariate analysis for categorical variables
cat_cols = df.select_dtypes(exclude='number').columns

for col in cat_cols:
    sns.countplot(x=col, data=df)
    plt.title(f"Bar Plot of {col}")
    plt.show()

# Missing values >10%
missing = df.isnull().mean()
cols_to_drop = missing[missing > 0.10].index
df.drop(columns=cols_to_drop, inplace=True)

# Replace missing values (<10%) with mean for numerical columns
num_cols = df.select_dtypes(include='number').columns
for col in num_cols:
    if df[col].isnull().mean() > 0 and df[col].isnull().mean() < 0.10:
        df[col].fillna(df[col].mean(), inplace=True)

df.head()
```

---

# **2. Answer**

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import confusion_matrix, accuracy_score, precision_score, recall_score, f1_score

data = pd.read_csv("Solar.csv")

# Prepare binary target based on Solar Radiation median
data['Target'] = (data['Solar Radiation'] > data['Solar Radiation'].median()).astype(int)

X = data.drop(columns=['Target', 'Solar Radiation'])
y = data['Target']

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.25, random_state=42
)

model = LogisticRegression(max_iter=500)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

# Confusion matrix
cm = confusion_matrix(y_test, y_pred)
print("Confusion Matrix:\n", cm)

# Metrics
acc = accuracy_score(y_test, y_pred)
prec = precision_score(y_test, y_pred)
rec = recall_score(y_test, y_pred)
f1 = f1_score(y_test, y_pred)

acc, prec, rec, f1

# Plot results
plt.scatter(range(len(y_test)), y_test, label="Actual")
plt.scatter(range(len(y_pred)), y_pred, label="Predicted")
plt.legend()
plt.title("Actual vs Predicted Classification")
plt.show()
```

---
# SpecQL stdlib Entity: Location
# Category: geo
# Version: 1.1.0
# Standard: N/A
# Description: Hierarchical physical locations with accessibility and dimensional data
#
# This entity is part of the SpecQL standard library, extracted from
# PrintOptim production system and generalized for universal reuse.
#
# Usage:
#   # Import as-is:
#   import: stdlib/geo/location
#
#   # Or extend with customizations:
#   entity: MyLocation
#   extends:
#     from: stdlib/geo/location
#   fields:
#     custom_field: text

entity: Location
schema: tenant
hierarchical: true
description: |
  Hierarchical physical locations with accessibility and dimensional data.
  Combines structural hierarchy with detailed location information and constraints.

fields:
  # Basic information
  name:
    type: text
    nullable: false
    description: "Descriptive name of the location (e.g., '3rd floor, west wing')."

  int_ordered:
    type: integer
    description: "Integer used for sorting sibling locations within the same level."

  # Accessibility features
  has_elevator:
    type: boolean
    description: "Whether the location is accessible via elevator."

  has_stairs:
    type: boolean
    description: "Whether access requires use of stairs."

  n_stair_steps:
    type: integer
    description: "Number of stair steps, if applicable."

  # Physical dimensions (generic for any space planning)
  available_width_mm:
    type: integer
    description: "Maximum available width (in mm) at the installation location."

  available_depth_mm:
    type: integer
    description: "Maximum available depth (in mm) at the installation location."

  available_height_mm:
    type: integer
    description: "Maximum available height (in mm) at the installation location."

  coordinates:
    type: coordinates
    nullable: true
    description: "Geographic coordinates (latitude, longitude) stored as PostgreSQL POINT"

  # Structural relationships
  customer_org:
    type: ref(Organization)
    schema: management
    nullable: false
    description: "References the customer organization. Used for scoping, access control, and tenant-aware filtering."

  public_address:
    type: ref(PublicAddress)
    schema: common
    nullable: false
    description: "Physical address information for this location."

  location_type:
    type: ref(LocationType)
    schema: common
    nullable: false
    description: "Type classification of this location."

  location_level:
    type: ref(LocationLevel)
    schema: common
    nullable: false
    description: "Hierarchical level of this location."

  parent_location:
    type: ref(Location)
    description: "Self-referencing foreign key for nested hierarchy of locations."

actions:
  - name: create_location
  - name: update_location
  - name: delete_location

  # Business actions
  - name: update_accessibility
  - name: change_elevator_access
  - name: change_stair_access
  - name: update_dimensions
  - name: update_coordinates
  - name: change_address
  - name: change_location_type
  - name: move_to_parent
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project]
name = "slash-man"
version = "v0.6.0a-3"
description = "A CLI tool for generating and managing slash commands with MCP server support for prompt management"
readme = "README.md"
requires-python = ">=3.12"
license = { file = "LICENSE" }
authors = [{ name = "Liatrio", email = "labs@liatrio.com" }]
keywords = [
  "cli",
  "generator",
  "mcp",
  "slash-commands",
  "prompt-management",
  "workflow",
  "automation",
  "ai-assistant",
]
classifiers = [
  "Development Status :: 4 - Beta",
  "Intended Audience :: Developers",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3.12",
  "Topic :: Software Development :: Build Tools",
  "Topic :: Software Development :: Libraries :: Python Modules",
  "Topic :: Utilities",
  "Operating System :: OS Independent",
]

dependencies = [
  "fastmcp",
  "questionary>=1.10.0",
  "requests>=2.31.0",
  "tomli-w>=1.0.0",
  "rich>=13.0.0",
  "typer>=0.9.0",
  "pyyaml>=6.0",
]

[project.optional-dependencies]
dev = [
  "pytest>=7.0.0",
  "pytest-cov>=4.0.0",
  "pytest-httpx>=0.35.0",
  "ruff>=0.1.0",
  "pre-commit>=3.0.0",
  "pexpect>=4.9.0",
]

[project.scripts]
slash-man = "slash_commands.cli:main"

[tool.hatch.build.targets.wheel]
packages = ["slash_commands", "mcp_server"]

[tool.hatch.build.targets.wheel.force-include]
"server.py" = "server.py"

[tool.hatch.build.hooks.custom]
path = "hatch_build.py"

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]
pythonpath = ["."]
addopts = ["-v", "--strict-markers", "--strict-config", "-m", "not integration"]
markers = [
  "integration: marks tests as integration tests (deselect with '-m \"not integration\"')",
]

[tool.ruff]
line-length = 100
target-version = "py312"

[tool.ruff.lint]
select = [
  "E",  # pycodestyle errors
  "W",  # pycodestyle warnings
  "F",  # pyflakes
  "I",  # isort
  "B",  # flake8-bugbear
  "C4", # flake8-comprehensions
  "UP", # pyupgrade
]
ignore = [
  "E501", # line too long, handled by formatter
  "B008", # do not perform function calls in argument defaults
  "C901", # too complex
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"] # allow unused imports in __init__.py files

[tool.ruff.lint.isort]
known-first-party = ["slash_commands", "mcp_server"]

# Semantic-release configuration moved to .releaserc.toml
# This matches the template repository approach and avoids build_command execution issues
# See .releaserc.toml for current configuration
#
# [tool.semantic_release]
# # Use annotated tags like v1.2.3
# tag_format = "v{version}"
# # Default commit parser (Angular/Conventional Commits)
# # Generate changelog and commit version bumps
# # Update the version field in pyproject.toml
# version_toml = ["pyproject.toml:project.version"]
# # Ensure uv.lock stays in sync with version changes and is committed
# # Run uv to refresh the lock file, then stage it so PSR includes it
# # Also build the package to ensure build hooks run
# # NOTE: build_command removed - it was failing because curl is not available
# # in the GitHub Actions environment. Build steps should be handled in workflow.
# build_command = """
# curl -LsSf https://astral.sh/uv/install.sh | sh -s
# export PATH="$HOME/.local/bin:$PATH"
# uv lock
# git add uv.lock
# python -m build --wheel --sdist
# """
# # Generate changelog and commit version bumps
# assets = ["uv.lock"]
#
# [tool.semantic_release.changelog]
# # Generate CHANGELOG.md in Markdown
# default_templates = { changelog_file = "CHANGELOG.md", output_format = "md" }
#
# [tool.semantic_release.branches]
# # Release from the main branch
# main = { match = "main" }

[dependency-groups]
dev = ["build>=1.3.0", "twine>=5.0.0"]

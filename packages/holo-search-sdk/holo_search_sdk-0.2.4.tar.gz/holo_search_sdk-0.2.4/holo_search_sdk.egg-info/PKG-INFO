Metadata-Version: 2.1
Name: holo-search-sdk
Version: 0.2.4
Summary: A Python SDK for database search operations with vector and full-text search capabilities
Author-email: Tiancheng YANG <yangtiancheng.ytc@alibaba-inc.com>
License: MIT
Project-URL: Homepage, https://github.com/hologram/holo-search-sdk
Project-URL: Documentation, https://holo-search-sdk.readthedocs.io
Project-URL: Repository, https://github.com/hologram/holo-search-sdk
Project-URL: Issues, https://github.com/hologram/holo-search-sdk/issues
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE.txt
Requires-Dist: numpy>=1.20.0
Requires-Dist: typing-extensions>=4.0.0
Requires-Dist: psycopg>=3.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: pre-commit>=3.0.0; extra == "dev"

# Holo Search SDK

ä¸€ä¸ªç”¨äºHologresæ•°æ®åº“æœç´¢æ“ä½œçš„ Python SDKï¼Œæ”¯æŒå‘é‡æœç´¢å’Œå…¨æ–‡æœç´¢åŠŸèƒ½ã€‚

## âœ¨ ç‰¹æ€§

- **ğŸ” å‘é‡æœç´¢**: åŸºäºè¯­ä¹‰ç›¸ä¼¼æ€§çš„æœç´¢åŠŸèƒ½
- **ğŸ“ å…¨æ–‡æœç´¢**: ä¼ ç»Ÿçš„åŸºäºå…³é”®è¯çš„æœç´¢
- **ğŸ›¡ï¸ ç±»å‹å®‰å…¨**: ä½¿ç”¨ç±»å‹æç¤ºå’Œæ•°æ®éªŒè¯
- **ğŸ§© æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤

## ğŸ“¦ å®‰è£…

### ä» PyPI å®‰è£…

```bash
pip install holo-search-sdk
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨

```python
import holo_search_sdk as holo

# è¿æ¥åˆ°æ•°æ®åº“
client = holo.connect(
    host="your-host",
    port=80,
    database="your-database",
    access_key_id="your-access-key-id",
    access_key_secret="your-access-key-secret",
    schema="public"
)

# å»ºç«‹è¿æ¥
client.connect()

# æ‰“å¼€è¡¨
columns = {
    "id": ("INTEGER", "PRIMARY KEY"),
    "content": "TEXT",
    "vector": "FLOAT8[]",
    "metadata": "JSONB"
}
table = client.open_table("table_name")

# æ’å…¥æ•°æ®
data = [
    [1, "Hello world", [0.1, 0.2, 0.3], {"category": "greeting"}],
    [2, "Python SDK", [0.4, 0.5, 0.6], {"category": "tech"}],
    [3, "Vector search", [0.7, 0.8, 0.9], {"category": "search"}]
]
table.insert_multi(data, ["id", "content", "vector", "metadata"])

# è®¾ç½®å‘é‡ç´¢å¼•
table.set_vector_index(
    column="vector",
    distance_method="Cosine",
    base_quantization_type="rabitq",
    max_degree=64,
    ef_construction=400
)

# å‘é‡æœç´¢
query_vector = [0.1, 0.2, 0.3]
# é™åˆ¶ç»“æœæ•°é‡
results = table.search_vector(query_vector, "vector").limit(10).fetchall()
# è®¾ç½®æœ€å°è·ç¦»
results = table.search_vector(query_vector, "vector").min_distance(0.5).fetchall()

# å…³é—­è¿æ¥
client.disconnect()
```

### ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨

```python
import holo_search_sdk as holo

with holo.connect(
    host="your-host",
    port=80,
    database="your-database",
    access_key_id="your-access-key-id",
    access_key_secret="your-access-key-secret"
) as client:
    client.connect()
    
    # æ‰§è¡Œæ•°æ®åº“æ“ä½œ
    table = client.open_table("table_name")
    results = table.search_vector([0.1, 0.2, 0.3], "vector_column").fetchall()
    
    # è¿æ¥ä¼šè‡ªåŠ¨å…³é—­
```

## ğŸ“š è¯¦ç»†æ–‡æ¡£

### æ ¸å¿ƒæ¦‚å¿µ

#### 1. å®¢æˆ·ç«¯ (Client)

å®¢æˆ·ç«¯æ˜¯ä¸æ•°æ®åº“äº¤äº’çš„ä¸»è¦æ¥å£ï¼š

```python
from holo_search_sdk import connect

# åˆ›å»ºå®¢æˆ·ç«¯
client = connect(
    host="localhost",
    port=80,
    database="test_db",
    access_key_id="your_key",
    access_key_secret="your_secret"
)

# å»ºç«‹è¿æ¥
client.connect()

# æ‰§è¡Œ SQL
result = client.execute("SELECT COUNT(*) FROM users", fetch_result=True)

# è¡¨æ“ä½œ
table = client.open_table("table_name")
```

#### 2. è¡¨æ“ä½œ (Table Operations)

è¡¨æ˜¯æ•°æ®å­˜å‚¨å’Œæœç´¢çš„åŸºæœ¬å•ä½ï¼š

```python
# æ‰“å¼€ç°æœ‰è¡¨
table = client.open_table("table_name")

# æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
exists = client.check_table_exist("table_name")

# åˆ é™¤è¡¨
client.drop_table("table_name")
```

#### 3. æ•°æ®æ’å…¥

æ”¯æŒå•æ¡å’Œæ‰¹é‡æ•°æ®æ’å…¥ï¼š

```python
# æ’å…¥å•æ¡è®°å½•
table.insert_one(
    [1, "æ ‡é¢˜", "å†…å®¹", [0.1, 0.2, 0.3]],
    ["id", "title", "content", "vector"]
)

# æ‰¹é‡æ’å…¥
data = [
    [1, "æ–‡æ¡£1", "å†…å®¹1", [0.1, 0.2, 0.3]],
    [2, "æ–‡æ¡£2", "å†…å®¹2", [0.4, 0.5, 0.6]],
    [3, "æ–‡æ¡£3", "å†…å®¹3", [0.7, 0.8, 0.9]]
]
table.insert_multi(data, ["id", "title", "content", "vector"])
```

#### 4. å‘é‡ç´¢å¼•

ä¸ºå‘é‡åˆ—åˆ›å»ºé«˜æ•ˆçš„æœç´¢ç´¢å¼•ï¼š

```python
# è®¾ç½®å•ä¸ªå‘é‡ç´¢å¼•
table.set_vector_index(
    column="vector",
    distance_method="Cosine",  # å¯é€‰: "Euclidean", "InnerProduct", "Cosine"
    base_quantization_type="rabitq",  # å¯é€‰: "sq8", "sq8_uniform", "fp16", "fp32", "rabitq"
    max_degree=64,
    ef_construction=400,
    use_reorder=True,
    precise_quantization_type="fp32",
    max_total_size_to_merge_mb=4096,  # ç£ç›˜åˆå¹¶æ—¶æ•°æ®çš„æœ€å¤§æ–‡ä»¶å¤§å°ï¼Œå•ä½MB
    build_thread_count=16  # ç´¢å¼•æ„å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨çš„çº¿ç¨‹æ•°
)

# è®¾ç½®å¤šä¸ªå‘é‡ç´¢å¼•
table.set_vector_indexes({
    "content_vector": {
        "distance_method": "Cosine",
        "base_quantization_type": "rabitq",
        "max_degree": 64,
        "ef_construction": 400,
        "use_reorder": True,
        "precise_quantization_type": "fp32",
        "max_total_size_to_merge_mb": 4096,
        "build_thread_count": 16
    },
    "title_vector": {
        "distance_method": "Euclidean",
        "base_quantization_type": "rabitq",
        "max_degree": 32,
        "ef_construction": 200,
        "use_reorder": True,
        "precise_quantization_type": "fp32",
        "max_total_size_to_merge_mb": 4096,
        "build_thread_count": 16
    }
})

# åˆ é™¤æ‰€æœ‰å‘é‡ç´¢å¼•
table.delete_vector_indexes()
```

#### 5. å‘é‡æœç´¢

æ‰§è¡Œè¯­ä¹‰ç›¸ä¼¼æ€§æœç´¢ï¼š

```python
# åŸºæœ¬å‘é‡æœç´¢
query_vector = [0.1, 0.2, 0.3]
results = table.search_vector(
    vector=query_vector,
    column="vector",
    distance_method="Cosine"
).fetchall()

# å¸¦è¾“å‡ºåˆ«åçš„æœç´¢
results = table.search_vector(
    vector=query_vector,
    column="vector",
    output_name="similarity_score",
    distance_method="Cosine"
).fetchall()
```

#### 6. æ•°æ®æŸ¥è¯¢

æ”¯æŒåŸºäºä¸»é”®çš„ç²¾ç¡®æŸ¥è¯¢ï¼š

```python
# æ ¹æ®ä¸»é”®æŸ¥è¯¢å•æ¡è®°å½•
result = table.get_by_key(
    key_column="id",
    key_value=1,
    return_columns=["id", "content", "vector"]  # å¯é€‰ï¼Œä¸æŒ‡å®šåˆ™è¿”å›æ‰€æœ‰åˆ—
).fetchone()

# æ ¹æ®ä¸»é”®åˆ—è¡¨æ‰¹é‡æŸ¥è¯¢
results = table.get_multi_by_keys(
    key_column="id", 
    key_values=[1, 2, 3],
    return_columns=["id", "content"]  # å¯é€‰ï¼Œä¸æŒ‡å®šåˆ™è¿”å›æ‰€æœ‰åˆ—
).fetchall()
```

#### 7. å‘é‡ç´¢å¼•ç®¡ç†

æŸ¥è¯¢å’Œç®¡ç†å‘é‡ç´¢å¼•ä¿¡æ¯ï¼š

```python
# è·å–å‘é‡ç´¢å¼•ä¿¡æ¯
index_info = table.get_vector_index_info()
if index_info:
    print("å½“å‰å‘é‡ç´¢å¼•é…ç½®:", index_info)
else:
    print("æœªæ‰¾åˆ°å‘é‡ç´¢å¼•é…ç½®")

# ç´¢å¼•ä¿¡æ¯ç¤ºä¾‹è¿”å›æ ¼å¼
# {
#     "vector_column": {
#         "algorithm": "HGraph",
#         "distance_method": "Cosine",
#         "builder_params": {
#             "max_degree": 64,
#             "ef_construction": 400,
#             "base_quantization_type": "rabitq",
#             "use_reorder": true,
#             "precise_quantization_type": "fp32",
#             "precise_io_type": "block_memory_io",
#             "max_total_size_to_merge_mb": 4096,
#             "build_thread_count": 16
#         }
#     }
# }
```

### é…ç½®é€‰é¡¹

#### è¿æ¥é…ç½®

```python
from holo_search_sdk.types import ConnectionConfig

config = ConnectionConfig(
    host="your-host.com",
    port=80,
    database="production_db",
    access_key_id="user...",
    access_key_secret="secret...",
    schema="analytics"  # é»˜è®¤ä¸º "public"
)
```

#### å‘é‡ç´¢å¼•é…ç½®

- **distance_method**: è·ç¦»è®¡ç®—æ–¹æ³•
  - `"Euclidean"`: æ¬§å‡ é‡Œå¾—è·ç¦»
  - `"InnerProduct"`: å†…ç§¯è·ç¦»
  - `"Cosine"`: ä½™å¼¦è·ç¦»

- **base_quantization_type**: åŸºç¡€é‡åŒ–ç±»å‹
  - `"sq8"`, `"sq8_uniform"`, `"fp16"`, `"fp32"`, `"rabitq"`
- **max_degree**: å›¾æ„å»ºè¿‡ç¨‹ä¸­æ¯ä¸ªé¡¶ç‚¹å°è¯•è¿æ¥çš„æœ€è¿‘é‚»æ•°é‡ (é»˜è®¤: 64)
- **ef_construction**: å›¾æ„å»ºè¿‡ç¨‹ä¸­çš„æœç´¢æ·±åº¦æ§åˆ¶ (é»˜è®¤: 400)
- **use_reorder**: æ˜¯å¦ä½¿ç”¨ HGraph é«˜ç²¾åº¦ç´¢å¼• (é»˜è®¤: False)
- **precise_quantization_type**: ç²¾ç¡®é‡åŒ–ç±»å‹ (é»˜è®¤: "fp32")
- **precise_io_type**: ç²¾ç¡® IO ç±»å‹ (é»˜è®¤: "block_memory_io")
- **max_total_size_to_merge_mb**: ç£ç›˜åˆå¹¶æ—¶æ•°æ®çš„æœ€å¤§æ–‡ä»¶å¤§å°ï¼Œå•ä½MB (é»˜è®¤: 4096)
- **build_thread_count**: ç´¢å¼•æ„å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨çš„çº¿ç¨‹æ•° (é»˜è®¤: 16)

## ğŸ”§ API å‚è€ƒ

### ä¸»è¦ç±»

- **`Client`**: æ•°æ®åº“å®¢æˆ·ç«¯ï¼Œç®¡ç†è¿æ¥å’Œè¡¨æ“ä½œ
- **`HoloTable`**: è¡¨æ“ä½œæ¥å£ï¼Œæ”¯æŒæ•°æ®æ’å…¥å’Œå‘é‡æœç´¢
- **`ConnectionConfig`**: è¿æ¥é…ç½®æ•°æ®ç±»

### ä¸»è¦å‡½æ•°

- **`connect()`**: åˆ›å»ºæ•°æ®åº“å®¢æˆ·ç«¯è¿æ¥
- **`open_table()`**: æ‰“å¼€ç°æœ‰è¡¨
- **`insert_one()`**: æ’å…¥å•æ¡è®°å½•
- **`insert_multi()`**: æ‰¹é‡æ’å…¥è®°å½•
- **`set_vector_index()`**: è®¾ç½®å‘é‡ç´¢å¼•
- **`search_vector()`**: æ‰§è¡Œå‘é‡æœç´¢

### å¼‚å¸¸ç±»

- **`HoloSearchError`**: åŸºç¡€å¼‚å¸¸ç±»
- **`ConnectionError`**: è¿æ¥ç›¸å…³é”™è¯¯
- **`QueryError`**: æŸ¥è¯¢æ‰§è¡Œé”™è¯¯
- **`SqlError`**: SQL ç”Ÿæˆé”™è¯¯
- **`TableError`**: è¡¨æ“ä½œé”™è¯¯

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE.txt](LICENSE.txt) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

**Holo Search SDK** - è®©Hologreså‘é‡å’Œå…¨æ–‡æœç´¢å˜å¾—ç®€å•é«˜æ•ˆ ğŸš€

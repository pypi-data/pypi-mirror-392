import{d as W,r as T,O as z,ci as m,$ as n,cj as P,ae as B,c as V,b as s,a as A,u,h as b,e as J,w as a,bt as oe,o as c,b8 as p,t as v,j as x,aY as X,l as F,F as N,g as R,k as H,b4 as Y,V as O,f as Z,v as d,s as re,b7 as ae,bM as G,bw as se,z as ie,x as le,b2 as de,q as ue,n as ce,ck as pe,P as ve,p as me}from"./index-Bi2RCUhr.js";import{C as fe}from"./Container-CKzxUByi.js";import{V as ne}from"./VTextField-CRf6TUgT.js";import{V as C}from"./VBtn-Cc_JVClJ.js";import{a as Q}from"./VInput-CwuOe4xT.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as K}from"./index-kQIztB-E.js";import{V as ge}from"./VDialog-D7LNvx9I.js";import{V as _e,a as he}from"./VRow-CKfMblbo.js";import"./VContainer-D800bc8B.js";/* empty css              */const ye={class:"filters-container"},be={class:"d-flex ga-2 filter-buttons"},Ce=W({__name:"ProviderFilters",props:{showStageFilter:{type:Boolean,default:!1}},emits:["update:search","update:types","update:stages"],setup(j,{emit:U}){const k=Z(),f=oe(),w=T(""),_=T([]),h=T([]);let y=null,$=null,M=null;const q=z(()=>[{title:n("settings.musicprovider"),value:m.MUSIC},{title:n("settings.playerprovider"),value:m.PLAYER},{title:n("settings.metadataprovider"),value:m.METADATA},{title:n("settings.pluginprovider"),value:m.PLUGIN}]),D=z(()=>[{title:n("settings.stage.options.stable"),value:P.STABLE},{title:n("settings.stage.options.beta"),value:P.BETA},{title:n("settings.stage.options.alpha"),value:P.ALPHA},{title:n("settings.stage.options.experimental"),value:P.EXPERIMENTAL},{title:n("settings.stage.options.unmaintained"),value:P.UNMAINTAINED},{title:n("settings.stage.options.deprecated"),value:P.DEPRECATED}]),I=U,E=function(r){const o=_.value.indexOf(r);o>-1?_.value.splice(o,1):_.value.push(r)},L=function(r){const o=h.value.indexOf(r);o>-1?h.value.splice(o,1):h.value.push(r)},S=function(){if(f.query.search&&(w.value=f.query.search),f.query.types){const r=f.query.types;_.value=r.split(",")}if(f.query.stages){const r=f.query.stages;h.value=r.split(",")}};return B(w,r=>{I("update:search",r),y&&clearTimeout(y),y=setTimeout(()=>{const o={...f.query};r?o.search=r:delete o.search,k.replace({query:o})},750)}),B(_,r=>{I("update:types",r),$&&clearTimeout($),$=setTimeout(()=>{const o={...f.query};r.length>0?o.types=r.join(","):delete o.types,k.replace({query:o})},750)},{deep:!0}),B(h,r=>{I("update:stages",r),M&&clearTimeout(M),M=setTimeout(()=>{const o={...f.query};r.length>0?o.stages=r.join(","):delete o.stages,k.replace({query:o})},750)},{deep:!0}),S(),(r,o)=>(c(),V("div",ye,[s(ne,{modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=i=>w.value=i),"prepend-inner-icon":"mdi-magnify",label:u(n)("search"),variant:"outlined",density:"compact",clearable:"","hide-details":"",class:"search-field"},null,8,["modelValue","label"]),A("div",be,[s(C,{height:"40",elevation:"0"},{default:a(()=>[p(v(u(n)("settings.provider_type"))+" ",1),s(x,{end:""},{default:a(()=>[...o[1]||(o[1]=[p("mdi-chevron-down",-1)])]),_:1}),s(X,{activator:"parent","close-on-content-click":!1},{default:a(()=>[s(F,null,{default:a(()=>[(c(!0),V(N,null,R(q.value,(i,e)=>(c(),b(O,{key:e,value:e,onClick:t=>E(i.value)},{append:a(()=>[s(Q,{"model-value":_.value.includes(i.value),onClick:Y(t=>E(i.value),["stop"])},null,8,["model-value","onClick"])]),default:a(()=>[s(H,null,{default:a(()=>[p(v(i.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1}),j.showStageFilter?(c(),b(C,{key:0,height:"40",elevation:"0"},{default:a(()=>[p(v(u(n)("settings.stage.label"))+" ",1),s(x,{end:""},{default:a(()=>[...o[2]||(o[2]=[p("mdi-chevron-down",-1)])]),_:1}),s(X,{activator:"parent","close-on-content-click":!1},{default:a(()=>[s(F,null,{default:a(()=>[(c(!0),V(N,null,R(D.value,(i,e)=>(c(),b(O,{key:e,value:e,onClick:t=>L(i.value)},{append:a(()=>[s(Q,{"model-value":h.value.includes(i.value),onClick:Y(t=>L(i.value),["stop"])},null,8,["model-value","onClick"])]),default:a(()=>[s(H,null,{default:a(()=>[p(v(i.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1})):J("",!0)])]))}}),Pe=ee(Ce,[["__scopeId","data-v-730d2954"]]),ke={class:"text-h6"},we={class:"d-flex ga-2 filter-buttons"},Ae={class:"provider-list-container"},xe={class:"provider-name"},Te={class:"provider-description"},Ee={class:"d-flex align-center ga-2"},Ve={key:1,class:"empty-state"},Me={class:"empty-title"},$e={class:"empty-message"},Ie=W({__name:"AddProviderDialog",props:{show:{type:Boolean,default:!1}},emits:["update:show"],setup(j,{emit:U}){const k=U,f=Z(),w=T([]),_=T(""),h=T([]),y=T([]),$=z(()=>[{title:n("settings.musicprovider"),value:m.MUSIC},{title:n("settings.playerprovider"),value:m.PLAYER},{title:n("settings.metadataprovider"),value:m.METADATA},{title:n("settings.pluginprovider"),value:m.PLUGIN}]),M=z(()=>[{title:n("settings.stage.options.stable"),value:P.STABLE},{title:n("settings.stage.options.beta"),value:P.BETA},{title:n("settings.stage.options.alpha"),value:P.ALPHA},{title:n("settings.stage.options.experimental"),value:P.EXPERIMENTAL},{title:n("settings.stage.options.unmaintained"),value:P.UNMAINTAINED},{title:n("settings.stage.options.deprecated"),value:P.DEPRECATED}]),q=z(()=>{let i=Object.values(d.providerManifests);return i=i.filter(e=>!e.builtin&&e.type!=="core"),i.filter(e=>e.multi_instance||!w.value.find(t=>t.domain==e.domain)).sort((e,t)=>{const l=(e.name||d.providerManifests[e.domain].name).toUpperCase(),g=(t.name||d.providerManifests[t.domain].name).toUpperCase();return l>g?1:-1})}),D=z(()=>{let i=q.value;if(_.value){const e=_.value.toLowerCase();i=i.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))}return h.value.length>0&&(i=i.filter(e=>h.value.includes(e.type))),y.value.length>0&&(i=i.filter(e=>y.value.includes(e.stage))),i}),I=async function(){w.value=await d.getProviderConfigs()},E=function(i){if(i.depends_on&&!d.getProvider(i.depends_on)){const e=d.getProviderName(i.depends_on);confirm(n("settings.provider_depends_on_confirm",[i.name,e]))&&f.push(`/settings/addprovider/${i.depends_on}`);return}f.push(`/settings/addprovider/${i.domain}`),o()},L=function(i){const e=h.value.indexOf(i);e>-1?h.value.splice(e,1):h.value.push(i)},S=function(i){const e=y.value.indexOf(i);e>-1?y.value.splice(e,1):y.value.push(i)},r=function(i){return K(i).with("stable",()=>"green").with("beta",()=>"blue").with("alpha",()=>"purple").with("experimental",()=>"orange").with("unmaintained",()=>"grey").with("deprecated",()=>"red").otherwise(()=>"green")},o=function(){k("update:show",!1)};return B(()=>d.providers,i=>{i&&I()},{immediate:!0}),(i,e)=>(c(),b(ge,{"model-value":j.show,"max-width":"800px",scrollable:"","onUpdate:modelValue":e[1]||(e[1]=t=>{u(re).dialogActive=t,k("update:show",t)})},{default:a(()=>[s(le,{class:"add-provider-dialog"},{default:a(()=>[s(ae,{class:"d-flex align-center justify-space-between pa-4"},{default:a(()=>[A("span",ke,v(u(n)("settings.add_provider")),1),s(C,{icon:"mdi-close",variant:"text",size:"small",onClick:o})]),_:1}),s(G,{class:"pa-4 pb-2"},{default:a(()=>[s(ne,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:u(n)("search"),variant:"outlined",density:"compact",clearable:"","hide-details":"",class:"search-field"},null,8,["modelValue","placeholder"])]),_:1}),s(G,{class:"pa-4 pt-2 pb-2"},{default:a(()=>[A("div",we,[s(C,{height:"40",elevation:"0",variant:"outlined",density:"compact"},{default:a(()=>[p(v(u(n)("settings.provider_type"))+" ",1),s(x,{end:""},{default:a(()=>[...e[2]||(e[2]=[p("mdi-chevron-down",-1)])]),_:1}),s(X,{activator:"parent","close-on-content-click":!1},{default:a(()=>[s(F,null,{default:a(()=>[(c(!0),V(N,null,R($.value,(t,l)=>(c(),b(O,{key:l,value:l,onClick:g=>L(t.value)},{append:a(()=>[s(Q,{"model-value":h.value.includes(t.value),onClick:Y(g=>L(t.value),["stop"])},null,8,["model-value","onClick"])]),default:a(()=>[s(H,null,{default:a(()=>[p(v(t.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1}),s(C,{height:"40",elevation:"0",variant:"outlined",density:"compact"},{default:a(()=>[p(v(u(n)("settings.stage.label"))+" ",1),s(x,{end:""},{default:a(()=>[...e[3]||(e[3]=[p("mdi-chevron-down",-1)])]),_:1}),s(X,{activator:"parent","close-on-content-click":!1},{default:a(()=>[s(F,null,{default:a(()=>[(c(!0),V(N,null,R(M.value,(t,l)=>(c(),b(O,{key:l,value:l,onClick:g=>S(t.value)},{append:a(()=>[s(Q,{"model-value":y.value.includes(t.value),onClick:Y(g=>S(t.value),["stop"])},null,8,["model-value","onClick"])]),default:a(()=>[s(H,null,{default:a(()=>[p(v(t.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1})]),_:1})])]),_:1}),s(G,{class:"pa-4 pt-2"},{default:a(()=>[A("div",Ae,[D.value.length>0?(c(),b(F,{key:0,class:"provider-list"},{default:a(()=>[(c(!0),V(N,null,R(D.value,t=>(c(),b(O,{key:t.domain,style:{padding:"0"},class:"provider-item",rounded:"lg",onClick:l=>E(t)},{prepend:a(()=>[s(ie,{domain:t.domain,size:40,class:"provider-icon"},null,8,["domain"])]),title:a(()=>[A("div",xe,v(t.name),1)]),subtitle:a(()=>[A("div",Te,v(t.description),1)]),append:a(()=>[A("div",Ee,[s(se,{size:"x-small",variant:"flat",class:"text-uppercase",color:r(t.stage)},{default:a(()=>[p(v(u(n)(String(t.stage||"").toLowerCase())),1)]),_:2},1032,["color"]),s(x,{icon:"mdi-chevron-right",size:"small"})])]),_:2},1032,["onClick"]))),128))]),_:1})):(c(),V("div",Ve,[s(x,{icon:"mdi-magnify",size:"48",class:"empty-icon"}),A("div",Me,v(u(n)("no_content")),1),A("div",$e,v(u(n)("no_content_filter")),1)]))])]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),Le=ee(Ie,[["__scopeId","data-v-520c5c4c"]]),Ne={class:"providers-header w-100"},Ue={class:"pl-5 font-weight-medium"},De=W({__name:"Providers",setup(j){const U=Z(),k=T([]),f=T(""),w=T([]),_=T(!1),h=d.subscribe(de.PROVIDERS_UPDATED,()=>{y()});ue(h);const y=async function(){k.value=await d.getProviderConfigs()},$=function(e){d.removeProviderConfig(e),k.value=k.value.filter(t=>t.instance_id!=e)},M=function(e){U.push(`/settings/editprovider/${e}`)},q=function(e){e.enabled=!e.enabled,d.saveProviderConfig(e.domain,{enabled:e.enabled},e.instance_id)},D=function(e){d.sendCommand("config/providers/reload",{instance_id:e}).catch(t=>alert(t))},I=function(e,t){const l=d.providerManifests[t.domain],g=d.getProvider(t.instance_id),te=[{label:"settings.configure",labelArgs:[],action:()=>{M(t.instance_id)},icon:"mdi-cog"},{label:t.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{q(t)},icon:"mdi-cancel",disabled:!l.allow_disable},{label:"settings.documentation",labelArgs:[],action:()=>{pe(l.documentation)},icon:"mdi-bookshelf",disabled:!l.documentation},{label:"settings.sync",labelArgs:[],action:()=>{d.startSync(void 0,[t.instance_id])},icon:"mdi-sync",hide:!g?.available||t.type!=m.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{$(t.instance_id)},icon:"mdi-delete",hide:l.builtin},{label:"settings.reload",labelArgs:[],action:()=>{D(t.instance_id)},icon:"mdi-refresh"}];g?.available&&g.supported_features.includes(ve.CREATE_GROUP_PLAYER)&&te.push({label:"settings.add_group_player",labelArgs:[],action:()=>{U.push(`/settings/addgroup/${g.lookup_key}`)},icon:"mdi-speaker-multiple"}),me.emit("contextmenu",{items:te,posX:e.clientX,posY:e.clientY})};B(()=>d.providers,e=>{e&&y()},{immediate:!0});const E=function(e){const t=d.providerManifests[e.domain].name;if(e.name)return`${t} [${e.name}]`;const l=d.getProvider(e.instance_id);return l&&l.instance_name_postfix?`${t} [${l.instance_name_postfix}]`:t},L=function(e){return e&&e.length>150},S=function(e){return K(e).with("stable",()=>"green").with("beta",()=>"blue").with("alpha",()=>"purple").with("experimental",()=>"orange").with("unmaintained",()=>"grey").with("deprecated",()=>"red").otherwise(()=>"green")},r=function(e){return K(e).with(m.MUSIC,()=>n("settings.music")).with(m.PLAYER,()=>n("settings.player")).with(m.METADATA,()=>n("settings.metadata")).with(m.PLUGIN,()=>n("settings.plugin")).otherwise(()=>n("settings.player"))},o=function(e){return{[m.MUSIC]:"mdi-music",[m.PLAYER]:"mdi-speaker",[m.METADATA]:"mdi-file-code",[m.PLUGIN]:"mdi-puzzle"}[e]||"mdi-help-circle"},i=function(){let e=[...k.value];if(f.value){const t=f.value.toLowerCase();e=e.filter(l=>E(l).toLowerCase().includes(t))}return w.value.length>0&&(e=e.filter(t=>w.value.includes(t.type))),e.sort((t,l)=>E(t).localeCompare(E(l)))};return(e,t)=>(c(),V(N,null,[A("div",Ne,[s(Pe,{"onUpdate:search":t[0]||(t[0]=l=>f.value=l),"onUpdate:types":t[1]||(t[1]=l=>w.value=l)}),s(C,{color:"primary",variant:"outlined",height:"40",class:"add-provider-btn",onClick:t[2]||(t[2]=l=>_.value=!0)},{default:a(()=>[p(v(u(n)("settings.add_provider")),1)]),_:1})]),A("div",Ue,v(u(n)("settings.providers_total",[i().length,i().length>1?"s":""])),1),s(fe,{variant:"comfortable",class:"mt-4"},{default:a(()=>[s(_e,null,{default:a(()=>[(c(!0),V(N,null,R(i(),l=>(c(),b(he,{key:l.instance_id,cols:"12",md:"6",lg:"4",class:"d-flex"},{default:a(()=>[s(le,{class:"flex-fill rounded-lg","min-height":"200px",onClick:g=>M(l.instance_id)},{prepend:a(()=>[s(ie,{domain:l.domain,size:50,class:"listitem-media-thumb",style:{"margin-top":"5px","margin-bottom":"5px"}},null,8,["domain"])]),append:a(()=>[u(d).syncTasks.value.filter(g=>g.provider_instance==l.instance_id).length>0?(c(),b(C,{key:0,variant:"text",size:"small",icon:"",title:u(n)("settings.sync_running")},{default:a(()=>[s(x,{color:"grey"},{default:a(()=>[...t[4]||(t[4]=[p(" mdi-sync ",-1)])]),_:1})]),_:1},8,["title"])):J("",!0),l.enabled?l.last_error?(c(),b(C,{key:2,variant:"text",size:"small",icon:"",title:l.last_error},{default:a(()=>[s(x,{color:"red"},{default:a(()=>[...t[6]||(t[6]=[p(" mdi-alert-circle ",-1)])]),_:1})]),_:1},8,["title"])):u(d).providers[l.instance_id]?.available?J("",!0):(c(),b(C,{key:3,variant:"text",size:"small",icon:"",title:u(n)("settings.not_loaded")},{default:a(()=>[s(x,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(c(),b(C,{key:1,variant:"text",size:"small",icon:"",title:u(n)("settings.provider_disabled")},{default:a(()=>[s(x,{color:"grey"},{default:a(()=>[...t[5]||(t[5]=[p(" mdi-cancel ",-1)])]),_:1})]),_:1},8,["title"])),s(C,{variant:"text",size:"small",icon:"",title:r(l.type)},{default:a(()=>[s(x,{icon:o(l.type)},null,8,["icon"])]),_:2},1032,["title"]),s(se,{size:"x-small",variant:"flat",class:"mx-1 text-uppercase",color:S(u(d).providerManifests[l.domain]?.stage)},{default:a(()=>[p(v(u(n)(String(u(d).providerManifests[l.domain]?.stage||"").toLowerCase())),1)]),_:2},1032,["color"]),s(C,{icon:"mdi-dots-vertical",size:"small",variant:"text",onClick:Y(g=>I(g,l),["stop"])},null,8,["onClick"])]),default:a(()=>[s(ae,null,{default:a(()=>[p(v(E(l)),1)]),_:2},1024),s(G,{class:ce(["provider-description",{"truncated-text":L(u(d).providerManifests[l.domain].description)}])},{default:a(()=>[p(v(u(d).providerManifests[l.domain].description),1)]),_:2},1032,["class"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),s(Le,{show:_.value,"onUpdate:show":t[3]||(t[3]=l=>_.value=l)},null,8,["show"])],64))}}),He=ee(De,[["__scopeId","data-v-793102d3"]]);export{He as default};

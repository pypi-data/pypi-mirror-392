import{r as M,O as B,ae as Z,s as V,h,o as i,i as ee,g as J,w as m,aT as ae,aD as le,b4 as C,d as Q,l as te,e as f,c as p,V as I,H as L,u as s,bc as k,b as _,j as S,a as R,t as v,bd as F,b8 as O,v as d,bj as $,y as oe,F as ie,bi as se,aW as W,aX as P,aV as A,be as Y,b5 as j,b6 as ne,b1 as re,bk as ue,x as de,n as me,aZ as N,M as ce,bh as pe,ba as ye,bo as ve,aI as be,p as fe,bl as H,bm as X}from"./index-Bi2RCUhr.js";import{B as E}from"./Button-jOejgyVz.js";import{M as ge}from"./MediaItemThumb-CwETg_tP.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as he}from"./VSlider-COnyqgaO.js";import{V as _e}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-CCq61o64.js";const we={inheritAttrs:!1,props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(e,t){const n=M(null),l=M(0),g=M(0),o=M(0),c=M(typeof t.attrs["model-value"]=="number"?t.attrs["model-value"]:0),b=B(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:20,step:2,elevation:0,style:`width: ${e.width}; height:${e.height}; display: inline-grid; ${e.style}`})),r=B(()=>{const w=t.attrs,{"model-value":T,modelValue:z,...U}=w||{};return U}),u=B(()=>({...b.value,...r.value})),a=({deltaY:w})=>{if(!e.allowWheel)return;const T=u.value.step,z=t.attrs["model-value"]??c.value,U=w<0?T:-T,q=Math.max(0,Math.min(100,z+U));c.value=q,t.emit("update:model-value",q)},y=w=>{l.value=w,g.value=0,c.value=w,V.isTouchscreen&&"vibrate"in navigator&&navigator.vibrate&&navigator.vibrate(10)},D=w=>{g.value++,g.value>2&&(c.value=w)},x=w=>{const T=Date.now();if(T-o.value<250)return;o.value=T;const z=u.value.step;if(g.value>3)c.value=w,t.emit("update:model-value",w);else{const U=w>l.value?z:-z,q=Math.max(0,Math.min(100,l.value+U));c.value=q,t.emit("update:model-value",q)}g.value=0};return Z(()=>t.attrs["model-value"],w=>{typeof w=="number"&&g.value===0&&(c.value=w)}),{playerVolumeProps:u,onWheel:a,sliderRef:n,onDragStart:y,onUpdateModelValue:D,onDragEnd:x,displayValue:c}}};function ke(e,t,n,l,g,o){return i(),h(he,le({ref:"sliderRef"},l.playerVolumeProps,{"model-value":l.displayValue,onWheel:C(l.onWheel,["prevent"]),onClick:t[0]||(t[0]=C(()=>{},["stop"])),onStart:l.onDragStart,"onUpdate:modelValue":l.onUpdateModelValue,onEnd:l.onDragEnd}),ee({_:2},[J(e.$slots,(c,b)=>({name:b,fn:m(()=>[ae(e.$slots,b,{},void 0,!0)])}))]),1040,["model-value","onWheel","onStart","onUpdate:modelValue","onEnd"])}const K=G(we,[["render",ke],["__scopeId","data-v-73f22395"]]),Ce={key:1,class:"text-caption volumecaption"},Se={key:0,class:"text-caption volumecaption"},Ve=Q({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(e){const t=e,n=M([]),l=M([]),g=M(void 0),o=B(()=>t.player.group_members.length>0),c=function(r){const u=[];for(const a of r.group_members){const y=d?.players[a];y&&y.volume_control!=k&&y&&y.available&&!u.includes(y)&&u.push(y)}if(t.showSyncControls&&r.supported_features.includes(W.SET_MEMBERS))for(const a of Object.values(d?.players))a.player_id!=r.player_id&&(!r.can_group_with.includes(a.player_id)&&!r.can_group_with.includes(a.provider)||a.available&&a.type!=$.GROUP&&(a.active_group&&a.active_group!=r.player_id||a.active_source&&a.playback_state==P.PLAYING&&![r.player_id,a.player_id].includes(a.active_source)||u.includes(a)||u.push(a)));return u.sort((a,y)=>{const D=r.group_members.includes(a.player_id),x=r.group_members.includes(y.player_id);return D!==x?D?-1:1:a.name.toUpperCase()>y.name.toUpperCase()?1:-1}),u},b=async function(r,u){const a=t.player.player_id;u?(l.value.includes(r)&&(l.value=l.value.filter(y=>y!=r)),n.value.includes(r)||n.value.push(r),d.players[a].group_members.push(r)):(n.value.includes(r)&&(n.value=n.value.filter(y=>y!=r)),l.value.includes(r)||l.value.push(r),d.players[a].group_members=d.players[a].group_members.filter(y=>y!=r)),g.value!=null&&clearTimeout(g.value),!(n.value.length==0&&l.value.length==0)&&(g.value=setTimeout(async()=>{d.playerCommandSetMembers(a,n.value.length?n.value:void 0,l.value.length?l.value:void 0).catch(async()=>{d.players[a]=await d.getPlayer(a)}).finally(()=>{n.value=[],l.value=[]})},500))};return(r,u)=>(i(),h(te,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:m(()=>[e.showHeadingRow?(i(),h(I,{key:0,class:"volumesliderrow heading",link:!1,style:L(e.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:m(()=>[_(S,{size:25,icon:e.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:m(()=>[R("h5",null,v(s(F)(e.player,27)),1)]),append:m(()=>[e.player.power_control!=s(k)?(i(),h(E,{key:0,class:"powerbtn",variant:"icon",onClick:u[0]||(u[0]=C(a=>s(d).playerCommandPowerToggle(e.player.player_id),["stop"]))},{default:m(()=>[_(S,{size:25,icon:"mdi-power"})]),_:1})):f("",!0)]),_:1},8,["style"])):f("",!0),e.showVolumeControl&&(e.player.volume_control!=s(k)||e.player.group_members.length)?(i(),h(I,{key:1,class:"volumesliderrow",link:!1,style:L(e.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:m(()=>[_(E,{icon:"",style:{height:"25px"},disabled:e.player.type==s($).GROUP||e.player.group_members.length>0||e.player.mute_control==s(k),onClick:u[1]||(u[1]=C(a=>s(d).playerCommandMuteToggle(e.player.player_id),["stop"]))},{default:m(()=>[_(S,{size:25,icon:e.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:m(()=>[e.player.volume_control!=s(k)||e.player.group_members.length?(i(),h(K,{key:0,color:"secondary",width:"100%","is-powered":e.player.powered!=!1,disabled:!e.player.available||e.player.volume_muted,"model-value":Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0),onClick:u[2]||(u[2]=C(()=>{},["stop"])),"onUpdate:modelValue":u[3]||(u[3]=a=>e.player.group_members.length>0?s(d).playerCommandGroupVolume(e.player.player_id,a):s(d).playerCommandVolumeSet(e.player.player_id,a))},null,8,["is-powered","disabled","model-value"])):f("",!0)]),append:m(()=>[o.value&&!e.showSubPlayers?(i(),h(S,{key:0,class:"expandbtn"},{default:m(()=>[...u[7]||(u[7]=[O(" mdi-chevron-down ",-1)])]),_:1})):(i(),p("div",Ce,v(Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0)),1))]),_:1},8,["style"])):f("",!0),e.showSubPlayers&&(e.player.group_members.length>0||e.showSyncControls)&&c(e.player).length>0?(i(),p("div",{key:2,onClick:u[6]||(u[6]=C(()=>{},["stop"]))},[_(oe,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(i(!0),p(ie,null,J(c(e.player),a=>(i(),p("div",{key:a.player_id},[_(I,{class:"volumesliderrow",link:!1,style:L(a.powered!=!1||e.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:u[4]||(u[4]=C(()=>{},["stop"]))},{prepend:m(()=>[_(S,{size:30,icon:a.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:m(()=>[R("h6",null,v(s(se)(a.name,27)),1)]),append:m(()=>[e.showSyncControls?(i(),h(_e,{key:0,ripple:!1,disabled:a.player_id==e.player.player_id||e.player.static_group_members.includes(a.player_id)&&e.player.group_members.includes(a.player_id),"model-value":e.player.group_members.includes(a.player_id)||a.player_id==e.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":y=>b(a.player_id,y)},null,8,["disabled","model-value","onUpdate:modelValue"])):f("",!0)]),_:2},1032,["style"]),a.volume_control!=s(k)&&e.player.group_members.includes(a.player_id)?(i(),h(I,{key:0,class:"volumesliderrow",link:!1,style:L(a.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:u[5]||(u[5]=C(()=>{},["stop"]))},{prepend:m(()=>[_(E,{icon:"",disabled:!a.available||a.mute_control==s(k),style:{height:"25px"},onClick:y=>s(d).playerCommandMuteToggle(a.player_id)},{default:m(()=>[_(S,{size:25,icon:a.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:m(()=>[a.volume_control!=s(k)?(i(),h(K,{key:0,color:"secondary",width:"100%","is-powered":a.powered!=!1,disabled:!a.available||a.volume_muted,"allow-wheel":e.allowWheel,"model-value":Math.round(a.volume_level||0),"onUpdate:modelValue":y=>s(d).playerCommandVolumeSet(a.player_id,y)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):f("",!0)]),append:m(()=>[a.volume_control!=s(k)?(i(),p("div",Se,v(a.volume_level),1)):f("",!0)]),_:2},1032,["style"])):f("",!0),u[8]||(u[8]=R("div",{style:{height:"14px"}},null,-1))]))),128))])):f("",!0)]),_:1}))}}),Me=G(Ve,[["__scopeId","data-v-b880ceed"]]),Te=(e,t)=>{const n=[];e?.power_control!=k&&n.push({label:e.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{d.playerCommandPowerToggle(e.player_id)},icon:"mdi-power"}),(e?.playback_state=="playing"||e?.playback_state=="paused")&&n.push({label:"stop_playback",labelArgs:[],action:()=>{d.playerCommandStop(e.player_id)},icon:"mdi-stop"});const l=Object.values(d.players).filter(o=>o.player_id!=e.player_id&&o.available&&o.enabled&&(o.can_group_with.includes(e.provider)||o.can_group_with.includes(e.player_id))&&o.supported_features.includes(W.SET_MEMBERS)&&!o.synced_to);e.supported_features.includes(W.SET_MEMBERS)&&!e.synced_to&&e.type==$.PLAYER&&e.group_members.length==0&&l.length>0&&n.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:l.map(o=>({label:o.name,labelArgs:[],action:()=>{d.playerCommandGroup(e.player_id,o.player_id)}})).sort((o,c)=>o.label.toUpperCase()>c.label?.toUpperCase()?1:-1)}),t&&n.push({label:t.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{d.queueCommandShuffleToggle(t.queue_id)},icon:t.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),t&&n.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{d.queueCommandRepeat(t.queue_id,A.OFF)},selected:t.repeat_mode==A.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{d.queueCommandRepeat(t.queue_id,A.ALL)},selected:t.repeat_mode==A.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{d.queueCommandRepeat(t.queue_id,A.ONE)},selected:t.repeat_mode==A.ONE}],icon:"mdi-repeat"}),t?.items&&n.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(d.players).filter(o=>o.player_id!=t.queue_id&&o.player_id!=e.player_id&&o.available&&o.enabled&&!o.synced_to).map(o=>({label:o.name,labelArgs:[],action:()=>{d.queueCommandTransfer(t.queue_id,o.player_id),V.activePlayerId=o.player_id}})).sort((o,c)=>o.label.toUpperCase()>c.label?.toUpperCase()?1:-1)}),t?.items&&n.push({label:"queue_clear",labelArgs:[],action:()=>{d.queueCommandClear(t.queue_id)},icon:"mdi-cancel"});const g=e.source_list.filter(o=>!o.passive||o.id==e.active_source);return!e.synced_to&&g.length>0&&n.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:g.map(o=>({label:o.name,labelArgs:[],disabled:o.id==e.active_source,selected:o.id==e.active_source,action:()=>{d.playerCommandGroupSelectSource(e.player_id,o.id)}})).sort((o,c)=>o.label.toUpperCase()>c.label?.toUpperCase()?1:-1)}),t&&"dont_stop_the_music_enabled"in t&&n.push({label:t.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{d.queueCommandDontStopTheMusicToggle(t.queue_id)},icon:"mdi-all-inclusive"}),n.push({label:"open_player_settings",labelArgs:[],action:()=>{V.showFullscreenPlayer=!1,V.showPlayersMenu=!1,Y.push(`/settings/editplayer/${e.player_id}`)},icon:"mdi-cog-outline"}),e.type!==$.GROUP&&n.push({label:"open_dsp_settings",labelArgs:[],action:()=>{V.showFullscreenPlayer=!1,V.showPlayersMenu=!1,Y.push(`/settings/editplayer/${e.player_id}/dsp`)},icon:"mdi-equalizer"}),n},Ae={class:"player-media-thumb"},Be={key:1},Ee={key:2,class:"icon-thumb"},ze={key:0,style:{"margin-bottom":"3px"}},Ue={key:0},qe={key:1},Ie={key:1},Pe={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},Re={key:0},$e={key:0},De={key:1},Le={key:2},Oe={class:"v-list-item-subtitle",style:{"font-size":"0.85rem","white-space":"nowrap"}},xe={key:0},Ne={key:1},Fe={key:2},We={key:3},Ge={key:4},Ye={key:5},je={key:6},He={key:7},Xe=Q({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean},allowPowerControl:{type:Boolean}},emits:["click"],setup(e){const t=e,n=B(()=>{if(t.player&&t.player.active_source&&t.player.active_source in d.queues)return d.queues[t.player.active_source];if(t.player&&!t.player.active_source&&t.player.player_id in d.queues)return d.queues[t.player.player_id]}),l=B(()=>{if(n.value&&n.value.active)return n.value.current_item}),g=function(b){fe.emit("contextmenu",{items:Te(t.player,n.value),posX:b.clientX,posY:b.clientY})},o=M({0:"",1:"",2:"",3:"",4:"",5:"",lightColor:"",darkColor:""}),c=new Image;return c.src=re.theme.current.value.dark?j:ne,c.crossOrigin="Anonymous",c.addEventListener("load",function(){o.value=ue(c)}),Z(l,b=>{b?.media_item?c.src=H(b.media_item,X.THUMB)||"":b?c.src=H(b,X.THUMB)||"":c.src=""},{immediate:!0}),(b,r)=>(i(),h(de,{flat:"",class:me(["panel-item",{"panel-item-selected":e.player.player_id==s(V).activePlayerId,"panel-item-idle":e.player.playback_state==s(P).IDLE,"panel-item-off":e.player.powered==!1}]),ripple:!1,disabled:!e.player.available,onClick:r[2]||(r[2]=u=>b.$emit("click",e.player))},{default:m(()=>[_(I,{class:"panel-item-details",flat:"",ripple:!1},{prepend:m(()=>[R("div",Ae,[e.player.powered!=!1&&l.value?(i(),h(ge,{key:0,class:"media-thumb",size:"60",item:l.value,fallback:s(j)},null,8,["item","fallback"])):e.player.powered!=!1&&!n.value&&e.player.current_media?.image_url?(i(),p("div",Be,[_(be,{class:"media-thumb",size:"60",src:e.player.current_media.image_url},null,8,["src"])])):(i(),p("div",Ee,[_(S,{size:"24",icon:e.player.type==s($).PLAYER&&e.player.group_members.length?"mdi-speaker-multiple":e.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]),title:m(()=>[s(ve).player_id===e.player.player_id?(i(),p("div",ze,[e.player.name=="This Device"?(i(),p("span",Ue,v(b.$t("this_device")),1)):(i(),p("span",qe,v(s(F)(e.player,27)),1)),_(S,{size:"20",class:"ml-2",icon:s(V).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(i(),p("div",Ie,v(s(F)(e.player,27)),1))]),subtitle:m(()=>[e.player.powered!=!1?(i(),p("div",Pe,[l.value?.media_item?(i(),p("div",Re,[O(v(l.value?.media_item.name)+" ",1),"version"in l.value?.media_item&&l.value?.media_item.version?(i(),p("span",$e,"("+v(l.value?.media_item.version)+")",1)):f("",!0)])):l.value?(i(),p("div",De,v(l.value?.name),1)):!n.value&&e.player.current_media?.title?(i(),p("div",Le,v(e.player.current_media.title),1)):f("",!0)])):f("",!0)]),default:m(()=>[R("div",Oe,[e.player.powered==!1?(i(),p("div",xe,v(b.$t("off")),1)):l.value?.media_item&&l.value?.media_item?.media_type==s(ce).TRACK&&"album"in l.value?.media_item&&l.value?.media_item.album?(i(),p("div",Ne,v(s(pe)(l.value?.media_item.artists))+" â€¢ "+v(l.value?.media_item.album.name),1)):l.value?.media_item&&"artists"in l.value?.media_item&&l.value?.media_item.artists.length>0?(i(),p("div",Fe,v(l.value?.media_item.artists[0].name),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title&&l.value?.streamdetails?.stream_metadata.artist?(i(),p("div",We,v(l.value?.streamdetails?.stream_metadata.artist)+" - "+v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title?(i(),p("div",Ge,v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.media_item?.metadata.description?(i(),p("div",Ye,v(l.value?.media_item.metadata.description),1)):!n.value&&e.player.active_source?(i(),p("div",je,v(b.$t("external_source_active",[s(ye)(e.player)])),1)):n.value?.items==0?(i(),p("div",He,v(b.$t("queue_empty")),1)):f("",!0)])]),append:m(()=>[e.player.playback_state==s(P).PAUSED||e.player.playback_state==s(P).PLAYING||n.value?.items?(i(),h(E,{key:0,variant:"icon",class:"player-command-btn",onClick:r[0]||(r[0]=C(u=>{s(d).playerCommandPlayPause(e.player.player_id),s(V).activePlayerId=e.player.player_id},["stop"]))},{default:m(()=>[_(S,{size:s(N)({breakpoint:"phone"})?"30":"32",icon:e.player.playback_state==s(P).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):f("",!0),e.player.power_control!=s(k)&&e.allowPowerControl?(i(),h(E,{key:1,variant:"icon",class:"player-command-btn",onClick:r[1]||(r[1]=C(u=>{s(d).playerCommandPowerToggle(e.player.player_id),s(V).activePlayerId=e.player.player_id},["stop"]))},{default:m(()=>[_(S,{size:s(N)({breakpoint:"phone"})?"30":"32"},{default:m(()=>[...r[3]||(r[3]=[O("mdi-power",-1)])]),_:1},8,["size"])]),_:1})):f("",!0),e.showMenuButton?(i(),h(E,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:C(g,["stop"])},{default:m(()=>[_(S,{size:s(N)({breakpoint:"phone"})?"30":"32"},{default:m(()=>[...r[4]||(r[4]=[O("mdi-dots-vertical",-1)])]),_:1},8,["size"])]),_:1})):f("",!0)]),_:1}),e.showVolumeControl?(i(),h(Me,{key:0,player:e.player,"show-sync-controls":e.showSyncControls,"show-heading-row":!1,"show-sub-players":e.showSubPlayers,"show-volume-control":e.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):f("",!0)]),_:1},8,["class","disabled"]))}}),la=G(Xe,[["__scopeId","data-v-f0fdac10"]]);export{K as P,Me as V,la as a,Te as g};

# This file was auto-generated by Fern from our API Definition.

import typing

import pydantic
import typing_extensions
from ..core.pydantic_utilities import IS_PYDANTIC_V2
from ..core.serialization import FieldMetadata
from ..core.unchecked_base_model import UncheckedBaseModel
from .insight_time_range import InsightTimeRange
from .update_text_insight_from_call_table_dto_queries_item import UpdateTextInsightFromCallTableDtoQueriesItem


class UpdateTextInsightFromCallTableDto(UncheckedBaseModel):
    name: typing.Optional[str] = pydantic.Field(default=None)
    """
    This is the name of the Insight.
    """

    type: typing.Literal["text"] = "text"
    formula: typing.Optional[typing.Dict[str, typing.Optional[typing.Any]]] = pydantic.Field(default=None)
    """
    Formulas are mathematical expressions applied on the data returned by the queries to transform them before being used to create the insight.
    The formulas needs to be a valid mathematical expression, supported by MathJS - https://mathjs.org/docs/expressions/syntax.html
    A formula is created by using the query names as the variable.
    The formulas must contain at least one query name in the LiquidJS format {{query_name}} or {{['query name']}} which will be substituted with the query result.
    For example, if you have 2 queries, 'Was Booking Made' and 'Average Call Duration', you can create a formula like this:
    ```
    {{['Query 1']}} / {{['Query 2']}} * 100
    ```
    
    ```
    ({{[Query 1]}} * 10) + {{[Query 2]}}
    ```
    This will take the
    
    You can also use the query names as the variable in the formula.
    """

    time_range: typing_extensions.Annotated[typing.Optional[InsightTimeRange], FieldMetadata(alias="timeRange")] = None
    queries: typing.Optional[typing.List[UpdateTextInsightFromCallTableDtoQueriesItem]] = pydantic.Field(default=None)
    """
    These are the queries to run to generate the insight.
    For Text Insights, we only allow a single query, or require a formula if multiple queries are provided
    """

    if IS_PYDANTIC_V2:
        model_config: typing.ClassVar[pydantic.ConfigDict] = pydantic.ConfigDict(extra="allow", frozen=True)  # type: ignore # Pydantic v2
    else:

        class Config:
            frozen = True
            smart_union = True
            extra = pydantic.Extra.allow

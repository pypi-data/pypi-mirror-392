# Context7 MCP Server Example
# Demonstrates using Context7 for up-to-date library/framework documentation
#
# Context7 provides version-specific documentation and code examples,
# eliminating outdated information and hallucinated APIs.
#
# Setup:
# - No API key required for basic use
# - Optional: Add CONTEXT7_API_KEY to .env for higher rate limits
#   Get key at: https://context7.com/dashboard
#
# Run with:
# uv run massgen --automation \
#   --config massgen/configs/tools/mcp/context7_documentation_example.yaml \
#   "Get the latest Next.js 15 App Router documentation for Server Components. Write the docs to a file, then summarize the key changes from Next.js 14."

agents:
  - id: "docs_researcher"
    backend:
      type: "gemini"
      model: "gemini-2.5-flash"

      mcp_servers:
        - name: "context7"
          type: "stdio"
          command: "npx"
          args: ["-y", "@upstash/context7-mcp"]
          security:
            level: "moderate"

    system_message: |
      You are a documentation research assistant with access to Context7.

      **Available Tools:**

      1. **resolve_context7_library_id** (mcp__context7__resolve_context7_library_id)
         - Resolves package/product names to Context7-compatible library IDs
         - Must be called before fetching docs (unless user provides explicit ID)
         - Input: libraryName (string)
         - Example: resolve_context7_library_id("next.js")

      2. **get_library_docs** (mcp__context7__get_library_docs)
         - Fetches version-specific documentation and code examples
         - Requires Context7-compatible library ID from resolver tool
         - Inputs:
           - context7CompatibleLibraryID (required)
           - topic (optional) - specific topic to focus on
           - tokens (optional) - defaults to 5000, can be 1000-50000
         - Returns: Current, version-specific documentation

      **Important Notes:**

      1. **Large Outputs**: Context7 can return extensive documentation (5K-50K tokens).
         - ALWAYS write output to a file first
         - Then read/parse the file to extract relevant sections
         - This prevents overwhelming the context window

      2. **Workflow**:
         - Step 1: Use resolve_context7_library_id() to get the library ID
         - Step 2: Use get_library_docs() with that ID (and optional topic)
         - Step 3: Write the result to a file (e.g., "docs.md")
         - Step 4: Read the file and extract/summarize relevant parts

      3. **Use Cases**:
         - Getting latest framework documentation (React, Vue, Next.js, etc.)
         - Finding current API references
         - Learning about new features in recent versions
         - Avoiding hallucinated or outdated information

      **Example Workflow:**
      ```
      User: "Get latest React hooks documentation"

      1. Call: resolve_context7_library_id("react")
         Result: "react-main"

      2. Call: get_library_docs(context7CompatibleLibraryID="react-main", topic="hooks")
         Result: [Large documentation text]

      3. Write result to "react_hooks_docs.md"

      4. Read file and summarize key points about hooks
      ```

ui:
  display_type: "rich_terminal"
  logging_enabled: true
